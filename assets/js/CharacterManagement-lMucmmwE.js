import{r as m,j as e,aF as y,aO as N,aR as C,a5 as k,X as w,e as S}from"./vendor-DB6ZcxRy.js";import{g as P,b as I,p as v,s as V}from"./index-7rp-VCqt.js";import"html5-qrcode";import"./utils-4B7jmfwz.js";const R=({characters:i,onEdit:h,onDelete:p,onCreate:c})=>{const[l,x]=m.useState(null),d=t=>{confirm(`Opravdu smazat postavu "${t.name}"?`)&&p(t.characterId)};return e.jsxs("div",{className:"p-6 pt-8 h-full overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-black uppercase tracking-wider text-white",children:"Správa postav"}),e.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-3 bg-signal-cyan text-black rounded-xl font-black uppercase hover:bg-white transition-colors",children:[e.jsx(y,{className:"w-5 h-5"}),"Nová postava"]})]}),i.length===0?e.jsx("div",{className:"text-center py-16",children:e.jsxs("div",{className:"text-zinc-600 mb-4",children:[e.jsx(N,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),e.jsx("p",{className:"text-lg font-bold",children:"Zatím žádné postavy"}),e.jsx("p",{className:"text-sm mt-2",children:'Klikni na "Nová postava" pro vytvoření první postavy.'})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(t=>{var r;return e.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-2xl p-5 hover:border-signal-cyan transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-black text-white mb-1",children:t.name}),e.jsx("p",{className:"text-xs font-mono text-zinc-500",children:t.characterId})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x(t),className:"p-2 bg-purple-500/10 hover:bg-purple-500/20 rounded-lg transition-colors",title:"Zobrazit QR kód",children:e.jsx(N,{className:"w-4 h-4 text-purple-400"})}),e.jsx("button",{onClick:()=>h(t),className:"p-2 bg-signal-cyan/10 hover:bg-signal-cyan/20 rounded-lg transition-colors",title:"Upravit",children:e.jsx(C,{className:"w-4 h-4 text-signal-cyan"})}),e.jsx("button",{onClick:()=>d(t),className:"p-2 bg-red-500/10 hover:bg-red-500/20 rounded-lg transition-colors",title:"Smazat",children:e.jsx(k,{className:"w-4 h-4 text-red-500"})})]})]}),t.description&&e.jsx("p",{className:"text-sm text-zinc-400 mb-4 line-clamp-2",children:t.description}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[e.jsxs("div",{className:"bg-black/50 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xs text-zinc-500 uppercase",children:"HP"}),e.jsx("div",{className:"text-lg font-bold text-white",children:t.baseStats.hp})]}),e.jsxs("div",{className:"bg-black/50 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xs text-zinc-500 uppercase",children:"DMG"}),e.jsx("div",{className:"text-lg font-bold text-white",children:t.baseStats.damage})]}),e.jsxs("div",{className:"bg-black/50 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xs text-zinc-500 uppercase",children:"Armor"}),e.jsx("div",{className:"text-lg font-bold text-white",children:t.baseStats.armor})]})]}),t.perks.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"text-xs font-bold text-signal-cyan uppercase mb-2",children:["Perky (",t.perks.length,")"]}),e.jsxs("div",{className:"space-y-1",children:[t.perks.slice(0,2).map((o,b)=>e.jsxs("div",{className:"text-xs text-zinc-400 truncate",children:["• ",o.name||"Bez názvu"]},b)),t.perks.length>2&&e.jsxs("div",{className:"text-xs text-zinc-600",children:["+",t.perks.length-2," dalších"]})]})]}),((r=t.timeVariant)==null?void 0:r.enabled)&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-purple-400",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-pulse"}),"Noční režim aktivní"]})]},t.characterId)})}),l&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl flex items-center justify-center p-6",onClick:()=>x(null),children:e.jsxs("div",{className:"bg-zinc-900 border border-signal-cyan/30 rounded-2xl p-8 max-w-sm w-full",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-black uppercase text-white",children:l.name}),e.jsx("button",{onClick:()=>x(null),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx(w,{className:"w-5 h-5 text-white"})})]}),e.jsx("div",{className:"bg-white p-4 rounded-xl mb-4",children:e.jsx("img",{id:`qr-${l.characterId}`,src:`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(l.characterId)}`,alt:"QR Code",className:"w-full h-auto"})}),e.jsx("button",{onClick:()=>{const t=document.createElement("a");t.href=`https://api.qrserver.com/v1/create-qr-code/?size=500x500&data=${encodeURIComponent(l.characterId)}`,t.download=`${l.characterId}_QR.png`,t.click()},className:"w-full py-3 mb-4 bg-signal-cyan text-black rounded-lg font-bold uppercase text-xs hover:bg-white transition-colors",children:"Stáhnout QR kód"}),e.jsx("p",{className:"text-center text-sm font-mono text-signal-cyan",children:l.characterId}),e.jsx("p",{className:"text-center text-xs text-zinc-500 mt-2",children:"Naskenuj tento kód pro načtení postavy"})]})})]})},D=({character:i,onSave:h,onClose:p})=>{var u,g;const[c,l]=m.useState(i||{characterId:"",adminEmail:"",name:"",description:"",imageUrl:"",baseStats:{hp:100,mana:100,armor:0,damage:10,critChance:5,speed:50},perks:[],timeVariant:{enabled:!1,nightModifiers:{statChanges:[],additionalPerks:[]}}}),[x,d]=m.useState(!1),t=(s,a)=>{l(n=>({...n,baseStats:{...n.baseStats,[s]:a}}))},r=()=>{l(s=>({...s,perks:[...s.perks,{name:"",description:"",effect:{stat:"damage",modifier:0,isPercentage:!1,condition:"always"}}]}))},o=(s,a)=>{l(n=>({...n,perks:n.perks.map((f,z)=>z===s?a:f)}))},b=s=>{l(a=>({...a,perks:a.perks.filter((n,f)=>f!==s)}))},j=async()=>{if(!c.name.trim()){alert("Jméno postavy je povinné!");return}d(!0);try{await h(c)}finally{d(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl overflow-y-auto",children:e.jsx("div",{className:"min-h-screen p-6 pt-36 pb-32",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-black uppercase tracking-wider text-white",children:i?"Upravit postavu":"Nová postava"}),e.jsx("button",{onClick:p,className:"p-2 bg-white/5 rounded-full hover:bg-white/10 transition-colors",children:e.jsx(w,{className:"w-6 h-6 text-white"})})]}),e.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-2xl p-6 mb-6",children:[e.jsx("h3",{className:"text-sm font-black uppercase text-signal-cyan mb-4",children:"Základní informace"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-zinc-400 mb-2",children:"Jméno postavy *"}),e.jsx("input",{type:"text",value:c.name,onChange:s=>l({...c,name:s.target.value}),className:"w-full bg-black border border-zinc-700 rounded-lg px-4 py-3 text-white outline-none focus:border-signal-cyan",placeholder:"např. Temný rytíř"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-zinc-400 mb-2",children:"Popis"}),e.jsx("textarea",{value:c.description,onChange:s=>l({...c,description:s.target.value}),className:"w-full bg-black border border-zinc-700 rounded-lg px-4 py-3 text-white outline-none focus:border-signal-cyan h-24 resize-none",placeholder:"Popis postavy..."})]}),i&&e.jsxs("div",{className:"text-xs text-zinc-500 font-mono",children:["ID: ",i.characterId]})]})]}),e.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-2xl p-6 mb-6",children:[e.jsx("h3",{className:"text-sm font-black uppercase text-signal-cyan mb-4",children:"Základní statistiky"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Object.entries(c.baseStats).map(([s,a])=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-zinc-400 mb-2",children:s==="hp"?"HP":s==="mana"?"Mana":s==="armor"?"Armor":s==="damage"?"Damage":s==="critChance"?"Crit %":"Speed"}),e.jsx("input",{type:"number",value:a,onChange:n=>t(s,parseInt(n.target.value)||0),className:"w-full bg-black border border-zinc-700 rounded-lg px-4 py-2 text-white outline-none focus:border-signal-cyan"})]},s))})]}),e.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-2xl p-6 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-sm font-black uppercase text-signal-cyan",children:"Výhody / Nevýhody"}),e.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-3 py-2 bg-signal-cyan text-black rounded-lg text-xs font-bold uppercase hover:bg-white transition-colors",children:[e.jsx(y,{className:"w-4 h-4"}),"Přidat"]})]}),e.jsxs("div",{className:"space-y-4",children:[c.perks.map((s,a)=>e.jsxs("div",{className:"bg-black/50 border border-zinc-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("span",{className:"text-xs font-bold text-zinc-500",children:["Perk #",a+1]}),e.jsx("button",{onClick:()=>b(a),className:"p-1 hover:bg-red-500/20 rounded transition-colors",children:e.jsx(k,{className:"w-4 h-4 text-red-500"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",value:s.name,onChange:n=>o(a,{...s,name:n.target.value}),placeholder:"Název perku",className:"bg-zinc-900 border border-zinc-700 rounded px-3 py-2 text-white text-sm outline-none focus:border-signal-cyan"}),e.jsx("input",{type:"text",value:s.description,onChange:n=>o(a,{...s,description:n.target.value}),placeholder:"Popis",className:"bg-zinc-900 border border-zinc-700 rounded px-3 py-2 text-white text-sm outline-none focus:border-signal-cyan"}),e.jsxs("select",{value:s.effect.stat,onChange:n=>o(a,{...s,effect:{...s.effect,stat:n.target.value}}),className:"bg-zinc-900 border border-zinc-700 rounded px-3 py-2 text-white text-sm outline-none focus:border-signal-cyan",children:[e.jsx("option",{value:"damage",children:"Damage"}),e.jsx("option",{value:"hp",children:"HP"}),e.jsx("option",{value:"armor",children:"Armor"}),e.jsx("option",{value:"mana",children:"Mana"}),e.jsx("option",{value:"critChance",children:"Crit Chance"}),e.jsx("option",{value:"speed",children:"Speed"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",value:s.effect.modifier,onChange:n=>o(a,{...s,effect:{...s.effect,modifier:parseFloat(n.target.value)||0}}),placeholder:"Hodnota",className:"flex-1 bg-zinc-900 border border-zinc-700 rounded px-3 py-2 text-white text-sm outline-none focus:border-signal-cyan"}),e.jsxs("select",{value:s.effect.isPercentage?"percent":"absolute",onChange:n=>o(a,{...s,effect:{...s.effect,isPercentage:n.target.value==="percent"}}),className:"bg-zinc-900 border border-zinc-700 rounded px-3 py-2 text-white text-sm outline-none focus:border-signal-cyan",children:[e.jsx("option",{value:"absolute",children:"+/-"}),e.jsx("option",{value:"percent",children:"%"})]})]}),e.jsxs("select",{value:s.effect.condition||"always",onChange:n=>o(a,{...s,effect:{...s.effect,condition:n.target.value}}),className:"bg-zinc-900 border border-zinc-700 rounded px-3 py-2 text-white text-sm outline-none focus:border-signal-cyan md:col-span-2",children:[e.jsx("option",{value:"always",children:"Vždy"}),e.jsx("option",{value:"night",children:"V noci"}),e.jsx("option",{value:"day",children:"Ve dne"}),e.jsx("option",{value:"combat",children:"V boji"})]})]})]},a)),c.perks.length===0&&e.jsx("div",{className:"text-center py-8 text-zinc-600 text-sm",children:'Zatím žádné perky. Klikni na "Přidat" pro vytvoření.'})]})]}),e.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-2xl p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("input",{type:"checkbox",checked:((u=c.timeVariant)==null?void 0:u.enabled)||!1,onChange:s=>l({...c,timeVariant:{...c.timeVariant,enabled:s.target.checked}}),className:"w-5 h-5"}),e.jsx("h3",{className:"text-sm font-black uppercase text-signal-cyan",children:"Noční režim"})]}),((g=c.timeVariant)==null?void 0:g.enabled)&&e.jsxs("div",{className:"text-xs text-zinc-400 bg-black/30 p-3 rounded-lg",children:[e.jsx("p",{className:"mb-2",children:"Noční režim je aktivní. Postava bude mít speciální vlastnosti během noci."}),e.jsx("p",{className:"text-zinc-500",children:'Tip: Přidej perky s podmínkou "V noci" pro noční bonusy.'})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:j,disabled:x,className:"flex-1 flex items-center justify-center gap-2 py-4 bg-signal-cyan text-black rounded-xl font-black uppercase hover:bg-white transition-colors disabled:opacity-50",children:[e.jsx(S,{className:"w-5 h-5"}),x?"Ukládám...":"Uložit postavu"]}),e.jsx("button",{onClick:p,className:"px-6 py-4 bg-zinc-800 text-white rounded-xl font-black uppercase hover:bg-zinc-700 transition-colors",children:"Zrušit"})]})]})})})},q=({userEmail:i})=>{const[h,p]=m.useState([]),[c,l]=m.useState(null),[x,d]=m.useState(!1),[t,r]=m.useState(null);m.useEffect(()=>{o()},[i]);const o=async()=>{try{const s=await P(i);p(s)}catch{}},b=()=>{l(null),d(!0)},j=s=>{l(s),d(!0)},u=async s=>{try{await V(i,s),r({message:"Postava uložena!",type:"success"}),v("success"),d(!1),await o(),setTimeout(()=>r(null),3e3)}catch(a){r({message:`Chyba: ${a.message}`,type:"error"}),v("error"),setTimeout(()=>r(null),3e3)}},g=async s=>{try{await I(i,s),r({message:"Postava smazána.",type:"success"}),v("success"),p(a=>a.filter(n=>n.characterId!==s)),setTimeout(()=>r(null),3e3)}catch(a){r({message:`Chyba: ${a.message}`,type:"error"}),v("error"),setTimeout(()=>r(null),3e3)}};return e.jsxs("div",{className:"h-full w-full bg-black relative overflow-hidden",children:[e.jsx(R,{characters:h,onCreate:b,onEdit:j,onDelete:g}),x&&e.jsx(D,{character:c,onSave:u,onClose:()=>d(!1)}),t&&e.jsx("div",{className:`fixed bottom-24 left-1/2 -translate-x-1/2 z-[300] px-6 py-3 rounded-xl border font-mono text-xs uppercase tracking-wider animate-in slide-in-from-bottom-4 ${t.type==="success"?"bg-green-950/90 border-green-500 text-green-400":"bg-red-950/90 border-red-500 text-red-400"}`,children:t.message})]})};export{q as default};
