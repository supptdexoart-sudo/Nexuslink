const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./InventoryView-F8E1UMx1.js","./vendor-DB6ZcxRy.js","./utils-4B7jmfwz.js","./Generator-Cv0namSM.js","./CharacterManagement-lMucmmwE.js","./Room-DKlo5_Gm.js","./SettingsView-BDzhfRYW.js","./SpaceshipView-BZ3Yl0cX.js"])))=>i.map(i=>d[i]);
var pa=Object.defineProperty;var ha=(t,s,p)=>s in t?pa(t,s,{enumerable:!0,configurable:!0,writable:!0,value:p}):t[s]=p;var Qt=(t,s,p)=>ha(t,typeof s!="symbol"?s+"":s,p);import{a as fa,r as a,j as e,T as ze,C as xs,A as xe,m as R,L as De,K as Lt,W as ba,S as ga,b as ja,c as Dt,P as Na,d as $t,e as va,U as ms,f as Vt,g as at,D as Ht,h as Nt,i as ya,k as us,l as ps,F as hs,n as fs,o as bs,p as Ct,H as wa,G as bt,q as ka,E as Sa,s as za,X as _e,I as Et,M as Ta,t as Ca,u as st,v as Ea,w as $e,x as Ve,y as He,z as gt,B as gs,J as Ze,N as vt,O as yt,Z as qe,Q as Ia,V as Re,Y as ke,_ as Ye,$ as Aa,a0 as Ra,a1 as Oa,a2 as _a,a3 as Ma,a4 as Ge,a5 as js,a6 as Pa,a7 as jt,a8 as It,a9 as La,aa as Ns,ab as vs,ac as ys,ad as ws,ae as Gt,af as Da,ag as $a,ah as Va,ai as Ha,aj as At,ak as Ga,al as Ua,am as Ba,an as ks,ao as Ka,ap as Xt,aq as Fa,ar as Za,as as qa,at as Ya,au as Ja,av as Wa,aw as Qa,ax as Xa,R as en}from"./vendor-DB6ZcxRy.js";import{Html5Qrcode as tn,Html5QrcodeSupportedFormats as ut}from"html5-qrcode";import{G as sn,a as an}from"./utils-4B7jmfwz.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))n(c);new MutationObserver(c=>{for(const i of c)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function p(c){const i={};return c.integrity&&(i.integrity=c.integrity),c.referrerPolicy&&(i.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?i.credentials="include":c.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(c){if(c.ep)return;c.ep=!0;const i=p(c);fetch(c.href,i)}})();var Rt={},es=fa;Rt.createRoot=es.createRoot,Rt.hydrateRoot=es.hydrateRoot;const nn="modulepreload",rn=function(t,s){return new URL(t,s).href},ts={},Je=function(s,p,n){let c=Promise.resolve();if(p&&p.length>0){const o=document.getElementsByTagName("link"),m=document.querySelector("meta[property=csp-nonce]"),g=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));c=Promise.allSettled(p.map(b=>{if(b=rn(b,n),b in ts)return;ts[b]=!0;const y=b.endsWith(".css"),v=y?'[rel="stylesheet"]':"";if(!!n)for(let E=o.length-1;E>=0;E--){const I=o[E];if(I.href===b&&(!y||I.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${b}"]${v}`))return;const N=document.createElement("link");if(N.rel=y?"stylesheet":nn,y||(N.as="script"),N.crossOrigin="",N.href=b,g&&N.setAttribute("nonce",g),document.head.appendChild(N),y)return new Promise((E,I)=>{N.addEventListener("load",E),N.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${b}`)))})}))}function i(o){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=o,window.dispatchEvent(m),!m.defaultPrevented)throw o}return c.then(o=>{for(const m of o||[])m.status==="rejected"&&i(m.reason);return s().catch(i)})},ne="https://nexus-backend-m492.onrender.com/api",Ss="nexus_admin_token",ln="263088388062-9dgio8dv930qsefdokl2g0uqekvrvs2c.apps.googleusercontent.com",ie=async(t,s={},p=!1)=>{if(!navigator.onLine)throw new Error("OFFLINE_MODE");try{const n=sessionStorage.getItem(Ss),c=localStorage.getItem("nexus_current_user"),i=new Headers(s.headers||{});n&&i.set("x-admin-key",n),c&&i.set("x-user-email",c),!i.has("Content-Type")&&!(s.body instanceof FormData)&&i.set("Content-Type","application/json");const o=await fetch(t,{...s,headers:i});if(!o.ok){const m=await o.json().catch(()=>({message:o.statusText}));throw new Error(m.message||`API Error: ${o.status}`)}return await o.json()}catch(n){throw n}},cn=async()=>{if(!navigator.onLine)return!1;try{const t=new AbortController,s=setTimeout(()=>t.abort(),2e3),p=await fetch(`${ne}/health`,{signal:t.signal});return clearTimeout(s),p.ok}catch{return!1}},er=async()=>{if(!navigator.onLine)throw new Error("Nelze z치lohovat v offline re쬴mu.");const t=sessionStorage.getItem(Ss),s=await fetch(`${ne}/admin/backup`,{method:"GET",headers:{"x-admin-key":t||""}});if(!s.ok)throw new Error("Chyba p콏i stahov치n칤 z치lohy (Access Denied?)");const p=await s.blob(),n=window.URL.createObjectURL(p),c=document.createElement("a");c.href=n,c.download=`nexus_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(n),document.body.removeChild(c)},tr=async t=>ie(`${ne}/admin/purge/${encodeURIComponent(t)}`,{method:"DELETE"}),on=async(t,s,p,n)=>ie(`${ne}/admin/action`,{method:"POST",body:JSON.stringify({roomId:t,targetName:s,actionType:p,value:n})}),dn=async(t,s,p,n)=>ie(`${ne}/inventory/swap`,{method:"POST",body:JSON.stringify({player1Email:t,player2Email:s,item1Id:p,item2Id:n})}),xn=async(t,s,p,n,c)=>ie(`${ne}/trade/init`,{method:"POST",body:JSON.stringify({roomId:t,initiatorEmail:s,initiatorNick:p,targetNick:n,item:c})}),mn=async(t,s)=>ie(`${ne}/trade/cancel`,{method:"POST",body:JSON.stringify({roomId:t,tradeId:s})}),un=async(t,s,p,n)=>ie(`${ne}/trade/update`,{method:"POST",body:JSON.stringify({roomId:t,tradeId:s,userEmail:p,item:n})}),pn=async(t,s,p,n)=>ie(`${ne}/trade/confirm`,{method:"POST",body:JSON.stringify({roomId:t,tradeId:s,userEmail:p,isConfirmed:n})}),ss=async t=>{await ie(`${ne}/rooms/${t}/start-game`,{method:"POST"})},hn=async t=>{const s=`${ne}/auth/google`;return ie(s,{method:"POST",body:JSON.stringify({credential:t,clientId:ln})})},as=async t=>ie(`${ne}/inventory/${t}`),Ot=async(t,s)=>ie(`${ne}/inventory/${t}`,{method:"POST",body:JSON.stringify(s)}),_t=async(t,s)=>ie(`${ne}/inventory/${t}/${encodeURIComponent(s)}`,{method:"DELETE"}),fn=async t=>ie(`${ne}/inventory/zbynekbal97@gmail.com`),Mt=async(t,s)=>{try{return await ie(`${ne}/inventory/${t}/${encodeURIComponent(s)}`,void 0,!0)}catch{return null}},et=async t=>ie(`${ne}/rooms/${t}/status`),ns=async(t,s,p)=>{ie(`${ne}/rooms/${t}/status`,{method:"POST",body:JSON.stringify({userName:s,hp:p})},!0).catch(()=>{})},bn=async t=>ie(`${ne}/rooms/${t}/next-turn`,{method:"POST"}),rs=async(t,s)=>{ie(`${ne}/rooms/${t}/leave`,{method:"POST",body:JSON.stringify({userName:s})},!0).catch(()=>{})},gn=async(t,s,p)=>ie(`${ne}/rooms/${t}/messages`,{method:"POST",body:JSON.stringify({sender:s,text:p})},!0),pt=async t=>ie(`${ne}/rooms/${t}/messages`),jn=async(t,s,p,n)=>ie(`${ne}/rooms`,{method:"POST",body:JSON.stringify({roomId:t,hostName:s,hostEmail:p,password:n})}),Nn=async(t,s,p,n,c)=>ie(`${ne}/rooms/${t}/join`,{method:"POST",body:JSON.stringify({userName:s,email:c,hp:p||100,password:n})}),vn=async(t,s,p)=>ie(`${ne}/rooms/${t}/ready`,{method:"POST",body:JSON.stringify({userName:s,isReady:p})},!0),is=async(t,s)=>{await ie(`${ne}/rooms/${t}/encounter`,{method:"POST",body:JSON.stringify({encounter:s})},!0).catch(()=>{})},sr=async t=>ie(`${ne}/characters/${t}`),Pt=async t=>{try{return await ie(`${ne}/characters/by-id/${encodeURIComponent(t)}`,void 0,!0)}catch{return null}},ar=async(t,s)=>ie(`${ne}/characters/${t}`,{method:"POST",body:JSON.stringify(s)}),nr=async(t,s)=>ie(`${ne}/characters/${t}/${encodeURIComponent(s)}`,{method:"DELETE"});var ae=(t=>(t.ITEM="P콎EDM캨T",t.ENCOUNTER="SETK츼N칈",t.TRAP="N츼STRAHA",t.MERCHANT="OBCHODN칈K",t.DILEMA="DILEMA",t.BOSS="BOSS",t.SPACE_STATION="VESM칈RN츼_STANICE",t.PLANET="PLANETA",t))(ae||{}),Oe=(t=>(t.WARRIOR="V치le캜n칤k",t.MAGE="M치g",t.ROGUE="Zlod캩j",t.CLERIC="Kn캩z",t))(Oe||{});let Se=null,tt=null,Ae=null,ht=null,ft=null,zs=localStorage.getItem("nexus_sound_enabled")!=="false",Ts=localStorage.getItem("nexus_vibration_enabled")!=="false";const yn=t=>{zs=t,localStorage.setItem("nexus_sound_enabled",String(t)),t&&w("click")},wn=t=>{Ts=t,localStorage.setItem("nexus_vibration_enabled",String(t)),t&&W(50)},kn=()=>(Se||(Se=new(window.AudioContext||window.webkitAudioContext),tt=Se.createGain(),tt.gain.value=.5,Ae=Se.createDynamicsCompressor(),Ae.threshold.value=-24,Ae.knee.value=30,Ae.ratio.value=12,Ae.attack.value=.003,Ae.release.value=.25,ht=Se.createDelay(1),ht.delayTime.value=.35,ft=Se.createGain(),ft.gain.value=.25,tt.connect(Ae),tt.connect(ht),ht.connect(ft),ft.connect(Ae),Ae.connect(Se.destination)),Se.state==="suspended"&&Se.resume(),{ctx:Se,master:tt}),W=t=>{Ts&&typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(t)},w=t=>{if(zs)try{const{ctx:s,master:p}=kn();if(!s||!p)return;const n=s.currentTime,c=(i,o,m,g,b=.1,y=0)=>{const v=s.createOscillator(),d=s.createGain(),N=s.createBiquadFilter();return v.type=o,v.frequency.value=i,v.detune.value=y,N.type="lowpass",N.frequency.setValueAtTime(3e3,m),N.Q.value=1,v.connect(N),N.connect(d),d.connect(p),d.gain.setValueAtTime(0,m),d.gain.linearRampToValueAtTime(b,m+.01),d.gain.exponentialRampToValueAtTime(.001,m+g),v.start(m),v.stop(m+g),{osc:v,gain:d,filter:N}};switch(t){case"click":{const{filter:i}=c(800,"square",n,.08,.05);i.frequency.setValueAtTime(2e3,n),i.frequency.exponentialRampToValueAtTime(100,n+.08)}break;case"open":{const i=c(220,"sawtooth",n,.4,.08,-5),o=c(220,"sawtooth",n,.4,.08,5);i.filter.frequency.setValueAtTime(100,n),i.filter.frequency.exponentialRampToValueAtTime(4e3,n+.3),o.filter.frequency.setValueAtTime(100,n),o.filter.frequency.exponentialRampToValueAtTime(4e3,n+.3)}break;case"scan":[880,1108,1318,1760].forEach((o,m)=>{const g=n+m*.06,{filter:b}=c(o,"square",g,.05,.04);b.frequency.value=3e3});break;case"error":{const i=s.createOscillator(),o=s.createGain(),m=s.createBiquadFilter();i.type="sawtooth",i.frequency.setValueAtTime(110,n),i.frequency.linearRampToValueAtTime(55,n+.3),m.type="lowpass",m.frequency.setValueAtTime(800,n),m.frequency.linearRampToValueAtTime(100,n+.3),i.connect(m),m.connect(o),o.connect(p),o.gain.setValueAtTime(.3,n),o.gain.exponentialRampToValueAtTime(.001,n+.3),i.start(n),i.stop(n+.35)}break;case"success":case"gift":{[523.25,659.25,783.99,1046.5].forEach((b,y)=>{const v=n+y*.08,d=s.createOscillator(),N=s.createGain();d.type="sine",d.frequency.setValueAtTime(b,v),d.connect(N),N.connect(p),N.gain.setValueAtTime(0,v),N.gain.linearRampToValueAtTime(.2,v+.02),N.gain.exponentialRampToValueAtTime(.001,v+.6),d.start(v),d.stop(v+.6)});const o=s.createOscillator(),m=s.createGain(),g=s.createBiquadFilter();o.type="triangle",o.frequency.setValueAtTime(261.63,n),g.type="lowpass",g.frequency.value=600,o.connect(g),g.connect(m),m.connect(p),m.gain.setValueAtTime(0,n),m.gain.linearRampToValueAtTime(.25,n+.05),m.gain.exponentialRampToValueAtTime(.001,n+.8),o.start(n),o.stop(n+.8)}break;case"heal":{const i=s.createOscillator(),o=s.createGain();i.type="sine",i.frequency.setValueAtTime(440,n);const m=s.sampleRate*2,g=s.createBuffer(1,m,s.sampleRate),b=g.getChannelData(0);for(let N=0;N<m;N++)b[N]=Math.random()*2-1;const y=s.createBufferSource();y.buffer=g;const v=s.createBiquadFilter();v.type="bandpass",v.frequency.value=1e3;const d=s.createGain();i.connect(o),y.connect(v),v.connect(d),d.connect(o),o.connect(p),o.gain.setValueAtTime(0,n),o.gain.linearRampToValueAtTime(.2,n+.8),o.gain.linearRampToValueAtTime(0,n+2),d.gain.value=.1,i.start(n),y.start(n),i.stop(n+2),y.stop(n+2)}break;case"damage":{const i=s.sampleRate,o=s.createBuffer(1,i,s.sampleRate),m=o.getChannelData(0);for(let v=0;v<i;v++)m[v]=Math.random()*2-1;const g=s.createBufferSource();g.buffer=o;const b=s.createBiquadFilter();b.type="lowpass",b.frequency.setValueAtTime(1e3,n),b.frequency.exponentialRampToValueAtTime(50,n+.4);const y=s.createGain();y.gain.setValueAtTime(.8,n),y.gain.exponentialRampToValueAtTime(.001,n+.4),g.connect(b),b.connect(y),y.connect(p),g.start(n),g.stop(n+.4),c(60,"square",n,.3,.3)}break;case"message":c(1200,"sine",n,.1,.05),c(1800,"sine",n+.1,.1,.05);break;case"siren":{const i=s.createOscillator(),o=s.createGain(),m=s.createBiquadFilter();i.type="sawtooth",i.frequency.value=150,i.detune.value=10,m.type="lowpass",m.Q.value=15;const g=s.createOscillator();g.type="sine",g.frequency.value=2;const b=s.createGain();b.gain.value=600,g.connect(b),b.connect(m.frequency),m.frequency.value=800,i.connect(m),m.connect(o),o.connect(p),o.gain.setValueAtTime(0,n),o.gain.linearRampToValueAtTime(.3,n+.5),o.gain.linearRampToValueAtTime(0,n+2.5),i.start(n),g.start(n),i.stop(n+2.5),g.stop(n+2.5)}break;case"crit":c(1500,"triangle",n,.3,.2).osc.frequency.exponentialRampToValueAtTime(3e3,n+.1),c(2e3,"sine",n+.05,.4,.2);break;case"miss":{const i=c(400,"sawtooth",n,.3,.1);i.filter.frequency.setValueAtTime(800,n),i.filter.frequency.exponentialRampToValueAtTime(100,n+.2),i.osc.frequency.linearRampToValueAtTime(100,n+.2)}break}}catch{}},ls="zbynekbal97@gmail.com",Tt="test1@nexus.cz",Sn=()=>{const t=new Date().getHours();return t>=20||t<6};var me=(t=>(t.SCANNER="scanner",t.INVENTORY="inventory",t.MERCHANT="merchant",t.GENERATOR="generator",t.CHARACTERS="characters",t.DATABASE="database",t.ROOM="room",t.SETTINGS="settings",t.SPACESHIP="spaceship",t))(me||{});const zn=()=>{const[t,s]=a.useState(localStorage.getItem("nexus_current_user")),[p,n]=a.useState(!1),[c,i]=a.useState(!1),[o,m]=a.useState(!1),[g,b]=a.useState(!1),[y,v]=a.useState(!1),[d,N]=a.useState(Sn()),[E,I]=a.useState(null),[Y,k]=a.useState(100),[M,A]=a.useState(100),[Z,ee]=a.useState(100),[ce,le]=a.useState(0),[L,h]=a.useState(0),[S,O]=a.useState(100),[J,F]=a.useState(null),[B,Q]=a.useState(null),[te,T]=a.useState("scanner"),[$,j]=a.useState(null);a.useEffect(()=>{},[$]);const[f,D]=a.useState([]),[q,oe]=a.useState(!1),[fe,ue]=a.useState(null),[be,Me]=a.useState(!0),[Te,Ue]=a.useState(!0),[he,_]=a.useState(null),[V,K]=a.useState([]),[de,Ce]=a.useState([]),[C,H]=a.useState(null),[l,U]=a.useState({id:"",isInRoom:!1,members:[],messages:[],nickname:"",isNicknameSet:!1,isGameStarted:!1,roundNumber:0,turnIndex:0,turnOrder:[],readyForNextRound:[],host:"",activeTrades:[]}),[re,ge]=a.useState(null),[Ne,ve]=a.useState(!1),[Ee,Ut]=a.useState(""),we=l.isInRoom&&l.isGameStarted&&l.turnOrder[l.turnIndex]===l.nickname,Be=l.isInRoom&&(!l.isGameStarted||!we),[je,Ls]=a.useState(!1),[Yn,Ds]=a.useState(!1),[$s,Bt]=a.useState(!1),[Vs,Kt]=a.useState(null),[Ft,Zt]=a.useState(null),qt=a.useRef([]),Hs=a.useRef(Y),nt=a.useRef(!1),rt=a.useRef(!1),it=a.useRef(-1),wt=a.useRef(0),Gs=async(r,u,x,P)=>{try{await dn(r,u,x,P),j({id:"swap-ok",message:"V칳m캩na 칰sp캩코n치.",type:"success"}),w("success"),c||dt()}catch{j({id:"swap-err",message:"V칳m캩na selhala.",type:"error"}),w("error")}},Us=async(r,u)=>{if(!(!l.id||!l.nickname||!t))try{await xn(l.id,t,l.nickname,r,u)}catch(x){j({id:"trade-init-err",message:x.message,type:"error"})}},Bs=async()=>{if(!(!l.id||!re))try{await mn(l.id,re.id),ge(null)}catch{}},Ks=async r=>{if(!(!l.id||!re||!t))try{const u=await pn(l.id,re.id,t,r);u.success&&u.status==="COMPLETED"&&(w("success"),j({id:"trade-done",message:"Obchod dokon캜en!",type:"success"}),ge(null),dt())}catch{}},Fs=async r=>{if(!(!l.id||!re||!t))try{await un(l.id,re.id,t,r)}catch{}},Ke=r=>{k(u=>{const x=Math.min(150,Math.max(0,u+r));return x<u?(ue("red"),W(200)):x>u&&ue("green"),l.isInRoom&&l.id&&ns(l.id,l.nickname,x),x}),setTimeout(()=>ue(null),300)},kt=r=>A(u=>Math.min(100,Math.max(0,u+r))),lt=r=>ee(u=>Math.min(100,Math.max(0,u+r))),We=r=>le(u=>Math.max(0,u+r)),Zs=async(r,u,x)=>{if(!u.every(z=>V.some(G=>G.id===z))&&!o){j({id:"craft-err",message:"Chyb칤 suroviny!",type:"error"});return}if(!o)for(const z of u){const G=V.find(X=>X.id===z);G&&await Qe(G.id)}await xt(x,!0),w("success"),j({id:"craft-ok",message:`Vyrobeno: ${x.title}`,type:"success"})},qs=async r=>{v(!0);try{const u=V.find(z=>z.id===r);if(!u)return;const x=(u.planetProgress||0)+1,P={...u,planetProgress:x};await xt(P,!1),j({id:"scan-prog-"+Date.now(),message:`Postup v sektoru: ${x}`,type:"success"})}catch{}finally{v(!1)}},Ys=async()=>{if(p&&confirm("OPRAVDU SMAZAT CEL칗 TESTOVAC칈 BATOH (test1@nexus.cz)? Tuto akci nelze vz칤t zp캩t.")){v(!0),w("error");try{const r=await as(Tt);await Promise.all(r.map(u=>_t(Tt,u.id))),K([]),localStorage.setItem(`nexus_inv_${Tt}`,JSON.stringify([])),j({id:"wipe-ok",message:"Testovac칤 batoh byl kompletn캩 vymaz치n.",type:"success"}),w("success")}catch{j({id:"wipe-err",message:"Chyba p콏i maz치n칤 testovac칤ch dat.",type:"error"})}finally{v(!1)}}},Js=async()=>{if(c){if(!confirm("VAROV츼N칈: Jste v re쬴mu Host. Vynucen치 synchronizace SMA콯E v코echna lok치ln칤 data a nen치vratn캩 ztrat칤te invent치콏. Pokra캜ovat?"))return;K([]),localStorage.removeItem("nexus_inv_guest"),localStorage.removeItem("nexus_master_catalog"),j({id:"hard-reset",message:"Lok치ln칤 data smaz치na.",type:"info"}),window.location.reload()}await dt()},Yt=(r,u)=>{if(!r||!r.perks)return{hp:0,mana:0,armor:0,damage:0,critChance:0};let x={hp:0,mana:0,armor:0,damage:0,critChance:0};return r.perks.forEach(P=>{const z=P.effect.condition||"always";let G=!1;switch(z){case"always":G=!0;break;case"night":G=u;break;case"day":G=!u;break;case"combat":G=!1;break}if(G){const X=P.effect.stat,se=P.effect.modifier,pe=P.effect.isPercentage;x.hasOwnProperty(X)&&(x[X]+=se)}}),x},Ws=async(r,u,x,P,z)=>{var G;if(localStorage.setItem(`nexus_nickname_${t}`,r),localStorage.setItem(`nexus_class_${t||"guest"}`,u),F(u),z){Q(z);let X=z.baseStats.hp,se=z.baseStats.mana,pe=z.baseStats.armor;const ye=Yt(z,d);X+=ye.hp,se+=ye.mana,pe+=ye.armor,k(X),A(se),h(pe),localStorage.setItem(`nexus_character_${t}`,JSON.stringify(z));const mt=((G=z.perks)==null?void 0:G.filter(Xe=>{const Ie=Xe.effect.condition||"always";return Ie==="always"||Ie==="night"&&d||Ie==="day"&&!d}))||[];if(mt.length>0){const Xe=mt.map(Ie=>Ie.name).join(", ");setTimeout(()=>{j({id:"char-init-"+Date.now(),type:"success",message:`Postava ${z.name} p콏ipravena! Aktivn칤 perky: ${Xe}`}),w("success")},1500)}}try{if(x==="solo"){ve(!0),localStorage.setItem("nexus_solo_mode","true"),localStorage.setItem("nexus_is_in_room","false"),U(pe=>({...pe,nickname:r,isNicknameSet:!0,isInRoom:!1,id:""})),Pe(`Syst칠m aktivov치n. Batoh p콏ipraven, ${r}.`);return}let X="",se=!1;x==="create"||x==="solo-online"?(X=(x==="solo-online"?"SOLO-":"")+Math.random().toString(36).substring(2,7).toUpperCase(),await jn(X,r,t||"guest",P),se=!0):(X=x.toUpperCase(),await Nn(X,r,Y,P,t||void 0)),U(pe=>({...pe,id:X,nickname:r,isNicknameSet:!0,isInRoom:!0,host:se?r:pe.host,members:se?[{name:r,email:t||"guest",hp:100,isReady:!1}]:pe.members})),localStorage.setItem("nexus_last_room_id",X),localStorage.setItem("nexus_is_in_room","true"),ve(x==="solo-online"),localStorage.setItem("nexus_solo_mode",x==="solo-online"?"true":"false"),x==="solo-online"&&setTimeout(async()=>{try{await ss(X)}catch{}},1e3),Pe(`${x==="create"?"Sektor zalo쬰n":"Vstup do sektoru"}: ${X} `)}catch(X){throw j({id:"room-err",type:"error",message:X.message}),X}},Jt=async()=>{l.id&&l.nickname&&await rs(l.id,l.nickname),U(r=>({...r,isInRoom:!1,id:""})),localStorage.removeItem("nexus_last_room_id"),localStorage.removeItem("nexus_is_in_room"),ve(!0),localStorage.setItem("nexus_solo_mode","true"),D([])},Qs=async()=>{if(l.id&&l.nickname)try{await rs(l.id,l.nickname)}catch{}U(r=>({...r,isInRoom:!1,id:"",isNicknameSet:!1})),localStorage.removeItem("nexus_last_room_id"),localStorage.removeItem("nexus_is_in_room"),ve(!1),localStorage.setItem("nexus_solo_mode","false"),D([])},Xs=async()=>{if(!l.id||!l.nickname)return;const r=l.members.find(x=>x.name===l.nickname),u=!(r!=null&&r.isReady);try{await vn(l.id,l.nickname,u),U(x=>({...x,members:x.members.map(P=>P.name===x.nickname?{...P,isReady:u}:P)})),w("success")}catch{}},ea=async r=>{if(!(!l.id||!l.nickname))try{await gn(l.id,l.nickname,r)}catch{}},ta=async r=>{oe(!0);try{let u=de.find(x=>x.id===r);u||(u=await Mt(ls,r)),u?(_(ot(u,d,J)),Pe(`Inspekce: ${u.title} `)):j({id:"inspect-err",type:"error",message:"Data assetu nelze dek칩dovat."})}catch{j({id:"inspect-err",type:"error",message:"Chyba spojen칤 s Batohem."})}finally{oe(!1)}};a.useEffect(()=>{if(te==="room"&&l.isInRoom&&l.id&&g){const r=async()=>{try{const x=await et(l.id),P=await pt(l.id);U(z=>({...z,members:x.members,turnOrder:x.turnOrder,turnIndex:x.turnIndex,messages:P,isGameStarted:x.isGameStarted,roundNumber:x.roundNumber,readyForNextRound:x.readyForNextRound,host:x.host}))}catch{}};r();const u=setTimeout(r,300);return()=>clearTimeout(u)}},[te,l.isInRoom,l.id,g]),a.useEffect(()=>{if(!l.isInRoom||!l.id||!g)return;const r=setInterval(async()=>{var u,x,P;try{const z=await et(l.id),G=await pt(l.id);if(qt.current=z.members,!z.members.some(ye=>ye.name===l.nickname)&&l.isInRoom){j({id:"kicked",type:"error",message:"游뛂 Byl jsi vyhozen ze sektoru."}),Jt();return}z.isGameStarted&&!nt.current&&(j({id:"game-start",type:"success",message:"游 MISE ZAH츼JENA! Sektor byl uzam캜en."}),w("success"),nt.current=!0);const se=(u=z.turnOrder)==null?void 0:u[z.turnIndex],pe=z.turnIndex;if(pe!==it.current&&(rt.current=!1,it.current=pe,z.isGameStarted&&se===l.nickname&&(j({id:"your-turn-"+Date.now(),type:"warning",message:"丘멆잺 JSI NA TAHU!"}),w("open"),W([100,50,100]),rt.current=!0)),U(ye=>({...ye,members:z.members,turnIndex:z.turnIndex,messages:G,isGameStarted:z.isGameStarted,roundNumber:z.roundNumber,turnOrder:z.turnOrder,readyForNextRound:z.readyForNextRound,host:z.host})),z.activeEncounter&&(!he||he.id!==z.activeEncounter.id)){const ye=ot(z.activeEncounter,d,J);_(ye),wt.current=Date.now(),w("error"),W([200,100,200])}await ns(l.id,l.nickname,Hs.current)}catch(z){((x=z.message)!=null&&x.includes("404")||(P=z.message)!=null&&P.includes("Sektor nenalezen"))&&(U(G=>({...G,isInRoom:!1,id:""})),localStorage.setItem("nexus_is_in_room","false"))}},1500);return()=>clearInterval(r)},[l.isInRoom,l.id,l.nickname,c,g,he]);const sa=async r=>{if(l.host===l.nickname)try{await on(l.id,r,"kick",null),j({id:"kick-ok",type:"success",message:`${r} byl odstran캩n.`}),w("success");const u=await et(l.id);U(x=>({...x,members:u.members,turnOrder:u.turnOrder}))}catch{}},aa=async()=>{if(l.host===l.nickname)try{await ss(l.id),U(r=>({...r,isGameStarted:!0})),w("success")}catch{}},na=async r=>{var P;if(Be&&!r.startsWith("friend:")){const z=l.isGameStarted?"NEM콡콯E SKENOVAT: Nejse코 na tahu!":"MISE NEZA캛ALA: 캛ekejte na hostitele.";j({id:"block",type:"error",message:z}),W([100,50,100]),w("error");return}if(Z<=0&&!r.startsWith("friend:")){j({id:"no-fuel",type:"error",message:"NEDOSTATEK PALIVA: Lo캞 nem콢쬰 man칠vrovat (skenovat)."}),w("error"),W([200,200,200]);return}if(oe(!0),W(50),w("scan"),r.toUpperCase().startsWith("CHAR-"))try{const z=await Pt(r.toUpperCase());if(z){Q(z);let G=z.baseStats.hp,X=z.baseStats.mana,se=z.baseStats.armor;const pe=Yt(z,d);G+=pe.hp,X+=pe.mana,se+=pe.armor,k(G),A(X),h(se),F(z.name),localStorage.setItem(`nexus_character_${t}`,JSON.stringify(z)),ue("blue");const ye=((P=z.perks)==null?void 0:P.filter(Ie=>{const zt=Ie.effect.condition||"always";return zt==="always"||zt==="night"&&d||zt==="day"&&!d}))||[],mt=ye.map(Ie=>Ie.name).join(", "),Xe=ye.length>0?`Postava ${z.name} aktivov치na! Aktivn칤 perky: ${mt}`:`Postava ${z.name} aktivov치na! (콯치dn칠 aktivn칤 perky)`;setTimeout(()=>{ue(null),j({id:`char-loaded-${Date.now()}`,type:"success",message:Xe}),w("success"),Pe(`Postava aktivov치na: ${z.name}`)},300),oe(!1);return}}catch{}const u=V.find(z=>z.id.split("__")[0].toLowerCase()===r.toLowerCase()||z.id.toLowerCase()===r.toLowerCase());if(u){St(u,"scanner");return}const x=de.find(z=>z.id.toLowerCase()===r.toLowerCase());if(x){St(x,"scanner");return}if(navigator.onLine)try{const z=await Mt(ls,r);if(z){St(z,"scanner");return}}catch{}oe(!1),j({id:"not-found-"+Date.now(),type:"error",message:"ID karty nenalezeno."}),w("error")},St=(r,u=null)=>{u==="scanner"&&(lt(-5),Pe("Man칠vr lodi: -5 % Paliva"));const x=ot(r,d,J);if(x.type===ae.SPACE_STATION&&u==="scanner"){oe(!1),Bt(!0),_(x),wt.current=Date.now();return}_(x),wt.current=Date.now(),x.type===ae.DILEMA&&x.dilemmaScope==="GLOBAL"&&l.isInRoom&&is(l.id,r),Pe(u==="scanner"?`Skenov치no: ${x.title} `:`Zobrazeno: ${x.title} `),oe(!1)},ra=()=>{Bt(!1),he&&he.type===ae.SPACE_STATION&&(Kt(he),_(null),Pe(`Dokov치no: ${he.title} `),w("success"))},ct=(r=!1)=>{(he==null?void 0:he.dilemmaScope)==="GLOBAL"&&l.isInRoom&&is(l.id,null);const u=we&&l.isGameStarted;_(null),r===!0&&u&&Wt()},ia=async r=>{if(Be){const x=l.isGameStarted?"NEM콡콯E HR츼T: Nejse코 na tahu!":"MISE NEZA캛ALA: 캛ekejte na hostitele.";j({id:"block-use",type:"error",message:x});return}if(r.isSellOnly){j({id:"sell-only",message:"Tento p콏edm캩t nelze pou쮂셦, pouze prodat.",type:"error"});return}if(r.type===ae.MERCHANT){Zt(r),ct(),w("open");return}let u=!1;r.stats&&r.stats.length>0&&r.stats.forEach(x=>{const z=String(x.value).replace(/[^0-9-]/g,""),G=parseInt(z),X=String(x.label).toUpperCase().trim();!isNaN(G)&&G!==0&&(["HP","ZDRAV칈","HEAL"].some(se=>X.includes(se))?(Ke(G),u=!0):["MANA","ENERGIE"].some(se=>X.includes(se))?(kt(G),u=!0):["PALIVO","FUEL"].some(se=>X.includes(se))?(lt(G),u=!0):["GOLD","ZLATO"].some(se=>X.includes(se))?(We(G),u=!0):["O2","KYSL칈K"].some(se=>X.includes(se))?(O(se=>Math.min(100,Math.max(0,se+G))),u=!0):["ARMOR","BRN캨N칈"].some(se=>X.includes(se))&&(h(se=>Math.max(0,se+G)),u=!0))}),u?(w("heal"),j({id:"use-success-"+Date.now(),message:"P콏edm캩t pou쬴t.",type:"success"}),r.isConsumable&&await Qe(r.id),ct(!0)):r.isConsumable?(await Qe(r.id),j({id:"consumed",message:"P콏edm캩t spot콏ebov치n.",type:"info"}),ct(!0)):(j({id:"no-effect",message:"Tento p콏edm캩t nem치 쮂멳n칳 okam쬴t칳 efekt.",type:"info"}),W(50))},la=(r,u)=>{var x;u==="success"?((x=r.rewards)==null||x.forEach(P=>{P.type==="HP"&&Ke(P.value),P.type==="MANA"&&kt(P.value),P.type==="GOLD"&&We(P.value)}),r.effectType==="hp"&&Ke(r.effectValue||0)):r.failDamage&&Ke(-r.failDamage)},Wt=async()=>{if(l.id)try{await bn(l.id),Ds(!1)}catch{}},ca=()=>{Kt(null),w("open")},oa=r=>{r.stationConfig&&(r.stationConfig.fuelReward&&lt(r.stationConfig.fuelReward),r.stationConfig.repairAmount&&Ke(r.stationConfig.repairAmount),r.stationConfig.refillO2&&O(100),w("success"),j({id:"station-reward",type:"success",message:"Servis dokon캜en."}))},da=async r=>{We(-(r.price||0)),await xt(r,!1),w("success"),j({id:"buy-success",type:"success",message:`Zakoupeno: ${r.title} `})},xa=async(r,u)=>{We(u),await Qe(r.id),w("success"),j({id:"sell-success",type:"success",message:`Prod치no: ${r.title} (+${u} G)`})},Pe=r=>{D(u=>[r,...u].slice(0,50))},ma=r=>{s(r),localStorage.setItem("nexus_current_user",r);const u=!r.includes("@");i(u),b(u)},ua=()=>m(r=>!r),ot=(r,u,x)=>{var z;let P={...r};if(u&&((z=r.timeVariant)!=null&&z.enabled)&&(r.timeVariant.nightTitle&&(P.title=r.timeVariant.nightTitle),r.timeVariant.nightDescription&&(P.description=r.timeVariant.nightDescription),r.timeVariant.nightType&&(P.type=r.timeVariant.nightType),r.timeVariant.nightStats&&(P.stats=r.timeVariant.nightStats)),x&&r.classVariants&&r.classVariants[x]){const G=r.classVariants[x];G.overrideTitle&&(P.title=G.overrideTitle),G.overrideDescription&&(P.description=G.overrideDescription),G.overrideType&&(P.type=G.overrideType),G.bonusStats&&(P.stats=[...P.stats||[],...G.bonusStats])}return P},dt=async()=>{v(!0);try{const r=t||"guest",u=await as(r);if(K(u),localStorage.setItem(`nexus_inv_${r}`,JSON.stringify(u)),p&&!o){const x=await fn();Ce(x)}}catch{}finally{v(!1)}},Qe=async r=>{const u=t||"guest";if(K(x=>{const P=x.filter(z=>z.id!==r);return localStorage.setItem(`nexus_inv_${u}`,JSON.stringify(P)),P}),!c&&navigator.onLine)try{await _t(u,r)}catch{}},xt=async(r,u)=>{const x=t||"guest";if(K(P=>{const z=u?[...P,r]:P.map(G=>G.id===r.id?r:G);return localStorage.setItem(`nexus_inv_${x}`,JSON.stringify(z)),z}),!c&&navigator.onLine)try{await Ot(x,r)}catch{}};return a.useEffect(()=>{if(!l.isInRoom||!l.id||!g)return;const r=setInterval(async()=>{var u;try{const x=await et(l.id),P=await pt(l.id);if(x.activeTrades){const z=x.activeTrades.find(G=>G.participants.some(X=>X.email===t));ge(z||null)}else ge(null);x.members&&(qt.current=x.members),x.turnIndex!==void 0&&x.turnIndex!==it.current&&(rt.current=!1,it.current=x.turnIndex,x.isGameStarted&&((u=x.turnOrder)==null?void 0:u[x.turnIndex])===l.nickname&&(j({id:"your-turn-"+Date.now(),type:"warning",message:"丘멆잺 JSI NA TAHU!"}),w("open"),W([100,50,100]),rt.current=!0)),x.isGameStarted&&!nt.current&&(j({id:"game-start",type:"success",message:"MISE ZAH츼JENA!"}),nt.current=!0),U(z=>({...z,members:x.members,turnIndex:x.turnIndex,messages:P,isGameStarted:x.isGameStarted,roundNumber:x.roundNumber,turnOrder:x.turnOrder,readyForNextRound:x.readyForNextRound,host:x.host,activeEncounter:x.activeEncounter,activeTrades:x.activeTrades}))}catch{}},1e3);return()=>clearInterval(r)},[l.isInRoom,l.id,g,t,l.nickname]),a.useEffect(()=>{te==="room"&&l.isInRoom&&l.id&&g&&(async()=>{try{const u=await et(l.id),x=await pt(l.id);U(P=>({...P,members:u.members,turnOrder:u.turnOrder,turnIndex:u.turnIndex,messages:x,isGameStarted:u.isGameStarted,roundNumber:u.roundNumber,readyForNextRound:u.readyForNextRound,host:u.host,activeTrades:u.activeTrades}))}catch{}})()},[te,l.isInRoom,l.id,g]),{userEmail:t,setUserEmail:s,isAdmin:p,setIsAdmin:n,isGuest:c,setIsGuest:i,isTestMode:o,toggleTestMode:ua,isServerReady:g,setIsServerReady:b,isRefreshing:y,handleRefreshDatabase:dt,isNight:d,adminNightOverride:E,setAdminNightOverride:I,playerHp:Y,handleHpChange:Ke,playerMana:M,handleManaChange:kt,playerFuel:Z,handleFuelChange:lt,playerGold:ce,handleGoldChange:We,playerArmor:L,setPlayerArmor:h,playerOxygen:S,setPlayerOxygen:O,playerClass:J,setPlayerClass:F,activeCharacter:B,setActiveCharacter:Q,activeTab:te,setActiveTab:T,notification:$,setNotification:j,scanLog:f,isAIThinking:q,screenFlash:fe,soundEnabled:be,handleToggleSound:()=>{yn(!be),Me(!be)},vibrationEnabled:Te,handleToggleVibration:()=>{wn(!Te),Ue(!Te)},currentEvent:he,setCurrentEvent:_,inventory:V,masterCatalog:de,editingEvent:C,setEditingEvent:H,roomState:l,setRoomState:U,activeTrade:re,handleInitTrade:Us,handleCancelTrade:Bs,handleConfirmTrade:Ks,handleTradeSelectOffer:Fs,isSoloMode:Ne,giftTarget:Ee,setGiftTarget:Ut,isMyTurn:we,isBlocked:Be,showRoundEndAlert:je,setShowRoundEndAlert:Ls,handleLogin:ma,handleLogout:()=>{localStorage.clear(),sessionStorage.clear(),window.location.reload()},handleScanCode:na,handleSaveEvent:xt,handleDeleteEvent:Qe,handleUseEvent:ia,handlePlanetProgress:qs,getAdjustedItem:ot,handleGameSetup:Ws,handleLeaveRoom:Jt,handleKickPlayer:sa,handleExitToMenu:Qs,handleStartGame:aa,handleResolveDilemma:la,handleEndTurn:Wt,handleSendMessage:ea,closeEvent:ct,handleOpenInventoryItem:r=>{p&&!o?(H(r),T("generator")):_(r)},handleSwapItems:Gs,handleInspectItem:ta,handleCraftItem:Zs,handleHardReset:Js,handleWipeTestVault:Ys,handleSwitchToOffline:()=>{i(!0),b(!0),j({id:"offline",message:"Offline Mode",type:"warning"})},handleBuyItem:da,handleSellItem:xa,activeStation:Vs,activeMerchant:Ft,setActiveMerchant:Zt,handleLeaveStation:ca,handleClaimStationRewards:oa,isDocking:$s,handleDockingComplete:ra,handleToggleReady:Xs,isScannerPaused:!!Ft||!!he||!!re||q}},Cs=({onScanCode:t,isAIThinking:s,isPaused:p})=>{const[n,c]=a.useState("idle"),[i,o]=a.useState(""),[m,g]=a.useState(!1),[b,y]=a.useState(""),v=a.useRef(null),d=a.useRef(!1);a.useEffect(()=>(v.current=new tn("qr-reader",{verbose:!1}),()=>{E()}),[]),a.useEffect(()=>{(p||s)&&d.current&&E()},[p,s]);const N=async()=>{if(!(!v.current||d.current))try{c("active"),d.current=!0,await v.current.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250},aspectRatio:1,formatsToSupport:[ut.QR_CODE,ut.EAN_13,ut.CODE_128,ut.CODE_39]},I=>{p||s||(t(I),W(50))},()=>{})}catch(I){c("error"),o(I.message||"P콏칤stup ke kame콏e zam칤tnut."),d.current=!1}},E=async()=>{if(v.current&&d.current)try{await v.current.stop(),v.current.clear()}catch{}finally{d.current=!1,c("idle")}};return e.jsxs("div",{className:"relative h-full w-full bg-black flex flex-col items-center justify-center p-6",children:[e.jsx("div",{className:"absolute top-10 left-0 right-0 z-20 flex justify-center pointer-events-none",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur px-4 py-2 border border-white/10 rounded-full flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${n==="active"?"bg-green-500 animate-pulse":"bg-red-500"}`}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-white/70",children:s?"AI_DEK칍DOV츼N...":n==="active"?"OPTIKA_AKTIVN칈":"SENZOR_OFFLINE"})]})}),e.jsxs("div",{className:"relative w-full aspect-square max-w-sm",children:[e.jsx("div",{className:"absolute -inset-2 border-2 border-signal-cyan/20 rounded-3xl pointer-events-none z-10"}),e.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-signal-cyan rounded-tl-xl z-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-signal-cyan rounded-tr-xl z-10"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-signal-cyan rounded-bl-xl z-10"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-signal-cyan rounded-br-xl z-10"}),e.jsxs("div",{className:"w-full h-full bg-zinc-900 rounded-2xl overflow-hidden relative shadow-2xl",children:[e.jsx("div",{id:"qr-reader",className:"w-full h-full object-cover"}),n!=="active"&&e.jsxs("div",{className:"absolute inset-0 z-20 flex flex-col items-center justify-center p-10 text-center gap-6 bg-zinc-900",children:[n==="error"?e.jsx(ze,{className:"w-12 h-12 text-red-500"}):e.jsx(xs,{className:"w-12 h-12 text-white/20"}),e.jsx("p",{className:"text-xs text-white/40 uppercase font-bold tracking-widest leading-relaxed",children:n==="error"?i:"Kamera v pohotovostn칤m re쬴mu"}),e.jsxs("button",{onClick:N,className:"button-primary py-3 px-8 text-xs relative overflow-hidden group",children:[e.jsx("span",{className:"relative z-10",children:n==="error"?"Zkusit znovu":"Aktivovat Senzor"}),e.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform"})]})]}),e.jsx(xe,{children:s&&e.jsxs(R.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-30 bg-signal-cyan/20 backdrop-blur-sm flex flex-col items-center justify-center gap-4",children:[e.jsx(De,{className:"w-12 h-12 text-white animate-spin"}),e.jsx("span",{className:"text-xs font-black text-white uppercase tracking-[0.3em]",children:"Analyzuji_Data..."})]})})]})]}),e.jsxs("button",{onClick:()=>g(!0),className:"mt-12 flex items-center gap-3 text-white/40 hover:text-white transition-colors text-xs font-bold uppercase tracking-widest active:scale-95",children:[e.jsx(Lt,{className:"w-5 h-5"})," Manu치ln칤 Identifikace"]}),e.jsx(xe,{children:m&&e.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-xl flex items-center justify-center p-8",children:e.jsxs("div",{className:"w-full max-w-xs space-y-6",children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase text-center tracking-widest",children:"Zadejte_ID"}),e.jsx("input",{type:"text",autoFocus:!0,value:b,onChange:I=>y(I.target.value),placeholder:"NAP콎. ITEM-01",className:"w-full bg-white/5 border border-white/10 p-4 text-white text-center text-xl font-mono uppercase rounded-xl outline-none focus:border-signal-cyan placeholder-white/20"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>g(!1),className:"flex-1 py-4 text-xs font-bold text-white/40 uppercase hover:text-white transition-colors",children:"Zru코it"}),e.jsx("button",{onClick:()=>{t(b),g(!1)},className:"flex-1 button-primary py-4 text-xs shadow-lg shadow-signal-amber/20",children:"Potvrdit"})]})]})})}),e.jsx("style",{children:`
        #qr-reader video { 
            object-fit: cover; 
            width: 100%; 
            height: 100%; 
            border-radius: 1rem;
        }
      `})]})},cs=["Inicializace protokolu...","Hled치n칤 sign치lu Nexus...","Propojov치n칤.##.%./*_#..","Ov캩콏ov치n칤 integrity dat...","Navazov치n칤 zabezpe캜en칠ho spojen칤..."],Es=({onConnected:t,onSwitchToOffline:s})=>{const[p,n]=a.useState(0),[c,i]=a.useState(1),[o,m]=a.useState(!1),[g,b]=a.useState(!navigator.onLine);return a.useEffect(()=>{const y=()=>b(!navigator.onLine);window.addEventListener("online",y),window.addEventListener("offline",y);const v=setInterval(()=>{n(d=>(d+1)%cs.length)},3e3);return()=>{window.removeEventListener("online",y),window.removeEventListener("offline",y),clearInterval(v)}},[]),a.useEffect(()=>{let y=!0,v;const d=async()=>{if(y){if(!navigator.onLine){m(!0);return}try{if(await cn()&&y){t();return}}catch{}y&&(i(N=>N+1),c>3&&m(!0),v=setTimeout(d,2500))}};return d(),()=>{y=!1,clearTimeout(v)}},[t,c]),e.jsxs("div",{className:"fixed inset-0 z-[200] bg-zinc-950 flex flex-col items-center justify-center p-6 text-white font-sans overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 z-0 opacity-10 pointer-events-none",style:{backgroundImage:"radial-gradient(#222 1px, transparent 1px)",backgroundSize:"20px 20px"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center max-w-sm w-full",children:[e.jsxs("div",{className:"relative mb-12",children:[e.jsx(R.div,{animate:{scale:[1,2.5],opacity:[.5,0]},transition:{duration:2,repeat:1/0,ease:"easeOut"},className:`absolute inset-0 ${g?"bg-amber-500/20":"bg-neon-blue/20"} rounded-full blur-md`}),e.jsxs("div",{className:`relative w-24 h-24 bg-zinc-900 rounded-2xl border ${g?"border-amber-500/50":"border-zinc-700"} flex items-center justify-center shadow-[0_0_30px_rgba(0,243,255,0.2)]`,children:[g?e.jsx(ba,{className:"w-10 h-10 text-amber-500"}):e.jsx(ga,{className:"w-10 h-10 text-neon-blue"}),e.jsx("div",{className:"absolute -top-1 -right-1",children:e.jsxs("span",{className:"relative flex h-3 w-3",children:[e.jsx("span",{className:`animate-ping absolute inline-flex h-full w-full rounded-full ${g?"bg-amber-500":"bg-green-500"} opacity-75`}),e.jsx("span",{className:`relative inline-flex rounded-full h-3 w-3 ${g?"bg-amber-500":"bg-green-500"}`})]})})]})]}),e.jsx("div",{className:"w-full h-1 bg-zinc-900 rounded-full overflow-hidden mb-6 relative",children:e.jsx(R.div,{animate:{x:["-100%","100%"]},transition:{duration:1.5,repeat:1/0,ease:"linear"},className:`absolute inset-y-0 left-0 w-1/2 bg-gradient-to-r from-transparent ${g?"via-amber-500":"via-neon-blue"} to-transparent`})}),e.jsx("h2",{className:"text-xl font-display font-bold uppercase tracking-widest mb-2 text-center",children:g?"OFFLINE_RE콯IM":"P콎IPOJOV츼N칈"}),e.jsx(R.p,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"text-xs text-zinc-500 font-mono uppercase tracking-wider text-center h-4",children:g?"Lok치ln칤 protokoly aktivn칤":cs[p]},p),e.jsxs("div",{className:"mt-8 flex gap-4 text-[10px] text-zinc-600 font-mono uppercase",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ja,{className:`w-3 h-3 ${g?"":"animate-spin"}`}),e.jsx("span",{children:g?"Senzory vypnuty":`Pokus #${c}`})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Dt,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{children:"Local_Vault OK"})]})]}),o&&e.jsxs(R.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},onClick:s,className:"mt-12 py-4 px-8 bg-amber-500/10 border border-amber-500/40 hover:bg-amber-500/20 rounded-xl flex items-center gap-3 text-xs font-black uppercase tracking-widest text-amber-500 hover:text-white transition-all shadow-[0_0_20px_rgba(245,158,11,0.1)]",children:[e.jsx(Na,{className:"w-5 h-5"}),"Aktivovat Offline Nasazen칤"]})]})]})},Tn=({onLogin:t})=>{const[s,p]=a.useState(""),[n,c]=a.useState(!1),[i,o]=a.useState(!1),[m,g]=a.useState(null),b=d=>{if(d.preventDefault(),s.trim().length<3){g("Identifik치tor (Nick) mus칤 m칤t alespo켿 3 znaky."),W(100),w("error");return}g(null),o(!0)},y=()=>{o(!1),w("click"),localStorage.setItem("nexus_nickname_guest",s.toUpperCase()),c(!0),setTimeout(()=>{t("guest",s.toUpperCase())},1500)},v=async d=>{if(d.credential){c(!0),g(null),w("click");try{const N=await hn(d.credential);W([50,50]),t(N.email)}catch(N){c(!1);let E="Chyba Google ov캩콏en칤.";N.message&&N.message.includes("Failed to fetch")?E="Nelze se spojit se serverem (Backend sp칤 nebo blokov치n).":N.message&&(E=`Server Error: ${N.message}`),g(E),w("error")}}};return n?e.jsx(Es,{onConnected:()=>{},onSwitchToOffline:()=>{c(!1),g("Odkaz p콏eru코en.")}}):e.jsxs("div",{className:"h-screen w-screen bg-[#0a0b0d] flex flex-col items-center justify-center p-8 relative overflow-hidden font-sans",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-5 z-0",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"30px 30px"}}),e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-10",children:e.jsxs("div",{className:"flex justify-between w-full p-8 font-mono text-[10px] text-signal-cyan",children:[e.jsx("span",{children:"SIGN츼L: VYHLED츼V츼N칈..."}),e.jsx("span",{children:"POZ: HLAVN칈_BR츼NA"})]})}),e.jsxs(R.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},className:"w-full max-w-sm z-10",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"relative inline-block mb-8",children:e.jsxs("div",{className:"w-24 h-24 tactical-card flex items-center justify-center border-signal-cyan/40 bg-black/40",children:[e.jsx("div",{className:"corner-accent top-left !border-2"}),e.jsx("div",{className:"corner-accent bottom-right !border-2"}),e.jsx($t,{className:"w-12 h-12 text-signal-cyan"})]})}),e.jsx("h1",{className:"text-5xl font-black text-white tracking-tighter uppercase mb-2 chromatic-text",children:"Nexus_Auth"}),e.jsx("p",{className:"text-signal-cyan font-mono text-[10px] uppercase tracking-[0.5em] font-black",children:"Hybridn칤 deskov치 hra"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 justify-center",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-green-500",children:"Doporu캜eno: Cloud Save (V코echna za콏칤zen칤)"})]}),e.jsx("div",{className:"flex flex-col justify-center gap-2",children:e.jsx(sn,{onSuccess:v,onError:()=>g("Google Login selhal na 칰rovni klienta."),theme:"filled_black",shape:"pill",size:"large",text:"signin_with",width:"100%"})})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"h-px bg-white/10 flex-1"}),e.jsx("span",{className:"text-[10px] text-white/30 uppercase font-mono tracking-widest font-black",children:"NEBO HOST (LOCAL SAVE)"}),e.jsx("div",{className:"h-px bg-white/10 flex-1"})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[11px] font-black text-white/50 uppercase tracking-[0.2em] ml-1 font-mono flex justify-between",children:[e.jsx("span",{children:"Identifikace Jednotky"}),e.jsxs("span",{className:"text-zinc-500 flex items-center gap-1",children:[e.jsx(va,{className:"w-3 h-3"})," Ukl치d치n칤 v prohl칤쬰캜i"]})]}),e.jsx("div",{className:"tactical-card p-0 overflow-hidden border-white/10 focus-within:border-white/40 transition-colors bg-white/5",children:e.jsxs("div",{className:"flex items-center px-5 py-5 gap-4",children:[e.jsx(ms,{className:"w-6 h-6 text-zinc-500"}),e.jsx("input",{type:"text",required:!0,value:s,onChange:d=>p(d.target.value),className:"w-full bg-transparent text-white placeholder-white/20 focus:outline-none font-mono text-sm uppercase font-bold",placeholder:"ZADEJTE P콎EZD칈VKU...",maxLength:12})]})})]}),m&&e.jsxs("div",{className:"p-4 bg-signal-hazard/10 border border-signal-hazard/40 text-signal-hazard text-[11px] uppercase font-black tracking-widest text-center animate-pulse",children:[e.jsx(ze,{className:"w-4 h-4 inline mr-2 mb-0.5"})," ",m]}),e.jsxs("button",{type:"submit",className:"w-full py-5 border border-white/10 bg-zinc-900 hover:bg-zinc-800 text-white font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-3 transition-all active:scale-95",children:[e.jsx(Vt,{className:"w-4 h-4 text-zinc-500"}),"Vstoupit jako Host",e.jsx(at,{className:"w-4 h-4 text-zinc-500"})]})]})]}),e.jsx(xe,{children:i&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-[#0a0b0d]/95 backdrop-blur-md flex items-center justify-center p-6",children:e.jsxs(R.div,{initial:{scale:.96,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.96,opacity:0},className:"tactical-card w-full max-w-sm border-zinc-700 p-0 overflow-hidden bg-black/90 shadow-2xl",children:[e.jsxs("div",{className:"bg-zinc-900 p-8 border-b border-white/10 flex items-center gap-6",children:[e.jsx(Dt,{className:"w-12 h-12 text-zinc-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tighter leading-none",children:"Lok치ln칤 Profil"}),e.jsx("p",{className:"text-zinc-500 font-mono text-[10px] uppercase tracking-[0.4em] font-black mt-2",children:"Database Access: OK"})]})]}),e.jsxs("div",{className:"p-8 space-y-6 text-[12px] text-white/70 leading-relaxed font-sans",children:[e.jsxs("div",{className:"p-4 bg-blue-900/20 border border-blue-500/30 rounded-sm",children:[e.jsxs("p",{className:"text-blue-400 font-black uppercase tracking-widest mb-2 flex items-center gap-2 text-xs",children:[e.jsx(Ht,{className:"w-4 h-4"})," Status: Online"]}),e.jsxs("p",{children:["Jako ",e.jsx("span",{className:"text-white font-bold",children:"HOST"})," m치te p콏칤stup k datab치zi karet a online funkc칤m. V치코 invent치콏 se v코ak ukl치d치 pouze do ",e.jsx("span",{className:"text-white font-bold",children:"tohoto za콏칤zen칤"}),"."]})]}),e.jsxs("ul",{className:"space-y-4 font-bold text-zinc-400",children:[e.jsxs("li",{className:"flex gap-4",children:[e.jsx(Nt,{className:"w-4 h-4 text-green-500 shrink-0 mt-0.5"}),e.jsx("span",{children:"P콏칤stup k Master Datab치zi karet."})]}),e.jsxs("li",{className:"flex gap-4",children:[e.jsx(ze,{className:"w-4 h-4 text-orange-500 shrink-0 mt-0.5"}),e.jsx("span",{children:"콯치dn치 synchronizace mezi za콏칤zen칤mi (Cloud Save)."})]})]})]}),e.jsxs("div",{className:"p-8 bg-black border-t border-white/10 flex flex-col gap-3",children:[e.jsx("button",{onClick:y,className:"button-primary w-full py-4 text-xs !bg-zinc-200 !text-black",children:"Rozum칤m, Spustit Misi"}),e.jsx("button",{onClick:()=>o(!1),className:"w-full py-3 text-zinc-500 hover:text-white text-[10px] uppercase font-black tracking-[0.2em] transition-colors",children:"Zp캩t"})]})]})})})]})},Cn=({onComplete:t})=>{const[s,p]=a.useState("init"),[n,c]=a.useState(0);a.useEffect(()=>{const o=setTimeout(()=>{i()},1500);return()=>clearTimeout(o)},[]);const i=()=>{p("boot"),w("open"),W([40,40])};return a.useEffect(()=>{if(s==="boot"){const o=setInterval(()=>{c(m=>m>=100?(clearInterval(o),setTimeout(()=>{p("complete"),w("success"),W([100,50,100]),setTimeout(t,1400)},500),100):m+2)},35);return()=>clearInterval(o)}},[s]),e.jsx("div",{className:"fixed inset-0 z-[9999] bg-[#0a0b0d] flex flex-col items-center justify-center font-sans overflow-hidden p-6",children:e.jsxs(xe,{mode:"wait",children:[s==="init"&&e.jsxs(R.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,y:20},className:"flex flex-col items-center gap-10 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx(R.div,{animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{repeat:1/0,duration:2.5},className:"absolute inset-0 bg-[#00f2ff]/20 blur-3xl rounded-full"}),e.jsx("div",{className:"w-24 h-24 border-2 border-[#ff9d00] rounded-full flex items-center justify-center shadow-[0_0_30px_rgba(255,157,0,0.25)] relative z-10 bg-[#0a0b0d]",children:e.jsx(ya,{className:"w-10 h-10 text-[#ff9d00]"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-[#00f2ff] font-mono text-[9px] uppercase tracking-[0.4em] mb-2 font-bold opacity-80",children:"NEXUS // J츼DRO_S칈T캨"}),e.jsx("h1",{className:"text-3xl font-black uppercase tracking-tighter chromatic-text leading-none",children:"Syst칠m_P콏ipraven"})]}),e.jsx("div",{className:"text-signal-cyan font-mono text-[9px] uppercase tracking-[0.2em] font-black animate-pulse opacity-50",children:"Navazov치n칤 spojen칤..."})]})]},"init"),s==="boot"&&e.jsxs(R.div,{initial:{opacity:0},animate:{opacity:1},className:"w-full max-w-[280px] flex flex-col items-center gap-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[e.jsx(Vt,{className:"w-12 h-12 text-[#00f2ff] animate-pulse"}),e.jsx("span",{className:"text-[#00f2ff] font-mono text-[10px] uppercase tracking-[0.3em] font-black",children:"Probouzen칤_S칤t캩"})]}),e.jsxs("div",{className:"w-full space-y-3",children:[e.jsxs("div",{className:"flex justify-between font-mono text-[10px] text-[#ff9d00] font-bold",children:[e.jsx("span",{children:"ZAV츼D캨N칈_PROTOKOL콡"}),e.jsxs("span",{className:"tabular-nums",children:[n,"%"]})]}),e.jsx("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden border border-white/5",children:e.jsx(R.div,{initial:{width:0},animate:{width:`${n}%`},className:"h-full bg-gradient-to-r from-[#ff9d00] to-[#fff] shadow-[0_0_10px_rgba(255,157,0,0.8)]"})})]}),e.jsxs("div",{className:"text-[9px] font-mono text-white/30 uppercase tracking-[0.2em] text-center leading-relaxed font-bold",children:["Na캜칤t치n칤_Taktick칳ch_Vrstev...",e.jsx("br",{}),"Kalibrace_Sign치ln칤_Matice..."]})]},"boot"),s==="complete"&&e.jsxs(R.div,{initial:{scale:1.1,opacity:0},animate:{scale:1,opacity:1},className:"flex flex-col items-center gap-6",children:[e.jsxs("div",{className:"p-8 tactical-card border-[#00f2ff] shadow-[0_0_50px_rgba(0,242,255,0.15)] bg-black/80",children:[e.jsx("div",{className:"corner-accent top-left !border-4"}),e.jsx("div",{className:"corner-accent bottom-right !border-4"}),e.jsx($t,{className:"w-16 h-16 text-[#00f2ff]"})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-3xl font-black uppercase tracking-[0.1em] chromatic-text",children:"Autorizov치no"}),e.jsx("p",{className:"text-[#00f2ff] font-mono text-[11px] uppercase tracking-[0.3em] font-black opacity-80",children:"Jednotka_Aktivn칤_V_Sektoru"})]})]},"complete")]})})},En=({initialNickname:t,onConfirmSetup:s,isGuest:p})=>{const[n,c]=a.useState(t?"class":"nickname"),[i,o]=a.useState(t||""),[m,g]=a.useState(null),[b,y]=a.useState(""),[v,d]=a.useState(!1),[N,E]=a.useState(null),[I,Y]=a.useState(""),[k,M]=a.useState(null),[A,Z]=a.useState(!1),[ee,ce]=a.useState(!1),[le,L]=a.useState(!1),[h,S]=a.useState(""),[O,J]=a.useState(!1),[F,B]=a.useState(!1),Q=f=>{f.preventDefault(),i.trim().length>=3&&c("class")},te=f=>{g(f),setTimeout(()=>c("action"),300)},T=async f=>{if(m){if(f==="join_mode"){S(""),E(null),c("join");return}d(!0),E(null);try{await s(i,m,f,f==="create"&&F?h:void 0,k)}catch{d(!1)}}},$=async f=>{if(f.preventDefault(),!(!b.trim()||!m)){d(!0),E(null);try{await s(i,m,b.toUpperCase().trim(),h||void 0,k)}catch(D){E(D.message||"Nepoda콏ilo se p콏ipojit. Zkontrolujte ID m칤stnosti."),d(!1)}}},j=[{id:Oe.WARRIOR,icon:e.jsx(us,{className:"w-6 h-6"}),desc:"Mistr boje zbl칤zka. Vysok치 odolnost.",color:"text-red-500",border:"border-red-500"},{id:Oe.MAGE,icon:e.jsx(ps,{className:"w-6 h-6"}),desc:"Vid칤 magick칠 aury a skryt칠 zpr치vy.",color:"text-blue-400",border:"border-blue-400"},{id:Oe.ROGUE,icon:e.jsx(hs,{className:"w-6 h-6"}),desc:"Najde loot tam, kde ostatn칤 vid칤 st칤n.",color:"text-green-500",border:"border-green-500"},{id:Oe.CLERIC,icon:e.jsx(fs,{className:"w-6 h-6"}),desc:"L칠캜itel a ochr치nce p콏ed temnotou.",color:"text-yellow-500",border:"border-yellow-500"}];return v&&p?e.jsxs("div",{className:"h-screen w-screen bg-zinc-950 flex flex-col items-center justify-center",children:[e.jsx(De,{className:"w-12 h-12 text-white animate-spin mb-4"}),e.jsx("p",{className:"text-white font-mono text-xs uppercase tracking-widest",children:"Generov치n칤 offline prost콏ed칤..."})]}):e.jsxs("div",{className:"h-screen w-screen bg-zinc-950 flex flex-col items-center justify-start p-6 pt-12 relative overflow-hidden overflow-y-auto no-scrollbar",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-5 z-0",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"30px 30px"}}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1/2 bg-gradient-to-b from-signal-cyan/5 to-transparent"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1/2 bg-gradient-to-t from-signal-amber/5 to-transparent"})]}),e.jsxs(R.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"w-full max-w-sm relative z-10 pb-10",children:[n==="nickname"&&e.jsxs("div",{className:"text-center mt-20",children:[e.jsx("div",{className:"w-20 h-20 bg-zinc-900 rounded-full flex items-center justify-center mx-auto mb-6 border border-zinc-700 shadow-xl",children:e.jsx(ms,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-2xl font-black text-white mb-2 uppercase tracking-widest",children:"Identifikace"}),e.jsx("p",{className:"text-zinc-400 text-sm mb-8 font-bold tracking-tight",children:"Zadejte svou hern칤 p콏ezd칤vku."}),e.jsxs("form",{onSubmit:Q,children:[e.jsx("input",{type:"text",value:i,onChange:f=>o(f.target.value),placeholder:"P콏ezd칤vka...",className:"w-full bg-zinc-900 border border-zinc-700 p-4 rounded-xl text-white font-display text-center text-lg focus:border-signal-cyan outline-none mb-4 uppercase font-bold",maxLength:12,autoFocus:!0}),e.jsx("button",{type:"submit",disabled:i.length<3,className:"button-primary w-full py-5 text-sm",children:"Pokra캜ovat"})]})]}),n==="class"&&e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-black text-white mb-1 uppercase tracking-tighter",children:"Zvolte T콏칤du"}),e.jsx("p",{className:"text-zinc-400 text-xs font-bold uppercase tracking-wider",children:"Va코e role ovlivn칤 hern칤 mechaniky."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3 overflow-y-auto pr-1 no-scrollbar",children:j.map(f=>e.jsxs("button",{onClick:()=>te(f.id),className:`p-4 rounded-xl border-2 text-left transition-all relative overflow-hidden group ${m===f.id?`bg-zinc-900 ${f.border}`:"bg-black border-zinc-800 hover:border-zinc-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:`p-3 rounded-lg bg-zinc-900 ${f.color} border border-white/5`,children:f.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-black uppercase tracking-widest ${f.color}`,children:f.id}),e.jsx("p",{className:"text-[11px] text-zinc-300 font-bold leading-tight mt-1",children:f.desc})]})]}),m===f.id&&e.jsx(R.div,{layoutId:"class-highlight",className:`absolute inset-0 opacity-10 ${f.color.replace("text-","bg-")}`})]},f.id))}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-zinc-800",children:[e.jsx("p",{className:"text-xs text-zinc-500 uppercase font-bold tracking-wider mb-3 text-center",children:"Nebo zadejte ID vlastn칤 postavy"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:I,onChange:f=>Y(f.target.value.toUpperCase()),placeholder:"CHAR-001",className:"flex-1 bg-black border border-zinc-700 px-4 py-3 rounded-lg text-white font-mono uppercase text-sm focus:border-signal-cyan outline-none",maxLength:10}),e.jsx("button",{onClick:async()=>{if(I.trim()){Z(!0),E(null);try{const f=await Pt(I.trim());f?(M(f),g(f.name),E(""),L(!0),setTimeout(()=>{L(!1),c("action")},2500)):E("Postava nenalezena!")}catch{E("Chyba p콏i na캜칤t치n칤 postavy.")}finally{Z(!1)}}},disabled:!I.trim()||A,className:"px-6 py-3 bg-signal-cyan text-black rounded-lg font-bold uppercase text-xs hover:bg-white transition-colors disabled:opacity-50",children:A?e.jsx(De,{className:"w-4 h-4 animate-spin"}):"Na캜칤st"})]}),N&&e.jsx("p",{className:"text-xs text-red-500 mt-2 text-center font-bold",children:N}),e.jsxs("button",{onClick:()=>ce(!0),className:"mt-3 w-full py-3 bg-purple-500/10 border border-purple-500/30 text-purple-400 rounded-lg font-bold uppercase text-xs hover:bg-purple-500/20 transition-colors flex items-center justify-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"}),"Skenovat QR k칩d"]})]}),ee&&e.jsxs("div",{className:"fixed inset-0 z-50 bg-black",children:[e.jsx(Cs,{onScanCode:async f=>{if(f.toUpperCase().startsWith("CHAR-")){ce(!1),Y(f.toUpperCase()),Z(!0),E(null);try{const D=await Pt(f.toUpperCase());D?(M(D),g(D.name),L(!0),setTimeout(()=>{L(!1),c("action")},2500)):E("Postava nenalezena!")}catch{E("Chyba p콏i na캜칤t치n칤 postavy.")}finally{Z(!1)}}else E("Neplatn칳 QR k칩d postavy!")},isAIThinking:A,isPaused:!1}),e.jsx("button",{onClick:()=>ce(!1),className:"absolute top-6 right-6 z-50 px-4 py-2 bg-red-500 text-white rounded-lg font-bold uppercase text-xs hover:bg-red-600 transition-colors",children:"Zav콏칤t"})]})]}),n==="action"&&e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("button",{onClick:()=>{c("class"),M(null),Y("")},className:"text-[10px] text-zinc-500 uppercase tracking-widest hover:text-white mb-2 font-bold underline underline-offset-4",children:["Zm캩nit ",k?"Postavu":"T콏칤du"]}),e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-wider",children:"P콎칈PRAVA"}),e.jsxs("div",{className:"flex justify-center items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-white font-bold tracking-tight",children:i}),e.jsx("span",{className:"text-zinc-600",children:""}),e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded bg-zinc-900 border border-zinc-700 text-signal-cyan uppercase font-black tracking-widest",children:m})]}),k&&e.jsxs("div",{className:"mt-4 p-4 bg-zinc-900/50 border border-signal-cyan/30 rounded-xl",children:[e.jsx("p",{className:"text-xs text-signal-cyan uppercase font-bold mb-2",children:"Vlastn칤 postava"}),e.jsx("p",{className:"text-sm text-zinc-400 mb-3",children:k.description}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"bg-black/50 rounded p-2 text-center",children:[e.jsx("div",{className:"text-[10px] text-zinc-500 uppercase",children:"HP"}),e.jsx("div",{className:"text-sm font-bold text-white",children:k.baseStats.hp})]}),e.jsxs("div",{className:"bg-black/50 rounded p-2 text-center",children:[e.jsx("div",{className:"text-[10px] text-zinc-500 uppercase",children:"DMG"}),e.jsx("div",{className:"text-sm font-bold text-white",children:k.baseStats.damage})]}),e.jsxs("div",{className:"bg-black/50 rounded p-2 text-center",children:[e.jsx("div",{className:"text-[10px] text-zinc-500 uppercase",children:"Armor"}),e.jsx("div",{className:"text-sm font-bold text-white",children:k.baseStats.armor})]})]})]})]}),e.jsxs("div",{className:"p-5 bg-zinc-900/90 border-2 border-zinc-800 hover:border-signal-cyan rounded-2xl transition-all shadow-xl backdrop-blur-sm",children:[e.jsx("div",{onClick:()=>!F&&T("create"),className:`cursor-pointer ${F?"":"flex flex-col"}`,children:e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx(bs,{className:"w-7 h-7 text-signal-cyan"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-tighter",children:"Zalo쬴t_Sektor"}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-bold uppercase tracking-wider",children:"Nov치 m칤stnost pro skupinu."})]})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-zinc-800 space-y-4",onClick:f=>f.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-[9px] font-black text-zinc-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(Ct,{className:"w-3 h-3"})," Soukrom칳_Sektor"]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:F,onChange:f=>{B(f.target.checked),f.target.checked||S("")}}),e.jsx("div",{className:"w-9 h-5 bg-zinc-800 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-signal-cyan"})]})]}),F&&e.jsx("div",{className:"animate-in slide-in-from-top-2 bg-black/40 p-3 rounded-lg border border-white/5",children:e.jsx("input",{type:"text",placeholder:"Vstupn칤 kl칤캜...",value:h,onChange:f=>S(f.target.value),className:"w-full bg-transparent p-2 text-white text-sm outline-none focus:border-signal-cyan font-mono uppercase font-bold"})}),F&&e.jsx("button",{onClick:()=>T("create"),disabled:v||F&&h.length<3,className:"w-full py-4 bg-zinc-900 border-2 border-signal-cyan/50 text-signal-cyan font-black uppercase rounded-xl text-xs mt-2 disabled:opacity-50 tracking-[0.2em] shadow-[0_0_20px_rgba(0,242,255,0.15)] active:scale-95 transition-transform",children:"Inicializovat Soukrom칳 Sektor"})]})]}),e.jsxs("button",{onClick:()=>T("join_mode"),disabled:v,className:"group relative overflow-hidden w-full p-5 bg-zinc-900/80 border-2 border-zinc-800 hover:border-signal-amber rounded-2xl text-left transition-all active:scale-[0.98] shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-signal-amber/10 to-transparent translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-500"}),e.jsx(wa,{className:"w-7 h-7 text-signal-amber mb-2 relative z-10"}),e.jsx("h3",{className:"text-lg font-bold text-white relative z-10 uppercase tracking-tighter",children:"Vstoupit do Sektoru"}),e.jsx("p",{className:"text-[10px] text-zinc-400 mt-1 relative z-10 font-bold uppercase tracking-wider",children:"P콏ipojit se k existuj칤c칤 jednotce."})]}),e.jsxs("button",{onClick:()=>T("solo-online"),disabled:v,className:"group relative overflow-hidden w-full p-5 bg-zinc-900/80 border-2 border-zinc-800 hover:border-white rounded-2xl text-left transition-all active:scale-[0.98] shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/5 to-transparent translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-500"}),e.jsx(bt,{className:"w-7 h-7 text-white mb-2 relative z-10"}),e.jsx("h3",{className:"text-lg font-bold text-white relative z-10 uppercase tracking-tighter",children:"Samostatn치_Mise (Online)"}),e.jsx("p",{className:"text-[10px] text-zinc-400 mt-1 relative z-10 font-bold uppercase tracking-wider",children:"Solo hra se synchronizac칤 Vaultu."})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[e.jsx("div",{className:"h-px bg-zinc-800 flex-1"}),e.jsx("span",{className:"text-[10px] text-zinc-600 uppercase font-black",children:"Nebo"}),e.jsx("div",{className:"h-px bg-zinc-800 flex-1"})]}),e.jsxs("button",{onClick:()=>T("solo"),className:"w-full py-3 text-zinc-500 hover:text-white text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-colors",children:[e.jsx(ka,{className:"w-4 h-4"})," Samostatn치_Mise (Offline)"]})]}),n==="join"&&e.jsxs("div",{className:"text-center mt-10",children:[e.jsx("button",{onClick:()=>c("action"),className:"text-zinc-500 text-[10px] font-black uppercase mb-6 hover:text-white tracking-widest underline underline-offset-4",children:" Zp캩t do Lobby"}),e.jsx("h2",{className:"text-xl font-black text-white mb-6 uppercase tracking-widest",children:"P콏ipojen칤 k Sektoru"}),N&&e.jsxs("div",{className:"p-3 bg-red-900/20 border border-red-500/50 rounded-lg text-red-400 text-xs text-center mb-4 font-bold animate-pulse flex items-center justify-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4"}),N]}),e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{type:"text",value:b,onChange:f=>{y(f.target.value),N&&E(null)},placeholder:"A1B2C",className:"w-full bg-black border border-zinc-700 p-6 rounded-xl text-white font-mono text-center text-3xl uppercase focus:border-signal-amber outline-none tracking-[0.5em]",maxLength:5,autoFocus:!0}),e.jsx("p",{className:"text-[10px] text-zinc-500 mt-2 uppercase tracking-widest font-bold",children:"Unik치tn칤 K칩d Sektoru"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ct,{className:"h-4 w-4 text-zinc-600"})}),e.jsx("input",{type:O?"text":"password",value:h,onChange:f=>S(f.target.value),placeholder:"P콏칤stupov칳 kl칤캜 (pokud je vy쬬dov치n)",className:"w-full bg-zinc-900 border border-zinc-700 p-4 pl-10 pr-10 rounded-xl text-white outline-none focus:border-signal-amber text-sm font-bold uppercase"}),e.jsx("button",{type:"button",onClick:()=>J(!O),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-zinc-500 hover:text-white",children:O?e.jsx(Sa,{className:"h-4 w-4"}):e.jsx(za,{className:"h-4 w-4"})})]}),e.jsxs("button",{type:"submit",disabled:v||b.length<1,className:"button-primary w-full py-5 text-sm !bg-signal-amber shadow-none",children:[v?e.jsx(De,{className:"w-5 h-5 animate-spin"}):"Nav치zat Spojen칤"," ",e.jsx(at,{className:"w-5 h-5 ml-2"})]})]})]})]},n),le&&e.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-blue-500/20 backdrop-blur-sm flex items-center justify-center",children:e.jsxs(R.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},className:"bg-zinc-900 border-2 border-signal-cyan rounded-2xl p-8 text-center shadow-2xl",children:[e.jsx("div",{className:"w-16 h-16 bg-signal-cyan rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse",children:e.jsx("svg",{className:"w-8 h-8 text-black",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-wider mb-2",children:"Postava na캜tena!"}),e.jsx("p",{className:"text-sm text-signal-cyan font-bold mb-4",children:k==null?void 0:k.name}),(k==null?void 0:k.perks)&&k.perks.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10 text-left",children:[e.jsx("p",{className:"text-[10px] text-zinc-500 uppercase font-black tracking-widest mb-2",children:"Aktivn칤 bonusy:"}),e.jsx("div",{className:"space-y-1",children:k.perks.map((f,D)=>e.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[e.jsx("div",{className:"w-1 h-1 bg-signal-cyan rounded-full"}),e.jsx("span",{className:"text-white font-bold",children:f.name})]},D))})]})]})})]})},In=({data:t,onClose:s})=>{a.useEffect(()=>{const c=setTimeout(()=>{s()},4e3);return()=>clearTimeout(c)},[t.id]);const n=(()=>{switch(t.type){case"success":return{bg:"bg-[#22c55e] text-black",icon:e.jsx(st,{className:"w-5 h-5"}),label:"POTVRZENO"};case"error":return{bg:"bg-signal-hazard text-white",icon:e.jsx(ze,{className:"w-5 h-5"}),label:"KRITICK칄"};case"gift":return{bg:"bg-purple-600 text-white",icon:e.jsx(Ca,{className:"w-5 h-5"}),label:"P콎ENOS"};case"message":return{bg:"bg-signal-cyan text-black",icon:e.jsx(Ta,{className:"w-5 h-5"}),label:"SIGN츼L"};case"warning":return{bg:"bg-signal-amber text-black",icon:e.jsx(ze,{className:"w-5 h-5"}),label:"VAROV츼N칈"};default:return{bg:"bg-white text-black",icon:e.jsx(Et,{className:"w-5 h-5"}),label:"INFO"}}})();return a.createElement(R.div,{layout:!0,initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9,transition:{duration:.1}},key:t.id,className:`fixed top-4 left-4 right-4 z-[10000] pointer-events-auto shadow-[0_10px_40px_rgba(0,0,0,0.6)] border-l-8 border-black font-mono overflow-hidden ${n.bg} rounded-l-lg mx-auto max-w-sm`},e.jsxs("div",{className:"p-4 flex flex-col gap-2 relative",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-black/10 pb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[n.icon,e.jsx("span",{className:"text-[10px] font-black tracking-[0.3em]",children:n.label})]}),e.jsx("button",{onClick:c=>{c.stopPropagation(),s()},className:"opacity-40 hover:opacity-100 transition-opacity p-1",children:e.jsx(_e,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-[12px] font-bold uppercase leading-tight py-1 break-words",children:t.message}),e.jsx(R.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:4,ease:"linear"},className:"absolute bottom-0 left-0 h-1 bg-black/20"})]}))},An=({event:t,onClose:s,onPlayerDamage:p,playerHp:n=100,playerArmor:c=0,onArmorChange:i,inventory:o,onUseItem:m,onClaimLoot:g})=>{var K,de,Ce;const[b,y]=a.useState(["Nep콏칤tel detekov치n. P콏ipravte se k boji."]),[v,d]=a.useState(0),[N,E]=a.useState(0),[I,Y]=a.useState(!1),[k,M]=a.useState(null),[A,Z]=a.useState(!1),[ee,ce]=a.useState(""),[le,L]=a.useState(!1),[h,S]=a.useState(null),[O,J]=a.useState(!1),[F,B]=a.useState(!1),[Q,te]=a.useState(!1),T=a.useRef(null);a.useEffect(()=>{var l,U;const C=(U=(l=t.stats)==null?void 0:l.find(re=>["HP","ZDRAV칈"].includes(re.label.toUpperCase())))==null?void 0:U.value,H=parseInt(String(C))||50;d(H),E(H)},[t]),a.useEffect(()=>{var C;(C=T.current)==null||C.scrollIntoView({behavior:"smooth"})},[b]);const $=()=>{switch((t.rarity||"Common").toLowerCase()){case"legendary":return 10;case"epic":return 40;case"rare":return 60;default:return 80}},j=()=>{var l,U,re,ge;const C=parseInt(String(((U=(l=t.stats)==null?void 0:l.find(Ne=>Ne.label.toUpperCase()==="DEF"))==null?void 0:U.value)||"0")),H=parseInt(String(((ge=(re=t.stats)==null?void 0:re.find(Ne=>Ne.label.toUpperCase()==="ATK"))==null?void 0:ge.value)||"10"));return{def:C,atk:H}},f=()=>{var H;const C=((H=t.enemyLoot)==null?void 0:H.lootStats)||[];return C.length===0&&t.enemyLoot&&t.enemyLoot.goldReward&&C.push({label:"ZLATO",value:`+${t.enemyLoot.goldReward}`}),C},D=()=>{if(O||F||v<=0)return;B(!0),J(!0);const C=$(),H=Math.floor(Math.random()*100)+1;y(l=>[...l,`POKUS O 칔T캨K (마nce ${C}%)...`]),w("scan"),setTimeout(()=>{H<=C?(w("open"),y(l=>[...l,`칔SP캨CH! (Hod: ${H}) Unikl jsi z boje.`]),setTimeout(s,800)):(w("error"),W(100),y(l=>[...l,`SELH츼N칈! (Hod: ${H}) Nep콏칤tel blokuje 칰stup.`]),B(!1),ue(!0))},1500)},q=()=>{if(I||v<=0||F)return;Y(!0),Z(!1),w("scan");let C=0;const H=setInterval(()=>{M([Math.floor(Math.random()*6)+1,Math.floor(Math.random()*6)+1]),C++,C>10&&(clearInterval(H),fe())},50)},oe=()=>{const C=parseInt(ee);if(isNaN(C)||C<2||C>12){w("error");return}Z(!1);const H=Math.floor(C/2),l=C-H;M([H,l]),fe(C)},fe=C=>{var Be;let H=0,l=0,U=0;C!==void 0?(U=C,H=Math.floor(C/2),l=C-H):(H=Math.floor(Math.random()*6)+1,l=Math.floor(Math.random()*6)+1,U=H+l),M([H,l]);const{def:re}=j(),ge=((Be=t.combatConfig)==null?void 0:Be.defBreakChance)||0;let Ne=!1;ge>0&&Math.random()*100<ge&&(Ne=!0);const ve=U===12,Ee=U===2;let we=Math.max(0,U-(Ne?0:re));ve&&(we*=2),Ee&&(we=0),we>0?(d(je=>Math.max(0,je-we)),Ne&&(y(je=>[...je,`游꿢 PENETRACE OBRANY! (Ignorov치no ${re} DEF)`]),w("crit")),ve?(w("crit"),W([50,50,50,100]),y(je=>[...je,`KRITICK칗 Z츼SAH! (12) -> ${we} DMG`])):(w("damage"),W(20),y(je=>[...je,`칔TOK: Hod ${U} vs ${Ne?"0 (BROKEN)":re} DEF -> ${we} DMG`]))):(w("miss"),W(50),y(je=>[...je,`MINUT칈: Hod ${U} nepro코el p콏es obranu.`])),setTimeout(()=>{v-we>0?ue():(y(je=>[...je,"C칈L ELIMINOV츼N."]),w("success")),Y(!1),ce("")},1e3)},ue=(C=!1)=>{const{atk:H}=j();let l=Math.max(0,H);if(l>0){const U=C?"NEP콎칈TEL (VOLN칗 칔TOK)":"NEP콎칈TEL";if(c>0){const re=Math.min(c,l);l-=re,i&&i(-re),y(ge=>[...ge,`游띠勇 T칈T ZASA콯EN: -${re} Armor`]),w("error")}l>0?(p&&p(-l),y(re=>[...re,`${U}: Z치sah za ${l} HP!`]),W([100])):y(re=>[...re,`${U}: 칔tok pln캩 pohlcen 코t칤tem!`])}},be=()=>{var H;if(!h)return;const C=(H=h.stats)==null?void 0:H.find(l=>["DMG","ATK","POKOZEN칈"].some(U=>l.label.toUpperCase().includes(U)));if(C){const l=parseInt(String(C.value).replace(/[^0-9-]/g,""));l>0&&(d(U=>Math.max(0,U-l)),y(U=>[...U,`POU콯IT P콎EDM캨T: ${h.title} -> ${l} DMG!`]),w("damage"),W(50),v-l<=0&&setTimeout(()=>{y(U=>[...U,"C칈L ELIMINOV츼N P콎EDM캨TEM."]),w("success")},500))}m&&m(h),S(null)},Me=()=>{if(Q)return;te(!0);const C=f();g&&g(C),w("success"),W([50,50,100]),setTimeout(s,1e3)},Te=(o==null?void 0:o.filter(C=>{var H;return!((H=C.resourceConfig)!=null&&H.isResourceContainer||C.type!==ae.ITEM&&C.type!=="P콎EDM캨T")}))||[],{atk:Ue,def:he}=j(),_=v<=0,V=((K=t.combatConfig)==null?void 0:K.defBreakChance)&&t.combatConfig.defBreakChance>0;if(_){const C=f();return e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 space-y-6 animate-in zoom-in duration-500 text-center",children:[e.jsx(Ea,{className:"w-24 h-24 text-yellow-500 animate-bounce drop-shadow-[0_0_20px_rgba(234,179,8,0.5)]"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-3xl font-display font-black text-yellow-500 uppercase tracking-widest",children:"V칈T캨ZSTV칈"}),e.jsx("p",{className:"text-zinc-400 font-mono text-xs uppercase tracking-widest",children:"Nep콏칤tel pora쬰n. Ko콏ist dostupn치."})]}),e.jsxs("div",{className:"w-full bg-zinc-900/80 border border-yellow-500/30 rounded-xl p-4 space-y-3",children:[e.jsx("h3",{className:"text-[10px] font-black uppercase text-zinc-500 tracking-[0.2em] border-b border-zinc-800 pb-2 mb-2",children:"Nalezen칠 Suroviny & Data"}),C.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-2",children:C.map((H,l)=>e.jsxs("div",{className:"bg-black p-2 rounded border border-zinc-800 flex items-center justify-between",children:[e.jsx("span",{className:"text-[9px] font-bold text-zinc-400 uppercase",children:H.label}),e.jsx("span",{className:"text-sm font-mono font-black text-yellow-500",children:H.value})]},l))}):e.jsx("p",{className:"text-xs text-zinc-600 italic",children:"콯치dn치 ko콏ist nalezena."})]}),e.jsx("button",{onClick:Me,disabled:Q,className:`w-full py-4 font-black uppercase text-sm tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 shadow-lg transition-all ${Q?"bg-green-600 text-white":"bg-yellow-500 hover:bg-yellow-400 text-black active:scale-95"}`,children:Q?e.jsxs(e.Fragment,{children:[e.jsx(Nt,{className:"w-5 h-5"})," VYZVEDNUTO"]}):e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"w-5 h-5"})," VYZVEDNOUT KO콎IST"]})})]})}return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 p-3 bg-zinc-900/50 border border-zinc-700 rounded-xl flex flex-col justify-end relative",children:[e.jsxs("div",{className:"flex justify-between items-end mb-1 relative z-10",children:[e.jsx("span",{className:"text-[8px] font-black uppercase text-zinc-500 tracking-widest flex items-center gap-1",children:"TY"}),e.jsxs("div",{className:"text-right",children:[c>0&&e.jsxs("div",{className:"flex items-center justify-end gap-1 text-zinc-400 mb-0.5",children:[e.jsx(Ve,{className:"w-3 h-3"}),e.jsx("span",{className:"text-[9px] font-mono font-bold",children:c})]}),e.jsxs("div",{className:"flex items-center justify-end gap-1 text-red-500",children:[e.jsx(He,{className:"w-3 h-3 fill-current"}),e.jsxs("span",{className:"text-[10px] font-mono font-bold",children:[n," HP"]})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[c>0&&e.jsx("div",{className:"h-1 bg-black rounded-full overflow-hidden border border-zinc-700",children:e.jsx(R.div,{className:"h-full bg-zinc-400",initial:{width:"100%"},animate:{width:`${Math.min(100,c)}%`}})}),e.jsx("div",{className:"h-1.5 bg-black rounded-full overflow-hidden border border-red-900/50",children:e.jsx(R.div,{className:"h-full bg-red-600",initial:{width:"100%"},animate:{width:`${Math.min(100,n)}%`}})})]})]}),e.jsxs("div",{className:"flex-1 p-3 bg-red-950/30 border border-red-500/30 rounded-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("span",{className:"text-[8px] font-black uppercase text-red-400 tracking-widest flex items-center gap-1",children:[e.jsx(gt,{className:"w-3 h-3"})," Nep콏칤tel"]}),e.jsxs("span",{className:"text-[10px] font-mono font-bold text-white",children:[v," HP"]})]}),e.jsx("div",{className:"h-1.5 bg-black rounded-full overflow-hidden border border-red-900/50 mt-auto",children:e.jsx(R.div,{className:"h-full bg-red-600",initial:{width:"100%"},animate:{width:`${v/N*100}%`}})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-black/40 border border-zinc-800 p-2 rounded flex justify-between items-center",children:[e.jsx("span",{className:"text-[9px] text-zinc-500 uppercase font-bold",children:"Enemy 칔tok (ATK)"}),e.jsx("span",{className:"text-sm font-black text-orange-500",children:Ue})]}),e.jsxs("div",{className:"bg-black/40 border border-zinc-800 p-2 rounded flex justify-between items-center relative overflow-hidden",children:[e.jsx("span",{className:"text-[9px] text-zinc-500 uppercase font-bold",children:"Enemy Obrana (DEF)"}),e.jsx("span",{className:`text-sm font-black text-blue-400 ${V?"pr-6":""}`,children:he}),V&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 bg-green-900/50 w-6 flex items-center justify-center border-l border-green-500/50",title:`Weakness: ${(de=t.combatConfig)==null?void 0:de.defBreakChance}%`,children:e.jsx(gs,{className:"w-3 h-3 text-green-500 animate-pulse"})})]})]}),e.jsxs("div",{className:"bg-black border border-white/10 rounded-xl p-4 relative overflow-hidden",children:[e.jsx(xe,{children:A&&e.jsxs(R.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute inset-0 z-30 bg-black flex flex-col items-center justify-center p-4 space-y-3",children:[e.jsx("h4",{className:"text-xs font-black text-white uppercase tracking-widest",children:"Zadejte sou캜et 2 kostek"}),e.jsx("input",{type:"number",autoFocus:!0,value:ee,onChange:C=>ce(C.target.value),placeholder:"2-12",className:"w-24 bg-zinc-900 border border-zinc-700 p-3 text-center text-xl font-bold text-white rounded-xl outline-none focus:border-signal-cyan"}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx("button",{onClick:()=>Z(!1),className:"flex-1 py-3 bg-zinc-800 text-zinc-400 font-bold text-[10px] uppercase rounded-lg",children:"Zru코it"}),e.jsx("button",{onClick:oe,className:"flex-1 py-3 bg-green-600 text-white font-bold text-[10px] uppercase rounded-lg",children:"Potvrdit"})]})]})}),e.jsx(xe,{children:I&&e.jsx(R.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.5},className:"absolute inset-0 z-20 bg-black/80 flex items-center justify-center gap-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex gap-2 justify-center mb-2",children:[e.jsx(Ze,{className:"w-12 h-12 text-white animate-spin"}),e.jsx(Ze,{className:"w-12 h-12 text-white animate-spin",style:{animationDirection:"reverse"}})]}),e.jsx("span",{className:"text-2xl font-black text-white font-mono tracking-widest",children:k?`${k[0]} + ${k[1]}`:"? + ?"})]})})}),e.jsxs("div",{className:"h-24 overflow-y-auto no-scrollbar space-y-1 font-mono text-[9px] text-zinc-400 mb-3 border-b border-zinc-800 pb-2",children:[b.length===0?e.jsx("span",{className:"italic opacity-50",children:"Zahajte 칰tok..."}):b.map((C,H)=>e.jsx("div",{className:C.includes("KRITICK칗")||C.includes("PENETRACE")?"text-yellow-400 font-bold":C.includes("NEP콎칈TEL")?"text-red-400":C.includes("POU콯IT")?"text-cyan-400":C.includes("칔SP캨CH")?"text-green-400":C.includes("SELH츼N칈")?"text-red-500":C.includes("T칈T")?"text-zinc-200":"text-zinc-300",children:C},H)),e.jsx("div",{ref:T})]}),e.jsxs("div",{className:"flex gap-2 h-16",children:[e.jsxs("button",{onClick:()=>Z(!0),disabled:I||F,className:"flex-1 py-4 bg-zinc-800 hover:bg-zinc-700 text-white font-black uppercase text-[10px] tracking-[0.1em] rounded-xl flex items-center justify-center gap-2 border border-zinc-600 active:scale-95 transition-all",children:[e.jsx(Lt,{className:"w-5 h-5 text-zinc-400"}),e.jsx("span",{children:"ZADAT HOD"})]}),e.jsx("button",{onClick:q,disabled:I||F,className:"w-20 bg-red-600 hover:bg-red-500 text-white rounded-xl shadow-[0_0_15px_rgba(220,38,38,0.4)] active:scale-95 transition-all flex flex-col items-center justify-center border border-red-400",children:e.jsx(Ze,{className:"w-8 h-8"})})]}),e.jsxs("button",{onClick:D,disabled:I||O||F,className:`w-full py-2 mt-2 bg-zinc-900 border border-zinc-700 text-zinc-400 font-bold uppercase text-[9px] tracking-widest rounded-lg flex items-center justify-center gap-2 ${O?"opacity-50 cursor-not-allowed":"hover:bg-zinc-800 hover:text-white"}`,children:[e.jsx(vt,{className:"w-3 h-3"}),O?"칔T캨K SELHAL":`POKUSIT SE UT칄CT (${$()}%)`]})]}),o&&o.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("button",{onClick:()=>{L(!le),S(null)},className:"w-full py-2 bg-zinc-900 hover:bg-zinc-800 border border-zinc-700 text-zinc-400 font-bold uppercase text-[9px] tracking-widest rounded-lg flex items-center justify-center gap-2",children:[e.jsx($e,{className:"w-3 h-3"})," ",le?"Zav콏칤t Batoh":"Podpora z Batohu"]}),e.jsx(xe,{children:le&&e.jsx(R.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden bg-black/40 rounded-lg border border-zinc-800 mt-2",children:h?e.jsxs("div",{className:"p-3 bg-zinc-900/80",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-white font-bold text-xs uppercase",children:h.title}),e.jsx("button",{onClick:()=>S(null),children:e.jsx(_e,{className:"w-4 h-4 text-zinc-500"})})]}),e.jsx("p",{className:"text-[10px] text-zinc-400 italic mb-3",children:h.description}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(Ce=h.stats)==null?void 0:Ce.map((C,H)=>e.jsxs("span",{className:"text-[9px] bg-black border border-zinc-700 px-2 py-1 rounded text-zinc-300 font-mono",children:[C.label,": ",C.value]},H))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>S(null),className:"flex-1 py-2 bg-zinc-800 text-zinc-400 text-[10px] font-bold uppercase rounded",children:"Zp캩t"}),e.jsx("button",{onClick:be,className:"flex-1 py-2 bg-green-600 text-white text-[10px] font-bold uppercase rounded hover:bg-green-500",children:"POU콯칈T"})]})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2 p-2 max-h-40 overflow-y-auto",children:[Te.map(C=>{var re,ge,Ne;const H=(re=C.stats)==null?void 0:re.find(ve=>["HP","ZDRAV칈","HEAL"].some(Ee=>ve.label.toUpperCase().includes(Ee))),l=(ge=C.stats)==null?void 0:ge.find(ve=>["DMG","ATK","POKOZEN칈"].some(Ee=>ve.label.toUpperCase().includes(Ee))),U=(Ne=C.stats)==null?void 0:Ne.find(ve=>["ARMOR","T칈T","BRN캨N칈"].some(Ee=>ve.label.toUpperCase().includes(Ee)));return!H&&!l&&!U&&!C.isConsumable?null:e.jsxs("button",{onClick:()=>S(C),className:"flex flex-col items-start p-2 bg-zinc-800 hover:bg-zinc-700 border border-zinc-700 rounded text-left active:scale-95 transition-all",children:[e.jsx("span",{className:"text-[9px] font-bold text-white uppercase line-clamp-1",children:C.title}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 flex-wrap",children:[l&&e.jsxs("span",{className:"text-[8px] font-mono text-orange-400 bg-orange-950/30 px-1 rounded flex items-center gap-0.5",children:[e.jsx(yt,{className:"w-2 h-2"})," ",l.value]}),H&&e.jsxs("span",{className:"text-[8px] font-mono text-green-400 bg-green-950/30 px-1 rounded flex items-center gap-0.5",children:[e.jsx(He,{className:"w-2 h-2"})," ",H.value]}),U&&e.jsxs("span",{className:"text-[8px] font-mono text-zinc-300 bg-zinc-700/50 px-1 rounded flex items-center gap-0.5",children:[e.jsx(Ve,{className:"w-2 h-2"})," ",U.value]})]})]},C.id)}),Te.length===0&&e.jsx("p",{className:"col-span-2 text-center text-[9px] text-zinc-600 italic py-2",children:"콯치dn칠 bojov칠 p콏edm캩ty."})]})})})]})]})},Rn=({event:t,onClose:s,onPlayerDamage:p,playerClass:n,onClaimLoot:c})=>{var le,L,h,S,O,J,F;const[i,o]=a.useState("active"),[m,g]=a.useState(!1),[b,y]=a.useState(null),[v,d]=a.useState(!1),[N,E]=a.useState(""),I={difficulty:((le=t.trapConfig)==null?void 0:le.difficulty)??10,damage:((L=t.trapConfig)==null?void 0:L.damage)??20,disarmClass:((h=t.trapConfig)==null?void 0:h.disarmClass)||"ANY",successMessage:((S=t.trapConfig)==null?void 0:S.successMessage)||"Past zne코kodn캩na.",failMessage:((O=t.trapConfig)==null?void 0:O.failMessage)||"Past sklapla!",trapType:((J=t.trapConfig)==null?void 0:J.trapType)||"N츼STRAHA",loot:((F=t.trapConfig)==null?void 0:F.loot)||[]},Y=n&&I.disarmClass===n,k=I.trapType,M=()=>{o("success"),w("success"),W([50,50,50])},A=()=>{i==="success"&&(I.loot&&I.loot.length>0&&c&&c(I.loot),o("claimed"),w("open"),setTimeout(s,800))},Z=()=>{if(m||i!=="active")return;g(!0),d(!1),w("scan");let B=0;const Q=setInterval(()=>{y([Math.floor(Math.random()*6)+1,Math.floor(Math.random()*6)+1]),B++,B>10&&(clearInterval(Q),ce())},50)},ee=()=>{const B=parseInt(N);if(isNaN(B)||B<2||B>12){w("error");return}d(!1);const Q=Math.floor(B/2),te=B-Q;y([Q,te]),ce(B)},ce=B=>{let Q=0;if(B!==void 0)Q=B;else{const te=Math.floor(Math.random()*6)+1,T=Math.floor(Math.random()*6)+1;y([te,T]),Q=te+T}g(!1),Q>=I.difficulty?(o("success"),w("success"),W([50,50])):(o("fail"),w("error"),W([200,100,200]),p&&I.damage>0&&setTimeout(()=>{p(-I.damage)},500),setTimeout(s,2500))};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`p-4 rounded-xl border-2 flex items-center justify-between transition-colors ${i==="active"?"bg-orange-950/30 border-orange-500/50":i==="success"||i==="claimed"?"bg-green-950/30 border-green-500":"bg-red-950/30 border-red-600"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-full border ${i==="active"?"bg-orange-500/10 border-orange-500 text-orange-500":i==="success"||i==="claimed"?"bg-green-500/10 border-green-500 text-green-500":"bg-red-500/10 border-red-500 text-red-500"}`,children:i==="active"?e.jsx(qe,{className:"w-6 h-6 animate-pulse"}):i==="success"||i==="claimed"?e.jsx(Nt,{className:"w-6 h-6"}):e.jsx($t,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-sm font-black uppercase tracking-widest ${i==="active"?"text-orange-500":i==="success"||i==="claimed"?"text-green-500":"text-red-500"}`,children:i==="active"?"DETEKOV츼NA HROZBA":i==="success"?"PAST ZNEKODN캨NA":i==="claimed"?"HOTOVO":"PAST SPUT캨NA"}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-mono font-bold uppercase tracking-wider",children:i==="active"?k:i==="success"?I.successMessage:I.failMessage})]})]})}),i==="active"&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-black/60 border border-zinc-800 p-4 rounded-xl flex flex-col items-center justify-center gap-1",children:[e.jsx("span",{className:"text-[9px] text-zinc-500 uppercase font-bold tracking-widest",children:"Obt칤쬹ost (C칤l)"}),e.jsxs("div",{className:`text-3xl font-black font-mono flex items-center gap-2 ${Y?"text-green-500":"text-white"}`,children:[Y?e.jsx(Ia,{className:"w-5 h-5"}):e.jsx(Re,{className:"w-5 h-5 text-zinc-600"}),Y?"0":`${I.difficulty}+`]})]}),e.jsxs("div",{className:"bg-red-950/20 border border-red-900/50 p-4 rounded-xl flex flex-col items-center justify-center gap-1",children:[e.jsx("span",{className:"text-[9px] text-red-400 uppercase font-bold tracking-widest",children:"Riziko (DMG)"}),e.jsxs("div",{className:"text-3xl font-black text-red-500 font-mono flex items-center gap-2",children:[e.jsx(gt,{className:"w-5 h-5"})," -",I.damage]})]})]}),i==="success"&&e.jsxs("div",{className:"animate-in zoom-in duration-300 space-y-4",children:[e.jsxs("div",{className:"bg-green-950/20 border border-green-500/30 p-4 rounded-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-20",children:e.jsx(ke,{className:"w-16 h-16 text-green-500"})}),e.jsx("p",{className:"text-[10px] text-green-400 font-bold uppercase tracking-widest mb-3 border-b border-green-500/30 pb-2",children:"Odm캩na za zne코kodn캩n칤 (Loot)"}),I.loot&&I.loot.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-2 relative z-10",children:I.loot.map((B,Q)=>e.jsxs("div",{className:"bg-black p-3 rounded border border-green-900 flex justify-between items-center shadow-lg",children:[e.jsx("span",{className:"text-[9px] font-bold text-zinc-400 uppercase tracking-wider",children:B.label}),e.jsx("span",{className:"text-lg font-mono font-black text-green-500",children:B.value})]},Q))}):e.jsx("p",{className:"text-[10px] text-zinc-500 italic py-4 text-center",children:"콯치dn치 dodate캜n치 odm캩na. Past se jen vypne."})]}),e.jsx("button",{onClick:A,className:"w-full py-4 bg-green-600 hover:bg-green-500 text-white font-black uppercase text-xs tracking-[0.2em] rounded-xl shadow-[0_0_20px_rgba(34,197,94,0.3)] flex items-center justify-center gap-2 transition-all active:scale-95",children:I.loot&&I.loot.length>0?e.jsxs(e.Fragment,{children:["VYZVEDNOUT A ULO콯IT ",e.jsx(Ye,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["POKRA캛OVAT ",e.jsx(at,{className:"w-4 h-4"})]})})]}),i==="active"&&e.jsx("div",{className:"bg-black border border-white/10 rounded-xl p-4 relative overflow-hidden",children:Y?e.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-2",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 bg-green-900/10 p-3 rounded-lg border border-green-500/20",children:[e.jsx(Dt,{className:"w-8 h-8 text-green-400"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-black text-green-400 uppercase tracking-widest",children:["Autorizace P콏ijata: ",n]}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-mono leading-tight mt-1",children:"Tv콢j v칳cvik ti umo쮄갓je tento mechanismus bezpe캜n캩 obej칤t. Kostky nejsou pot콏eba."})]})]}),e.jsxs("button",{onClick:M,className:"w-full py-4 bg-green-600 hover:bg-green-500 text-white font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-3 transition-all active:scale-95 shadow-[0_0_20px_rgba(34,197,94,0.4)] animate-pulse",children:[e.jsx(Aa,{className:"w-5 h-5"}),"BEZPE캛N캨 ZNEKODNIT"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{children:v&&e.jsxs(R.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute inset-0 z-30 bg-black flex flex-col items-center justify-center p-4 space-y-3",children:[e.jsx("h4",{className:"text-xs font-black text-white uppercase tracking-widest",children:"Zadejte sou캜et 2 kostek"}),e.jsx("input",{type:"number",autoFocus:!0,value:N,onChange:B=>E(B.target.value),placeholder:"2-12",className:"w-24 bg-zinc-900 border border-zinc-700 p-3 text-center text-xl font-bold text-white rounded-xl outline-none focus:border-orange-500"}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx("button",{onClick:()=>d(!1),className:"flex-1 py-3 bg-zinc-800 text-zinc-400 font-bold text-[10px] uppercase rounded-lg",children:"Zru코it"}),e.jsx("button",{onClick:ee,className:"flex-1 py-3 bg-orange-600 text-white font-bold text-[10px] uppercase rounded-lg",children:"Potvrdit"})]})]})}),e.jsx(xe,{children:m&&e.jsx(R.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.5},className:"absolute inset-0 z-20 bg-black/80 flex items-center justify-center gap-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex gap-2 justify-center mb-2",children:[e.jsx(Ze,{className:"w-12 h-12 text-white animate-spin"}),e.jsx(Ze,{className:"w-12 h-12 text-white animate-spin",style:{animationDirection:"reverse"}})]}),e.jsx("span",{className:"text-2xl font-black text-white font-mono tracking-widest",children:b?`${b[0]} + ${b[1]}`:"? + ?"})]})})}),e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest mb-3 text-center",children:"Zvolte metodu ov캩콏en칤"}),e.jsxs("div",{className:"flex gap-2 h-20",children:[e.jsxs("button",{onClick:()=>d(!0),disabled:m,className:"flex-1 bg-zinc-800 hover:bg-zinc-700 text-white font-black uppercase text-[10px] tracking-[0.1em] rounded-xl flex flex-col items-center justify-center gap-2 border border-zinc-600 active:scale-95 transition-all group",children:[e.jsx(Lt,{className:"w-6 h-6 text-zinc-400 group-hover:text-white transition-colors"}),e.jsx("span",{children:"ZADAT HOD (FYZICK칄 KOSTKY)"})]}),e.jsxs("button",{onClick:Z,disabled:m,className:"w-24 bg-orange-600 hover:bg-orange-500 text-white rounded-xl shadow-[0_0_15px_rgba(249,115,22,0.4)] active:scale-95 transition-all flex flex-col items-center justify-center border border-orange-400",children:[e.jsx(Ze,{className:"w-8 h-8"}),e.jsx("span",{className:"text-[8px] font-bold mt-1",children:"VIRTU츼LN칈"})]})]})]})})]})},On=({event:t,onClose:s,onSave:p,onDiscard:n,onUse:c,onResolveDilemma:i,isSaved:o,onPlayerDamage:m,playerHp:g,playerArmor:b,onArmorChange:y,playerClass:v,inventory:d,onUseItem:N,onClaimLoot:E})=>{var ue,be,Me,Te,Ue,he;const[I,Y]=a.useState("CHOICE"),[k,M]=a.useState(null),[A,Z]=a.useState("success"),[ee,ce]=a.useState(!1),[le,L]=a.useState(null);a.useEffect(()=>{w("open")},[t]);const h=t.type===ae.ENCOUNTER||t.type===ae.BOSS,S=t.type===ae.TRAP,O=!h&&!S,J=_=>{L(le===_?null:_),w("click"),W(10)},F=_=>{const V=_.toUpperCase();return["HP","ZDRAV칈","HEAL","HEALTH"].some(K=>V.includes(K))?"text-green-400":["DMG","ATK","칔TOK","UTOK","ATTACK"].some(K=>V.includes(K))?"text-signal-hazard":["GOLD","MINCE","KREDITY","CREDITS"].some(K=>V.includes(K))?"text-signal-amber":["MANA","ENERGIE","ENERGY"].some(K=>V.includes(K))?"text-signal-cyan":"text-white"},B=(_,V)=>{const K=_.toUpperCase(),de=String(V),Ce=de.includes("+")||!de.includes("-")&&parseInt(de)>0;return["HP","ZDRAV칈","HEAL","HEALTH"].some(C=>K.includes(C))?Ce?`Okam쬴t캩 obnovuje ${de} jednotek biologick칠 integrity.`:`Zp콢sobuje p콏칤m칠 po코kozen칤 tk치n칤 ve v칳코i ${de} HP.`:["DMG","ATK","칔TOK","UTOK","ATTACK"].some(C=>K.includes(C))?`Zvy코uje s칤lu p콏칤코t칤ho 칰deru nebo automatick칠ho 칰toku o ${de}.`:["GOLD","MINCE","KREDITY","CREDITS"].some(C=>K.includes(C))?`Transak캜n칤 kredity v hodnot캩 ${de} byly p콏ips치ny do tv칠ho 칰캜tu.`:["MANA","ENERGIE","ENERGY"].some(C=>K.includes(C))?`Obnovuje ${de} jednotek energie pro pou쬴t칤 schopnost칤 nebo svitk콢.`:["ARMOR","OBRANA","BRN캨N칈"].some(C=>K.includes(C))?`Zvy코uje tvou statickou ochranu o ${de}. Sni쬿je p콏칤choz칤 DMG.`:`Speci치ln칤 modifik치tor sektoru ovliv켿uj칤c칤 parametr ${_} o ${de}.`},Q=_=>{M(_);const K=Math.random()*100<(_.successChance??100),de=K?"success":"fail";Z(de),Y("RESULT"),K?(w("success"),W([50,50])):(w("error"),W([100,100])),i&&i(_,de)},te=()=>{ee&&n?(n(),w("error"),s()):(ce(!0),W(20))},$=((_,V)=>{var de,Ce;if(_===ae.BOSS)return{bg:"bg-gradient-to-b from-red-950/90 to-black",border:"border-red-600 shadow-[0_0_60px_rgba(220,38,38,0.4)]",text:"text-red-500",accent:"bg-red-600",icon:e.jsx(Pa,{className:"w-8 h-8 text-red-500"})};if(_===ae.SPACE_STATION)return{bg:"bg-gradient-to-b from-slate-900/90 to-black",border:"border-cyan-400 shadow-[0_0_40px_rgba(34,211,238,0.2)]",text:"text-cyan-400",accent:"bg-cyan-500",icon:e.jsx(jt,{className:"w-8 h-8 text-cyan-400"})};if(_===ae.PLANET)return{bg:"bg-gradient-to-b from-indigo-950/90 to-black",border:"border-indigo-500 shadow-[0_0_40px_rgba(99,102,241,0.2)]",text:"text-indigo-400",accent:"bg-indigo-500",icon:e.jsx(bt,{className:"w-8 h-8 text-indigo-400"})};if(_===ae.TRAP)return{bg:"bg-gradient-to-b from-orange-950/90 to-black",border:"border-orange-500 shadow-[0_0_30px_rgba(249,115,22,0.3)]",text:"text-orange-500",accent:"bg-orange-500",icon:e.jsx(qe,{className:"w-8 h-8 text-orange-500"})};if(_===ae.MERCHANT)return{bg:"bg-gradient-to-b from-yellow-950/90 to-black",border:"border-yellow-500 shadow-[0_0_30px_rgba(234,179,8,0.3)]",text:"text-yellow-500",accent:"bg-yellow-500",icon:e.jsx(It,{className:"w-8 h-8 text-yellow-500"})};if(_===ae.ENCOUNTER)return{bg:"bg-gradient-to-b from-rose-950/90 to-black",border:"border-rose-500 shadow-[0_0_30px_rgba(244,63,94,0.3)]",text:"text-rose-500",accent:"bg-rose-500",icon:e.jsx(yt,{className:"w-8 h-8 text-rose-500"})};if(_===ae.DILEMA)return{bg:"bg-[#0a0b0d]",border:"border-purple-500/50 shadow-[0_0_40px_rgba(168,85,247,0.2)]",text:"text-purple-400",accent:"bg-purple-500",icon:e.jsx(La,{className:"w-8 h-8 text-purple-400"})};const K={Legendary:"border-signal-amber text-signal-amber shadow-[0_0_30px_rgba(255,157,0,0.3)]",Epic:"border-purple-400 text-purple-400 shadow-[0_0_20px_rgba(192,132,252,0.3)]",Rare:"border-signal-cyan text-signal-cyan shadow-[0_0_20px_rgba(0,242,255,0.2)]",Common:"border-white/30 text-white/60"};return{bg:"bg-[#0a0b0d]",border:K[V]||K.Common,text:((de=K[V])==null?void 0:de.split(" ")[1])||"text-white",accent:((Ce=K[V])==null?void 0:Ce.split(" ")[1].replace("text-","bg-"))||"bg-white",icon:e.jsx(Ns,{className:"w-8 h-8"})}})(t.type,t.rarity),j=t.type===ae.DILEMA,f=(_,V)=>e.jsx(xe,{children:le===_&&e.jsx(R.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx("div",{className:"mt-2 p-2 bg-black/60 border border-white/10 rounded-lg text-[10px] text-zinc-300 leading-tight italic",children:B(_,V)})})}),D=()=>{var _,V;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-indigo-950/30 border border-indigo-500/30 rounded-xl flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-black border border-indigo-500/50 rounded-full shadow-[0_0_20px_rgba(99,102,241,0.2)]",children:e.jsx(vs,{className:"w-6 h-6 text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-indigo-400 tracking-widest mb-1",children:"Naviga캜n칤 Data"}),e.jsx("p",{className:"text-xs text-zinc-300 font-mono leading-relaxed",children:"Ulo쬾e tuto kartu do batohu. Odemkne v치m novou destinaci v naviga캜n칤m syst칠mu lodi."})]})]}),e.jsxs("div",{className:"bg-black/40 border border-white/5 p-3 rounded-lg flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-500 uppercase",children:"Sektor ID"}),e.jsx("span",{className:"text-white font-mono font-bold",children:((_=t.planetConfig)==null?void 0:_.planetId)||"N/A"})]}),e.jsxs("div",{className:"bg-black/40 border border-white/5 p-3 rounded-lg flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-500 uppercase",children:"Typ Eventu"}),e.jsx("span",{className:"text-white font-mono font-bold",children:((V=t.planetConfig)==null?void 0:V.landingEventType)||"UNKNOWN"})]})]})},q=()=>{var _,V,K,de;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-cyan-950/20 border border-cyan-500/30 p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-cyan-400",children:[e.jsx(ws,{className:"w-4 h-4 animate-pulse"}),e.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest",children:"Stanice Online"})]}),e.jsxs("p",{className:"text-xs text-zinc-300 italic mb-4",children:['"',((_=t.stationConfig)==null?void 0:_.welcomeMessage)||"V칤tejte na palub캩. Syst칠my jsou funk캜n칤.",'"']}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-3 rounded border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vt,{className:"w-4 h-4 text-cyan-300"}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-300 uppercase",children:"Kysl칤k (O2)"})]}),e.jsx("div",{className:"text-green-500 font-mono text-xs font-bold flex items-center gap-1 uppercase",children:(V=t.stationConfig)!=null&&V.refillO2?"DOPLN캨N칈 NA 100%":"---"})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-3 rounded border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4 text-slate-300"}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-300 uppercase",children:"Oprava Pl치코t캩"})]}),e.jsxs("div",{className:"text-green-500 font-mono text-xs font-bold flex items-center gap-1",children:["+",((K=t.stationConfig)==null?void 0:K.repairAmount)||30," HP"]})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-3 rounded border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gt,{className:"w-4 h-4 text-orange-400"}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-300 uppercase",children:"Dopln캩n칤 Paliva"})]}),e.jsxs("div",{className:"text-green-500 font-mono text-xs font-bold flex items-center gap-1",children:["+",((de=t.stationConfig)==null?void 0:de.fuelReward)||50]})]})]})]}),e.jsx("p",{className:"text-[9px] text-green-500 text-center uppercase font-bold",children:"Odm캩na za p콏ist치n칤 na stanici"})]})},oe=()=>{var _,V,K;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-yellow-900/10 border border-yellow-700/30 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-yellow-500 mb-2",children:"Obchodn칤 Status"}),e.jsxs("div",{className:"text-xs text-zinc-300 italic",children:['"',t.description,'"']})]}),e.jsxs("div",{className:"bg-black/40 border border-zinc-800 rounded-lg p-3",children:[e.jsx("h4",{className:"text-[10px] font-bold text-zinc-400 uppercase mb-3 border-b border-zinc-800 pb-1",children:"T콏칤dn칤 Slevy & Bonusy"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-[10px] font-bold uppercase",children:[e.jsx(us,{className:"w-3 h-3"})," V치le캜n칤k"]}),e.jsxs("div",{className:"text-white font-mono text-xs",children:[((_=t.tradeConfig)==null?void 0:_.warriorDiscount)||10,"% SLEVA"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-400 text-[10px] font-bold uppercase",children:[e.jsx(ps,{className:"w-3 h-3"})," M치g (Svitky)"]}),e.jsxs("div",{className:"text-white font-mono text-xs",children:[((V=t.tradeConfig)==null?void 0:V.mageDiscount)||25,"% SLEVA"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-500 text-[10px] font-bold uppercase",children:[e.jsx(fs,{className:"w-3 h-3"})," Kn캩z (Heal)"]}),e.jsxs("div",{className:"text-white font-mono text-xs",children:[((K=t.tradeConfig)==null?void 0:K.clericDiscount)||45,"% SLEVA"]})]})]})]})]})},fe=()=>{var _;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-[8px] text-white/30 uppercase font-black tracking-widest flex items-center gap-2 mb-2",children:[e.jsx(Et,{className:"w-3 h-3"})," Klikni na stat pro vysv캩tlen칤 vlivu"]}),t.isSellOnly&&e.jsxs("div",{className:"bg-red-950/20 border border-red-500/30 p-4 rounded-xl flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-3 bg-black border border-red-500/50 rounded-lg shadow-[0_0_15px_rgba(239,68,68,0.15)]",children:e.jsx(ys,{className:"w-6 h-6 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-red-500 tracking-widest mb-1 flex items-center gap-2",children:"JEN PRO PRODEJ"}),e.jsx("p",{className:"text-[8px] text-zinc-400 font-mono leading-relaxed",children:"Tento p콏edm캩t nem치 쮂멳nou funk캜n칤 hodnotu. Lze jej pouze prodat obchodn칤k콢m za kredity."})]})]}),((_=t.resourceConfig)==null?void 0:_.isResourceContainer)&&e.jsxs("div",{className:"bg-orange-950/20 border border-orange-500/30 p-4 rounded-xl flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-3 bg-black border border-orange-500/50 rounded-lg shadow-[0_0_15px_rgba(249,115,22,0.15)]",children:e.jsx(Ge,{className:"w-6 h-6 text-orange-500"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-orange-500 tracking-widest mb-1 flex items-center gap-2",children:[e.jsx(Ye,{className:"w-3 h-3"})," ",t.resourceConfig.customLabel||"Surovina k T캩쬭캩"]}),e.jsxs("p",{className:"text-lg font-mono font-bold text-white uppercase leading-none",children:[t.resourceConfig.resourceName," ",e.jsxs("span",{className:"text-orange-500 text-sm",children:["x",t.resourceConfig.resourceAmount]})]}),e.jsx("p",{className:"text-[8px] text-zinc-500 font-mono mt-1",children:"Lze pou쮂셦 pro crafting nebo prodej."})]})]}),t.stats&&t.stats.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.stats.map((V,K)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs(R.button,{onClick:()=>J(V.label),className:`bg-white/5 border p-3 rounded-xl flex flex-col items-center transition-all ${le===V.label?"border-signal-cyan bg-signal-cyan/5":"border-white/10"}`,children:[e.jsx("span",{className:"text-[9px] uppercase font-bold text-zinc-400",children:V.label}),e.jsx("span",{className:`text-lg font-black font-mono ${F(V.label)}`,children:V.value})]}),f(V.label,V.value)]},K))}),e.jsxs("div",{className:"flex justify-between items-center bg-zinc-900 p-3 rounded-lg border border-zinc-700",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-400 uppercase",children:"Tr쬹칤 Hodnota"}),e.jsxs("div",{className:"flex items-center gap-2 text-yellow-500",children:[e.jsx(ke,{className:"w-4 h-4"}),e.jsx("span",{className:"font-mono font-bold text-lg",children:t.price??50})]})]})]})};return e.jsx(R.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:1.05,y:-20},className:"fixed inset-0 z-[150] bg-black/95 flex items-center justify-center p-6 backdrop-blur-md",children:e.jsxs("div",{className:`w-full max-w-sm ${$.bg} border-2 ${$.border} relative overflow-hidden flex flex-col shadow-2xl rounded-3xl max-h-[90vh]`,children:[e.jsxs("div",{className:"relative p-6 pb-4 z-10",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-32 bg-gradient-to-b from-white/10 to-transparent pointer-events-none"}),e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:`p-3 rounded-xl bg-black/40 border border-white/10 backdrop-blur-sm ${$.text}`,children:$.icon}),e.jsx("button",{onClick:s,className:"p-2 text-white/30 hover:text-white transition-colors bg-black/20 rounded-full",children:e.jsx(_e,{className:"w-6 h-6"})})]}),e.jsx("span",{className:`text-[9px] font-mono font-bold uppercase tracking-[0.3em] block mb-1 flex items-center gap-2 ${t.dilemmaScope==="GLOBAL"?"text-purple-400 animate-pulse":"text-white/30"}`,children:j?t.dilemmaScope==="GLOBAL"?e.jsxs(e.Fragment,{children:[e.jsx(bt,{className:"w-3 h-3"})," GLOB츼LN칈 K콎I콯OVATKA"]}):"TAKTICK칄 ROZHODNUT칈":`${t.type}`}),e.jsx("h2",{className:`text-3xl font-black uppercase tracking-tighter leading-none font-sans ${$.text} drop-shadow-md`,children:t.title}),!j&&e.jsx("div",{className:`inline-block mt-2 px-2 py-0.5 text-[8px] font-bold uppercase tracking-widest border rounded ${$.border} ${$.text} bg-black/40`,children:t.rarity})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar px-6 pb-6 relative z-10",children:[e.jsxs("div",{className:"mb-6 relative",children:[e.jsx("div",{className:`absolute top-0 left-0 w-1 h-full ${$.accent} opacity-50`}),e.jsxs("p",{className:"pl-4 text-xs text-zinc-300 italic leading-relaxed font-serif opacity-90",children:['"',t.description,'"']})]}),!j&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:[t.type===ae.TRAP&&e.jsx(Rn,{event:t,onClose:s,onPlayerDamage:m,playerClass:v,onClaimLoot:E}),h&&e.jsx(An,{event:t,onClose:s,playerHp:g,playerArmor:b,onArmorChange:y,onPlayerDamage:m,inventory:d,onUseItem:N,onClaimLoot:E}),t.type===ae.MERCHANT&&oe(),t.type===ae.PLANET&&D(),(t.type===ae.ITEM||t.type==="P콎EDM캨T")&&fe(),t.type===ae.SPACE_STATION&&q()]}),j&&I==="CHOICE"&&e.jsxs("div",{className:"space-y-4 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ra,{className:"w-4 h-4 text-purple-400 animate-pulse"}),e.jsx("p",{className:"text-[10px] font-bold text-purple-400 uppercase tracking-[0.2em]",children:"Anal칳za Rozcest칤"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:(ue=t.dilemmaOptions)==null?void 0:ue.map((_,V)=>e.jsxs("button",{onClick:()=>Q(_),className:"relative group p-0 overflow-hidden rounded-xl border border-purple-500/30 bg-purple-900/10 hover:border-purple-400 hover:bg-purple-900/20 transition-all active:scale-[0.98]",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-50",children:e.jsx(Oa,{className:"w-12 h-12 text-purple-500/20 group-hover:text-purple-400/30 transition-colors"})}),e.jsxs("div",{className:"p-4 flex flex-col items-start relative z-10",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsxs("span",{className:"text-[9px] font-black text-zinc-500 uppercase tracking-widest mb-1 group-hover:text-purple-300",children:["TRASA ",String.fromCharCode(65+V)]}),_.successChance!==void 0&&_.successChance<100&&e.jsxs("span",{className:"text-[9px] font-bold text-zinc-500 flex items-center gap-1",children:[e.jsx(_a,{className:"w-3 h-3"})," ",_.successChance,"%"]})]}),e.jsx("span",{className:"text-sm font-bold text-white uppercase tracking-wider text-left w-full",children:_.label})]}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-purple-500/20 group-hover:bg-purple-400 transition-colors"})]},V))})]}),j&&I==="RESULT"&&e.jsxs("div",{className:"space-y-6 mt-4 animate-in slide-in-from-right-8 duration-300",children:[e.jsxs("div",{className:`p-5 rounded-2xl border relative overflow-hidden ${A==="success"?"bg-purple-900/20 border-purple-500/30":"bg-red-900/20 border-red-500/30"}`,children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-white/5 rounded-bl-full pointer-events-none"}),e.jsxs("div",{className:`flex items-center gap-2 mb-3 ${A==="success"?"text-purple-400":"text-red-400"}`,children:[A==="success"?e.jsx(Et,{className:"w-4 h-4"}):e.jsx(gt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:A==="success"?"Taktick칳 D콢sledek":"Selh치n칤 Operace"})]}),e.jsx("p",{className:"text-sm text-white font-medium leading-relaxed",children:A==="success"?k==null?void 0:k.consequenceText:(k==null?void 0:k.failMessage)||"Akce selhala."}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[A==="success"&&((be=k==null?void 0:k.rewards)==null?void 0:be.map((_,V)=>e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border bg-green-500/10 border-green-500/30 text-green-400",children:[_.type==="HP"?e.jsx(He,{className:"w-3 h-3"}):_.type==="GOLD"?e.jsx(ke,{className:"w-3 h-3"}):e.jsx(qe,{className:"w-3 h-3"}),e.jsxs("span",{children:["+",_.value," ",_.type]})]},V))),A==="success"&&!(k!=null&&k.rewards)&&(k==null?void 0:k.effectType)&&k.effectType!=="none"&&e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border ${(k.effectValue??0)>0?"bg-green-500/10 border-green-500/30 text-green-400":"bg-red-500/10 border-red-500/30 text-red-400"}`,children:[k.effectType==="hp"?e.jsx(He,{className:"w-3 h-3"}):e.jsx(ke,{className:"w-3 h-3"}),e.jsxs("span",{children:[(k.effectValue??0)>0?"+":"",k.effectValue," ",k.effectType.toUpperCase()]})]}),A==="fail"&&(k!=null&&k.failDamage)?e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border bg-red-500/10 border-red-500/30 text-red-400",children:[e.jsx(gt,{className:"w-3 h-3"}),e.jsxs("span",{children:["-",k.failDamage," HP"]})]}):null]})]}),(k==null?void 0:k.physicalInstruction)&&e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-signal-amber to-transparent opacity-30 blur rounded-lg"}),e.jsxs("div",{className:"relative bg-black border-l-4 border-signal-amber p-4 rounded-r-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-signal-amber mb-2",children:[e.jsx(Ma,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.3em]",children:"Rozkaz pro Desku"})]}),e.jsx("p",{className:"text-xs text-white font-mono font-bold leading-relaxed uppercase",children:k.physicalInstruction})]})]})]})]}),e.jsxs("div",{className:"p-4 bg-black/60 border-t border-white/5 flex flex-col gap-2 relative z-10 backdrop-blur-md",children:[e.jsxs("div",{className:"flex gap-3",children:[c&&I!=="RESULT"&&!j&&!((Me=t.resourceConfig)!=null&&Me.isResourceContainer)&&!t.isSellOnly&&!h&&!S&&t.type!==ae.PLANET&&e.jsx("button",{onClick:c,className:`flex-1 py-4 text-black font-black uppercase text-[11px] tracking-[0.2em] hover:brightness-110 active:scale-95 transition-all font-mono rounded-xl shadow-lg ${$.accent}`,children:t.type===ae.MERCHANT?"OTEV콎칈T OBCHOD":t.type===ae.SPACE_STATION?"Dokovat a Doplnit":"Pou쮂셦"}),I==="RESULT"&&j&&e.jsxs("button",{onClick:s,className:"w-full py-4 bg-purple-600 hover:bg-purple-500 text-white font-black uppercase text-[11px] tracking-[0.2em] active:scale-95 transition-all rounded-xl shadow-lg shadow-purple-500/20 flex items-center justify-center gap-2",children:["Pokra캜ovat v Misi ",e.jsx(at,{className:"w-4 h-4"})]}),O&&p&&!o?e.jsx("button",{onClick:p,className:`flex-1 py-4 border ${(Te=t.resourceConfig)!=null&&Te.isResourceContainer?"border-orange-500 text-orange-500 bg-orange-950/20 hover:bg-orange-900/40":"border-white/20 text-white hover:bg-white/5"} font-black uppercase text-[11px] tracking-[0.2em] active:scale-95 transition-all font-mono rounded-xl flex items-center justify-center gap-2`,children:(Ue=t.resourceConfig)!=null&&Ue.isResourceContainer?e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"w-4 h-4"})," Vyt캩쬴t"]}):"Ulo쬴t"}):o&&!h&&!S&&(((he=t.resourceConfig)==null?void 0:he.isResourceContainer)||t.type===ae.PLANET||t.isSellOnly)&&e.jsxs("div",{className:"flex-1 py-4 border border-white/10 bg-white/5 text-zinc-500 font-black uppercase text-[11px] tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 cursor-default",children:[e.jsx(Ye,{className:"w-4 h-4"})," VLASTN캨NO"]})]}),o&&n&&!j&&!h&&!S&&e.jsxs("button",{onClick:te,className:`w-full py-3 border ${ee?"bg-red-900/80 border-red-500 text-white":"border-white/5 bg-transparent text-zinc-500"} font-black uppercase text-[10px] tracking-[0.2em] active:scale-95 transition-all font-mono rounded-xl flex items-center justify-center gap-2`,children:[e.jsx(js,{className:"w-3 h-3"})," ",ee?"POTVRDIT ZAHOZEN칈":"Zahodit"]})]})]})})},_n=({onComplete:t})=>{const[s,p]=a.useState("approach"),[n,c]=a.useState(8500),[i,o]=a.useState(34),[m,g]=a.useState([]);return a.useEffect(()=>{const b=setInterval(()=>{const y=Math.random().toString(16).substr(2,8).toUpperCase();g(v=>[`SYS_DAT: 0x${y}`,...v.slice(0,6)])},150);return()=>clearInterval(b)},[]),a.useEffect(()=>{w("open");const b=setInterval(()=>{c(y=>Math.max(0,y-150))},30);return setTimeout(()=>{p("align"),w("scan");const y=setInterval(()=>{o(v=>Math.min(100,v+2))},50);setTimeout(()=>clearInterval(y),2e3)},2e3),setTimeout(()=>{p("dock"),clearInterval(b),c(0),o(100),w("error"),W([80,50,80,50])},4e3),setTimeout(()=>{p("flash"),w("success")},4800),setTimeout(()=>{t()},5500),()=>clearInterval(b)},[]),e.jsxs("div",{className:"fixed inset-0 z-[2000] bg-black overflow-hidden flex flex-col items-center justify-center font-mono cursor-none select-none",children:[e.jsxs("div",{className:"absolute inset-0 perspective-1000",children:[e.jsx(R.div,{className:"absolute bottom-0 left-[-50%] right-[-50%] h-[50vh] bg-[linear-gradient(transparent_0%,rgba(0,242,255,0.2)_1px,transparent_1px),linear-gradient(90deg,transparent_0%,rgba(0,242,255,0.2)_1px,transparent_1px)]",style:{backgroundSize:"100px 100px",transform:"rotateX(60deg)",transformOrigin:"bottom"},animate:{backgroundPositionY:["0px","1000px"]},transition:{duration:s==="approach"?1:5,repeat:1/0,ease:"linear"}}),s==="approach"&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:[...Array(8)].map((b,y)=>e.jsx(R.div,{className:"absolute w-0.5 h-1/2 bg-cyan-500/50",style:{left:`${50+(Math.random()*80-40)}%`,top:"50%",transformOrigin:"top"},animate:{scaleY:[0,2],opacity:[0,1,0],rotate:Math.random()*60-30},transition:{duration:.4,repeat:1/0,delay:Math.random()*.5}},y))})]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center w-full h-full",children:[e.jsxs(R.div,{initial:{scale:.1,opacity:0},animate:{scale:s==="approach"?.4:s==="align"?.9:1.2,opacity:1,rotate:s==="dock"?0:15},transition:{duration:4.5,ease:"circIn"},className:"relative",children:[e.jsx(jt,{className:"w-64 h-64 text-zinc-300 drop-shadow-[0_0_50px_rgba(0,242,255,0.2)]",strokeWidth:.5}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:[1,2,3].map(b=>e.jsx(R.div,{className:"absolute border border-cyan-500/30 rounded-full",style:{width:"100%",height:"100%"},animate:{scale:[.5,2],opacity:[0,1,0]},transition:{duration:2,repeat:1/0,delay:b*.6,ease:"linear"}},b))})]}),e.jsxs(R.div,{className:"absolute inset-0 pointer-events-none",animate:s==="dock"?{x:[-5,5,-5,5,0],y:[-5,5,-5,5,0]}:{},transition:{duration:.4},children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:`relative transition-all duration-500 ${s==="dock"?"scale-90":"scale-100"}`,children:[e.jsx("div",{className:"w-[280px] h-[280px] border border-cyan-500/30 rounded-full flex items-center justify-center border-dashed animate-spin-slow"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(gs,{className:`w-8 h-8 ${i===100?"text-green-500":"text-red-500"}`})}),e.jsxs("div",{className:"absolute top-[-40px] left-1/2 -translate-x-1/2 text-center w-full",children:[e.jsx("div",{className:"text-[10px] font-black text-cyan-500 uppercase tracking-widest bg-black/50 px-2",children:i<100?"KALIBRACE VEKTORU":"ZAM캨콎ENO"}),e.jsxs("div",{className:"text-xl font-bold text-white font-mono",children:[i,"%"]})]})]})}),e.jsxs("div",{className:"absolute top-12 w-full px-6 flex justify-between items-start",children:[e.jsxs("div",{className:"bg-black/60 border-l-4 border-cyan-500 p-2 pl-4 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-cyan-400 mb-1",children:[e.jsx(ws,{className:"w-4 h-4 animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"NEXUS_LINK"})]}),e.jsx("div",{className:"text-xs text-white font-bold uppercase",children:"Sign치l: SILN칗"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-black text-white font-mono tracking-tighter tabular-nums",children:[Math.floor(n),e.jsx("span",{className:"text-sm text-zinc-500 ml-1",children:"m"})]}),e.jsx("div",{className:"text-[10px] font-bold text-red-500 uppercase tracking-widest animate-pulse",children:s==="approach"?"P콎IBLI콯OV츼N칈 >>":s==="align"?"BRZD캨N칈...":"KONTAKT"})]})]}),e.jsxs("div",{className:"absolute left-6 bottom-24 w-40 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 text-zinc-500 mb-2 border-b border-zinc-800 pb-1",children:[e.jsx(Vt,{className:"w-3 h-3"}),e.jsx("span",{className:"text-[8px] font-black uppercase",children:"Telemetrie"})]}),e.jsx("div",{className:"space-y-1 font-mono text-[9px] text-cyan-500/70 h-24 flex flex-col-reverse opacity-80",children:m.map((b,y)=>e.jsx(R.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},children:b},y))})]}),e.jsxs("div",{className:"absolute right-6 bottom-24 w-32 text-right space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[8px] font-bold text-zinc-500 uppercase block mb-1",children:"Tlak Kabiny"}),e.jsx("div",{className:"w-full bg-zinc-800 h-1.5 rounded-full overflow-hidden",children:e.jsx(R.div,{className:"h-full bg-green-500",initial:{width:"90%"},animate:{width:["90%","92%","89%"]},transition:{repeat:1/0,duration:2}})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[8px] font-bold text-zinc-500 uppercase block mb-1",children:"Integrita Pl치코t캩"}),e.jsx("div",{className:"w-full bg-zinc-800 h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-cyan-500 w-full"})})]}),e.jsx("div",{className:"pt-2",children:s==="dock"||s==="flash"?e.jsxs("div",{className:"flex items-center justify-end gap-2 text-green-500",children:[e.jsx(Ct,{className:"w-4 h-4"})," ",e.jsx("span",{className:"font-black text-xs uppercase",children:"ZAM캛ENO"})]}):e.jsxs("div",{className:"flex items-center justify-end gap-2 text-yellow-500",children:[e.jsx(Da,{className:"w-4 h-4 animate-bounce"})," ",e.jsx("span",{className:"font-black text-xs uppercase",children:"DOKOV츼N칈"})]})})]}),e.jsxs("div",{className:"absolute bottom-10 left-10 right-10 flex flex-col items-center",children:[e.jsx("div",{className:"w-full max-w-md bg-zinc-900/50 h-2 rounded-full overflow-hidden border border-zinc-800",children:e.jsx(R.div,{className:`h-full ${s==="dock"?"bg-green-500":"bg-red-500"}`,animate:{width:s==="approach"?"80%":s==="align"?"20%":"0%"},transition:{duration:.5}})}),e.jsxs("div",{className:"flex justify-between w-full max-w-md mt-1 text-[8px] font-bold text-zinc-600 uppercase tracking-widest",children:[e.jsx("span",{children:"Rychlost"}),e.jsx("span",{children:s==="approach"?"850 m/s":s==="align"?"120 m/s":"0 m/s"})]})]})]})]}),s==="flash"&&e.jsx(R.div,{className:"absolute inset-0 bg-white z-[2100]",initial:{opacity:0},animate:{opacity:1},transition:{duration:.2,ease:"easeIn"}})]})},Mn=({inventory:t,masterCatalog:s,onClose:p,onCraft:n})=>{var Z,ee,ce,le;const c=t.filter(L=>{var h;return(h=L.resourceConfig)==null?void 0:h.isResourceContainer}),i=s.filter(L=>L.craftingRecipe&&L.craftingRecipe.enabled===!0),[o,m]=a.useState(null),[g,b]=a.useState(!1),[y,v]=a.useState(0),[d,N]=a.useState(0),E=a.useRef(null);a.useEffect(()=>()=>{E.current&&clearInterval(E.current)},[]);const I=L=>{g||(w("click"),m(L),v(0),N(0))},Y=L=>c.reduce((h,S)=>{var O;return((O=S.resourceConfig)==null?void 0:O.resourceName)===L?h+(S.resourceConfig.resourceAmount||0):h},0),k=L=>{var h;return(h=L.craftingRecipe)!=null&&h.requiredResources?L.craftingRecipe.requiredResources.every(S=>Y(S.resourceName)>=S.amount):!0},M=()=>{var J;if(!o||!n)return;if(!k(o)){w("error");return}b(!0),w("scan"),W([50,100,50]);const L=((J=o.craftingRecipe)==null?void 0:J.craftingTimeSeconds)||10,h=L*1e3,S=50;let O=0;N(L),v(0),E.current=setInterval(()=>{O+=S;const F=Math.min(100,O/h*100),B=Math.max(0,L-O/1e3);v(F),N(B),O>=h&&(clearInterval(E.current),A())},S)},A=()=>{!o||!n||(n(o),w("success"),W([50,50,50]),b(!1),v(0),N(0),m(null))};return e.jsxs("div",{className:"fixed inset-0 z-[250] bg-zinc-950 text-white flex flex-col font-sans overflow-hidden",children:[e.jsxs("header",{className:"bg-zinc-900 border-b border-orange-500/30 p-4 flex justify-between items-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"repeating-linear-gradient(45deg, #000 0, #000 10px, #f97316 10px, #f97316 20px)"}}),e.jsxs("div",{className:"flex items-center gap-3 relative z-10 text-orange-500",children:[e.jsx("div",{className:"p-2 bg-orange-500/10 border border-orange-500/30 rounded",children:e.jsx(Ge,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black uppercase tracking-widest leading-none text-white",children:"V칳robn칤 Modul"}),e.jsx("p",{className:"text-[9px] font-mono font-bold uppercase tracking-[0.3em]",children:"Sekce: FAB-01"})]})]}),e.jsx("button",{onClick:p,disabled:g,className:`p-2 relative z-10 bg-zinc-800 rounded-full hover:bg-zinc-700 transition-colors ${g?"opacity-50 cursor-not-allowed":""}`,children:e.jsx(_e,{className:"w-6 h-6 text-zinc-400"})})]}),e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden relative",children:[e.jsxs("div",{className:"flex-1 border-b md:border-b-0 md:border-r border-zinc-800 bg-zinc-950/50 flex flex-col min-h-[40%] md:min-h-full",children:[e.jsxs("div",{className:"p-3 bg-zinc-900/50 border-b border-zinc-800 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-500 flex items-center gap-2",children:[e.jsx(Ye,{className:"w-4 h-4"})," Sklad Surovin"]}),e.jsxs("span",{className:"text-[9px] font-mono text-zinc-600",children:[c.length," jednotek"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 grid grid-cols-2 md:grid-cols-2 gap-3 content-start",children:c.length===0?e.jsxs("div",{className:"col-span-2 text-center py-10 opacity-30 flex flex-col items-center",children:[e.jsx(Ye,{className:"w-12 h-12 mb-2"}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"Sklad pr치zdn칳"})]}):c.map((L,h)=>{var S;return e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 p-3 rounded-lg flex flex-col items-center justify-center gap-1 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-orange-600/50"}),e.jsx(Ge,{className:"w-5 h-5 text-orange-500/50 mb-1"}),e.jsx("span",{className:"text-xs font-bold text-white uppercase text-center leading-tight line-clamp-2",children:L.title}),e.jsxs("span",{className:"text-[10px] font-mono text-orange-400 bg-orange-950/30 px-2 py-0.5 rounded border border-orange-500/20",children:["x",((S=L.resourceConfig)==null?void 0:S.resourceAmount)||1]})]},h)})})]}),e.jsxs("div",{className:"flex-[1.5] bg-black flex flex-col",children:[e.jsxs("div",{className:"p-3 bg-zinc-900/50 border-b border-zinc-800 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-500 flex items-center gap-2",children:[e.jsx(Ht,{className:"w-4 h-4"})," Datab치ze Sch칠mat"]}),e.jsx("span",{className:"text-[9px] font-mono text-zinc-600",children:"Admin_Vault Access"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:i.length===0?e.jsx("div",{className:"text-center py-10 text-zinc-600 font-mono text-xs uppercase",children:"콯치dn치 sch칠mata k dispozici."}):i.map(L=>e.jsxs("button",{onClick:()=>I(L),className:"w-full text-left bg-zinc-900/40 border border-zinc-800 hover:border-orange-500/50 hover:bg-zinc-900 p-3 rounded-xl flex items-center gap-4 transition-all active:scale-[0.98] group",children:[e.jsx("div",{className:"w-10 h-10 bg-black border border-zinc-700 rounded-lg flex items-center justify-center group-hover:border-orange-500/50 transition-colors",children:e.jsx($a,{className:"w-5 h-5 text-zinc-500 group-hover:text-orange-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h4",{className:"text-xs font-bold text-white uppercase tracking-wider",children:L.title}),e.jsx("span",{className:"text-[9px] font-mono text-zinc-500",children:L.rarity})]}),e.jsx("p",{className:"text-[9px] text-zinc-500 line-clamp-1 italic",children:L.description})]})]},L.id))})]})]}),e.jsx(xe,{children:o&&e.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-black/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(R.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-zinc-900 border border-orange-500/50 w-full max-w-sm rounded-2xl p-6 relative shadow-[0_0_50px_rgba(249,115,22,0.15)] flex flex-col max-h-[90vh]",children:[!g&&e.jsx("button",{onClick:()=>m(null),className:"absolute top-4 right-4 text-zinc-500 hover:text-white",children:e.jsx(_e,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[e.jsx("div",{className:"w-20 h-20 bg-black border-2 border-orange-500/30 rounded-xl flex items-center justify-center mb-4 relative overflow-hidden",children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-orange-500/20 z-0",style:{height:`${y}%`,bottom:0,top:"auto",transition:"height 0.1s linear"}}),e.jsxs("span",{className:"relative z-10 text-xl font-black text-white",children:[d.toFixed(1),"s"]})]}):e.jsx(Va,{className:"w-8 h-8 text-orange-500"})}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter mb-1",children:o.title}),!g&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-orange-400 bg-orange-950/20 px-3 py-1 rounded-full border border-orange-500/20",children:[e.jsx(Ha,{className:"w-3 h-3"}),e.jsxs("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:["캛as v칳roby: ",((Z=o.craftingRecipe)==null?void 0:Z.craftingTimeSeconds)||10,"s"]})]})]}),e.jsxs("div",{className:"p-4 bg-black/40 rounded-xl border border-zinc-800 mb-6 flex-1 overflow-y-auto",children:[e.jsx("p",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-3 tracking-widest border-b border-zinc-800 pb-2",children:"Po쬬dovan칠 Suroviny"}),e.jsxs("div",{className:"space-y-2",children:[(ce=(ee=o.craftingRecipe)==null?void 0:ee.requiredResources)==null?void 0:ce.map((L,h)=>{const S=Y(L.resourceName),O=S>=L.amount;return e.jsxs("div",{className:"flex justify-between items-center bg-zinc-900/50 p-2 rounded",children:[e.jsx("span",{className:"text-xs text-zinc-300 font-mono",children:L.resourceName}),e.jsxs("div",{className:`flex items-center gap-2 text-xs font-mono font-bold ${O?"text-green-500":"text-red-500"}`,children:[e.jsxs("span",{children:[S," / ",L.amount]}),O?e.jsx(st,{className:"w-3 h-3"}):e.jsx(ze,{className:"w-3 h-3"})]})]},h)}),(!((le=o.craftingRecipe)!=null&&le.requiredResources)||o.craftingRecipe.requiredResources.length===0)&&e.jsx("p",{className:"text-center text-zinc-600 text-xs italic",children:"콯치dn칠 suroviny nejsou pot콏eba."})]})]}),g?e.jsxs("div",{className:"w-full bg-zinc-800 rounded-full h-4 overflow-hidden border border-zinc-700 relative",children:[e.jsx(R.div,{className:"h-full bg-orange-500",style:{width:`${y}%`},transition:{duration:.1,ease:"linear"}}),e.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[8px] font-black uppercase text-white drop-shadow-md",children:"Fabrikace..."})]}):e.jsx("button",{onClick:M,disabled:!k(o),className:`w-full py-4 font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 transition-all ${k(o)?"bg-orange-600 hover:bg-orange-500 text-white shadow-lg shadow-orange-500/20":"bg-zinc-800 text-zinc-600 cursor-not-allowed border border-zinc-700"}`,children:k(o)?"VYROBIT P콎EDM캨T":"NEDOSTATEK SUROVIN"})]})})})]})},Pn=({onClose:t,masterCatalog:s,inventory:p,playerGold:n,playerClass:c,onBuy:i,onRecycle:o})=>{const[m,g]=a.useState("BUY"),[b,y]=a.useState(null),[v,d]=a.useState(!1),[N,E]=a.useState("ALL");a.useEffect(()=>{w("open")},[]);const I=a.useMemo(()=>{const h={};return s.forEach(S=>{var O;if((O=S.marketConfig)!=null&&O.saleChance){const J=Math.random()*100;h[S.id]=J<=S.marketConfig.saleChance}}),h},[s]),Y=a.useMemo(()=>{let h=s.filter(S=>{var O;return(O=S.marketConfig)==null?void 0:O.enabled});return N!=="ALL"&&(h=h.filter(S=>S.type===N)),h},[s,N]),k=a.useMemo(()=>p.filter(h=>{var S;return((S=h.marketConfig)==null?void 0:S.recyclingOutput)&&h.marketConfig.recyclingOutput.length>0}),[p]),M=h=>{var Q,te;const S=h.price??100;let O=S,J=null;const F=I[h.id]||!1;if(F&&((Q=h.marketConfig)!=null&&Q.marketPrice&&h.marketConfig.marketPrice>0?O=h.marketConfig.marketPrice:O=Math.floor(S*.7)),c&&((te=h.marketConfig)!=null&&te.classModifiers)){const T=h.marketConfig.classModifiers.find($=>$.playerClass===c);T&&(O=Math.floor(O*T.priceMultiplier),T.priceMultiplier<1?J=`BONUS: ${c}`:T.priceMultiplier>1&&(J=`P콎IR츼콯KA: ${c}`))}return{finalPrice:Math.max(1,O),basePrice:S,discountLabel:J,isOnSale:F}},A=h=>{var S;return(S=h.marketConfig)!=null&&S.recyclingOutput?h.marketConfig.recyclingOutput.map(O=>{const J=s.find(F=>{var B;return((B=F.resourceConfig)==null?void 0:B.isResourceContainer)&&F.resourceConfig.resourceName===O.resourceName||F.title===O.resourceName});return J?{resource:J,amount:O.amount}:null}).filter(O=>O!==null):[]},Z=()=>{if(!(!b||v))if(d(!0),m==="BUY"){const{finalPrice:h}=M(b);if(n<h){w("error"),d(!1);return}w("success"),W([50,50]),setTimeout(()=>{i(b,h),d(!1),y(null)},1e3)}else{const h=A(b);w("damage"),W([100,50,200]),setTimeout(()=>{o(b,h),d(!1),y(null),w("success")},1500)}},ee=h=>{const S=h.toUpperCase();return S.includes("HP")||S.includes("ZDRAV칈")?e.jsx(He,{className:"w-3 h-3 text-red-500"}):S.includes("MANA")||S.includes("ENERGIE")?e.jsx(qe,{className:"w-3 h-3 text-blue-400"}):S.includes("DMG")||S.includes("칔TOK")?e.jsx(yt,{className:"w-3 h-3 text-orange-500"}):S.includes("DEF")||S.includes("OBRANA")?e.jsx(Ve,{className:"w-3 h-3 text-slate-300"}):e.jsx(Re,{className:"w-3 h-3 text-zinc-400"})},ce="text-yellow-500",le="border-yellow-500/30";return e.jsxs("div",{className:"fixed inset-0 z-[250] bg-zinc-950 text-white flex flex-col font-sans overflow-hidden",children:[e.jsxs("header",{className:`bg-zinc-900 border-b ${le} p-4 flex justify-between items-center relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"repeating-linear-gradient(45deg, #000 0, #000 10px, #eab308 10px, #eab308 20px)"}}),e.jsxs("div",{className:`flex items-center gap-3 relative z-10 ${ce}`,children:[e.jsx("div",{className:`p-2 bg-yellow-950/20 border ${le} rounded`,children:e.jsx(At,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black uppercase tracking-widest leading-none text-white",children:"Obchodn칤 Termin치l"}),e.jsx("p",{className:"text-[9px] font-mono font-bold uppercase tracking-[0.3em] text-zinc-400",children:"SEKTOR MARKET_V2"})]})]}),e.jsx("button",{onClick:t,className:"p-2 relative z-10 bg-zinc-800 rounded-full hover:bg-zinc-700 transition-colors",children:e.jsx(_e,{className:"w-6 h-6 text-zinc-400"})})]}),e.jsxs("div",{className:"flex flex-col border-b border-zinc-800",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-zinc-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-black border border-yellow-500/30 rounded-lg shadow-[0_0_15px_rgba(234,179,8,0.1)]",children:[e.jsx(ke,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"text-xl font-mono font-bold text-white",children:n})]}),e.jsxs("div",{className:"flex bg-black rounded-lg p-1 border border-zinc-800",children:[e.jsx("button",{onClick:()=>{g("BUY"),w("click")},className:`px-6 py-2 rounded-md text-xs font-bold uppercase tracking-wider transition-all ${m==="BUY"?"bg-yellow-600 text-black shadow-lg":"text-zinc-500 hover:text-white"}`,children:"N치kup"}),e.jsx("button",{onClick:()=>{g("RECYCLE"),w("click")},className:`px-6 py-2 rounded-md text-xs font-bold uppercase tracking-wider transition-all ${m==="RECYCLE"?"bg-orange-600 text-white shadow-lg":"text-zinc-500 hover:text-white"}`,children:"Drti캜ka"})]})]}),m==="BUY"&&e.jsxs("div",{className:"flex gap-2 p-2 px-4 bg-black overflow-x-auto no-scrollbar border-b border-zinc-800",children:[e.jsx(Ga,{className:"w-4 h-4 text-zinc-600 my-auto mr-2"}),["ALL","P콎EDM캨T","SUROVINA"].map(h=>e.jsx("button",{onClick:()=>E(h),className:`px-3 py-1 rounded text-[10px] font-bold uppercase border transition-colors whitespace-nowrap ${N===h?"border-yellow-500 text-yellow-500 bg-yellow-950/20":"border-zinc-800 text-zinc-500"}`,children:h==="ALL"?"V코e":h},h))]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-zinc-950 relative",children:m==="BUY"?Y.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full opacity-30",children:[e.jsx(At,{className:"w-16 h-16 mb-4 text-zinc-500"}),e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-zinc-500",children:"Sklad vyprod치n"})]}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Y.map(h=>{const{finalPrice:S,basePrice:O,discountLabel:J,isOnSale:F}=M(h),B=n>=S,Q=S<O;return e.jsxs("button",{onClick:()=>{y(h),w("click")},className:`relative flex flex-col text-left p-3 rounded-xl border transition-all active:scale-95 group ${B?"bg-zinc-900 border-zinc-800 hover:border-yellow-500/50":"bg-zinc-900/50 border-red-900/30 opacity-70"}`,children:[F&&e.jsx("div",{className:"absolute top-2 right-2 bg-pink-600 text-white text-[8px] font-black px-1.5 py-0.5 rounded uppercase tracking-wider animate-pulse shadow-[0_0_10px_#db2777]",children:"AKCE"}),e.jsx("div",{className:"mb-2 p-3 bg-black rounded-lg border border-zinc-800 self-start group-hover:border-yellow-500/30 transition-colors",children:e.jsx($e,{className:`w-6 h-6 ${B?"text-zinc-200":"text-red-900"}`})}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("h4",{className:"text-xs font-bold text-white uppercase line-clamp-1 mb-1",children:h.title}),h.stats&&h.stats.length>0&&e.jsx("div",{className:"grid grid-cols-1 gap-1 mb-2",children:h.stats.slice(0,3).map((te,T)=>e.jsxs("div",{className:"flex items-center justify-between text-[9px] bg-white/5 px-1.5 py-0.5 rounded border border-white/5",children:[e.jsxs("span",{className:"text-zinc-400 font-bold uppercase flex items-center gap-1",children:[ee(te.label)," ",te.label.substring(0,3)]}),e.jsx("span",{className:"text-white font-mono font-bold",children:te.value})]},T))})]}),e.jsxs("div",{className:"mt-auto pt-2 border-t border-zinc-800 w-full",children:[J&&e.jsx("span",{className:"text-[8px] text-green-500 font-bold uppercase block mb-1",children:J}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:`flex items-center gap-1 font-mono font-bold ${B?"text-yellow-500":"text-red-500"}`,children:[e.jsx("span",{children:S}),e.jsx(ke,{className:"w-3 h-3"})]}),Q&&e.jsx("span",{className:"text-[9px] text-zinc-600 line-through decoration-red-500 font-mono",children:O})]})]})]},h.id)})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-orange-900/10 border border-orange-500/20 rounded-lg flex items-center gap-3 mb-4",children:[e.jsx(Ua,{className:"w-5 h-5 text-orange-500"}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-mono leading-tight",children:"Vlo쬾e nepot콏ebn칠 p콏edm캩ty do drti캜ky a z칤skejte suroviny pro v칳robu."})]}),k.length===0?e.jsxs("div",{className:"text-center py-10 opacity-30",children:[e.jsx(Ba,{className:"w-12 h-12 mx-auto mb-2"}),e.jsx("p",{className:"text-xs font-bold uppercase",children:"콯치dn칳 recyklovateln칳 odpad"})]}):k.map(h=>e.jsxs("button",{onClick:()=>{y(h),w("click")},className:"w-full flex items-center gap-4 p-3 bg-zinc-900 border border-zinc-800 hover:border-orange-500/50 rounded-xl transition-all active:scale-95 group text-left",children:[e.jsx("div",{className:"p-2 bg-black border border-zinc-700 rounded text-zinc-500 group-hover:text-orange-500 transition-colors",children:e.jsx($e,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-bold text-white uppercase",children:h.title}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:A(h).map((S,O)=>e.jsxs("span",{className:"text-[9px] bg-orange-950/30 text-orange-400 px-1.5 py-0.5 rounded border border-orange-500/20",children:["+",S.amount," ",S.resource.title]},O))})]}),e.jsx(at,{className:"w-4 h-4 text-zinc-600 group-hover:text-orange-500"})]},h.id))]})}),e.jsx(xe,{children:b&&e.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-black/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(R.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:`bg-zinc-900 border w-full max-w-sm rounded-2xl p-6 relative shadow-2xl flex flex-col ${m==="BUY"?"border-yellow-500/50":"border-orange-500/50"}`,children:[e.jsx("button",{onClick:()=>y(null),className:"absolute top-4 right-4 text-zinc-500 hover:text-white",children:e.jsx(_e,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[e.jsx("div",{className:`w-20 h-20 bg-black border-2 rounded-xl flex items-center justify-center mb-4 ${m==="BUY"?"border-yellow-500/30 text-yellow-500":"border-orange-500/30 text-orange-500"}`,children:m==="BUY"?e.jsx($e,{className:"w-10 h-10"}):e.jsx(js,{className:"w-10 h-10"})}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter mb-1",children:b.title}),e.jsx("p",{className:"text-[10px] font-mono text-zinc-500 uppercase",children:b.type})]}),m==="BUY"?e.jsxs("div",{className:"space-y-4",children:[b.stats&&b.stats.length>0&&e.jsxs("div",{className:"bg-white/5 p-3 rounded-lg border border-white/5 mb-2",children:[e.jsxs("p",{className:"text-[10px] font-bold text-zinc-400 uppercase mb-2 flex items-center gap-1",children:[e.jsx(Re,{className:"w-3 h-3"})," Statistiky Assetu"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:b.stats.map((h,S)=>e.jsxs("div",{className:"flex justify-between items-center bg-black px-2 py-1 rounded",children:[e.jsxs("span",{className:"text-[9px] text-zinc-500 font-bold uppercase flex items-center gap-1",children:[ee(h.label)," ",h.label]}),e.jsx("span",{className:"text-xs font-mono font-bold text-white",children:h.value})]},S))})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-4 rounded-xl border border-zinc-800",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-bold text-zinc-400 uppercase",children:"Cena"}),M(b).finalPrice<M(b).basePrice&&e.jsxs("span",{className:"text-[10px] text-zinc-600 line-through decoration-red-500 font-mono",children:[M(b).basePrice," GOLD"]})]}),e.jsxs("div",{className:`flex items-center gap-2 text-xl font-mono font-black ${n>=M(b).finalPrice?"text-yellow-500":"text-red-500"}`,children:[M(b).finalPrice," ",e.jsx(ke,{className:"w-5 h-5"})]})]}),n<M(b).finalPrice&&e.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-[10px] font-bold uppercase justify-center bg-red-950/20 p-2 rounded",children:[e.jsx(ze,{className:"w-3 h-3"})," Nedostatek prost콏edk콢"]})]}):e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("p",{className:"text-[10px] font-bold text-orange-500 uppercase tracking-widest mb-2 border-b border-orange-500/20 pb-1",children:"Z칤sk치te suroviny:"}),A(b).map((h,S)=>e.jsxs("div",{className:"flex justify-between items-center bg-orange-900/10 p-2 rounded border border-orange-500/20",children:[e.jsx("span",{className:"text-xs text-zinc-300 font-mono",children:h.resource.title}),e.jsxs("span",{className:"text-sm font-black text-white",children:["x",h.amount]})]},S))]}),e.jsx("button",{onClick:Z,disabled:v||m==="BUY"&&n<M(b).finalPrice,className:`w-full py-4 mt-6 font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 transition-all ${v?"bg-zinc-800 text-zinc-500 cursor-not-allowed":m==="BUY"?n>=M(b).finalPrice?"bg-yellow-600 hover:bg-yellow-500 text-black shadow-lg shadow-yellow-500/20":"bg-zinc-800 text-zinc-600 cursor-not-allowed":"bg-orange-600 hover:bg-orange-500 text-white shadow-lg shadow-orange-500/20"}`,children:v?e.jsx("span",{className:"animate-pulse",children:"Zpracov치n칤..."}):m==="BUY"?e.jsxs(e.Fragment,{children:[n>=M(b).finalPrice?"POTVRDIT N츼KUP":"NEDOSTATEK KREDIT콡",e.jsx(ks,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["ROZEML칈T P콎EDM캨T ",e.jsx(Ge,{className:"w-4 h-4"})]})})]})})})]})},Ln="admin_test_vault@nexus.local",Dn=({station:t,onLeave:s,onClaimRewards:p,onCraft:n,inventory:c=[],masterCatalog:i=[],playerGold:o=0,playerClass:m=null,onInventoryUpdate:g,onGoldChange:b,isAdmin:y=!1,isTestMode:v=!1})=>{var Q,te,T,$;const[d,N]=a.useState(!0),[E,I]=a.useState(!1),[Y,k]=a.useState(null),[M,A]=a.useState(!1),[Z,ee]=a.useState(!1),[ce,le]=a.useState(!1);a.useEffect(()=>{w("open");const j=setTimeout(()=>N(!1),2e3);return()=>clearTimeout(j)},[]);const L=()=>{!M&&p&&(p(t),A(!0))},h=()=>{w("click"),I(!0)},S=()=>{I(!1),s()},O=j=>{w("error"),k(j),setTimeout(()=>k(null),2e3)},J=()=>y&&v?Ln:localStorage.getItem("nexus_current_user"),F=async(j,f)=>{try{const D=J();D&&(b&&b(-Math.abs(f)),await Ot(D,{...j,id:`BOUGHT-${Date.now()}`}),g&&g())}catch{}},B=async(j,f)=>{try{const D=J();if(D){await _t(D,j.id);for(const q of f){const oe={...q.resource,id:`RES-${Date.now()}-${Math.random()}`,resourceConfig:{...q.resource.resourceConfig,resourceAmount:q.amount}};await Ot(D,oe)}g&&g()}}catch{}};return d?e.jsx("div",{className:"fixed inset-0 z-[200] bg-black flex items-center justify-center font-mono",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(jt,{className:"w-16 h-16 text-cyan-500 animate-pulse mx-auto"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-cyan-500 uppercase tracking-[0.2em] font-bold",children:"Iniciace Servisn칤ch Protokol콢..."}),e.jsx("p",{className:"text-xl text-white font-black uppercase tracking-widest",children:t.title})]}),e.jsx("div",{className:"w-48 h-1 bg-zinc-800 rounded-full mx-auto overflow-hidden",children:e.jsx(R.div,{className:"h-full bg-cyan-500",initial:{width:0},animate:{width:"100%"},transition:{duration:1.5,ease:"easeInOut"}})})]})}):e.jsxs(R.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[200] bg-[#050608] text-white overflow-hidden flex flex-col font-sans",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-10",style:{backgroundImage:"linear-gradient(rgba(34, 211, 238, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(34, 211, 238, 0.1) 1px, transparent 1px)",backgroundSize:"40px 40px"}}),e.jsxs("header",{className:"relative z-10 bg-black/60 backdrop-blur-md border-b border-white/10 p-6 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-cyan-950/30 border border-cyan-500/50 rounded-lg flex items-center justify-center",children:e.jsx(jt,{className:"w-6 h-6 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black uppercase tracking-tighter leading-none",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsxs("span",{className:"text-[10px] font-mono text-cyan-500/80 uppercase tracking-widest",children:["P콏ipojen칤 Stabiln칤  ID: ",t.id]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[y&&v&&e.jsx("div",{className:"px-3 py-1 bg-orange-900/30 border border-orange-500/30 rounded text-[9px] font-bold uppercase text-orange-500 animate-pulse hidden md:block",children:"TESTOVAC칈 RE콯IM AKTIVN칈"}),e.jsxs("div",{className:"text-right hidden md:block",children:[e.jsx("p",{className:"text-[10px] text-zinc-500 uppercase font-bold tracking-widest",children:"Lok치ln칤 캛as"}),e.jsx("p",{className:"text-sm font-mono font-bold text-zinc-300",children:new Date().toLocaleTimeString()})]})]})]}),e.jsxs("main",{className:"flex-1 relative z-10 p-6 overflow-y-auto no-scrollbar pb-32",children:[e.jsxs("div",{className:"mb-8 p-6 bg-gradient-to-r from-cyan-900/20 to-transparent border-l-4 border-cyan-500 rounded-r-xl",children:[e.jsx("h2",{className:"text-lg font-bold text-cyan-100 mb-1",children:"Diagnostika lodi."}),e.jsxs("p",{className:"text-sm text-cyan-400/60 font-mono",children:['"',((Q=t.stationConfig)==null?void 0:Q.welcomeMessage)||"Dostupn칠 servisn칤 칰kony nalezeny.",'"']})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("h3",{className:"text-xs font-black text-white/40 uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"})," Dostupn칳 Servis"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[((te=t.stationConfig)==null?void 0:te.refillO2)&&e.jsxs(R.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:`p-5 rounded-xl flex items-center gap-4 border transition-colors ${M?"bg-green-900/20 border-green-500/50":"bg-black/40 border-white/10"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${M?"bg-green-900/20 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:e.jsx(vt,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest",children:"Podpora 콯ivota"}),e.jsx("p",{className:"text-lg font-black text-white uppercase",children:"Dopln캩n칤 O2"})]}),M&&e.jsx(st,{className:"w-6 h-6 text-green-500 ml-auto"})]}),((T=t.stationConfig)==null?void 0:T.fuelReward)&&e.jsxs(R.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:`p-5 rounded-xl flex items-center gap-4 border transition-colors ${M?"bg-green-900/20 border-green-500/50":"bg-black/40 border-white/10"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${M?"bg-green-900/20 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:e.jsx(Gt,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest",children:"Tankov치n칤"}),e.jsxs("p",{className:"text-lg font-black text-white uppercase",children:["+",t.stationConfig.fuelReward," Paliva"]})]}),M&&e.jsx(st,{className:"w-6 h-6 text-green-500 ml-auto"})]}),(($=t.stationConfig)==null?void 0:$.repairAmount)&&e.jsxs(R.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:`p-5 rounded-xl flex items-center gap-4 border transition-colors ${M?"bg-green-900/20 border-green-500/50":"bg-black/40 border-white/10"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${M?"bg-green-900/20 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:e.jsx(Ve,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest",children:"Opravy"}),e.jsxs("p",{className:"text-lg font-black text-white uppercase",children:["+",t.stationConfig.repairAmount," HP/Hull"]})]}),M&&e.jsx(st,{className:"w-6 h-6 text-green-500 ml-auto"})]})]}),e.jsx("button",{onClick:L,disabled:M,className:`w-full py-5 font-black uppercase text-sm tracking-[0.3em] rounded-xl flex items-center justify-center gap-3 transition-all shadow-lg ${M?"bg-green-600 text-white cursor-default":"bg-white text-black hover:bg-cyan-400 active:scale-95"}`,children:M?e.jsxs(e.Fragment,{children:[e.jsx(Nt,{className:"w-5 h-5"})," SERVISN칈 칔KONY DOKON캛ENY"]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"w-5 h-5"})," PROV칄ST KOMPLETN칈 SERVIS"]})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-xs font-black text-white/40 uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"})," Dopl켿kov칠 Slu쬭y"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>le(!0),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(At,{className:"w-6 h-6 text-zinc-500 group-hover:text-cyan-400 transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400 group-hover:text-white",children:"Tr쬴코t캩 & Scrap"})]}),e.jsxs("button",{onClick:()=>ee(!0),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(Ge,{className:"w-6 h-6 text-zinc-500 group-hover:text-orange-500 transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400 group-hover:text-white",children:"V칳roba (Factory)"})]}),e.jsxs("button",{onClick:()=>O("Lod캩nice"),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(Ka,{className:"w-6 h-6 text-zinc-500 group-hover:text-signal-cyan transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400",children:"Vylep코it Lo캞"})]}),e.jsxs("button",{onClick:()=>O("Kartografie"),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(bt,{className:"w-6 h-6 text-zinc-500 group-hover:text-purple-500 transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400",children:"Registr Planet"})]})]})]}),e.jsx("div",{className:"w-full h-0.5 bg-signal-amber mb-6 shadow-[0_0_10px_#ff9d00]"}),e.jsxs("div",{className:"pt-2",children:[e.jsxs("h3",{className:"text-xs font-black text-signal-amber uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"})," Protokol 칔dr쬭y"]}),e.jsxs("div",{className:"font-mono text-[10px] text-zinc-500 space-y-1.5 p-4 bg-black/40 rounded-xl border border-white/5",children:[e.jsxs("p",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-700",children:"08:00"})," ",e.jsx("span",{children:"> Nav치z치no spojen칤 s centr치ln칤m serverem..."})]}),e.jsxs("p",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-700",children:"08:01"})," ",e.jsx("span",{children:"> Autorizace jednotky: 칔SP캨CH"})]}),e.jsxs("p",{className:"flex gap-2 text-green-500",children:[e.jsx("span",{className:"text-green-900",children:"08:02"})," ",e.jsx("span",{children:"> Zah치jen칤 automatick칳ch oprav..."})]}),e.jsxs("p",{className:"flex gap-2 text-green-500",children:[e.jsx("span",{className:"text-green-900",children:"08:05"})," ",e.jsx("span",{children:"> Dopln캩n칤 z치sob..."})]}),e.jsxs("p",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-700",children:"08:10"})," ",e.jsx("span",{children:"> Odpojen칤 servisn칤ch ramen."})]}),e.jsxs("p",{className:"flex gap-2 animate-pulse text-signal-cyan",children:[e.jsx("span",{className:"text-cyan-900",children:"08:11"})," ",e.jsx("span",{children:"> P콏ipraveno k odletu."})]})]})]})]}),e.jsx("footer",{className:"relative z-10 p-6 bg-black/80 backdrop-blur-xl border-t border-white/10",children:e.jsxs("button",{onClick:h,className:"w-full py-4 bg-cyan-600/10 hover:bg-cyan-600/20 border border-cyan-600/30 text-cyan-400 font-black uppercase text-sm tracking-[0.3em] rounded-xl flex items-center justify-center gap-3 transition-all active:scale-95 shadow-[0_0_20px_rgba(8,145,178,0.2)]",children:[e.jsx(Xt,{className:"w-5 h-5"}),"Opustit Stanici (Undock)"]})}),e.jsx(xe,{children:E&&e.jsx("div",{className:"fixed inset-0 z-[250] bg-black/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(R.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-zinc-900 border border-white/10 p-6 rounded-2xl w-full max-w-xs text-center shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-signal-cyan"}),e.jsx("div",{className:"w-16 h-16 bg-cyan-500/10 rounded-full flex items-center justify-center mx-auto mb-4 text-cyan-500 border border-cyan-500/30",children:e.jsx(Xt,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-wider mb-2",children:"Opustit Dok?"}),e.jsx("p",{className:"text-xs text-zinc-400 mb-6 font-mono leading-relaxed",children:"Opravdu chcete opustit stanici? Ujist캩te se, 쬰 m치te dopln캩no palivo a z치soby."}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>I(!1),className:"py-3 bg-zinc-800 text-zinc-400 font-bold uppercase text-[10px] rounded-lg hover:bg-zinc-700 transition-colors",children:"Z콢stat"}),e.jsx("button",{onClick:S,className:"py-3 bg-cyan-600 text-white font-bold uppercase text-[10px] rounded-lg hover:bg-cyan-500 transition-colors shadow-lg shadow-cyan-500/20",children:"Odlet캩t"})]})]})})}),e.jsx(xe,{children:Y&&e.jsxs(R.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},className:"fixed bottom-24 left-1/2 -translate-x-1/2 z-[300] bg-black/90 border border-orange-500/50 px-6 py-3 rounded-full shadow-[0_0_30px_rgba(249,115,22,0.3)] flex items-center gap-3",children:[e.jsx(Fa,{className:"w-5 h-5 text-orange-500 animate-pulse"}),e.jsxs("span",{className:"text-xs font-bold text-orange-500 uppercase tracking-widest whitespace-nowrap",children:["Modul ",Y," ve v칳stavb캩"]})]})}),e.jsx(xe,{children:Z&&e.jsx(R.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-[250]",children:e.jsx(Mn,{inventory:c,masterCatalog:i,onClose:()=>ee(!1),onCraft:n})})}),e.jsx(xe,{children:ce&&e.jsx(R.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-[250]",children:e.jsx(Pn,{onClose:()=>le(!1),masterCatalog:i,inventory:c,playerGold:o,playerClass:m,onBuy:(j,f)=>{F(j,f)},onRecycle:(j,f)=>{B(j,f)}})})})]})},$n=({merchant:t,userGold:s,adminEmail:p,inventory:n,playerClass:c,onClose:i,onBuy:o,onSell:m,onAddFreeItem:g,masterCatalog:b=[]})=>{const[y,v]=a.useState("buy"),[d,N]=a.useState([]),[E,I]=a.useState({}),[Y,k]=a.useState(!0),[M,A]=a.useState(null),[Z,ee]=a.useState(null),[ce,le]=a.useState("thinking"),[L,h]=a.useState(0),S=t.tradeConfig||{warriorDiscount:10,clericDiscount:45,mageDiscount:25,rogueStealChance:30},O=a.useMemo(()=>{var $;const T={};return($=t.merchantItems)==null||$.forEach(j=>{if(j.saleChance&&j.saleChance>0){const f=Math.random()*100;T[j.id]=f<=j.saleChance}}),T},[t.id]);a.useEffect(()=>{(async()=>{if(!t.merchantItems||t.merchantItems.length===0){k(!1);return}k(!0);const $={},j=[];for(const f of t.merchantItems){$[f.id]=f.stock;const D=f.id.trim();let q=b.find(oe=>oe.id===D);if(q||(q=b.find(oe=>oe.id.split("__")[0]===D)),!q)try{q=await Mt(p,D)||void 0}catch{}q&&j.push({...q,price:f.price!==void 0&&f.price>0?f.price:q.price,_merchantEntry:f})}I($),N(j),k(!1)})()},[t,p,b]);const J=T=>{var oe,fe;const $=T.price??100;let j=$,f=null;const D=((oe=T._merchantEntry)==null?void 0:oe.id)||T.id,q=O[D]||!1;if(q&&(j=Math.floor($*.7),f="SALE"),c===Oe.WARRIOR){const ue=(100-S.warriorDiscount)/100;j=Math.floor(j*ue),f||(f="CLASS")}if(c===Oe.CLERIC&&((fe=T.stats)==null?void 0:fe.some(be=>["HP","HEAL","L칄캛EN칈","ZDRAV칈"].some(Me=>be.label.toUpperCase().includes(Me))))){const be=(100-S.clericDiscount)/100;j=Math.floor(j*be),f||(f="CLASS")}if(c===Oe.MAGE&&(T.isConsumable||T.type===ae.ITEM)){const ue=(100-S.mageDiscount)/100;j=Math.floor(j*ue),f||(f="CLASS")}return{finalPrice:Math.max(1,j),basePrice:$,discountType:f,isOnSale:q}},F=T=>{var D;const $=((D=T._merchantEntry)==null?void 0:D.id)||T.id,j=E[$]||0,{finalPrice:f}=J(T);if(j>0&&s>=f){let q=1;c===Oe.ROGUE&&j>=2&&g&&Math.random()*100<S.rogueStealChance&&(q=2,g(T),w("success"),A(`Z칤skal jsi ${T.title} nav칤c zdarma! (Kr치de)`),setTimeout(()=>A(null),3e3)),I(fe=>({...fe,[$]:Math.max(0,fe[$]-q)}));const oe={...T,price:f};o(oe)}},B=T=>{ee(T),le("thinking"),w("scan"),setTimeout(()=>{var f;const $=T.id.split("__")[0],j=(f=t.merchantItems)==null?void 0:f.find(D=>D.id===T.id||D.id===$);j&&j.sellPrice&&j.sellPrice>0?(h(j.sellPrice),le("offer"),w("success")):(le("reject"),w("error"))},1500)},Q=()=>{Z&&m&&(m(Z,L),w("success"),ee(null))},te=T=>!T||T.length===0?null:e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:T.map(($,j)=>{let f=e.jsx(Re,{className:"w-3 h-3"}),D="text-zinc-400";const q=$.label.toUpperCase();return(q.includes("HP")||q.includes("HEAL"))&&(f=e.jsx(He,{className:"w-3 h-3"}),D="text-red-400"),(q.includes("DMG")||q.includes("ATK"))&&(f=e.jsx(yt,{className:"w-3 h-3"}),D="text-orange-400"),(q.includes("DEF")||q.includes("ARMOR"))&&(f=e.jsx(Ve,{className:"w-3 h-3"}),D="text-blue-400"),q.includes("MANA")&&(f=e.jsx(qe,{className:"w-3 h-3"}),D="text-cyan-400"),e.jsxs("div",{className:`flex items-center gap-1 text-[9px] bg-black/60 px-2 py-1 rounded border border-white/10 ${D} font-bold`,children:[f," ",$.label,": ",$.value]},j)})});return e.jsxs(R.div,{initial:{opacity:0,y:"100%"},animate:{opacity:1,y:0},exit:{opacity:0,y:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed inset-0 z-[60] bg-zinc-950/95 flex flex-col pt-28",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-5 z-0",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"30px 30px"}}),e.jsxs("div",{className:"p-4 bg-black border-b border-zinc-800 shadow-xl z-20 flex flex-col gap-4 relative",children:[e.jsx(xe,{children:M&&e.jsxs(R.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},className:"absolute top-2 left-2 right-2 bg-green-900/90 border border-green-500 text-green-100 p-3 rounded-xl z-50 flex items-center gap-2 shadow-xl",children:[e.jsx(hs,{className:"w-5 h-5 text-green-400"}),e.jsx("span",{className:"text-xs font-bold uppercase",children:M})]})}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-2xl font-display font-black text-white uppercase tracking-wider leading-none",children:t.title})}),e.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2 bg-red-900/20 border border-red-500/50 rounded-lg text-red-500 hover:bg-red-900/40 active:scale-95 transition-all",children:[e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Odej칤t"}),e.jsx(_e,{className:"w-4 h-4"})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-zinc-900 p-3 rounded-xl border border-zinc-800",children:[e.jsx("span",{className:"text-xs text-zinc-400 font-bold uppercase tracking-widest",children:"Dostupn칳 Kredit"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"text-xl font-mono font-black text-white",children:s})]})]}),t.canSellToMerchant&&e.jsxs("div",{className:"flex bg-zinc-900 p-1 rounded-lg border border-zinc-800",children:[e.jsx("button",{onClick:()=>v("buy"),className:`flex-1 py-2 text-xs font-bold uppercase rounded-md transition-all ${y==="buy"?"bg-zinc-800 text-white shadow":"text-zinc-500 hover:text-zinc-200"}`,children:"N치kup"}),e.jsx("button",{onClick:()=>v("sell"),className:`flex-1 py-2 text-xs font-bold uppercase rounded-md transition-all ${y==="sell"?"bg-zinc-800 text-white shadow":"text-zinc-500 hover:text-zinc-200"}`,children:"Prodej"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-zinc-950 pb-20 relative z-10",children:y==="buy"?Y?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 gap-4",children:[e.jsx(De,{className:"w-8 h-8 text-signal-cyan animate-spin"}),e.jsx("p",{className:"text-xs text-zinc-400 uppercase tracking-widest font-bold",children:"Nasklad켿ov치n칤 zbo쮂..."})]}):d.length===0?e.jsxs("div",{className:"text-center py-10 opacity-50",children:[e.jsx(It,{className:"w-16 h-16 mx-auto mb-4 text-zinc-600"}),e.jsx("p",{className:"text-zinc-300 font-bold uppercase tracking-widest",children:"Vyprod치no"}),e.jsx("p",{className:"text-[10px] text-zinc-500 mt-2 max-w-xs mx-auto",children:"Obchodn칤k nem치 na sklad캩 쮂멳n칠 zbo쮂 odpov칤daj칤c칤 zadan칳m ID. Zkontrolujte Fabrikaci."})]}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:d.map(T=>{var be;const $=((be=T._merchantEntry)==null?void 0:be.id)||T.id,j=E[$]||0,f=j<=0,{finalPrice:D,basePrice:q,discountType:oe,isOnSale:fe}=J(T),ue=s>=D;return e.jsxs("div",{className:`bg-zinc-900 border border-zinc-800 p-4 rounded-xl relative overflow-hidden transition-all ${f?"opacity-50 grayscale":"hover:border-zinc-600"}`,children:[fe&&!f&&e.jsx("div",{className:"absolute top-0 right-0 bg-pink-600 text-white text-[9px] font-black px-2 py-1 rounded-bl-xl uppercase tracking-wider animate-pulse shadow-[0_0_10px_#db2777]",children:"BLESKOV츼 AKCE"}),e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${T.rarity==="Legendary"?"bg-yellow-500":T.rarity==="Epic"?"bg-purple-500":T.rarity==="Rare"?"bg-blue-500":"bg-zinc-600"}`}),e.jsxs("div",{className:"pl-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h3",{className:"font-bold text-white text-lg leading-tight",children:T.title}),e.jsxs("div",{className:`flex items-center gap-1 text-[10px] px-1.5 py-0.5 rounded font-bold uppercase border ${f?"bg-red-900/20 text-red-500 border-red-900/40":"bg-zinc-800 text-zinc-200 border-zinc-700"}`,children:[e.jsx($e,{className:"w-3 h-3"}),f?"Vyprod치no":`Skladem: ${j}`]})]}),e.jsxs("span",{className:"text-[10px] text-zinc-400 uppercase tracking-wider font-bold block mb-2",children:[T.type,"  ",T.rarity]}),e.jsxs("p",{className:"text-xs text-zinc-300 line-clamp-2 font-serif leading-relaxed mb-2 italic opacity-80",children:['"',T.description,'"']}),te(T.stats)]}),e.jsxs("div",{className:"pl-3 mt-3 pt-3 border-t border-zinc-800 flex justify-between items-end",children:[e.jsxs("div",{className:"flex flex-col",children:[D<q&&e.jsxs("span",{className:"text-[10px] text-zinc-500 line-through decoration-red-500 font-mono mb-0.5",children:[q," GOLD"]}),e.jsxs("div",{className:`flex items-center gap-1 font-mono font-black text-xl ${ue?"text-yellow-500":"text-red-500"}`,children:[D," ",e.jsx(ke,{className:"w-4 h-4"})]}),oe&&e.jsx("span",{className:"text-[8px] text-green-500 font-bold uppercase",children:oe==="SALE"?"Sleva":"T콏칤dn칤 Bonus"})]}),e.jsx("button",{onClick:()=>F(T),disabled:f||!ue,className:`px-6 py-3 rounded-lg font-bold uppercase tracking-widest text-xs transition-all shadow-lg flex items-center justify-center gap-2 ${f?"bg-zinc-800 text-zinc-500 cursor-not-allowed border border-zinc-700":ue?"bg-signal-cyan text-black hover:bg-white shadow-[0_0_15px_rgba(0,242,255,0.4)] active:scale-95":"bg-zinc-900 text-zinc-600 cursor-not-allowed border border-zinc-800"}`,children:f?"Vyprod치no":ue?e.jsxs(e.Fragment,{children:[e.jsx(It,{className:"w-4 h-4"})," Koupit"]}):"Drah칠"})]})]},T.id)})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"mb-4 bg-zinc-900 border border-zinc-800 p-3 rounded-lg flex items-center gap-3",children:[e.jsx(Za,{className:"w-5 h-5 text-green-500"}),e.jsx("p",{className:"text-xs text-zinc-200 font-bold leading-relaxed",children:"Vyberte p콏edm캩t k prodeji."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[(n||[]).filter(T=>T.type===ae.ITEM||T.type==="P콎EDM캨T").map(T=>e.jsxs("button",{onClick:()=>B(T),className:"bg-zinc-900 border border-zinc-800 p-3 rounded-xl flex flex-col gap-2 relative overflow-hidden hover:border-green-500/50 transition-colors text-left group active:scale-95",children:[e.jsx("div",{className:"flex justify-between items-start w-full",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-black p-2 rounded-lg border border-zinc-800 group-hover:border-green-500/30 transition-colors",children:e.jsx($e,{className:"w-5 h-5 text-zinc-400 group-hover:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white text-sm uppercase tracking-tight",children:T.title}),e.jsx("span",{className:"text-[9px] font-bold uppercase bg-black/40 px-1.5 rounded text-zinc-400 border border-white/10",children:T.rarity})]})]})}),te(T.stats)]},T.id)),(!n||n.filter(T=>T.type===ae.ITEM||T.type==="P콎EDM캨T").length===0)&&e.jsx("p",{className:"col-span-1 text-center text-zinc-500 text-xs py-10 uppercase font-bold tracking-widest",children:"V치코 batoh je pr치zdn칳."})]})]})}),e.jsx(xe,{children:Z&&e.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-black/95 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(R.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-zinc-900 border border-zinc-700 rounded-2xl p-6 w-full max-w-sm text-center relative overflow-hidden",children:[e.jsx("button",{onClick:()=>ee(null),className:"absolute top-4 right-4 text-zinc-400 hover:text-white",children:e.jsx(_e,{className:"w-5 h-5"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-1 uppercase tracking-tighter",children:Z.title}),e.jsx("div",{className:"flex justify-center mb-4",children:te(Z.stats)}),ce==="thinking"&&e.jsxs("div",{className:"py-8 flex flex-col items-center gap-4",children:[e.jsx(qa,{className:"w-12 h-12 text-neon-purple animate-pulse"}),e.jsx("p",{className:"text-sm font-bold text-neon-purple uppercase tracking-widest animate-pulse",children:"Obchodn칤k p콏em칳코l칤..."})]}),ce==="reject"&&e.jsxs("div",{className:"py-4 flex flex-col items-center gap-4",children:[e.jsx(ys,{className:"w-12 h-12 text-red-500"}),e.jsx("div",{className:"bg-black/60 p-4 rounded-xl border-l-4 border-red-500 text-left w-full border border-zinc-800",children:e.jsx("p",{className:"text-sm italic text-zinc-100 leading-relaxed font-serif",children:'"Tohle? To je bezcenn칳 kr치m. O to nem치m z치jem. P콏ines mi n캩co po콏치dn칠ho, co m치m na seznamu."'})}),e.jsx("button",{onClick:()=>ee(null),className:"w-full py-3 bg-zinc-800 text-white font-bold uppercase rounded-lg border border-zinc-700 tracking-widest text-xs",children:"Zp캩t k Batohu"})]}),ce==="offer"&&e.jsxs("div",{className:"py-4 flex flex-col items-center gap-4",children:[e.jsx(ks,{className:"w-12 h-12 text-green-500"}),e.jsxs("div",{className:"bg-black/60 p-4 rounded-xl border-l-4 border-green-500 text-left w-full border border-zinc-800",children:[e.jsx("p",{className:"text-sm italic text-zinc-200 mb-4 font-serif leading-relaxed",children:'"Hmm, zaj칤mav칠. O tohle bych z치jem m캩l."'}),e.jsxs("div",{className:"flex justify-between items-center bg-black/50 p-3 rounded border border-zinc-800",children:[e.jsx("span",{className:"text-xs font-bold uppercase text-zinc-300 tracking-wider",children:"Nab칤dka:"}),e.jsxs("span",{className:"text-xl font-mono font-bold text-green-500 flex items-center gap-1",children:[L," ",e.jsx(ke,{className:"w-4 h-4"})]})]})]}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx("button",{onClick:()=>ee(null),className:"flex-1 py-3 bg-zinc-800 text-zinc-300 font-bold uppercase rounded-lg border border-zinc-700 text-xs tracking-widest",children:"Odm칤tnout"}),e.jsx("button",{onClick:Q,className:"flex-1 py-3 bg-green-600 hover:bg-green-500 text-white font-bold uppercase rounded-lg shadow-[0_0_15px_rgba(34,197,94,0.4)] text-xs tracking-widest",children:"PRODAT"})]})]})]})})})]})},Is=()=>Je(()=>import("./InventoryView-F8E1UMx1.js"),__vite__mapDeps([0,1,2]),import.meta.url),As=()=>Je(()=>import("./Generator-Cv0namSM.js"),__vite__mapDeps([3,1,2]),import.meta.url),Rs=()=>Je(()=>import("./CharacterManagement-lMucmmwE.js"),__vite__mapDeps([4,1,2]),import.meta.url),Os=()=>Je(()=>import("./Room-DKlo5_Gm.js"),__vite__mapDeps([5,1,2]),import.meta.url),_s=()=>Je(()=>import("./SettingsView-BDzhfRYW.js"),__vite__mapDeps([6,1]),import.meta.url),Ms=()=>Je(()=>import("./SpaceshipView-BZ3Yl0cX.js"),__vite__mapDeps([7,1,2]),import.meta.url),Vn=a.lazy(Is),Hn=a.lazy(As),Gn=a.lazy(Rs),Un=a.lazy(Os),Bn=a.lazy(_s),Kn=a.lazy(Ms);class Fn extends a.Component{constructor(){super(...arguments);Qt(this,"state",{hasError:!1})}static getDerivedStateFromError(p){return{hasError:!0}}componentDidCatch(p,n){}render(){return this.state.hasError?e.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center bg-black p-10 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-950/20 border border-red-500/50 rounded-full flex items-center justify-center mb-6 shadow-[0_0_20px_rgba(239,68,68,0.2)]",children:e.jsx(ze,{className:"w-8 h-8 text-red-500"})}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-widest mb-2",children:"Chyba_Segmentu"}),e.jsxs("p",{className:"text-zinc-500 text-[10px] font-mono uppercase tracking-widest mb-8 leading-relaxed",children:["Nepoda콏ilo se st치hnout hern칤 modul.",e.jsx("br",{}),"Mo쬹치 ztr치ta sign치lu se sektorem."]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"button-primary py-4 px-10 text-[10px]",children:"Restartovat HUD"})]}):this.props.children}}const Zn=()=>e.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center bg-black gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"w-12 h-12 text-signal-cyan animate-spin opacity-50"}),e.jsx(R.div,{animate:{scale:[1,1.2,1],opacity:[.3,1,.3]},transition:{duration:1.5,repeat:1/0},className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-signal-cyan rounded-full shadow-[0_0_10px_#00f2ff]"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-black text-signal-cyan uppercase tracking-[0.4em] animate-pulse",children:"Synchronizace_Dat"}),e.jsx("span",{className:"text-[8px] font-mono text-zinc-600 uppercase mt-1",children:"Stahov치n칤_Segmentu..."})]})]}),qn=()=>{const t=zn(),[s,p]=a.useState(()=>sessionStorage.getItem("nexus_boot_done")==="true"),[n,c]=a.useState(.85),[i,o]=a.useState(navigator.onLine);a.useEffect(()=>{s&&t.userEmail&&i&&(Is().catch(()=>{}),Os().catch(()=>{}),Ms().catch(()=>{}),t.isAdmin&&(As().catch(()=>{}),t.userEmail==="zbynekbal97@gmail.com"&&Rs().catch(()=>{})),_s().catch(()=>{}))},[s,t.userEmail,i,t.isAdmin]),a.useEffect(()=>{const d=()=>o(navigator.onLine);return window.addEventListener("online",d),window.addEventListener("offline",d),"getBattery"in navigator&&navigator.getBattery().then(N=>{const E=()=>c(N.level);return E(),N.addEventListener("levelchange",E),()=>N.removeEventListener("levelchange",E)}),()=>{window.removeEventListener("online",d),window.removeEventListener("offline",d)}},[]);const m=()=>{p(!0),sessionStorage.setItem("nexus_boot_done","true")},g=()=>{w("message"),W(15);const d=t.isNight,N=d?"NO캛N칈 PROTOKOL AKTIVN칈":"DENN칈 PROTOKOL AKTIVN칈",E=d?"20:00  06:00":"06:00  20:00",I=d?"Zv칳코en치 aktivita biotick칳ch hrozeb. No캜n칤 varianty karet maj칤 bonus k po코kozen칤 (+5 DMG). Viditelnost skeneru omezena.":"Stabiln칤 atmosf칠rick칠 podm칤nky. Standardn칤 loot tabulky a bezpe캜n칠 obchodn칤 trasy. Bonus k regeneraci kysl칤ku.";t.setNotification({id:"cycle-"+Date.now(),message:`${N}
캛as: ${E}

${I}`,type:"info"})},b=d=>{let N=0;d.forEach(E=>{const Y=String(E.value).replace(/[^0-9-]/g,""),k=parseInt(Y),M=String(E.label).toUpperCase().trim();!isNaN(k)&&k!==0&&(["HP","ZDRAV칈","HEAL"].some(A=>M.includes(A))?(t.handleHpChange(k),N++):["MANA","ENERGIE"].some(A=>M.includes(A))?(t.handleManaChange(k),N++):["PALIVO","FUEL"].some(A=>M.includes(A))?(t.handleFuelChange(k),N++):["GOLD","ZLATO","MINCE"].some(A=>M.includes(A))?(t.handleGoldChange(k),N++):["O2","KYSL칈K"].some(A=>M.includes(A))?(t.setPlayerOxygen(A=>Math.min(100,Math.max(0,A+k))),N++):["ARMOR","BRN캨N칈"].some(A=>M.includes(A))&&(t.setPlayerArmor(A=>Math.max(0,A+k)),N++))}),N>0&&t.setNotification({id:"loot-claim-"+Date.now(),type:"success",message:"Ko콏ist byla 칰sp캩코n캩 p콏ips치na."})},y=d=>{t.setPlayerArmor(N=>Math.max(0,N+d))},v=(d,N)=>{var k,M;const E=t.inventory.find(A=>{var Z;return A.type===ae.PLANET&&((Z=A.planetConfig)==null?void 0:Z.planetId)===d});if((k=E==null?void 0:E.planetConfig)!=null&&k.phases&&E.planetConfig.phases.length>0){const A=E.planetProgress||0;if(A<E.planetConfig.phases.length){const Z=E.planetConfig.phases[A],ee=t.masterCatalog.find(ce=>ce.id===Z);if(ee){t.setCurrentEvent({...ee});return}}}if((M=E==null?void 0:E.planetConfig)!=null&&M.landingEventId){const A=t.masterCatalog.find(Z=>Z.id===E.planetConfig.landingEventId);if(A){t.setCurrentEvent({...A,id:`LIVE-${Date.now()}`});return}}const I=t.masterCatalog.filter(A=>A.type===N);let Y=null;if(I.length>0){const A=Math.floor(Math.random()*I.length);Y={...I[A],id:`LANDING-${Date.now()}`}}else Y={id:`GEN-${Date.now()}`,title:"Pr콢zkum Sektoru",description:`Narazili jste na nezn치mou aktivitu typu ${N}.`,type:N,rarity:"Common",stats:[],isConsumable:!1};t.setCurrentEvent(Y)};return s?t.userEmail?e.jsxs("div",{className:"h-screen w-screen bg-black overflow-hidden flex flex-col font-sans text-white relative",children:[e.jsx(xe,{children:t.notification&&e.jsx("div",{className:"fixed inset-0 z-[20000] pointer-events-none",children:e.jsx(In,{data:t.notification,onClose:()=>t.setNotification(null)})})}),!t.isServerReady&&!t.isGuest?e.jsx(Es,{onConnected:()=>t.setIsServerReady(!0),onSwitchToOffline:t.handleSwitchToOffline}):!t.roomState.isNicknameSet||!t.playerClass?e.jsx(En,{initialNickname:t.roomState.nickname,onConfirmSetup:t.handleGameSetup,isGuest:t.isGuest}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{children:t.screenFlash&&e.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-[999] pointer-events-none mix-blend-overlay ${t.screenFlash==="red"?"bg-red-600/40":t.screenFlash==="green"?"bg-green-500/30":t.screenFlash==="blue"?"bg-blue-500/30":"bg-orange-500/50"}`})}),e.jsxs("div",{className:"h-36 bg-zinc-950/95 border-b border-white/10 flex flex-col z-[100] shadow-[0_5px_20px_rgba(0,0,0,0.8)]",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-1 border-b border-white/5 bg-white/[0.01] relative",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-1 h-1 rounded-full ${i?"bg-green-500 animate-pulse":"bg-red-500 shadow-[0_0_8px_red] animate-ping"}`}),t.isAdmin&&e.jsxs("div",{className:`ml-2 px-2 py-0.5 rounded border-[0.5px] text-[6px] font-black uppercase tracking-wider flex items-center gap-1 ${t.isTestMode?"border-orange-500/50 text-orange-500 bg-orange-950/30 shadow-[0_0_10px_rgba(249,115,22,0.2)]":"border-purple-500/50 text-purple-400 bg-purple-950/30 shadow-[0_0_10px_rgba(168,85,247,0.2)]"}`,children:[t.isTestMode?e.jsx(Ya,{className:"w-2 h-2"}):e.jsx(Ht,{className:"w-2 h-2"}),t.isTestMode?"TEST_ENV":"LIVE_DB"]})]}),t.roomState.isInRoom&&t.roomState.isGameStarted&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center gap-2",children:e.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-0.5 rounded-full border animate-pulse shadow-[0_0_10px_rgba(0,0,0,0.1)] ${t.isMyTurn?"bg-green-500/10 border-green-500/50 text-green-500 shadow-[0_0_15px_rgba(34,197,94,0.3)]":"bg-signal-amber/10 border-signal-amber/30 text-signal-amber"}`,children:[t.isMyTurn?e.jsx(Re,{className:"w-2 h-2 text-green-500 animate-pulse"}):e.jsx(De,{className:"w-2 h-2 text-signal-amber animate-spin"}),e.jsx("span",{className:"text-[8px] font-black uppercase tracking-[0.2em]",children:t.isMyTurn?"JSI NA TAHU":`NA TAHU: ${t.roomState.turnOrder[t.roomState.turnIndex]||"---"}`})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:g,className:"flex items-center gap-1.5 active:scale-95 transition-transform",children:[t.isNight?e.jsx(Ja,{className:"w-3 h-3 text-indigo-400"}):e.jsx(Wa,{className:"w-3 h-3 text-signal-amber"}),e.jsx("span",{className:"text-[8px] font-mono text-zinc-400 uppercase tracking-widest",children:t.isNight?"Night_Cycle":"Day_Cycle"})]}),e.jsx("div",{className:"w-8 h-1.5 bg-white/5 relative rounded-full overflow-hidden border border-white/10",children:e.jsx("div",{className:"h-full bg-signal-amber shadow-[0_0_50px_#ff9d00]",style:{width:`${n*100}%`}})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-1 p-1 bg-black/40",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-1",children:[e.jsx(Fe,{icon:e.jsx(He,{className:"w-4 h-4"}),value:t.playerHp,max:150,color:"#ef4444",label:"HP"}),e.jsx(Fe,{icon:e.jsx(qe,{className:"w-4 h-4"}),value:t.playerMana,max:100,color:"#00f2ff",label:"MANA"}),e.jsx(Fe,{icon:e.jsx(Gt,{className:"w-4 h-4"}),value:t.playerFuel,max:100,color:"#f97316",label:"PALIVO"})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-1",children:[e.jsx(Fe,{icon:e.jsx(ke,{className:"w-4 h-4"}),value:t.playerGold,color:"#fbbf24",label:"GOLD"}),e.jsx(Fe,{icon:e.jsx(Ve,{className:"w-4 h-4"}),value:t.playerArmor,color:"#a1a1aa",label:"ARMOR"}),e.jsx(Fe,{icon:e.jsx(vt,{className:"w-4 h-4"}),value:t.playerOxygen,max:100,color:"#22d3ee",label:"O2"})]})]})]}),e.jsx("div",{className:"flex-1 relative overflow-hidden",children:e.jsx(Fn,{children:e.jsxs(a.Suspense,{fallback:e.jsx(Zn,{}),children:[t.activeTab===me.SCANNER&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(Cs,{onScanCode:t.handleScanCode,isAIThinking:t.isAIThinking,isPaused:t.isScannerPaused})}),t.activeTab===me.INVENTORY&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(Vn,{inventory:t.inventory,loadingInventory:!1,isRefreshing:t.isRefreshing,isAdmin:t.isAdmin,isNight:t.isNight,adminNightOverride:t.adminNightOverride,playerClass:t.playerClass,giftTarget:t.giftTarget,onRefresh:t.handleRefreshDatabase,onItemClick:t.handleOpenInventoryItem,isTestMode:t.isTestMode,getAdjustedItem:t.getAdjustedItem})}),t.activeTab===me.GENERATOR&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(Hn,{onSaveCard:d=>{t.handleSaveEvent(d,!0)},userEmail:t.userEmail||"",initialData:t.editingEvent,onClearData:()=>t.setEditingEvent(null),onDelete:d=>{t.handleDeleteEvent(d)},masterCatalog:t.masterCatalog})}),t.activeTab===me.ROOM&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(Un,{roomState:t.roomState,inventory:t.inventory,scanLog:t.scanLog,onExitToMenu:t.handleExitToMenu,onSendMessage:t.handleSendMessage,onStartGame:t.handleStartGame,userEmail:t.userEmail||void 0,onToggleReady:t.handleToggleReady,onKickPlayer:t.handleKickPlayer,activeCharacter:t.activeCharacter,isNight:t.isNight,activeTrade:t.activeTrade,onInitTrade:t.handleInitTrade,onCancelTrade:t.handleCancelTrade,onConfirmTrade:t.handleConfirmTrade,onTradeSelectOffer:t.handleTradeSelectOffer})}),t.activeTab===me.SETTINGS&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(Bn,{onBack:()=>t.setActiveTab(me.SCANNER),onLogout:t.handleLogout,soundEnabled:t.soundEnabled,vibrationEnabled:t.vibrationEnabled,onToggleSound:t.handleToggleSound,onToggleVibration:t.handleToggleVibration,userEmail:t.userEmail,isAdmin:t.isAdmin,isTestMode:t.isTestMode,onToggleTestMode:t.toggleTestMode,onHardReset:t.handleHardReset,onWipeTestVault:t.handleWipeTestVault})}),t.activeTab===me.SPACESHIP&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(Kn,{playerFuel:t.playerFuel,inventory:t.inventory,onPlanetLand:v,onFuelConsume:d=>t.handleFuelChange(d),onProgressPlanet:d=>{t.handlePlanetProgress(d)},masterCatalog:t.masterCatalog})}),t.activeTab===me.CHARACTERS&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(Gn,{userEmail:t.userEmail||""})})]})})}),e.jsxs("div",{className:"h-20 bg-zinc-950 border-t-2 border-signal-cyan/40 flex items-center justify-around px-2 pb-2 relative z-50 shadow-[0_-12px_35px_rgba(0,242,255,0.25)]",children:[e.jsx(Le,{active:t.activeTab===me.SCANNER,onClick:()=>t.setActiveTab(me.SCANNER),icon:e.jsx(Ns,{}),label:"Sken"}),e.jsx(Le,{active:t.activeTab===me.INVENTORY,onClick:()=>t.setActiveTab(me.INVENTORY),icon:e.jsx(Ye,{}),label:t.isAdmin&&!t.isTestMode?"Datab치ze":"Batoh"}),e.jsx(Le,{active:t.activeTab===me.SPACESHIP,onClick:()=>t.setActiveTab(me.SPACESHIP),icon:e.jsx(vs,{}),label:"Lo캞"}),t.isAdmin&&!t.isTestMode&&e.jsx(Le,{active:t.activeTab===me.GENERATOR,onClick:()=>t.setActiveTab(me.GENERATOR),icon:e.jsx(Ge,{}),label:"Fab"}),t.userEmail==="zbynekbal97@gmail.com"&&!t.isTestMode&&e.jsx(Le,{active:t.activeTab===me.CHARACTERS,onClick:()=>t.setActiveTab(me.CHARACTERS),icon:e.jsx(Qa,{}),label:"Postavy"}),e.jsx(Le,{active:t.activeTab===me.ROOM,onClick:()=>t.setActiveTab(me.ROOM),icon:e.jsx(bs,{}),label:"T칳m"}),e.jsx(Le,{active:t.activeTab===me.SETTINGS,onClick:()=>t.setActiveTab(me.SETTINGS),icon:e.jsx(Xa,{}),label:"Sys"})]}),e.jsx(xe,{children:t.isDocking&&e.jsx(_n,{onComplete:t.handleDockingComplete})}),e.jsx(xe,{children:t.activeMerchant&&e.jsx($n,{merchant:t.activeMerchant,userGold:t.playerGold,adminEmail:t.isTestMode?"test1@nexus.cz":"zbynekbal97@gmail.com",inventory:t.inventory,playerClass:t.playerClass,onClose:()=>t.setActiveMerchant(null),onBuy:t.handleBuyItem,onSell:t.handleSellItem,onAddFreeItem:d=>t.handleSaveEvent(d,!1),masterCatalog:t.masterCatalog})}),e.jsx(xe,{children:t.activeStation&&e.jsx(Dn,{station:t.activeStation,onLeave:t.handleLeaveStation,onClaimRewards:t.handleClaimStationRewards,inventory:t.inventory,masterCatalog:t.masterCatalog,onCraft:d=>{t.handleCraftItem(d.id,[],d)},playerGold:t.playerGold,playerClass:t.playerClass,onInventoryUpdate:t.handleRefreshDatabase,isAdmin:t.isAdmin,isTestMode:t.isTestMode,onGoldChange:t.handleGoldChange})}),e.jsx(xe,{children:t.currentEvent&&!t.isDocking&&!t.activeStation&&!t.activeMerchant&&e.jsx(On,{event:t.currentEvent,onClose:()=>t.closeEvent(),onSave:()=>{t.handleSaveEvent(t.currentEvent,!1)},onUse:()=>{t.handleUseEvent(t.currentEvent)},onDiscard:()=>{t.handleDeleteEvent(t.currentEvent.id)},onResolveDilemma:t.handleResolveDilemma,isSaved:t.inventory.some(d=>{var N;return d.id===((N=t.currentEvent)==null?void 0:N.id)}),onPlayerDamage:t.handleHpChange,playerHp:t.playerHp,playerArmor:t.playerArmor,onArmorChange:y,playerClass:t.playerClass,inventory:t.inventory,onUseItem:d=>t.handleUseEvent(d),onClaimLoot:b})})]}),e.jsx("style",{children:`
        .stat-glow-box {
          box-shadow: inset 0 0 10px var(--slot-color-alpha);
          border-color: var(--slot-color-border);
        }
        .animate-spin-slow {
          animation: spin 6s linear infinite;
        }
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]}):e.jsx(Tn,{onLogin:t.handleLogin}):e.jsx(Cn,{onComplete:m})},Fe=({icon:t,value:s,max:p,color:n,label:c})=>{const i=p?Math.min(100,Math.max(0,s/p*100)):100;return e.jsxs("div",{className:"relative overflow-hidden rounded-md bg-zinc-950/80 border border-white/5 flex flex-col items-center justify-center py-1 h-[48px] group",children:[e.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-10 transition-opacity duration-500",style:{backgroundColor:n}}),e.jsxs("div",{className:"flex flex-col items-center gap-0.5 z-10 relative w-full px-2",children:[e.jsxs("div",{className:"flex items-end justify-center gap-1.5 w-full",children:[e.jsx("div",{className:"mb-0.5 opacity-80",style:{color:n},children:t}),e.jsx("span",{className:"font-mono font-black text-lg leading-none text-white tracking-tighter",style:{textShadow:`0 0 10px ${n}40`},children:s})]}),e.jsx("span",{className:"text-[7px] font-bold text-zinc-500 uppercase tracking-[0.2em]",children:c})]}),p&&e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-[2px] bg-white/5",children:e.jsx("div",{className:"h-full transition-all duration-700 ease-out relative",style:{width:`${i}%`,backgroundColor:n},children:e.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-1 h-1 rounded-full bg-white opacity-50 blur-[1px]"})})})]})},Le=({active:t,onClick:s,icon:p,label:n})=>e.jsxs("button",{onClick:s,className:`flex flex-col items-center gap-1 transition-all duration-300 ${t?"text-signal-cyan scale-110":"text-zinc-500"}`,children:[e.jsx("div",{className:`p-2 rounded-xl transition-colors ${t?"bg-signal-cyan/10 border border-signal-cyan/20":""}`,children:p}),e.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest",children:n})]}),Ps=document.getElementById("root");if(!Ps)throw new Error("Could not find root element to mount to");"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").then(t=>{}).catch(t=>{})});const os="263088388062-9dgio8dv930qsefdokl2g0uqekvrvs2c.apps.googleusercontent.com";window.onerror=function(t,s,p,n,c){const i=document.createElement("div");return i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100vw",i.style.height="100vh",i.style.backgroundColor="#000000",i.style.color="#ff0000",i.style.zIndex="999999",i.style.padding="20px",i.style.fontFamily="monospace",i.style.whiteSpace="pre-wrap",i.style.overflow="auto",i.innerHTML=`<h1>CRITICAL ERROR</h1><h3>${t}</h3><p>${s}:${p}:${n}</p><pre>${(c==null?void 0:c.stack)||"No stack"}</pre>`,document.body.appendChild(i),!1};window.onunhandledrejection=function(t){var p;const s=document.createElement("div");s.style.position="fixed",s.style.top="50%",s.style.left="0",s.style.width="100vw",s.style.height="50vh",s.style.backgroundColor="#1a0000",s.style.color="#ff5555",s.style.zIndex="999999",s.style.padding="20px",s.style.fontFamily="monospace",s.style.whiteSpace="pre-wrap",s.style.borderTop="2px solid red",s.style.overflow="auto",s.innerHTML=`<h1>UNHANDLED PROMISE REJECTION</h1><pre>${((p=t.reason)==null?void 0:p.stack)||t.reason}</pre>`,document.body.appendChild(s)};const ds=Rt.createRoot(Ps);os.length<10?ds.render(e.jsxs("div",{className:"h-screen w-screen bg-zinc-950 flex flex-col items-center justify-center p-8 text-center text-white",children:[e.jsx("div",{className:"w-20 h-20 bg-red-900/20 rounded-full flex items-center justify-center border border-red-500/50 mb-6",children:e.jsx(ze,{className:"w-10 h-10 text-red-500"})}),e.jsx("h1",{className:"text-2xl font-black uppercase tracking-widest mb-2",children:"Chyba Konfigurace"}),e.jsxs("p",{className:"text-sm text-zinc-400 font-mono mb-6 max-w-md",children:["Aplikace postr치d치 ",e.jsx("strong",{children:"VITE_GOOGLE_CLIENT_ID"}),".",e.jsx("br",{}),"Vytvo콏te soubor ",e.jsx("code",{children:".env"})," v ko콏enov칠m adres치콏i a p콏idejte va코e Google Client ID."]}),e.jsx("div",{className:"bg-black p-4 rounded border border-zinc-800 text-xs font-mono text-zinc-500",children:"VITE_GOOGLE_CLIENT_ID=va코e-id-z-google-cloud.apps.googleusercontent.com"})]})):ds.render(e.jsx(en.StrictMode,{children:e.jsx(an,{clientId:os,children:e.jsx(qn,{})})}));export{ae as G,Oe as P,tr as a,nr as b,er as d,sr as g,w as p,ar as s,W as v};
