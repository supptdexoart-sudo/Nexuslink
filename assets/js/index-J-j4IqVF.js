const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./InventoryView-BDbPwm56.js","./vendor-B0Ce1M0L.js","./utils-Z5IBgiKl.js","./Generator-C1raaoqF.js","./CharacterManagement-BPfGiF8h.js","./Room-DKCP_HST.js","./SettingsView-CW0Lfad7.js","./SpaceshipView-DspdBIlj.js"])))=>i.map(i=>d[i]);
var oa=Object.defineProperty;var da=(t,s,h)=>s in t?oa(t,s,{enumerable:!0,configurable:!0,writable:!0,value:h}):t[s]=h;var ns=(t,s,h)=>da(t,typeof s!="symbol"?s+"":s,h);import{a as xa,r as a,j as e,T as Ie,C as bs,A as de,m as _,L as Ve,K as Ht,W as ma,S as ua,b as pa,c as Gt,P as ha,d as Ut,e as fa,U as gs,f as Bt,g as at,D as Kt,h as jt,i as ba,k as js,l as Ns,F as vs,n as ys,o as ws,p as Rt,H as ga,G as ft,q as ja,E as Na,s as va,X as Me,I as _t,M as ya,t as wa,u as st,v as ka,w as He,x as Ge,y as Ue,z as bt,B as ks,J as Ye,N as Nt,O as vt,Z as Je,Q as Sa,V as _e,Y as ze,_ as We,$ as za,a0 as Ca,a1 as Ta,a2 as Ea,a3 as Ia,a4 as Be,a5 as Ss,a6 as Aa,a7 as gt,a8 as Ot,a9 as Ra,aa as zs,ab as Cs,ac as Ts,ad as Es,ae as Ft,af as _a,ag as Oa,ah as Ma,ai as Pa,aj as Mt,ak as La,al as Da,am as $a,an as Is,ao as Va,ap as rs,aq as Ha,ar as Ga,as as Ua,at as Ba,au as Ka,av as Fa,aw as Za,ax as qa,R as Ya}from"./vendor-B0Ce1M0L.js";import{Html5Qrcode as Ja,Html5QrcodeSupportedFormats as xt}from"html5-qrcode";import{G as Wa,a as Qa}from"./utils-Z5IBgiKl.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function h(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(l){if(l.ep)return;l.ep=!0;const r=h(l);fetch(l.href,r)}})();var Pt={},is=xa;Pt.createRoot=is.createRoot,Pt.hydrateRoot=is.hydrateRoot;const Xa="modulepreload",en=function(t,s){return new URL(t,s).href},ls={},Qe=function(s,h,n){let l=Promise.resolve();if(h&&h.length>0){const c=document.getElementsByTagName("link"),x=document.querySelector("meta[property=csp-nonce]"),g=(x==null?void 0:x.nonce)||(x==null?void 0:x.getAttribute("nonce"));l=Promise.allSettled(h.map(f=>{if(f=en(f,n),f in ls)return;ls[f]=!0;const y=f.endsWith(".css"),v=y?'[rel="stylesheet"]':"";if(!!n)for(let I=c.length-1;I>=0;I--){const A=c[I];if(A.href===f&&(!y||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${v}`))return;const j=document.createElement("link");if(j.rel=y?"stylesheet":Xa,y||(j.as="script"),j.crossOrigin="",j.href=f,g&&j.setAttribute("nonce",g),document.head.appendChild(j),y)return new Promise((I,A)=>{j.addEventListener("load",I),j.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${f}`)))})}))}function r(c){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=c,window.dispatchEvent(x),!x.defaultPrevented)throw c}return l.then(c=>{for(const x of c||[])x.status==="rejected"&&r(x.reason);return s().catch(r)})},re="https://nexus-backend-m492.onrender.com/api",As="nexus_admin_token",tn="263088388062-9dgio8dv930qsefdokl2g0uqekvrvs2c.apps.googleusercontent.com",oe=async(t,s={},h=!1)=>{if(!navigator.onLine)throw new Error("OFFLINE_MODE");try{const n=sessionStorage.getItem(As),l=localStorage.getItem("nexus_current_user"),r=new Headers(s.headers||{});n&&r.set("x-admin-key",n),l&&r.set("x-user-email",l),!r.has("Content-Type")&&!(s.body instanceof FormData)&&r.set("Content-Type","application/json");const c=await fetch(t,{...s,headers:r});if(!c.ok){const x=await c.json().catch(()=>({message:c.statusText}));throw new Error(x.message||`API Error: ${c.status}`)}return await c.json()}catch(n){throw n}},Rs=async()=>{if(!navigator.onLine)return!1;try{const t=new AbortController,s=setTimeout(()=>t.abort(),2e3),h=await fetch(`${re}/health`,{signal:t.signal});return clearTimeout(s),h.ok}catch{return!1}},Zn=async()=>{if(!navigator.onLine)throw new Error("Nelze z치lohovat v offline re쬴mu.");const t=sessionStorage.getItem(As),s=await fetch(`${re}/admin/backup`,{method:"GET",headers:{"x-admin-key":t||""}});if(!s.ok)throw new Error("Chyba p콏i stahov치n칤 z치lohy (Access Denied?)");const h=await s.blob(),n=window.URL.createObjectURL(h),l=document.createElement("a");l.href=n,l.download=`nexus_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(n),document.body.removeChild(l)},qn=async t=>oe(`${re}/admin/purge/${encodeURIComponent(t)}`,{method:"DELETE"}),sn=async(t,s,h,n)=>oe(`${re}/admin/action`,{method:"POST",body:JSON.stringify({roomId:t,targetName:s,actionType:h,value:n})}),an=async(t,s,h,n)=>oe(`${re}/inventory/swap`,{method:"POST",body:JSON.stringify({player1Email:t,player2Email:s,item1Id:h,item2Id:n})}),cs=async t=>{await oe(`${re}/rooms/${t}/start-game`,{method:"POST"})},nn=async(t,s)=>{await oe(`${re}/rooms/${t}/acknowledge-round`,{method:"POST",body:JSON.stringify({userName:s})})},rn=async t=>{const s=`${re}/auth/google`;return oe(s,{method:"POST",body:JSON.stringify({credential:t,clientId:tn})})},Et=async t=>oe(`${re}/inventory/${t}`),Lt=async(t,s)=>oe(`${re}/inventory/${t}`,{method:"POST",body:JSON.stringify(s)}),Dt=async(t,s)=>oe(`${re}/inventory/${t}/${encodeURIComponent(s)}`,{method:"DELETE"}),os=async t=>oe(`${re}/inventory/zbynekbal97@gmail.com`),$t=async(t,s)=>{try{return await oe(`${re}/inventory/${t}/${encodeURIComponent(s)}`,void 0,!0)}catch{return null}},It=async t=>oe(`${re}/rooms/${t}/status`),ds=async(t,s,h)=>{oe(`${re}/rooms/${t}/status`,{method:"POST",body:JSON.stringify({userName:s,hp:h})},!0).catch(()=>{})},ln=async t=>oe(`${re}/rooms/${t}/next-turn`,{method:"POST"}),xs=async(t,s)=>{oe(`${re}/rooms/${t}/leave`,{method:"POST",body:JSON.stringify({userName:s})},!0).catch(()=>{})},cn=async(t,s,h)=>oe(`${re}/rooms/${t}/messages`,{method:"POST",body:JSON.stringify({sender:s,text:h})},!0),ms=async t=>oe(`${re}/rooms/${t}/messages`),on=async(t,s,h,n)=>oe(`${re}/rooms`,{method:"POST",body:JSON.stringify({roomId:t,hostName:s,hostEmail:h,password:n})}),dn=async(t,s,h,n,l)=>oe(`${re}/rooms/${t}/join`,{method:"POST",body:JSON.stringify({userName:s,email:l,hp:h||100,password:n})}),xn=async(t,s,h)=>oe(`${re}/rooms/${t}/ready`,{method:"POST",body:JSON.stringify({userName:s,isReady:h})},!0),us=async(t,s)=>{await oe(`${re}/rooms/${t}/encounter`,{method:"POST",body:JSON.stringify({encounter:s})},!0).catch(()=>{})},Yn=async t=>oe(`${re}/characters/${t}`),Vt=async t=>{try{return await oe(`${re}/characters/by-id/${encodeURIComponent(t)}`,void 0,!0)}catch{return null}},Jn=async(t,s)=>oe(`${re}/characters/${t}`,{method:"POST",body:JSON.stringify(s)}),Wn=async(t,s)=>oe(`${re}/characters/${t}/${encodeURIComponent(s)}`,{method:"DELETE"});var se=(t=>(t.ITEM="P콎EDM캨T",t.ENCOUNTER="SETK츼N칈",t.TRAP="N츼STRAHA",t.MERCHANT="OBCHODN칈K",t.DILEMA="DILEMA",t.BOSS="BOSS",t.SPACE_STATION="VESM칈RN츼_STANICE",t.PLANET="PLANETA",t))(se||{}),Oe=(t=>(t.WARRIOR="V치le캜n칤k",t.MAGE="M치g",t.ROGUE="Zlod캩j",t.CLERIC="Kn캩z",t))(Oe||{});let Ee=null,tt=null,Re=null,mt=null,ut=null,_s=localStorage.getItem("nexus_sound_enabled")!=="false",Os=localStorage.getItem("nexus_vibration_enabled")!=="false";const mn=t=>{_s=t,localStorage.setItem("nexus_sound_enabled",String(t)),t&&k("click")},un=t=>{Os=t,localStorage.setItem("nexus_vibration_enabled",String(t)),t&&ee(50)},pn=()=>(Ee||(Ee=new(window.AudioContext||window.webkitAudioContext),tt=Ee.createGain(),tt.gain.value=.5,Re=Ee.createDynamicsCompressor(),Re.threshold.value=-24,Re.knee.value=30,Re.ratio.value=12,Re.attack.value=.003,Re.release.value=.25,mt=Ee.createDelay(1),mt.delayTime.value=.35,ut=Ee.createGain(),ut.gain.value=.25,tt.connect(Re),tt.connect(mt),mt.connect(ut),ut.connect(Re),Re.connect(Ee.destination)),Ee.state==="suspended"&&Ee.resume(),{ctx:Ee,master:tt}),ee=t=>{Os&&typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(t)},k=t=>{if(_s)try{const{ctx:s,master:h}=pn();if(!s||!h)return;const n=s.currentTime,l=(r,c,x,g,f=.1,y=0)=>{const v=s.createOscillator(),m=s.createGain(),j=s.createBiquadFilter();return v.type=c,v.frequency.value=r,v.detune.value=y,j.type="lowpass",j.frequency.setValueAtTime(3e3,x),j.Q.value=1,v.connect(j),j.connect(m),m.connect(h),m.gain.setValueAtTime(0,x),m.gain.linearRampToValueAtTime(f,x+.01),m.gain.exponentialRampToValueAtTime(.001,x+g),v.start(x),v.stop(x+g),{osc:v,gain:m,filter:j}};switch(t){case"click":{const{filter:r}=l(800,"square",n,.08,.05);r.frequency.setValueAtTime(2e3,n),r.frequency.exponentialRampToValueAtTime(100,n+.08)}break;case"open":{const r=l(220,"sawtooth",n,.4,.08,-5),c=l(220,"sawtooth",n,.4,.08,5);r.filter.frequency.setValueAtTime(100,n),r.filter.frequency.exponentialRampToValueAtTime(4e3,n+.3),c.filter.frequency.setValueAtTime(100,n),c.filter.frequency.exponentialRampToValueAtTime(4e3,n+.3)}break;case"scan":[880,1108,1318,1760].forEach((c,x)=>{const g=n+x*.06,{filter:f}=l(c,"square",g,.05,.04);f.frequency.value=3e3});break;case"error":{const r=s.createOscillator(),c=s.createGain(),x=s.createBiquadFilter();r.type="sawtooth",r.frequency.setValueAtTime(110,n),r.frequency.linearRampToValueAtTime(55,n+.3),x.type="lowpass",x.frequency.setValueAtTime(800,n),x.frequency.linearRampToValueAtTime(100,n+.3),r.connect(x),x.connect(c),c.connect(h),c.gain.setValueAtTime(.3,n),c.gain.exponentialRampToValueAtTime(.001,n+.3),r.start(n),r.stop(n+.35)}break;case"success":case"gift":{[523.25,659.25,783.99,1046.5].forEach((f,y)=>{const v=n+y*.08,m=s.createOscillator(),j=s.createGain();m.type="sine",m.frequency.setValueAtTime(f,v),m.connect(j),j.connect(h),j.gain.setValueAtTime(0,v),j.gain.linearRampToValueAtTime(.2,v+.02),j.gain.exponentialRampToValueAtTime(.001,v+.6),m.start(v),m.stop(v+.6)});const c=s.createOscillator(),x=s.createGain(),g=s.createBiquadFilter();c.type="triangle",c.frequency.setValueAtTime(261.63,n),g.type="lowpass",g.frequency.value=600,c.connect(g),g.connect(x),x.connect(h),x.gain.setValueAtTime(0,n),x.gain.linearRampToValueAtTime(.25,n+.05),x.gain.exponentialRampToValueAtTime(.001,n+.8),c.start(n),c.stop(n+.8)}break;case"heal":{const r=s.createOscillator(),c=s.createGain();r.type="sine",r.frequency.setValueAtTime(440,n);const x=s.sampleRate*2,g=s.createBuffer(1,x,s.sampleRate),f=g.getChannelData(0);for(let j=0;j<x;j++)f[j]=Math.random()*2-1;const y=s.createBufferSource();y.buffer=g;const v=s.createBiquadFilter();v.type="bandpass",v.frequency.value=1e3;const m=s.createGain();r.connect(c),y.connect(v),v.connect(m),m.connect(c),c.connect(h),c.gain.setValueAtTime(0,n),c.gain.linearRampToValueAtTime(.2,n+.8),c.gain.linearRampToValueAtTime(0,n+2),m.gain.value=.1,r.start(n),y.start(n),r.stop(n+2),y.stop(n+2)}break;case"damage":{const r=s.sampleRate,c=s.createBuffer(1,r,s.sampleRate),x=c.getChannelData(0);for(let v=0;v<r;v++)x[v]=Math.random()*2-1;const g=s.createBufferSource();g.buffer=c;const f=s.createBiquadFilter();f.type="lowpass",f.frequency.setValueAtTime(1e3,n),f.frequency.exponentialRampToValueAtTime(50,n+.4);const y=s.createGain();y.gain.setValueAtTime(.8,n),y.gain.exponentialRampToValueAtTime(.001,n+.4),g.connect(f),f.connect(y),y.connect(h),g.start(n),g.stop(n+.4),l(60,"square",n,.3,.3)}break;case"message":l(1200,"sine",n,.1,.05),l(1800,"sine",n+.1,.1,.05);break;case"siren":{const r=s.createOscillator(),c=s.createGain(),x=s.createBiquadFilter();r.type="sawtooth",r.frequency.value=150,r.detune.value=10,x.type="lowpass",x.Q.value=15;const g=s.createOscillator();g.type="sine",g.frequency.value=2;const f=s.createGain();f.gain.value=600,g.connect(f),f.connect(x.frequency),x.frequency.value=800,r.connect(x),x.connect(c),c.connect(h),c.gain.setValueAtTime(0,n),c.gain.linearRampToValueAtTime(.3,n+.5),c.gain.linearRampToValueAtTime(0,n+2.5),r.start(n),g.start(n),r.stop(n+2.5),g.stop(n+2.5)}break;case"crit":l(1500,"triangle",n,.3,.2).osc.frequency.exponentialRampToValueAtTime(3e3,n+.1),l(2e3,"sine",n+.05,.4,.2);break;case"miss":{const r=l(400,"sawtooth",n,.3,.1);r.filter.frequency.setValueAtTime(800,n),r.filter.frequency.exponentialRampToValueAtTime(100,n+.2),r.osc.frequency.linearRampToValueAtTime(100,n+.2)}break}}catch{}},pt="zbynekbal97@gmail.com",ht="test1@nexus.cz",At=()=>{const t=new Date().getHours();return t>=20||t<6};var me=(t=>(t.SCANNER="scanner",t.INVENTORY="inventory",t.MERCHANT="merchant",t.GENERATOR="generator",t.CHARACTERS="characters",t.DATABASE="database",t.ROOM="room",t.SETTINGS="settings",t.SPACESHIP="spaceship",t))(me||{});const hn=()=>{const[t,s]=a.useState(localStorage.getItem("nexus_current_user")),[h,n]=a.useState(!1),[l,r]=a.useState(!1),[c,x]=a.useState(!1),[g,f]=a.useState(!1),[y,v]=a.useState(!1),[m,j]=a.useState(At()),[I,A]=a.useState(null),[Y,w]=a.useState(100),[P,R]=a.useState(100),[J,te]=a.useState(100),[ie,ne]=a.useState(0),[L,u]=a.useState(0),[z,O]=a.useState(100),[W,Z]=a.useState(null),[F,X]=a.useState(null),[ae,C]=a.useState("scanner"),[U,N]=a.useState(null);a.useEffect(()=>{},[U]);const[p,D]=a.useState([]),[Q,le]=a.useState(!1),[be,ue]=a.useState(null),[ge,Pe]=a.useState(!0),[Ae,Ke]=a.useState(!0),[fe,M]=a.useState(null),[$,G]=a.useState([]),[ce,ye]=a.useState([]),[T,B]=a.useState(null),[d,K]=a.useState({id:"",isInRoom:!1,members:[],messages:[],nickname:"",isNicknameSet:!1,isGameStarted:!1,roundNumber:0,turnIndex:0,turnOrder:[],readyForNextRound:[],host:""}),[pe,je]=a.useState(!1),[we,Ce]=a.useState(""),Se=d.isInRoom&&d.isGameStarted&&d.turnOrder[d.turnIndex]===d.nickname,nt=d.isInRoom&&(!d.isGameStarted||!Se),[Te,rt]=a.useState(!1),[ve,Bs]=a.useState(!1),[Zt,qt]=a.useState(!1),[Yt,Jt]=a.useState(null),[Wt,Qt]=a.useState(null),Ks=a.useRef([]),Xt=a.useRef(Y),yt=a.useRef(!1),es=a.useRef(!1),ts=a.useRef(-1),wt=a.useRef(0);a.useEffect(()=>{d.isGameStarted||(yt.current=!1)},[d.isGameStarted]),a.useEffect(()=>{Xt.current=Y},[Y]),a.useEffect(()=>{(async()=>{const S=await Rs();f(S);const E=localStorage.getItem("nexus_current_user");if(E)if(s(E),n(E.toLowerCase()===pt.toLowerCase()),r(!E.includes("@")),E.includes("@"))try{const xe=await Et(E);G(xe)}catch{}else{const xe=localStorage.getItem("nexus_inv_guest");xe&&G(JSON.parse(xe))}x(localStorage.getItem("nexus_test_mode")==="true");const o=localStorage.getItem("nexus_master_catalog");o&&ye(JSON.parse(o));try{const xe=await os();ye(xe),localStorage.setItem("nexus_master_catalog",JSON.stringify(xe))}catch{}const V=localStorage.getItem("nexus_last_room_id"),H=localStorage.getItem("nexus_is_in_room")==="true",q=localStorage.getItem(`nexus_nickname_${E}`),he=localStorage.getItem(`nexus_class_${E||"guest"}`),Ne=localStorage.getItem(`nexus_character_${E}`);if(he&&Z(he),Ne)try{const xe=JSON.parse(Ne);if(X(xe),H||V==="solo"||localStorage.getItem("nexus_solo_mode")==="true"){let Le=xe.baseStats.hp,ke=xe.baseStats.mana,Ze=xe.baseStats.armor;const Tt=zt(xe,At());Le+=Tt.hp,ke+=Tt.mana,Ze+=Tt.armor,w(Le),R(ke),u(Ze)}}catch{}H&&V&&q&&K(xe=>({...xe,id:V,isInRoom:!0,nickname:q,isNicknameSet:!0}))})();const b=setInterval(()=>{j(I===null?At():I)},6e4);return()=>clearInterval(b)},[I]),a.useEffect(()=>{g&&t&&!l&&$.length>0},[g,t]),a.useEffect(()=>{t&&!l||l&&localStorage.setItem("nexus_inv_guest",JSON.stringify($))},[$,t,l]);const kt=c&&h?ht:t||"guest",Fs=()=>{const i=!c;x(i),localStorage.setItem("nexus_test_mode",String(i)),N(i?{id:"test-mode-"+Date.now(),message:"Testovac칤 re쬴m AKTIVN칈 (Editace povolena)",type:"warning"}:{id:"test-mode-"+Date.now(),message:"Testovac칤 re쬴m VYPNUT",type:"info"})};a.useEffect(()=>{t&&h&&lt()},[c]);const De=i=>{D(b=>[i,...b].slice(0,50))},it=(i,b,S)=>{if(!i)return i;let E={...i};if(S&&i.classVariants&&i.classVariants[S]){const o=i.classVariants[S];o!=null&&o.overrideDescription&&(E.description=o.overrideDescription),o!=null&&o.overrideTitle&&(E.title=o.overrideTitle),o!=null&&o.bonusStats&&(E.stats=[...E.stats||[],...o.bonusStats])}if(b&&i.timeVariant&&i.timeVariant.enabled){const o=i.timeVariant;o.nightDescription&&(E.description=o.nightDescription),o.nightTitle&&(E.title=o.nightTitle),o.nightType&&(E.type=o.nightType),o.nightFlavorText&&(E.flavorText=o.nightFlavorText),o.nightRarity&&(E.rarity=o.nightRarity),o.nightStats&&(E.stats=[...E.stats||[],...o.nightStats])}return E},lt=async()=>{v(!0);try{const i=await os();if(ye(i),localStorage.setItem("nexus_master_catalog",JSON.stringify(i)),t&&!l){const b=await Et(kt);G(b)}N({id:"refresh-ok-"+Date.now(),message:"Datab치ze a invent치콏 synchronizov치ny.",type:"success"}),k("success")}catch{N({id:"refresh-err-"+Date.now(),message:"Chyba synchronizace.",type:"error"}),k("error")}finally{v(!1)}},ct=async(i,b=!1)=>{v(!0);try{const S={...i};if(S.id||(S.id=`GEN-${Date.now()}`),t&&!l){const E=await Lt(kt,S);return G(b?o=>[...o,E]:o=>o.map(V=>V.id===E.id?E:V)),h&&ye(o=>o.find(H=>H.id===E.id)?o.map(H=>H.id===E.id?E:H):[...o,E]),E}else{const E=S;return G(b?o=>[...o,E]:o=>o.map(V=>V.id===E.id?E:V)),ye(o=>o.find(H=>H.id===E.id)?o.map(H=>H.id===E.id?E:H):[...o,E]),E}}catch(S){throw S}finally{v(!1)}},Xe=async i=>{if(G(b=>b.filter(S=>S.id!==i)),t&&!l)try{await Dt(kt,i)}catch{}},Zs=async(i,b,S,E)=>{try{const o=await an(i,b,S,E);N({id:"swap-ok",message:"V칳m캩na 칰sp캩코n치.",type:"success"}),k("success"),l?t===i||l&&i==="guest"?G(V=>[...V.filter(q=>q.id!==S),o.item2]):(t===b||l&&b==="guest")&&G(V=>[...V.filter(q=>q.id!==E),o.item1]):lt()}catch{N({id:"swap-err",message:"V칳m캩na selhala.",type:"error"}),k("error")}},Fe=i=>{w(b=>{const S=Math.min(150,Math.max(0,b+i));return S<b?(ue("red"),ee(200)):S>b&&ue("green"),d.isInRoom&&d.id&&ds(d.id,d.nickname,S),S}),setTimeout(()=>ue(null),300)},St=i=>R(b=>Math.min(100,Math.max(0,b+i))),ot=i=>te(b=>Math.min(100,Math.max(0,b+i))),et=i=>ne(b=>Math.max(0,b+i)),qs=async(i,b,S)=>{if(!b.every(o=>$.some(V=>V.id===o))&&!c){N({id:"craft-err",message:"Chyb칤 suroviny!",type:"error"});return}if(!c)for(const o of b){const V=$.find(H=>H.id===o);V&&await Xe(V.id)}await ct(S,!0),k("success"),N({id:"craft-ok",message:`Vyrobeno: ${S.title}`,type:"success"})},Ys=async i=>{v(!0);try{const b=$.find(o=>o.id===i);if(!b)return;const S=(b.planetProgress||0)+1,E={...b,planetProgress:S};await ct(E,!1),N({id:"scan-prog-"+Date.now(),message:`Postup v sektoru: ${S}`,type:"success"})}catch{}finally{v(!1)}},Js=async()=>{if(h&&confirm("OPRAVDU SMAZAT CEL칗 TESTOVAC칈 BATOH (test1@nexus.cz)? Tuto akci nelze vz칤t zp캩t.")){v(!0),k("error");try{const i=await Et(ht);await Promise.all(i.map(b=>Dt(ht,b.id))),G([]),localStorage.setItem(`nexus_inv_${ht}`,JSON.stringify([])),N({id:"wipe-ok",message:"Testovac칤 batoh byl kompletn캩 vymaz치n.",type:"success"}),k("success")}catch{N({id:"wipe-err",message:"Chyba p콏i maz치n칤 testovac칤ch dat.",type:"error"})}finally{v(!1)}}},Ws=async()=>{if(l){if(!confirm("VAROV츼N칈: Jste v re쬴mu Host. Vynucen치 synchronizace SMA콯E v코echna lok치ln칤 data a nen치vratn캩 ztrat칤te invent치콏. Pokra캜ovat?"))return;G([]),localStorage.removeItem("nexus_inv_guest"),localStorage.removeItem("nexus_master_catalog"),N({id:"hard-reset",message:"Lok치ln칤 data smaz치na.",type:"info"}),window.location.reload()}await lt()},zt=(i,b)=>{if(!i||!i.perks)return{hp:0,mana:0,armor:0,damage:0,critChance:0};let S={hp:0,mana:0,armor:0,damage:0,critChance:0};return i.perks.forEach(E=>{const o=E.effect.condition||"always";let V=!1;switch(o){case"always":V=!0;break;case"night":V=b;break;case"day":V=!b;break;case"combat":V=!1;break}if(V){const H=E.effect.stat,q=E.effect.modifier,he=E.effect.isPercentage;S.hasOwnProperty(H)&&(S[H]+=q)}}),S},Qs=async(i,b,S,E,o)=>{var V;if(localStorage.setItem(`nexus_nickname_${t}`,i),localStorage.setItem(`nexus_class_${t||"guest"}`,b),Z(b),o){X(o);let H=o.baseStats.hp,q=o.baseStats.mana,he=o.baseStats.armor;const Ne=zt(o,m);H+=Ne.hp,q+=Ne.mana,he+=Ne.armor,w(H),R(q),u(he),localStorage.setItem(`nexus_character_${t}`,JSON.stringify(o));const xe=((V=o.perks)==null?void 0:V.filter(Le=>{const ke=Le.effect.condition||"always";return ke==="always"||ke==="night"&&m||ke==="day"&&!m}))||[];if(xe.length>0){const Le=xe.map(ke=>ke.name).join(", ");setTimeout(()=>{N({id:"char-init-"+Date.now(),type:"success",message:`Postava ${o.name} p콏ipravena! Aktivn칤 perky: ${Le}`}),k("success")},1500)}}try{if(S==="solo"){je(!0),localStorage.setItem("nexus_solo_mode","true"),localStorage.setItem("nexus_is_in_room","false"),K(he=>({...he,nickname:i,isNicknameSet:!0,isInRoom:!1,id:""})),De(`Syst칠m aktivov치n. Batoh p콏ipraven, ${i}.`);return}let H="",q=!1;S==="create"||S==="solo-online"?(H=(S==="solo-online"?"SOLO-":"")+Math.random().toString(36).substring(2,7).toUpperCase(),await on(H,i,t||"guest",E),q=!0):(H=S.toUpperCase(),await dn(H,i,Y,E,t||void 0)),K(he=>({...he,id:H,nickname:i,isNicknameSet:!0,isInRoom:!0,host:q?i:he.host,members:q?[{name:i,email:t||"guest",hp:100,isReady:!1}]:he.members})),localStorage.setItem("nexus_last_room_id",H),localStorage.setItem("nexus_is_in_room","true"),je(S==="solo-online"),localStorage.setItem("nexus_solo_mode",S==="solo-online"?"true":"false"),S==="solo-online"&&setTimeout(async()=>{try{await cs(H)}catch{}},1e3),De(`${S==="create"?"Sektor zalo쬰n":"Vstup do sektoru"}: ${H} `)}catch(H){throw N({id:"room-err",type:"error",message:H.message}),H}},ss=async()=>{d.id&&d.nickname&&await xs(d.id,d.nickname),K(i=>({...i,isInRoom:!1,id:""})),localStorage.removeItem("nexus_last_room_id"),localStorage.removeItem("nexus_is_in_room"),je(!0),localStorage.setItem("nexus_solo_mode","true"),D([])},Xs=async()=>{if(d.id&&d.nickname)try{await xs(d.id,d.nickname)}catch{}K(i=>({...i,isInRoom:!1,id:"",isNicknameSet:!1})),localStorage.removeItem("nexus_last_room_id"),localStorage.removeItem("nexus_is_in_room"),je(!1),localStorage.setItem("nexus_solo_mode","false"),D([])},ea=async()=>{if(!d.id||!d.nickname)return;const i=d.members.find(S=>S.name===d.nickname),b=!(i!=null&&i.isReady);try{await xn(d.id,d.nickname,b),K(S=>({...S,members:S.members.map(E=>E.name===S.nickname?{...E,isReady:b}:E)})),k("success")}catch{}},ta=async i=>{if(!(!d.id||!d.nickname))try{await cn(d.id,d.nickname,i)}catch{}},sa=async i=>{le(!0);try{let b=ce.find(S=>S.id===i);b||(b=await $t(pt,i)),b?(M(it(b,m,W)),De(`Inspekce: ${b.title} `)):N({id:"inspect-err",type:"error",message:"Data assetu nelze dek칩dovat."})}catch{N({id:"inspect-err",type:"error",message:"Chyba spojen칤 s Batohem."})}finally{le(!1)}};a.useEffect(()=>{ae==="room"&&d.isInRoom&&d.id&&g&&(async()=>{try{const b=await It(d.id),S=await ms(d.id);K(E=>({...E,members:b.members,turnOrder:b.turnOrder,turnIndex:b.turnIndex,messages:S,isGameStarted:b.isGameStarted,roundNumber:b.roundNumber,readyForNextRound:b.readyForNextRound,host:b.host}))}catch{}})()},[ae,d.isInRoom,d.id,g]),a.useEffect(()=>{if(!d.isInRoom||!d.id||!g)return;const i=setInterval(async()=>{var b,S,E;try{const o=await It(d.id),V=await ms(d.id);if(Ks.current=o.members,!o.members.some(Ne=>Ne.name===d.nickname)&&d.isInRoom){N({id:"kicked",type:"error",message:"游뛂 Byl jsi vyhozen ze sektoru."}),ss();return}o.isGameStarted&&!yt.current&&(N({id:"game-start",type:"success",message:"游 MISE ZAH츼JENA! Sektor byl uzam캜en."}),k("success"),yt.current=!0);const q=(b=o.turnOrder)==null?void 0:b[o.turnIndex],he=o.turnIndex;if(he!==ts.current&&(es.current=!1,ts.current=he,o.isGameStarted&&q===d.nickname&&(N({id:"your-turn-"+Date.now(),type:"warning",message:"丘멆잺 JSI NA TAHU!"}),k("open"),ee([100,50,100]),es.current=!0)),K(Ne=>({...Ne,members:o.members,turnIndex:o.turnIndex,messages:V,isGameStarted:o.isGameStarted,roundNumber:o.roundNumber,turnOrder:o.turnOrder,readyForNextRound:o.readyForNextRound,host:o.host})),o.activeEncounter&&(!fe||fe.id!==o.activeEncounter.id)){const Ne=it(o.activeEncounter,m,W);M(Ne),wt.current=Date.now(),k("error"),ee([200,100,200])}await ds(d.id,d.nickname,Xt.current)}catch(o){((S=o.message)!=null&&S.includes("404")||(E=o.message)!=null&&E.includes("Sektor nenalezen"))&&(K(V=>({...V,isInRoom:!1,id:""})),localStorage.setItem("nexus_is_in_room","false"))}},1500);return()=>clearInterval(i)},[d.isInRoom,d.id,d.nickname,l,g,fe]);const aa=async i=>{if(d.host===d.nickname)try{await sn(d.id,i,"kick",null),N({id:"kick-ok",type:"success",message:`${i} byl odstran캩n.`}),k("success");const b=await It(d.id);K(S=>({...S,members:b.members,turnOrder:b.turnOrder}))}catch{}},na=async()=>{if(d.host===d.nickname)try{await cs(d.id),K(i=>({...i,isGameStarted:!0})),k("success")}catch{}},ra=async i=>{var E;if(nt&&!i.startsWith("friend:")){const o=d.isGameStarted?"NEM콡콯E SKENOVAT: Nejse코 na tahu!":"MISE NEZA캛ALA: 캛ekejte na hostitele.";N({id:"block",type:"error",message:o}),ee([100,50,100]),k("error");return}if(J<=0&&!i.startsWith("friend:")){N({id:"no-fuel",type:"error",message:"NEDOSTATEK PALIVA: Lo캞 nem콢쬰 man칠vrovat (skenovat)."}),k("error"),ee([200,200,200]);return}if(le(!0),ee(50),k("scan"),i.toUpperCase().startsWith("CHAR-"))try{const o=await Vt(i.toUpperCase());if(o){X(o);let V=o.baseStats.hp,H=o.baseStats.mana,q=o.baseStats.armor;const he=zt(o,m);V+=he.hp,H+=he.mana,q+=he.armor,w(V),R(H),u(q),Z(o.name),localStorage.setItem(`nexus_character_${t}`,JSON.stringify(o)),ue("blue");const Ne=((E=o.perks)==null?void 0:E.filter(ke=>{const Ze=ke.effect.condition||"always";return Ze==="always"||Ze==="night"&&m||Ze==="day"&&!m}))||[],xe=Ne.map(ke=>ke.name).join(", "),Le=Ne.length>0?`Postava ${o.name} aktivov치na! Aktivn칤 perky: ${xe}`:`Postava ${o.name} aktivov치na! (콯치dn칠 aktivn칤 perky)`;setTimeout(()=>{ue(null),N({id:`char-loaded-${Date.now()}`,type:"success",message:Le}),k("success"),De(`Postava aktivov치na: ${o.name}`)},300),le(!1);return}}catch{}const b=$.find(o=>o.id.split("__")[0].toLowerCase()===i.toLowerCase()||o.id.toLowerCase()===i.toLowerCase());if(b){Ct(b,"scanner");return}const S=ce.find(o=>o.id.toLowerCase()===i.toLowerCase());if(S){Ct(S,"scanner");return}if(navigator.onLine)try{const o=await $t(pt,i);if(o){Ct(o,"scanner");return}}catch{}le(!1),N({id:"not-found-"+Date.now(),type:"error",message:"ID karty nenalezeno."}),k("error")},Ct=(i,b=null)=>{b==="scanner"&&(ot(-5),De("Man칠vr lodi: -5 % Paliva"));const S=it(i,m,W);if(S.type===se.SPACE_STATION&&b==="scanner"){le(!1),qt(!0),M(S),wt.current=Date.now();return}M(S),wt.current=Date.now(),S.type===se.DILEMA&&S.dilemmaScope==="GLOBAL"&&d.isInRoom&&us(d.id,i),De(b==="scanner"?`Skenov치no: ${S.title} `:`Zobrazeno: ${S.title} `),le(!1)},ia=()=>{qt(!1),fe&&fe.type===se.SPACE_STATION&&(Jt(fe),M(null),De(`Dokov치no: ${fe.title} `),k("success"))},dt=(i=!1)=>{(fe==null?void 0:fe.dilemmaScope)==="GLOBAL"&&d.isInRoom&&us(d.id,null);const b=Se&&d.isGameStarted;M(null),i===!0&&b&&as()},la=async i=>{if(nt){const S=d.isGameStarted?"NEM콡콯E HR츼T: Nejse코 na tahu!":"MISE NEZA캛ALA: 캛ekejte na hostitele.";N({id:"block-use",type:"error",message:S});return}if(i.isSellOnly){N({id:"sell-only",message:"Tento p콏edm캩t nelze pou쮂셦, pouze prodat.",type:"error"});return}if(i.type===se.MERCHANT){Qt(i),dt(),k("open");return}let b=!1;i.stats&&i.stats.length>0&&i.stats.forEach(S=>{const o=String(S.value).replace(/[^0-9-]/g,""),V=parseInt(o),H=String(S.label).toUpperCase().trim();!isNaN(V)&&V!==0&&(["HP","ZDRAV칈","HEAL"].some(q=>H.includes(q))?(Fe(V),b=!0):["MANA","ENERGIE"].some(q=>H.includes(q))?(St(V),b=!0):["PALIVO","FUEL"].some(q=>H.includes(q))?(ot(V),b=!0):["GOLD","ZLATO"].some(q=>H.includes(q))?(et(V),b=!0):["O2","KYSL칈K"].some(q=>H.includes(q))?(O(q=>Math.min(100,Math.max(0,q+V))),b=!0):["ARMOR","BRN캨N칈"].some(q=>H.includes(q))&&(u(q=>Math.max(0,q+V)),b=!0))}),b?(k("heal"),N({id:"use-success-"+Date.now(),message:"P콏edm캩t pou쬴t.",type:"success"}),i.isConsumable&&await Xe(i.id),dt(!0)):i.isConsumable?(await Xe(i.id),N({id:"consumed",message:"P콏edm캩t spot콏ebov치n.",type:"info"}),dt(!0)):(N({id:"no-effect",message:"Tento p콏edm캩t nem치 쮂멳n칳 okam쬴t칳 efekt.",type:"info"}),ee(50))},ca=(i,b)=>{var S;b==="success"?((S=i.rewards)==null||S.forEach(E=>{E.type==="HP"&&Fe(E.value),E.type==="MANA"&&St(E.value),E.type==="GOLD"&&et(E.value)}),i.effectType==="hp"&&Fe(i.effectValue||0)):i.failDamage&&Fe(-i.failDamage)},as=async()=>{if(d.id)try{await ln(d.id),Bs(!1)}catch{}};return{userEmail:t,isAdmin:h,isGuest:l,isServerReady:g,setIsServerReady:f,isNight:m,adminNightOverride:I,setAdminNightOverride:A,activeTab:ae,setActiveTab:C,currentEvent:fe,setCurrentEvent:M,editingEvent:T,setEditingEvent:B,screenFlash:be,inventory:$,isRefreshing:y,notification:U,setNotification:N,showEndTurnPrompt:ve,playerHp:Y,playerMana:P,playerFuel:J,playerGold:ie,playerArmor:L,playerOxygen:z,playerClass:W,setPlayerArmor:u,setPlayerOxygen:O,roomState:d,isSoloMode:pe,giftTarget:we,setGiftTarget:Ce,activeCharacter:F,isScannerPaused:!!fe||Te||Zt||!!Yt||!!Wt,isAIThinking:Q,showRoundEndAlert:Te,handleAcknowledgeRound:async()=>{if(d.id&&d.nickname)try{await nn(d.id,d.nickname),rt(!1)}catch{}},isMyTurn:Se,isBlocked:nt,handleStartGame:na,isDocking:Zt,handleDockingComplete:ia,activeStation:Yt,handleLeaveStation:()=>{Jt(null),k("open")},handleClaimStationRewards:i=>{i.stationConfig&&(i.stationConfig.fuelReward&&ot(i.stationConfig.fuelReward),i.stationConfig.repairAmount&&Fe(i.stationConfig.repairAmount),i.stationConfig.refillO2&&O(100),k("success"),N({id:"station-reward",type:"success",message:"Servis dokon캜en."}))},activeMerchant:Wt,setActiveMerchant:Qt,handleBuyItem:async i=>{et(-(i.price||0)),await ct(i,!1),k("success"),N({id:"buy-success",type:"success",message:`Zakoupeno: ${i.title} `})},handleSellItem:async(i,b)=>{et(b),await Xe(i.id),k("success"),N({id:"sell-success",type:"success",message:`Prod치no: ${i.title} (+${b} G)`})},masterCatalog:ce,handleLogin:(i,b)=>{localStorage.setItem("nexus_current_user",i),b&&(localStorage.setItem(`nexus_nickname_${i}`,b),K(E=>({...E,nickname:b}))),s(i),n(i.toLowerCase()===pt.toLowerCase());const S=!i.includes("@");r(S),f(S)},handleLogout:()=>{localStorage.clear(),sessionStorage.clear(),window.location.reload()},handleScanCode:ra,handleSaveEvent:ct,handlePlanetProgress:Ys,handleDeleteEvent:Xe,handleUseEvent:la,handleRefreshDatabase:lt,handleGameSetup:Qs,handleLeaveRoom:ss,handleKickPlayer:aa,handleExitToMenu:Xs,handleResolveDilemma:ca,handleEndTurn:as,handleSendMessage:ta,closeEvent:dt,handleHpChange:Fe,handleManaChange:St,handleGoldChange:et,handleFuelChange:ot,handleOpenInventoryItem:i=>{h&&!c?(B(i),C("generator")):M(i)},getAdjustedItem:it,handleSwapItems:Zs,soundEnabled:ge,vibrationEnabled:Ae,handleToggleSound:()=>{mn(!ge),Pe(!ge)},handleToggleVibration:()=>{un(!Ae),Ke(!Ae)},handleInspectItem:sa,handleCraftItem:qs,handleHardReset:Ws,handleWipeTestVault:Js,scanLog:p,isTestMode:c,toggleTestMode:Fs,handleToggleReady:ea,handleSwitchToOffline:()=>{r(!0),f(!0),N({id:"offline-mode-"+Date.now(),message:"Nouzov칳 re쬴m AKTIVN칈 (Offline)",type:"warning"})}}},Ms=({onScanCode:t,isAIThinking:s,isPaused:h})=>{const[n,l]=a.useState("idle"),[r,c]=a.useState(""),[x,g]=a.useState(!1),[f,y]=a.useState(""),v=a.useRef(null),m=a.useRef(!1);a.useEffect(()=>(v.current=new Ja("qr-reader",{verbose:!1}),()=>{I()}),[]),a.useEffect(()=>{(h||s)&&m.current&&I()},[h,s]);const j=async()=>{if(!(!v.current||m.current))try{l("active"),m.current=!0,await v.current.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250},aspectRatio:1,formatsToSupport:[xt.QR_CODE,xt.EAN_13,xt.CODE_128,xt.CODE_39]},A=>{h||s||(t(A),ee(50))},()=>{})}catch(A){l("error"),c(A.message||"P콏칤stup ke kame콏e zam칤tnut."),m.current=!1}},I=async()=>{if(v.current&&m.current)try{await v.current.stop(),v.current.clear()}catch{}finally{m.current=!1,l("idle")}};return e.jsxs("div",{className:"relative h-full w-full bg-black flex flex-col items-center justify-center p-6",children:[e.jsx("div",{className:"absolute top-10 left-0 right-0 z-20 flex justify-center pointer-events-none",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur px-4 py-2 border border-white/10 rounded-full flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${n==="active"?"bg-green-500 animate-pulse":"bg-red-500"}`}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-white/70",children:s?"AI_DEK칍DOV츼N...":n==="active"?"OPTIKA_AKTIVN칈":"SENZOR_OFFLINE"})]})}),e.jsxs("div",{className:"relative w-full aspect-square max-w-sm",children:[e.jsx("div",{className:"absolute -inset-2 border-2 border-signal-cyan/20 rounded-3xl pointer-events-none z-10"}),e.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-signal-cyan rounded-tl-xl z-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-signal-cyan rounded-tr-xl z-10"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-signal-cyan rounded-bl-xl z-10"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-signal-cyan rounded-br-xl z-10"}),e.jsxs("div",{className:"w-full h-full bg-zinc-900 rounded-2xl overflow-hidden relative shadow-2xl",children:[e.jsx("div",{id:"qr-reader",className:"w-full h-full object-cover"}),n!=="active"&&e.jsxs("div",{className:"absolute inset-0 z-20 flex flex-col items-center justify-center p-10 text-center gap-6 bg-zinc-900",children:[n==="error"?e.jsx(Ie,{className:"w-12 h-12 text-red-500"}):e.jsx(bs,{className:"w-12 h-12 text-white/20"}),e.jsx("p",{className:"text-xs text-white/40 uppercase font-bold tracking-widest leading-relaxed",children:n==="error"?r:"Kamera v pohotovostn칤m re쬴mu"}),e.jsxs("button",{onClick:j,className:"button-primary py-3 px-8 text-xs relative overflow-hidden group",children:[e.jsx("span",{className:"relative z-10",children:n==="error"?"Zkusit znovu":"Aktivovat Senzor"}),e.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform"})]})]}),e.jsx(de,{children:s&&e.jsxs(_.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-30 bg-signal-cyan/20 backdrop-blur-sm flex flex-col items-center justify-center gap-4",children:[e.jsx(Ve,{className:"w-12 h-12 text-white animate-spin"}),e.jsx("span",{className:"text-xs font-black text-white uppercase tracking-[0.3em]",children:"Analyzuji_Data..."})]})})]})]}),e.jsxs("button",{onClick:()=>g(!0),className:"mt-12 flex items-center gap-3 text-white/40 hover:text-white transition-colors text-xs font-bold uppercase tracking-widest active:scale-95",children:[e.jsx(Ht,{className:"w-5 h-5"})," Manu치ln칤 Identifikace"]}),e.jsx(de,{children:x&&e.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-xl flex items-center justify-center p-8",children:e.jsxs("div",{className:"w-full max-w-xs space-y-6",children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase text-center tracking-widest",children:"Zadejte_ID"}),e.jsx("input",{type:"text",autoFocus:!0,value:f,onChange:A=>y(A.target.value),placeholder:"NAP콎. ITEM-01",className:"w-full bg-white/5 border border-white/10 p-4 text-white text-center text-xl font-mono uppercase rounded-xl outline-none focus:border-signal-cyan placeholder-white/20"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>g(!1),className:"flex-1 py-4 text-xs font-bold text-white/40 uppercase hover:text-white transition-colors",children:"Zru코it"}),e.jsx("button",{onClick:()=>{t(f),g(!1)},className:"flex-1 button-primary py-4 text-xs shadow-lg shadow-signal-amber/20",children:"Potvrdit"})]})]})})}),e.jsx("style",{children:`
        #qr-reader video { 
            object-fit: cover; 
            width: 100%; 
            height: 100%; 
            border-radius: 1rem;
        }
      `})]})},ps=["Inicializace protokolu...","Hled치n칤 sign치lu Nexus...","Propojov치n칤.##.%./*_#..","Ov캩콏ov치n칤 integrity dat...","Navazov치n칤 zabezpe캜en칠ho spojen칤..."],Ps=({onConnected:t,onSwitchToOffline:s})=>{const[h,n]=a.useState(0),[l,r]=a.useState(1),[c,x]=a.useState(!1),[g,f]=a.useState(!navigator.onLine);return a.useEffect(()=>{const y=()=>f(!navigator.onLine);window.addEventListener("online",y),window.addEventListener("offline",y);const v=setInterval(()=>{n(m=>(m+1)%ps.length)},3e3);return()=>{window.removeEventListener("online",y),window.removeEventListener("offline",y),clearInterval(v)}},[]),a.useEffect(()=>{let y=!0,v;const m=async()=>{if(y){if(!navigator.onLine){x(!0);return}try{if(await Rs()&&y){t();return}}catch{}y&&(r(j=>j+1),l>3&&x(!0),v=setTimeout(m,2500))}};return m(),()=>{y=!1,clearTimeout(v)}},[t,l]),e.jsxs("div",{className:"fixed inset-0 z-[200] bg-zinc-950 flex flex-col items-center justify-center p-6 text-white font-sans overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 z-0 opacity-10 pointer-events-none",style:{backgroundImage:"radial-gradient(#222 1px, transparent 1px)",backgroundSize:"20px 20px"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center max-w-sm w-full",children:[e.jsxs("div",{className:"relative mb-12",children:[e.jsx(_.div,{animate:{scale:[1,2.5],opacity:[.5,0]},transition:{duration:2,repeat:1/0,ease:"easeOut"},className:`absolute inset-0 ${g?"bg-amber-500/20":"bg-neon-blue/20"} rounded-full blur-md`}),e.jsxs("div",{className:`relative w-24 h-24 bg-zinc-900 rounded-2xl border ${g?"border-amber-500/50":"border-zinc-700"} flex items-center justify-center shadow-[0_0_30px_rgba(0,243,255,0.2)]`,children:[g?e.jsx(ma,{className:"w-10 h-10 text-amber-500"}):e.jsx(ua,{className:"w-10 h-10 text-neon-blue"}),e.jsx("div",{className:"absolute -top-1 -right-1",children:e.jsxs("span",{className:"relative flex h-3 w-3",children:[e.jsx("span",{className:`animate-ping absolute inline-flex h-full w-full rounded-full ${g?"bg-amber-500":"bg-green-500"} opacity-75`}),e.jsx("span",{className:`relative inline-flex rounded-full h-3 w-3 ${g?"bg-amber-500":"bg-green-500"}`})]})})]})]}),e.jsx("div",{className:"w-full h-1 bg-zinc-900 rounded-full overflow-hidden mb-6 relative",children:e.jsx(_.div,{animate:{x:["-100%","100%"]},transition:{duration:1.5,repeat:1/0,ease:"linear"},className:`absolute inset-y-0 left-0 w-1/2 bg-gradient-to-r from-transparent ${g?"via-amber-500":"via-neon-blue"} to-transparent`})}),e.jsx("h2",{className:"text-xl font-display font-bold uppercase tracking-widest mb-2 text-center",children:g?"OFFLINE_RE콯IM":"P콎IPOJOV츼N칈"}),e.jsx(_.p,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"text-xs text-zinc-500 font-mono uppercase tracking-wider text-center h-4",children:g?"Lok치ln칤 protokoly aktivn칤":ps[h]},h),e.jsxs("div",{className:"mt-8 flex gap-4 text-[10px] text-zinc-600 font-mono uppercase",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pa,{className:`w-3 h-3 ${g?"":"animate-spin"}`}),e.jsx("span",{children:g?"Senzory vypnuty":`Pokus #${l}`})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Gt,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{children:"Local_Vault OK"})]})]}),c&&e.jsxs(_.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},onClick:s,className:"mt-12 py-4 px-8 bg-amber-500/10 border border-amber-500/40 hover:bg-amber-500/20 rounded-xl flex items-center gap-3 text-xs font-black uppercase tracking-widest text-amber-500 hover:text-white transition-all shadow-[0_0_20px_rgba(245,158,11,0.1)]",children:[e.jsx(ha,{className:"w-5 h-5"}),"Aktivovat Offline Nasazen칤"]})]})]})},fn=({onLogin:t})=>{const[s,h]=a.useState(""),[n,l]=a.useState(!1),[r,c]=a.useState(!1),[x,g]=a.useState(null),f=m=>{if(m.preventDefault(),s.trim().length<3){g("Identifik치tor (Nick) mus칤 m칤t alespo켿 3 znaky."),ee(100),k("error");return}g(null),c(!0)},y=()=>{c(!1),k("click"),localStorage.setItem("nexus_nickname_guest",s.toUpperCase()),l(!0),setTimeout(()=>{t("guest",s.toUpperCase())},1500)},v=async m=>{if(m.credential){l(!0),g(null),k("click");try{const j=await rn(m.credential);ee([50,50]),t(j.email)}catch(j){l(!1);let I="Chyba Google ov캩콏en칤.";j.message&&j.message.includes("Failed to fetch")?I="Nelze se spojit se serverem (Backend sp칤 nebo blokov치n).":j.message&&(I=`Server Error: ${j.message}`),g(I),k("error")}}};return n?e.jsx(Ps,{onConnected:()=>{},onSwitchToOffline:()=>{l(!1),g("Odkaz p콏eru코en.")}}):e.jsxs("div",{className:"h-screen w-screen bg-[#0a0b0d] flex flex-col items-center justify-center p-8 relative overflow-hidden font-sans",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-5 z-0",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"30px 30px"}}),e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-10",children:e.jsxs("div",{className:"flex justify-between w-full p-8 font-mono text-[10px] text-signal-cyan",children:[e.jsx("span",{children:"SIGN츼L: VYHLED츼V츼N칈..."}),e.jsx("span",{children:"POZ: HLAVN칈_BR츼NA"})]})}),e.jsxs(_.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},className:"w-full max-w-sm z-10",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"relative inline-block mb-8",children:e.jsxs("div",{className:"w-24 h-24 tactical-card flex items-center justify-center border-signal-cyan/40 bg-black/40",children:[e.jsx("div",{className:"corner-accent top-left !border-2"}),e.jsx("div",{className:"corner-accent bottom-right !border-2"}),e.jsx(Ut,{className:"w-12 h-12 text-signal-cyan"})]})}),e.jsx("h1",{className:"text-5xl font-black text-white tracking-tighter uppercase mb-2 chromatic-text",children:"Nexus_Auth"}),e.jsx("p",{className:"text-signal-cyan font-mono text-[10px] uppercase tracking-[0.5em] font-black",children:"Hybridn칤 deskov치 hra"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 justify-center",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-green-500",children:"Doporu캜eno: Cloud Save (V코echna za콏칤zen칤)"})]}),e.jsx("div",{className:"flex flex-col justify-center gap-2",children:e.jsx(Wa,{onSuccess:v,onError:()=>g("Google Login selhal na 칰rovni klienta."),theme:"filled_black",shape:"pill",size:"large",text:"signin_with",width:"100%"})})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"h-px bg-white/10 flex-1"}),e.jsx("span",{className:"text-[10px] text-white/30 uppercase font-mono tracking-widest font-black",children:"NEBO HOST (LOCAL SAVE)"}),e.jsx("div",{className:"h-px bg-white/10 flex-1"})]}),e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[11px] font-black text-white/50 uppercase tracking-[0.2em] ml-1 font-mono flex justify-between",children:[e.jsx("span",{children:"Identifikace Jednotky"}),e.jsxs("span",{className:"text-zinc-500 flex items-center gap-1",children:[e.jsx(fa,{className:"w-3 h-3"})," Ukl치d치n칤 v prohl칤쬰캜i"]})]}),e.jsx("div",{className:"tactical-card p-0 overflow-hidden border-white/10 focus-within:border-white/40 transition-colors bg-white/5",children:e.jsxs("div",{className:"flex items-center px-5 py-5 gap-4",children:[e.jsx(gs,{className:"w-6 h-6 text-zinc-500"}),e.jsx("input",{type:"text",required:!0,value:s,onChange:m=>h(m.target.value),className:"w-full bg-transparent text-white placeholder-white/20 focus:outline-none font-mono text-sm uppercase font-bold",placeholder:"ZADEJTE P콎EZD칈VKU...",maxLength:12})]})})]}),x&&e.jsxs("div",{className:"p-4 bg-signal-hazard/10 border border-signal-hazard/40 text-signal-hazard text-[11px] uppercase font-black tracking-widest text-center animate-pulse",children:[e.jsx(Ie,{className:"w-4 h-4 inline mr-2 mb-0.5"})," ",x]}),e.jsxs("button",{type:"submit",className:"w-full py-5 border border-white/10 bg-zinc-900 hover:bg-zinc-800 text-white font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-3 transition-all active:scale-95",children:[e.jsx(Bt,{className:"w-4 h-4 text-zinc-500"}),"Vstoupit jako Host",e.jsx(at,{className:"w-4 h-4 text-zinc-500"})]})]})]}),e.jsx(de,{children:r&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-[#0a0b0d]/95 backdrop-blur-md flex items-center justify-center p-6",children:e.jsxs(_.div,{initial:{scale:.96,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.96,opacity:0},className:"tactical-card w-full max-w-sm border-zinc-700 p-0 overflow-hidden bg-black/90 shadow-2xl",children:[e.jsxs("div",{className:"bg-zinc-900 p-8 border-b border-white/10 flex items-center gap-6",children:[e.jsx(Gt,{className:"w-12 h-12 text-zinc-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tighter leading-none",children:"Lok치ln칤 Profil"}),e.jsx("p",{className:"text-zinc-500 font-mono text-[10px] uppercase tracking-[0.4em] font-black mt-2",children:"Database Access: OK"})]})]}),e.jsxs("div",{className:"p-8 space-y-6 text-[12px] text-white/70 leading-relaxed font-sans",children:[e.jsxs("div",{className:"p-4 bg-blue-900/20 border border-blue-500/30 rounded-sm",children:[e.jsxs("p",{className:"text-blue-400 font-black uppercase tracking-widest mb-2 flex items-center gap-2 text-xs",children:[e.jsx(Kt,{className:"w-4 h-4"})," Status: Online"]}),e.jsxs("p",{children:["Jako ",e.jsx("span",{className:"text-white font-bold",children:"HOST"})," m치te p콏칤stup k datab치zi karet a online funkc칤m. V치코 invent치콏 se v코ak ukl치d치 pouze do ",e.jsx("span",{className:"text-white font-bold",children:"tohoto za콏칤zen칤"}),"."]})]}),e.jsxs("ul",{className:"space-y-4 font-bold text-zinc-400",children:[e.jsxs("li",{className:"flex gap-4",children:[e.jsx(jt,{className:"w-4 h-4 text-green-500 shrink-0 mt-0.5"}),e.jsx("span",{children:"P콏칤stup k Master Datab치zi karet."})]}),e.jsxs("li",{className:"flex gap-4",children:[e.jsx(Ie,{className:"w-4 h-4 text-orange-500 shrink-0 mt-0.5"}),e.jsx("span",{children:"콯치dn치 synchronizace mezi za콏칤zen칤mi (Cloud Save)."})]})]})]}),e.jsxs("div",{className:"p-8 bg-black border-t border-white/10 flex flex-col gap-3",children:[e.jsx("button",{onClick:y,className:"button-primary w-full py-4 text-xs !bg-zinc-200 !text-black",children:"Rozum칤m, Spustit Misi"}),e.jsx("button",{onClick:()=>c(!1),className:"w-full py-3 text-zinc-500 hover:text-white text-[10px] uppercase font-black tracking-[0.2em] transition-colors",children:"Zp캩t"})]})]})})})]})},bn=({onComplete:t})=>{const[s,h]=a.useState("init"),[n,l]=a.useState(0);a.useEffect(()=>{const c=setTimeout(()=>{r()},1500);return()=>clearTimeout(c)},[]);const r=()=>{h("boot"),k("open"),ee([40,40])};return a.useEffect(()=>{if(s==="boot"){const c=setInterval(()=>{l(x=>x>=100?(clearInterval(c),setTimeout(()=>{h("complete"),k("success"),ee([100,50,100]),setTimeout(t,1400)},500),100):x+2)},35);return()=>clearInterval(c)}},[s]),e.jsx("div",{className:"fixed inset-0 z-[9999] bg-[#0a0b0d] flex flex-col items-center justify-center font-sans overflow-hidden p-6",children:e.jsxs(de,{mode:"wait",children:[s==="init"&&e.jsxs(_.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,y:20},className:"flex flex-col items-center gap-10 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx(_.div,{animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{repeat:1/0,duration:2.5},className:"absolute inset-0 bg-[#00f2ff]/20 blur-3xl rounded-full"}),e.jsx("div",{className:"w-24 h-24 border-2 border-[#ff9d00] rounded-full flex items-center justify-center shadow-[0_0_30px_rgba(255,157,0,0.25)] relative z-10 bg-[#0a0b0d]",children:e.jsx(ba,{className:"w-10 h-10 text-[#ff9d00]"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-[#00f2ff] font-mono text-[9px] uppercase tracking-[0.4em] mb-2 font-bold opacity-80",children:"NEXUS // J츼DRO_S칈T캨"}),e.jsx("h1",{className:"text-3xl font-black uppercase tracking-tighter chromatic-text leading-none",children:"Syst칠m_P콏ipraven"})]}),e.jsx("div",{className:"text-signal-cyan font-mono text-[9px] uppercase tracking-[0.2em] font-black animate-pulse opacity-50",children:"Navazov치n칤 spojen칤..."})]})]},"init"),s==="boot"&&e.jsxs(_.div,{initial:{opacity:0},animate:{opacity:1},className:"w-full max-w-[280px] flex flex-col items-center gap-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[e.jsx(Bt,{className:"w-12 h-12 text-[#00f2ff] animate-pulse"}),e.jsx("span",{className:"text-[#00f2ff] font-mono text-[10px] uppercase tracking-[0.3em] font-black",children:"Probouzen칤_S칤t캩"})]}),e.jsxs("div",{className:"w-full space-y-3",children:[e.jsxs("div",{className:"flex justify-between font-mono text-[10px] text-[#ff9d00] font-bold",children:[e.jsx("span",{children:"ZAV츼D캨N칈_PROTOKOL콡"}),e.jsxs("span",{className:"tabular-nums",children:[n,"%"]})]}),e.jsx("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden border border-white/5",children:e.jsx(_.div,{initial:{width:0},animate:{width:`${n}%`},className:"h-full bg-gradient-to-r from-[#ff9d00] to-[#fff] shadow-[0_0_10px_rgba(255,157,0,0.8)]"})})]}),e.jsxs("div",{className:"text-[9px] font-mono text-white/30 uppercase tracking-[0.2em] text-center leading-relaxed font-bold",children:["Na캜칤t치n칤_Taktick칳ch_Vrstev...",e.jsx("br",{}),"Kalibrace_Sign치ln칤_Matice..."]})]},"boot"),s==="complete"&&e.jsxs(_.div,{initial:{scale:1.1,opacity:0},animate:{scale:1,opacity:1},className:"flex flex-col items-center gap-6",children:[e.jsxs("div",{className:"p-8 tactical-card border-[#00f2ff] shadow-[0_0_50px_rgba(0,242,255,0.15)] bg-black/80",children:[e.jsx("div",{className:"corner-accent top-left !border-4"}),e.jsx("div",{className:"corner-accent bottom-right !border-4"}),e.jsx(Ut,{className:"w-16 h-16 text-[#00f2ff]"})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-3xl font-black uppercase tracking-[0.1em] chromatic-text",children:"Autorizov치no"}),e.jsx("p",{className:"text-[#00f2ff] font-mono text-[11px] uppercase tracking-[0.3em] font-black opacity-80",children:"Jednotka_Aktivn칤_V_Sektoru"})]})]},"complete")]})})},gn=({initialNickname:t,onConfirmSetup:s,isGuest:h})=>{const[n,l]=a.useState(t?"class":"nickname"),[r,c]=a.useState(t||""),[x,g]=a.useState(null),[f,y]=a.useState(""),[v,m]=a.useState(!1),[j,I]=a.useState(null),[A,Y]=a.useState(""),[w,P]=a.useState(null),[R,J]=a.useState(!1),[te,ie]=a.useState(!1),[ne,L]=a.useState(!1),[u,z]=a.useState(""),[O,W]=a.useState(!1),[Z,F]=a.useState(!1),X=p=>{p.preventDefault(),r.trim().length>=3&&l("class")},ae=p=>{g(p),setTimeout(()=>l("action"),300)},C=async p=>{if(x){if(p==="join_mode"){z(""),I(null),l("join");return}m(!0),I(null);try{await s(r,x,p,p==="create"&&Z?u:void 0,w)}catch{m(!1)}}},U=async p=>{if(p.preventDefault(),!(!f.trim()||!x)){m(!0),I(null);try{await s(r,x,f.toUpperCase().trim(),u||void 0,w)}catch(D){I(D.message||"Nepoda콏ilo se p콏ipojit. Zkontrolujte ID m칤stnosti."),m(!1)}}},N=[{id:Oe.WARRIOR,icon:e.jsx(js,{className:"w-6 h-6"}),desc:"Mistr boje zbl칤zka. Vysok치 odolnost.",color:"text-red-500",border:"border-red-500"},{id:Oe.MAGE,icon:e.jsx(Ns,{className:"w-6 h-6"}),desc:"Vid칤 magick칠 aury a skryt칠 zpr치vy.",color:"text-blue-400",border:"border-blue-400"},{id:Oe.ROGUE,icon:e.jsx(vs,{className:"w-6 h-6"}),desc:"Najde loot tam, kde ostatn칤 vid칤 st칤n.",color:"text-green-500",border:"border-green-500"},{id:Oe.CLERIC,icon:e.jsx(ys,{className:"w-6 h-6"}),desc:"L칠캜itel a ochr치nce p콏ed temnotou.",color:"text-yellow-500",border:"border-yellow-500"}];return v&&h?e.jsxs("div",{className:"h-screen w-screen bg-zinc-950 flex flex-col items-center justify-center",children:[e.jsx(Ve,{className:"w-12 h-12 text-white animate-spin mb-4"}),e.jsx("p",{className:"text-white font-mono text-xs uppercase tracking-widest",children:"Generov치n칤 offline prost콏ed칤..."})]}):e.jsxs("div",{className:"h-screen w-screen bg-zinc-950 flex flex-col items-center justify-start p-6 pt-12 relative overflow-hidden overflow-y-auto no-scrollbar",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-5 z-0",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"30px 30px"}}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1/2 bg-gradient-to-b from-signal-cyan/5 to-transparent"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1/2 bg-gradient-to-t from-signal-amber/5 to-transparent"})]}),e.jsxs(_.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"w-full max-w-sm relative z-10 pb-10",children:[n==="nickname"&&e.jsxs("div",{className:"text-center mt-20",children:[e.jsx("div",{className:"w-20 h-20 bg-zinc-900 rounded-full flex items-center justify-center mx-auto mb-6 border border-zinc-700 shadow-xl",children:e.jsx(gs,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-2xl font-black text-white mb-2 uppercase tracking-widest",children:"Identifikace"}),e.jsx("p",{className:"text-zinc-400 text-sm mb-8 font-bold tracking-tight",children:"Zadejte svou hern칤 p콏ezd칤vku."}),e.jsxs("form",{onSubmit:X,children:[e.jsx("input",{type:"text",value:r,onChange:p=>c(p.target.value),placeholder:"P콏ezd칤vka...",className:"w-full bg-zinc-900 border border-zinc-700 p-4 rounded-xl text-white font-display text-center text-lg focus:border-signal-cyan outline-none mb-4 uppercase font-bold",maxLength:12,autoFocus:!0}),e.jsx("button",{type:"submit",disabled:r.length<3,className:"button-primary w-full py-5 text-sm",children:"Pokra캜ovat"})]})]}),n==="class"&&e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-black text-white mb-1 uppercase tracking-tighter",children:"Zvolte T콏칤du"}),e.jsx("p",{className:"text-zinc-400 text-xs font-bold uppercase tracking-wider",children:"Va코e role ovlivn칤 hern칤 mechaniky."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3 overflow-y-auto pr-1 no-scrollbar",children:N.map(p=>e.jsxs("button",{onClick:()=>ae(p.id),className:`p-4 rounded-xl border-2 text-left transition-all relative overflow-hidden group ${x===p.id?`bg-zinc-900 ${p.border}`:"bg-black border-zinc-800 hover:border-zinc-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:`p-3 rounded-lg bg-zinc-900 ${p.color} border border-white/5`,children:p.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-black uppercase tracking-widest ${p.color}`,children:p.id}),e.jsx("p",{className:"text-[11px] text-zinc-300 font-bold leading-tight mt-1",children:p.desc})]})]}),x===p.id&&e.jsx(_.div,{layoutId:"class-highlight",className:`absolute inset-0 opacity-10 ${p.color.replace("text-","bg-")}`})]},p.id))}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-zinc-800",children:[e.jsx("p",{className:"text-xs text-zinc-500 uppercase font-bold tracking-wider mb-3 text-center",children:"Nebo zadejte ID vlastn칤 postavy"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:A,onChange:p=>Y(p.target.value.toUpperCase()),placeholder:"CHAR-001",className:"flex-1 bg-black border border-zinc-700 px-4 py-3 rounded-lg text-white font-mono uppercase text-sm focus:border-signal-cyan outline-none",maxLength:10}),e.jsx("button",{onClick:async()=>{if(A.trim()){J(!0),I(null);try{const p=await Vt(A.trim());p?(P(p),g(p.name),I(""),L(!0),setTimeout(()=>{L(!1),l("action")},2500)):I("Postava nenalezena!")}catch{I("Chyba p콏i na캜칤t치n칤 postavy.")}finally{J(!1)}}},disabled:!A.trim()||R,className:"px-6 py-3 bg-signal-cyan text-black rounded-lg font-bold uppercase text-xs hover:bg-white transition-colors disabled:opacity-50",children:R?e.jsx(Ve,{className:"w-4 h-4 animate-spin"}):"Na캜칤st"})]}),j&&e.jsx("p",{className:"text-xs text-red-500 mt-2 text-center font-bold",children:j}),e.jsxs("button",{onClick:()=>ie(!0),className:"mt-3 w-full py-3 bg-purple-500/10 border border-purple-500/30 text-purple-400 rounded-lg font-bold uppercase text-xs hover:bg-purple-500/20 transition-colors flex items-center justify-center gap-2",children:[e.jsx(bs,{className:"w-4 h-4"}),"Skenovat QR k칩d"]})]}),te&&e.jsxs("div",{className:"fixed inset-0 z-50 bg-black",children:[e.jsx(Ms,{onScanCode:async p=>{if(p.toUpperCase().startsWith("CHAR-")){ie(!1),Y(p.toUpperCase()),J(!0),I(null);try{const D=await Vt(p.toUpperCase());D?(P(D),g(D.name),L(!0),setTimeout(()=>{L(!1),l("action")},2500)):I("Postava nenalezena!")}catch{I("Chyba p콏i na캜칤t치n칤 postavy.")}finally{J(!1)}}else I("Neplatn칳 QR k칩d postavy!")},isAIThinking:R,isPaused:!1}),e.jsx("button",{onClick:()=>ie(!1),className:"absolute top-6 right-6 z-50 px-4 py-2 bg-red-500 text-white rounded-lg font-bold uppercase text-xs hover:bg-red-600 transition-colors",children:"Zav콏칤t"})]})]}),n==="action"&&e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("button",{onClick:()=>{l("class"),P(null),Y("")},className:"text-[10px] text-zinc-500 uppercase tracking-widest hover:text-white mb-2 font-bold underline underline-offset-4",children:["Zm캩nit ",w?"Postavu":"T콏칤du"]}),e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-wider",children:"P콎칈PRAVA"}),e.jsxs("div",{className:"flex justify-center items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-white font-bold tracking-tight",children:r}),e.jsx("span",{className:"text-zinc-600",children:""}),e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded bg-zinc-900 border border-zinc-700 text-signal-cyan uppercase font-black tracking-widest",children:x})]}),w&&e.jsxs("div",{className:"mt-4 p-4 bg-zinc-900/50 border border-signal-cyan/30 rounded-xl",children:[e.jsx("p",{className:"text-xs text-signal-cyan uppercase font-bold mb-2",children:"Vlastn칤 postava"}),e.jsx("p",{className:"text-sm text-zinc-400 mb-3",children:w.description}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"bg-black/50 rounded p-2 text-center",children:[e.jsx("div",{className:"text-[10px] text-zinc-500 uppercase",children:"HP"}),e.jsx("div",{className:"text-sm font-bold text-white",children:w.baseStats.hp})]}),e.jsxs("div",{className:"bg-black/50 rounded p-2 text-center",children:[e.jsx("div",{className:"text-[10px] text-zinc-500 uppercase",children:"DMG"}),e.jsx("div",{className:"text-sm font-bold text-white",children:w.baseStats.damage})]}),e.jsxs("div",{className:"bg-black/50 rounded p-2 text-center",children:[e.jsx("div",{className:"text-[10px] text-zinc-500 uppercase",children:"Armor"}),e.jsx("div",{className:"text-sm font-bold text-white",children:w.baseStats.armor})]})]})]})]}),e.jsxs("div",{className:"p-5 bg-zinc-900/90 border-2 border-zinc-800 hover:border-signal-cyan rounded-2xl transition-all shadow-xl backdrop-blur-sm",children:[e.jsx("div",{onClick:()=>!Z&&C("create"),className:`cursor-pointer ${Z?"":"flex flex-col"}`,children:e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx(ws,{className:"w-7 h-7 text-signal-cyan"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-tighter",children:"Zalo쬴t_Sektor"}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-bold uppercase tracking-wider",children:"Nov치 m칤stnost pro skupinu."})]})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-zinc-800 space-y-4",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-[9px] font-black text-zinc-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(Rt,{className:"w-3 h-3"})," Soukrom칳_Sektor"]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:Z,onChange:p=>{F(p.target.checked),p.target.checked||z("")}}),e.jsx("div",{className:"w-9 h-5 bg-zinc-800 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-signal-cyan"})]})]}),Z&&e.jsx("div",{className:"animate-in slide-in-from-top-2 bg-black/40 p-3 rounded-lg border border-white/5",children:e.jsx("input",{type:"text",placeholder:"Vstupn칤 kl칤캜...",value:u,onChange:p=>z(p.target.value),className:"w-full bg-transparent p-2 text-white text-sm outline-none focus:border-signal-cyan font-mono uppercase font-bold"})}),Z&&e.jsx("button",{onClick:()=>C("create"),disabled:v||Z&&u.length<3,className:"w-full py-4 bg-zinc-900 border-2 border-signal-cyan/50 text-signal-cyan font-black uppercase rounded-xl text-xs mt-2 disabled:opacity-50 tracking-[0.2em] shadow-[0_0_20px_rgba(0,242,255,0.15)] active:scale-95 transition-transform",children:"Inicializovat Soukrom칳 Sektor"})]})]}),e.jsxs("button",{onClick:()=>C("join_mode"),disabled:v,className:"group relative overflow-hidden w-full p-5 bg-zinc-900/80 border-2 border-zinc-800 hover:border-signal-amber rounded-2xl text-left transition-all active:scale-[0.98] shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-signal-amber/10 to-transparent translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-500"}),e.jsx(ga,{className:"w-7 h-7 text-signal-amber mb-2 relative z-10"}),e.jsx("h3",{className:"text-lg font-bold text-white relative z-10 uppercase tracking-tighter",children:"Vstoupit do Sektoru"}),e.jsx("p",{className:"text-[10px] text-zinc-400 mt-1 relative z-10 font-bold uppercase tracking-wider",children:"P콏ipojit se k existuj칤c칤 jednotce."})]}),e.jsxs("button",{onClick:()=>C("solo-online"),disabled:v,className:"group relative overflow-hidden w-full p-5 bg-zinc-900/80 border-2 border-zinc-800 hover:border-white rounded-2xl text-left transition-all active:scale-[0.98] shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/5 to-transparent translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-500"}),e.jsx(ft,{className:"w-7 h-7 text-white mb-2 relative z-10"}),e.jsx("h3",{className:"text-lg font-bold text-white relative z-10 uppercase tracking-tighter",children:"Samostatn치_Mise (Online)"}),e.jsx("p",{className:"text-[10px] text-zinc-400 mt-1 relative z-10 font-bold uppercase tracking-wider",children:"Solo hra se synchronizac칤 Vaultu."})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[e.jsx("div",{className:"h-px bg-zinc-800 flex-1"}),e.jsx("span",{className:"text-[10px] text-zinc-600 uppercase font-black",children:"Nebo"}),e.jsx("div",{className:"h-px bg-zinc-800 flex-1"})]}),e.jsxs("button",{onClick:()=>C("solo"),className:"w-full py-3 text-zinc-500 hover:text-white text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-colors",children:[e.jsx(ja,{className:"w-4 h-4"})," Samostatn치_Mise (Offline)"]})]}),n==="join"&&e.jsxs("div",{className:"text-center mt-10",children:[e.jsx("button",{onClick:()=>l("action"),className:"text-zinc-500 text-[10px] font-black uppercase mb-6 hover:text-white tracking-widest underline underline-offset-4",children:" Zp캩t do Lobby"}),e.jsx("h2",{className:"text-xl font-black text-white mb-6 uppercase tracking-widest",children:"P콏ipojen칤 k Sektoru"}),j&&e.jsxs("div",{className:"p-3 bg-red-900/20 border border-red-500/50 rounded-lg text-red-400 text-xs text-center mb-4 font-bold animate-pulse flex items-center justify-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4"}),j]}),e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{type:"text",value:f,onChange:p=>{y(p.target.value),j&&I(null)},placeholder:"A1B2C",className:"w-full bg-black border border-zinc-700 p-6 rounded-xl text-white font-mono text-center text-3xl uppercase focus:border-signal-amber outline-none tracking-[0.5em]",maxLength:5,autoFocus:!0}),e.jsx("p",{className:"text-[10px] text-zinc-500 mt-2 uppercase tracking-widest font-bold",children:"Unik치tn칤 K칩d Sektoru"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Rt,{className:"h-4 w-4 text-zinc-600"})}),e.jsx("input",{type:O?"text":"password",value:u,onChange:p=>z(p.target.value),placeholder:"P콏칤stupov칳 kl칤캜 (pokud je vy쬬dov치n)",className:"w-full bg-zinc-900 border border-zinc-700 p-4 pl-10 pr-10 rounded-xl text-white outline-none focus:border-signal-amber text-sm font-bold uppercase"}),e.jsx("button",{type:"button",onClick:()=>W(!O),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-zinc-500 hover:text-white",children:O?e.jsx(Na,{className:"h-4 w-4"}):e.jsx(va,{className:"h-4 w-4"})})]}),e.jsxs("button",{type:"submit",disabled:v||f.length<1,className:"button-primary w-full py-5 text-sm !bg-signal-amber shadow-none",children:[v?e.jsx(Ve,{className:"w-5 h-5 animate-spin"}):"Nav치zat Spojen칤"," ",e.jsx(at,{className:"w-5 h-5 ml-2"})]})]})]})]},n),ne&&e.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-blue-500/20 backdrop-blur-sm flex items-center justify-center",children:e.jsxs(_.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},className:"bg-zinc-900 border-2 border-signal-cyan rounded-2xl p-8 text-center shadow-2xl",children:[e.jsx("div",{className:"w-16 h-16 bg-signal-cyan rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse",children:e.jsx("svg",{className:"w-8 h-8 text-black",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-wider mb-2",children:"Postava na캜tena!"}),e.jsx("p",{className:"text-sm text-signal-cyan font-bold mb-4",children:w==null?void 0:w.name}),(w==null?void 0:w.perks)&&w.perks.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10 text-left",children:[e.jsx("p",{className:"text-[10px] text-zinc-500 uppercase font-black tracking-widest mb-2",children:"Aktivn칤 bonusy:"}),e.jsx("div",{className:"space-y-1",children:w.perks.map((p,D)=>e.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[e.jsx("div",{className:"w-1 h-1 bg-signal-cyan rounded-full"}),e.jsx("span",{className:"text-white font-bold",children:p.name})]},D))})]})]})})]})},jn=({data:t,onClose:s})=>{a.useEffect(()=>{const l=setTimeout(()=>{s()},4e3);return()=>clearTimeout(l)},[t.id]);const n=(()=>{switch(t.type){case"success":return{bg:"bg-[#22c55e] text-black",icon:e.jsx(st,{className:"w-5 h-5"}),label:"POTVRZENO"};case"error":return{bg:"bg-signal-hazard text-white",icon:e.jsx(Ie,{className:"w-5 h-5"}),label:"KRITICK칄"};case"gift":return{bg:"bg-purple-600 text-white",icon:e.jsx(wa,{className:"w-5 h-5"}),label:"P콎ENOS"};case"message":return{bg:"bg-signal-cyan text-black",icon:e.jsx(ya,{className:"w-5 h-5"}),label:"SIGN츼L"};case"warning":return{bg:"bg-signal-amber text-black",icon:e.jsx(Ie,{className:"w-5 h-5"}),label:"VAROV츼N칈"};default:return{bg:"bg-white text-black",icon:e.jsx(_t,{className:"w-5 h-5"}),label:"INFO"}}})();return a.createElement(_.div,{layout:!0,initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9,transition:{duration:.1}},key:t.id,className:`fixed top-4 left-4 right-4 z-[10000] pointer-events-auto shadow-[0_10px_40px_rgba(0,0,0,0.6)] border-l-8 border-black font-mono overflow-hidden ${n.bg} rounded-l-lg mx-auto max-w-sm`},e.jsxs("div",{className:"p-4 flex flex-col gap-2 relative",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-black/10 pb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[n.icon,e.jsx("span",{className:"text-[10px] font-black tracking-[0.3em]",children:n.label})]}),e.jsx("button",{onClick:l=>{l.stopPropagation(),s()},className:"opacity-40 hover:opacity-100 transition-opacity p-1",children:e.jsx(Me,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-[12px] font-bold uppercase leading-tight py-1 break-words",children:t.message}),e.jsx(_.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:4,ease:"linear"},className:"absolute bottom-0 left-0 h-1 bg-black/20"})]}))},Nn=({event:t,onClose:s,onPlayerDamage:h,playerHp:n=100,playerArmor:l=0,onArmorChange:r,inventory:c,onUseItem:x,onClaimLoot:g})=>{var G,ce,ye;const[f,y]=a.useState(["Nep콏칤tel detekov치n. P콏ipravte se k boji."]),[v,m]=a.useState(0),[j,I]=a.useState(0),[A,Y]=a.useState(!1),[w,P]=a.useState(null),[R,J]=a.useState(!1),[te,ie]=a.useState(""),[ne,L]=a.useState(!1),[u,z]=a.useState(null),[O,W]=a.useState(!1),[Z,F]=a.useState(!1),[X,ae]=a.useState(!1),C=a.useRef(null);a.useEffect(()=>{var d,K;const T=(K=(d=t.stats)==null?void 0:d.find(pe=>["HP","ZDRAV칈"].includes(pe.label.toUpperCase())))==null?void 0:K.value,B=parseInt(String(T))||50;m(B),I(B)},[t]),a.useEffect(()=>{var T;(T=C.current)==null||T.scrollIntoView({behavior:"smooth"})},[f]);const U=()=>{switch((t.rarity||"Common").toLowerCase()){case"legendary":return 10;case"epic":return 40;case"rare":return 60;default:return 80}},N=()=>{var d,K,pe,je;const T=parseInt(String(((K=(d=t.stats)==null?void 0:d.find(we=>we.label.toUpperCase()==="DEF"))==null?void 0:K.value)||"0")),B=parseInt(String(((je=(pe=t.stats)==null?void 0:pe.find(we=>we.label.toUpperCase()==="ATK"))==null?void 0:je.value)||"10"));return{def:T,atk:B}},p=()=>{var B;const T=((B=t.enemyLoot)==null?void 0:B.lootStats)||[];return T.length===0&&t.enemyLoot&&t.enemyLoot.goldReward&&T.push({label:"ZLATO",value:`+${t.enemyLoot.goldReward}`}),T},D=()=>{if(O||Z||v<=0)return;F(!0),W(!0);const T=U(),B=Math.floor(Math.random()*100)+1;y(d=>[...d,`POKUS O 칔T캨K (마nce ${T}%)...`]),k("scan"),setTimeout(()=>{B<=T?(k("open"),y(d=>[...d,`칔SP캨CH! (Hod: ${B}) Unikl jsi z boje.`]),setTimeout(s,800)):(k("error"),ee(100),y(d=>[...d,`SELH츼N칈! (Hod: ${B}) Nep콏칤tel blokuje 칰stup.`]),F(!1),ue(!0))},1500)},Q=()=>{if(A||v<=0||Z)return;Y(!0),J(!1),k("scan");let T=0;const B=setInterval(()=>{P([Math.floor(Math.random()*6)+1,Math.floor(Math.random()*6)+1]),T++,T>10&&(clearInterval(B),be())},50)},le=()=>{const T=parseInt(te);if(isNaN(T)||T<2||T>12){k("error");return}J(!1);const B=Math.floor(T/2),d=T-B;P([B,d]),be(T)},be=T=>{var rt;let B=0,d=0,K=0;T!==void 0?(K=T,B=Math.floor(T/2),d=T-B):(B=Math.floor(Math.random()*6)+1,d=Math.floor(Math.random()*6)+1,K=B+d),P([B,d]);const{def:pe}=N(),je=((rt=t.combatConfig)==null?void 0:rt.defBreakChance)||0;let we=!1;je>0&&Math.random()*100<je&&(we=!0);const Ce=K===12,Se=K===2;let Te=Math.max(0,K-(we?0:pe));Ce&&(Te*=2),Se&&(Te=0),Te>0?(m(ve=>Math.max(0,ve-Te)),we&&(y(ve=>[...ve,`游꿢 PENETRACE OBRANY! (Ignorov치no ${pe} DEF)`]),k("crit")),Ce?(k("crit"),ee([50,50,50,100]),y(ve=>[...ve,`KRITICK칗 Z츼SAH! (12) -> ${Te} DMG`])):(k("damage"),ee(20),y(ve=>[...ve,`칔TOK: Hod ${K} vs ${we?"0 (BROKEN)":pe} DEF -> ${Te} DMG`]))):(k("miss"),ee(50),y(ve=>[...ve,`MINUT칈: Hod ${K} nepro코el p콏es obranu.`])),setTimeout(()=>{v-Te>0?ue():(y(ve=>[...ve,"C칈L ELIMINOV츼N."]),k("success")),Y(!1),ie("")},1e3)},ue=(T=!1)=>{const{atk:B}=N();let d=Math.max(0,B);if(d>0){const K=T?"NEP콎칈TEL (VOLN칗 칔TOK)":"NEP콎칈TEL";if(l>0){const pe=Math.min(l,d);d-=pe,r&&r(-pe),y(je=>[...je,`游띠勇 T칈T ZASA콯EN: -${pe} Armor`]),k("error")}d>0?(h&&h(-d),y(pe=>[...pe,`${K}: Z치sah za ${d} HP!`]),ee([100])):y(pe=>[...pe,`${K}: 칔tok pln캩 pohlcen 코t칤tem!`])}},ge=()=>{var B;if(!u)return;const T=(B=u.stats)==null?void 0:B.find(d=>["DMG","ATK","POKOZEN칈"].some(K=>d.label.toUpperCase().includes(K)));if(T){const d=parseInt(String(T.value).replace(/[^0-9-]/g,""));d>0&&(m(K=>Math.max(0,K-d)),y(K=>[...K,`POU콯IT P콎EDM캨T: ${u.title} -> ${d} DMG!`]),k("damage"),ee(50),v-d<=0&&setTimeout(()=>{y(K=>[...K,"C칈L ELIMINOV츼N P콎EDM캨TEM."]),k("success")},500))}x&&x(u),z(null)},Pe=()=>{if(X)return;ae(!0);const T=p();g&&g(T),k("success"),ee([50,50,100]),setTimeout(s,1e3)},Ae=(c==null?void 0:c.filter(T=>{var B;return!((B=T.resourceConfig)!=null&&B.isResourceContainer||T.type!==se.ITEM&&T.type!=="P콎EDM캨T")}))||[],{atk:Ke,def:fe}=N(),M=v<=0,$=((G=t.combatConfig)==null?void 0:G.defBreakChance)&&t.combatConfig.defBreakChance>0;if(M){const T=p();return e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 space-y-6 animate-in zoom-in duration-500 text-center",children:[e.jsx(ka,{className:"w-24 h-24 text-yellow-500 animate-bounce drop-shadow-[0_0_20px_rgba(234,179,8,0.5)]"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-3xl font-display font-black text-yellow-500 uppercase tracking-widest",children:"V칈T캨ZSTV칈"}),e.jsx("p",{className:"text-zinc-400 font-mono text-xs uppercase tracking-widest",children:"Nep콏칤tel pora쬰n. Ko콏ist dostupn치."})]}),e.jsxs("div",{className:"w-full bg-zinc-900/80 border border-yellow-500/30 rounded-xl p-4 space-y-3",children:[e.jsx("h3",{className:"text-[10px] font-black uppercase text-zinc-500 tracking-[0.2em] border-b border-zinc-800 pb-2 mb-2",children:"Nalezen칠 Suroviny & Data"}),T.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-2",children:T.map((B,d)=>e.jsxs("div",{className:"bg-black p-2 rounded border border-zinc-800 flex items-center justify-between",children:[e.jsx("span",{className:"text-[9px] font-bold text-zinc-400 uppercase",children:B.label}),e.jsx("span",{className:"text-sm font-mono font-black text-yellow-500",children:B.value})]},d))}):e.jsx("p",{className:"text-xs text-zinc-600 italic",children:"콯치dn치 ko콏ist nalezena."})]}),e.jsx("button",{onClick:Pe,disabled:X,className:`w-full py-4 font-black uppercase text-sm tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 shadow-lg transition-all ${X?"bg-green-600 text-white":"bg-yellow-500 hover:bg-yellow-400 text-black active:scale-95"}`,children:X?e.jsxs(e.Fragment,{children:[e.jsx(jt,{className:"w-5 h-5"})," VYZVEDNUTO"]}):e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"w-5 h-5"})," VYZVEDNOUT KO콎IST"]})})]})}return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 p-3 bg-zinc-900/50 border border-zinc-700 rounded-xl flex flex-col justify-end relative",children:[e.jsxs("div",{className:"flex justify-between items-end mb-1 relative z-10",children:[e.jsx("span",{className:"text-[8px] font-black uppercase text-zinc-500 tracking-widest flex items-center gap-1",children:"TY"}),e.jsxs("div",{className:"text-right",children:[l>0&&e.jsxs("div",{className:"flex items-center justify-end gap-1 text-zinc-400 mb-0.5",children:[e.jsx(Ge,{className:"w-3 h-3"}),e.jsx("span",{className:"text-[9px] font-mono font-bold",children:l})]}),e.jsxs("div",{className:"flex items-center justify-end gap-1 text-red-500",children:[e.jsx(Ue,{className:"w-3 h-3 fill-current"}),e.jsxs("span",{className:"text-[10px] font-mono font-bold",children:[n," HP"]})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[l>0&&e.jsx("div",{className:"h-1 bg-black rounded-full overflow-hidden border border-zinc-700",children:e.jsx(_.div,{className:"h-full bg-zinc-400",initial:{width:"100%"},animate:{width:`${Math.min(100,l)}%`}})}),e.jsx("div",{className:"h-1.5 bg-black rounded-full overflow-hidden border border-red-900/50",children:e.jsx(_.div,{className:"h-full bg-red-600",initial:{width:"100%"},animate:{width:`${Math.min(100,n)}%`}})})]})]}),e.jsxs("div",{className:"flex-1 p-3 bg-red-950/30 border border-red-500/30 rounded-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("span",{className:"text-[8px] font-black uppercase text-red-400 tracking-widest flex items-center gap-1",children:[e.jsx(bt,{className:"w-3 h-3"})," Nep콏칤tel"]}),e.jsxs("span",{className:"text-[10px] font-mono font-bold text-white",children:[v," HP"]})]}),e.jsx("div",{className:"h-1.5 bg-black rounded-full overflow-hidden border border-red-900/50 mt-auto",children:e.jsx(_.div,{className:"h-full bg-red-600",initial:{width:"100%"},animate:{width:`${v/j*100}%`}})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-black/40 border border-zinc-800 p-2 rounded flex justify-between items-center",children:[e.jsx("span",{className:"text-[9px] text-zinc-500 uppercase font-bold",children:"Enemy 칔tok (ATK)"}),e.jsx("span",{className:"text-sm font-black text-orange-500",children:Ke})]}),e.jsxs("div",{className:"bg-black/40 border border-zinc-800 p-2 rounded flex justify-between items-center relative overflow-hidden",children:[e.jsx("span",{className:"text-[9px] text-zinc-500 uppercase font-bold",children:"Enemy Obrana (DEF)"}),e.jsx("span",{className:`text-sm font-black text-blue-400 ${$?"pr-6":""}`,children:fe}),$&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 bg-green-900/50 w-6 flex items-center justify-center border-l border-green-500/50",title:`Weakness: ${(ce=t.combatConfig)==null?void 0:ce.defBreakChance}%`,children:e.jsx(ks,{className:"w-3 h-3 text-green-500 animate-pulse"})})]})]}),e.jsxs("div",{className:"bg-black border border-white/10 rounded-xl p-4 relative overflow-hidden",children:[e.jsx(de,{children:R&&e.jsxs(_.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute inset-0 z-30 bg-black flex flex-col items-center justify-center p-4 space-y-3",children:[e.jsx("h4",{className:"text-xs font-black text-white uppercase tracking-widest",children:"Zadejte sou캜et 2 kostek"}),e.jsx("input",{type:"number",autoFocus:!0,value:te,onChange:T=>ie(T.target.value),placeholder:"2-12",className:"w-24 bg-zinc-900 border border-zinc-700 p-3 text-center text-xl font-bold text-white rounded-xl outline-none focus:border-signal-cyan"}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx("button",{onClick:()=>J(!1),className:"flex-1 py-3 bg-zinc-800 text-zinc-400 font-bold text-[10px] uppercase rounded-lg",children:"Zru코it"}),e.jsx("button",{onClick:le,className:"flex-1 py-3 bg-green-600 text-white font-bold text-[10px] uppercase rounded-lg",children:"Potvrdit"})]})]})}),e.jsx(de,{children:A&&e.jsx(_.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.5},className:"absolute inset-0 z-20 bg-black/80 flex items-center justify-center gap-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex gap-2 justify-center mb-2",children:[e.jsx(Ye,{className:"w-12 h-12 text-white animate-spin"}),e.jsx(Ye,{className:"w-12 h-12 text-white animate-spin",style:{animationDirection:"reverse"}})]}),e.jsx("span",{className:"text-2xl font-black text-white font-mono tracking-widest",children:w?`${w[0]} + ${w[1]}`:"? + ?"})]})})}),e.jsxs("div",{className:"h-24 overflow-y-auto no-scrollbar space-y-1 font-mono text-[9px] text-zinc-400 mb-3 border-b border-zinc-800 pb-2",children:[f.length===0?e.jsx("span",{className:"italic opacity-50",children:"Zahajte 칰tok..."}):f.map((T,B)=>e.jsx("div",{className:T.includes("KRITICK칗")||T.includes("PENETRACE")?"text-yellow-400 font-bold":T.includes("NEP콎칈TEL")?"text-red-400":T.includes("POU콯IT")?"text-cyan-400":T.includes("칔SP캨CH")?"text-green-400":T.includes("SELH츼N칈")?"text-red-500":T.includes("T칈T")?"text-zinc-200":"text-zinc-300",children:T},B)),e.jsx("div",{ref:C})]}),e.jsxs("div",{className:"flex gap-2 h-16",children:[e.jsxs("button",{onClick:()=>J(!0),disabled:A||Z,className:"flex-1 py-4 bg-zinc-800 hover:bg-zinc-700 text-white font-black uppercase text-[10px] tracking-[0.1em] rounded-xl flex items-center justify-center gap-2 border border-zinc-600 active:scale-95 transition-all",children:[e.jsx(Ht,{className:"w-5 h-5 text-zinc-400"}),e.jsx("span",{children:"ZADAT HOD"})]}),e.jsx("button",{onClick:Q,disabled:A||Z,className:"w-20 bg-red-600 hover:bg-red-500 text-white rounded-xl shadow-[0_0_15px_rgba(220,38,38,0.4)] active:scale-95 transition-all flex flex-col items-center justify-center border border-red-400",children:e.jsx(Ye,{className:"w-8 h-8"})})]}),e.jsxs("button",{onClick:D,disabled:A||O||Z,className:`w-full py-2 mt-2 bg-zinc-900 border border-zinc-700 text-zinc-400 font-bold uppercase text-[9px] tracking-widest rounded-lg flex items-center justify-center gap-2 ${O?"opacity-50 cursor-not-allowed":"hover:bg-zinc-800 hover:text-white"}`,children:[e.jsx(Nt,{className:"w-3 h-3"}),O?"칔T캨K SELHAL":`POKUSIT SE UT칄CT (${U()}%)`]})]}),c&&c.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("button",{onClick:()=>{L(!ne),z(null)},className:"w-full py-2 bg-zinc-900 hover:bg-zinc-800 border border-zinc-700 text-zinc-400 font-bold uppercase text-[9px] tracking-widest rounded-lg flex items-center justify-center gap-2",children:[e.jsx(He,{className:"w-3 h-3"})," ",ne?"Zav콏칤t Batoh":"Podpora z Batohu"]}),e.jsx(de,{children:ne&&e.jsx(_.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden bg-black/40 rounded-lg border border-zinc-800 mt-2",children:u?e.jsxs("div",{className:"p-3 bg-zinc-900/80",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-white font-bold text-xs uppercase",children:u.title}),e.jsx("button",{onClick:()=>z(null),children:e.jsx(Me,{className:"w-4 h-4 text-zinc-500"})})]}),e.jsx("p",{className:"text-[10px] text-zinc-400 italic mb-3",children:u.description}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(ye=u.stats)==null?void 0:ye.map((T,B)=>e.jsxs("span",{className:"text-[9px] bg-black border border-zinc-700 px-2 py-1 rounded text-zinc-300 font-mono",children:[T.label,": ",T.value]},B))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>z(null),className:"flex-1 py-2 bg-zinc-800 text-zinc-400 text-[10px] font-bold uppercase rounded",children:"Zp캩t"}),e.jsx("button",{onClick:ge,className:"flex-1 py-2 bg-green-600 text-white text-[10px] font-bold uppercase rounded hover:bg-green-500",children:"POU콯칈T"})]})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2 p-2 max-h-40 overflow-y-auto",children:[Ae.map(T=>{var pe,je,we;const B=(pe=T.stats)==null?void 0:pe.find(Ce=>["HP","ZDRAV칈","HEAL"].some(Se=>Ce.label.toUpperCase().includes(Se))),d=(je=T.stats)==null?void 0:je.find(Ce=>["DMG","ATK","POKOZEN칈"].some(Se=>Ce.label.toUpperCase().includes(Se))),K=(we=T.stats)==null?void 0:we.find(Ce=>["ARMOR","T칈T","BRN캨N칈"].some(Se=>Ce.label.toUpperCase().includes(Se)));return!B&&!d&&!K&&!T.isConsumable?null:e.jsxs("button",{onClick:()=>z(T),className:"flex flex-col items-start p-2 bg-zinc-800 hover:bg-zinc-700 border border-zinc-700 rounded text-left active:scale-95 transition-all",children:[e.jsx("span",{className:"text-[9px] font-bold text-white uppercase line-clamp-1",children:T.title}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 flex-wrap",children:[d&&e.jsxs("span",{className:"text-[8px] font-mono text-orange-400 bg-orange-950/30 px-1 rounded flex items-center gap-0.5",children:[e.jsx(vt,{className:"w-2 h-2"})," ",d.value]}),B&&e.jsxs("span",{className:"text-[8px] font-mono text-green-400 bg-green-950/30 px-1 rounded flex items-center gap-0.5",children:[e.jsx(Ue,{className:"w-2 h-2"})," ",B.value]}),K&&e.jsxs("span",{className:"text-[8px] font-mono text-zinc-300 bg-zinc-700/50 px-1 rounded flex items-center gap-0.5",children:[e.jsx(Ge,{className:"w-2 h-2"})," ",K.value]})]})]},T.id)}),Ae.length===0&&e.jsx("p",{className:"col-span-2 text-center text-[9px] text-zinc-600 italic py-2",children:"콯치dn칠 bojov칠 p콏edm캩ty."})]})})})]})]})},vn=({event:t,onClose:s,onPlayerDamage:h,playerClass:n,onClaimLoot:l})=>{var ne,L,u,z,O,W,Z;const[r,c]=a.useState("active"),[x,g]=a.useState(!1),[f,y]=a.useState(null),[v,m]=a.useState(!1),[j,I]=a.useState(""),A={difficulty:((ne=t.trapConfig)==null?void 0:ne.difficulty)??10,damage:((L=t.trapConfig)==null?void 0:L.damage)??20,disarmClass:((u=t.trapConfig)==null?void 0:u.disarmClass)||"ANY",successMessage:((z=t.trapConfig)==null?void 0:z.successMessage)||"Past zne코kodn캩na.",failMessage:((O=t.trapConfig)==null?void 0:O.failMessage)||"Past sklapla!",trapType:((W=t.trapConfig)==null?void 0:W.trapType)||"N츼STRAHA",loot:((Z=t.trapConfig)==null?void 0:Z.loot)||[]},Y=n&&A.disarmClass===n,w=A.trapType,P=()=>{c("success"),k("success"),ee([50,50,50])},R=()=>{r==="success"&&(A.loot&&A.loot.length>0&&l&&l(A.loot),c("claimed"),k("open"),setTimeout(s,800))},J=()=>{if(x||r!=="active")return;g(!0),m(!1),k("scan");let F=0;const X=setInterval(()=>{y([Math.floor(Math.random()*6)+1,Math.floor(Math.random()*6)+1]),F++,F>10&&(clearInterval(X),ie())},50)},te=()=>{const F=parseInt(j);if(isNaN(F)||F<2||F>12){k("error");return}m(!1);const X=Math.floor(F/2),ae=F-X;y([X,ae]),ie(F)},ie=F=>{let X=0;if(F!==void 0)X=F;else{const ae=Math.floor(Math.random()*6)+1,C=Math.floor(Math.random()*6)+1;y([ae,C]),X=ae+C}g(!1),X>=A.difficulty?(c("success"),k("success"),ee([50,50])):(c("fail"),k("error"),ee([200,100,200]),h&&A.damage>0&&setTimeout(()=>{h(-A.damage)},500),setTimeout(s,2500))};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`p-4 rounded-xl border-2 flex items-center justify-between transition-colors ${r==="active"?"bg-orange-950/30 border-orange-500/50":r==="success"||r==="claimed"?"bg-green-950/30 border-green-500":"bg-red-950/30 border-red-600"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-full border ${r==="active"?"bg-orange-500/10 border-orange-500 text-orange-500":r==="success"||r==="claimed"?"bg-green-500/10 border-green-500 text-green-500":"bg-red-500/10 border-red-500 text-red-500"}`,children:r==="active"?e.jsx(Je,{className:"w-6 h-6 animate-pulse"}):r==="success"||r==="claimed"?e.jsx(jt,{className:"w-6 h-6"}):e.jsx(Ut,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-sm font-black uppercase tracking-widest ${r==="active"?"text-orange-500":r==="success"||r==="claimed"?"text-green-500":"text-red-500"}`,children:r==="active"?"DETEKOV츼NA HROZBA":r==="success"?"PAST ZNEKODN캨NA":r==="claimed"?"HOTOVO":"PAST SPUT캨NA"}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-mono font-bold uppercase tracking-wider",children:r==="active"?w:r==="success"?A.successMessage:A.failMessage})]})]})}),r==="active"&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-black/60 border border-zinc-800 p-4 rounded-xl flex flex-col items-center justify-center gap-1",children:[e.jsx("span",{className:"text-[9px] text-zinc-500 uppercase font-bold tracking-widest",children:"Obt칤쬹ost (C칤l)"}),e.jsxs("div",{className:`text-3xl font-black font-mono flex items-center gap-2 ${Y?"text-green-500":"text-white"}`,children:[Y?e.jsx(Sa,{className:"w-5 h-5"}):e.jsx(_e,{className:"w-5 h-5 text-zinc-600"}),Y?"0":`${A.difficulty}+`]})]}),e.jsxs("div",{className:"bg-red-950/20 border border-red-900/50 p-4 rounded-xl flex flex-col items-center justify-center gap-1",children:[e.jsx("span",{className:"text-[9px] text-red-400 uppercase font-bold tracking-widest",children:"Riziko (DMG)"}),e.jsxs("div",{className:"text-3xl font-black text-red-500 font-mono flex items-center gap-2",children:[e.jsx(bt,{className:"w-5 h-5"})," -",A.damage]})]})]}),r==="success"&&e.jsxs("div",{className:"animate-in zoom-in duration-300 space-y-4",children:[e.jsxs("div",{className:"bg-green-950/20 border border-green-500/30 p-4 rounded-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-20",children:e.jsx(ze,{className:"w-16 h-16 text-green-500"})}),e.jsx("p",{className:"text-[10px] text-green-400 font-bold uppercase tracking-widest mb-3 border-b border-green-500/30 pb-2",children:"Odm캩na za zne코kodn캩n칤 (Loot)"}),A.loot&&A.loot.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-2 relative z-10",children:A.loot.map((F,X)=>e.jsxs("div",{className:"bg-black p-3 rounded border border-green-900 flex justify-between items-center shadow-lg",children:[e.jsx("span",{className:"text-[9px] font-bold text-zinc-400 uppercase tracking-wider",children:F.label}),e.jsx("span",{className:"text-lg font-mono font-black text-green-500",children:F.value})]},X))}):e.jsx("p",{className:"text-[10px] text-zinc-500 italic py-4 text-center",children:"콯치dn치 dodate캜n치 odm캩na. Past se jen vypne."})]}),e.jsx("button",{onClick:R,className:"w-full py-4 bg-green-600 hover:bg-green-500 text-white font-black uppercase text-xs tracking-[0.2em] rounded-xl shadow-[0_0_20px_rgba(34,197,94,0.3)] flex items-center justify-center gap-2 transition-all active:scale-95",children:A.loot&&A.loot.length>0?e.jsxs(e.Fragment,{children:["VYZVEDNOUT A ULO콯IT ",e.jsx(We,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["POKRA캛OVAT ",e.jsx(at,{className:"w-4 h-4"})]})})]}),r==="active"&&e.jsx("div",{className:"bg-black border border-white/10 rounded-xl p-4 relative overflow-hidden",children:Y?e.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-2",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 bg-green-900/10 p-3 rounded-lg border border-green-500/20",children:[e.jsx(Gt,{className:"w-8 h-8 text-green-400"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-black text-green-400 uppercase tracking-widest",children:["Autorizace P콏ijata: ",n]}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-mono leading-tight mt-1",children:"Tv콢j v칳cvik ti umo쮄갓je tento mechanismus bezpe캜n캩 obej칤t. Kostky nejsou pot콏eba."})]})]}),e.jsxs("button",{onClick:P,className:"w-full py-4 bg-green-600 hover:bg-green-500 text-white font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-3 transition-all active:scale-95 shadow-[0_0_20px_rgba(34,197,94,0.4)] animate-pulse",children:[e.jsx(za,{className:"w-5 h-5"}),"BEZPE캛N캨 ZNEKODNIT"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{children:v&&e.jsxs(_.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute inset-0 z-30 bg-black flex flex-col items-center justify-center p-4 space-y-3",children:[e.jsx("h4",{className:"text-xs font-black text-white uppercase tracking-widest",children:"Zadejte sou캜et 2 kostek"}),e.jsx("input",{type:"number",autoFocus:!0,value:j,onChange:F=>I(F.target.value),placeholder:"2-12",className:"w-24 bg-zinc-900 border border-zinc-700 p-3 text-center text-xl font-bold text-white rounded-xl outline-none focus:border-orange-500"}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx("button",{onClick:()=>m(!1),className:"flex-1 py-3 bg-zinc-800 text-zinc-400 font-bold text-[10px] uppercase rounded-lg",children:"Zru코it"}),e.jsx("button",{onClick:te,className:"flex-1 py-3 bg-orange-600 text-white font-bold text-[10px] uppercase rounded-lg",children:"Potvrdit"})]})]})}),e.jsx(de,{children:x&&e.jsx(_.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.5},className:"absolute inset-0 z-20 bg-black/80 flex items-center justify-center gap-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex gap-2 justify-center mb-2",children:[e.jsx(Ye,{className:"w-12 h-12 text-white animate-spin"}),e.jsx(Ye,{className:"w-12 h-12 text-white animate-spin",style:{animationDirection:"reverse"}})]}),e.jsx("span",{className:"text-2xl font-black text-white font-mono tracking-widest",children:f?`${f[0]} + ${f[1]}`:"? + ?"})]})})}),e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest mb-3 text-center",children:"Zvolte metodu ov캩콏en칤"}),e.jsxs("div",{className:"flex gap-2 h-20",children:[e.jsxs("button",{onClick:()=>m(!0),disabled:x,className:"flex-1 bg-zinc-800 hover:bg-zinc-700 text-white font-black uppercase text-[10px] tracking-[0.1em] rounded-xl flex flex-col items-center justify-center gap-2 border border-zinc-600 active:scale-95 transition-all group",children:[e.jsx(Ht,{className:"w-6 h-6 text-zinc-400 group-hover:text-white transition-colors"}),e.jsx("span",{children:"ZADAT HOD (FYZICK칄 KOSTKY)"})]}),e.jsxs("button",{onClick:J,disabled:x,className:"w-24 bg-orange-600 hover:bg-orange-500 text-white rounded-xl shadow-[0_0_15px_rgba(249,115,22,0.4)] active:scale-95 transition-all flex flex-col items-center justify-center border border-orange-400",children:[e.jsx(Ye,{className:"w-8 h-8"}),e.jsx("span",{className:"text-[8px] font-bold mt-1",children:"VIRTU츼LN칈"})]})]})]})})]})},yn=({event:t,onClose:s,onSave:h,onDiscard:n,onUse:l,onResolveDilemma:r,isSaved:c,onPlayerDamage:x,playerHp:g,playerArmor:f,onArmorChange:y,playerClass:v,inventory:m,onUseItem:j,onClaimLoot:I})=>{var ue,ge,Pe,Ae,Ke,fe;const[A,Y]=a.useState("CHOICE"),[w,P]=a.useState(null),[R,J]=a.useState("success"),[te,ie]=a.useState(!1),[ne,L]=a.useState(null);a.useEffect(()=>{k("open")},[t]);const u=t.type===se.ENCOUNTER||t.type===se.BOSS,z=t.type===se.TRAP,O=!u&&!z,W=M=>{L(ne===M?null:M),k("click"),ee(10)},Z=M=>{const $=M.toUpperCase();return["HP","ZDRAV칈","HEAL","HEALTH"].some(G=>$.includes(G))?"text-green-400":["DMG","ATK","칔TOK","UTOK","ATTACK"].some(G=>$.includes(G))?"text-signal-hazard":["GOLD","MINCE","KREDITY","CREDITS"].some(G=>$.includes(G))?"text-signal-amber":["MANA","ENERGIE","ENERGY"].some(G=>$.includes(G))?"text-signal-cyan":"text-white"},F=(M,$)=>{const G=M.toUpperCase(),ce=String($),ye=ce.includes("+")||!ce.includes("-")&&parseInt(ce)>0;return["HP","ZDRAV칈","HEAL","HEALTH"].some(T=>G.includes(T))?ye?`Okam쬴t캩 obnovuje ${ce} jednotek biologick칠 integrity.`:`Zp콢sobuje p콏칤m칠 po코kozen칤 tk치n칤 ve v칳코i ${ce} HP.`:["DMG","ATK","칔TOK","UTOK","ATTACK"].some(T=>G.includes(T))?`Zvy코uje s칤lu p콏칤코t칤ho 칰deru nebo automatick칠ho 칰toku o ${ce}.`:["GOLD","MINCE","KREDITY","CREDITS"].some(T=>G.includes(T))?`Transak캜n칤 kredity v hodnot캩 ${ce} byly p콏ips치ny do tv칠ho 칰캜tu.`:["MANA","ENERGIE","ENERGY"].some(T=>G.includes(T))?`Obnovuje ${ce} jednotek energie pro pou쬴t칤 schopnost칤 nebo svitk콢.`:["ARMOR","OBRANA","BRN캨N칈"].some(T=>G.includes(T))?`Zvy코uje tvou statickou ochranu o ${ce}. Sni쬿je p콏칤choz칤 DMG.`:`Speci치ln칤 modifik치tor sektoru ovliv켿uj칤c칤 parametr ${M} o ${ce}.`},X=M=>{P(M);const G=Math.random()*100<(M.successChance??100),ce=G?"success":"fail";J(ce),Y("RESULT"),G?(k("success"),ee([50,50])):(k("error"),ee([100,100])),r&&r(M,ce)},ae=()=>{te&&n?(n(),k("error"),s()):(ie(!0),ee(20))},U=((M,$)=>{var ce,ye;if(M===se.BOSS)return{bg:"bg-gradient-to-b from-red-950/90 to-black",border:"border-red-600 shadow-[0_0_60px_rgba(220,38,38,0.4)]",text:"text-red-500",accent:"bg-red-600",icon:e.jsx(Aa,{className:"w-8 h-8 text-red-500"})};if(M===se.SPACE_STATION)return{bg:"bg-gradient-to-b from-slate-900/90 to-black",border:"border-cyan-400 shadow-[0_0_40px_rgba(34,211,238,0.2)]",text:"text-cyan-400",accent:"bg-cyan-500",icon:e.jsx(gt,{className:"w-8 h-8 text-cyan-400"})};if(M===se.PLANET)return{bg:"bg-gradient-to-b from-indigo-950/90 to-black",border:"border-indigo-500 shadow-[0_0_40px_rgba(99,102,241,0.2)]",text:"text-indigo-400",accent:"bg-indigo-500",icon:e.jsx(ft,{className:"w-8 h-8 text-indigo-400"})};if(M===se.TRAP)return{bg:"bg-gradient-to-b from-orange-950/90 to-black",border:"border-orange-500 shadow-[0_0_30px_rgba(249,115,22,0.3)]",text:"text-orange-500",accent:"bg-orange-500",icon:e.jsx(Je,{className:"w-8 h-8 text-orange-500"})};if(M===se.MERCHANT)return{bg:"bg-gradient-to-b from-yellow-950/90 to-black",border:"border-yellow-500 shadow-[0_0_30px_rgba(234,179,8,0.3)]",text:"text-yellow-500",accent:"bg-yellow-500",icon:e.jsx(Ot,{className:"w-8 h-8 text-yellow-500"})};if(M===se.ENCOUNTER)return{bg:"bg-gradient-to-b from-rose-950/90 to-black",border:"border-rose-500 shadow-[0_0_30px_rgba(244,63,94,0.3)]",text:"text-rose-500",accent:"bg-rose-500",icon:e.jsx(vt,{className:"w-8 h-8 text-rose-500"})};if(M===se.DILEMA)return{bg:"bg-[#0a0b0d]",border:"border-purple-500/50 shadow-[0_0_40px_rgba(168,85,247,0.2)]",text:"text-purple-400",accent:"bg-purple-500",icon:e.jsx(Ra,{className:"w-8 h-8 text-purple-400"})};const G={Legendary:"border-signal-amber text-signal-amber shadow-[0_0_30px_rgba(255,157,0,0.3)]",Epic:"border-purple-400 text-purple-400 shadow-[0_0_20px_rgba(192,132,252,0.3)]",Rare:"border-signal-cyan text-signal-cyan shadow-[0_0_20px_rgba(0,242,255,0.2)]",Common:"border-white/30 text-white/60"};return{bg:"bg-[#0a0b0d]",border:G[$]||G.Common,text:((ce=G[$])==null?void 0:ce.split(" ")[1])||"text-white",accent:((ye=G[$])==null?void 0:ye.split(" ")[1].replace("text-","bg-"))||"bg-white",icon:e.jsx(zs,{className:"w-8 h-8"})}})(t.type,t.rarity),N=t.type===se.DILEMA,p=(M,$)=>e.jsx(de,{children:ne===M&&e.jsx(_.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx("div",{className:"mt-2 p-2 bg-black/60 border border-white/10 rounded-lg text-[10px] text-zinc-300 leading-tight italic",children:F(M,$)})})}),D=()=>{var M,$;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-indigo-950/30 border border-indigo-500/30 rounded-xl flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-black border border-indigo-500/50 rounded-full shadow-[0_0_20px_rgba(99,102,241,0.2)]",children:e.jsx(Cs,{className:"w-6 h-6 text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-indigo-400 tracking-widest mb-1",children:"Naviga캜n칤 Data"}),e.jsx("p",{className:"text-xs text-zinc-300 font-mono leading-relaxed",children:"Ulo쬾e tuto kartu do batohu. Odemkne v치m novou destinaci v naviga캜n칤m syst칠mu lodi."})]})]}),e.jsxs("div",{className:"bg-black/40 border border-white/5 p-3 rounded-lg flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-500 uppercase",children:"Sektor ID"}),e.jsx("span",{className:"text-white font-mono font-bold",children:((M=t.planetConfig)==null?void 0:M.planetId)||"N/A"})]}),e.jsxs("div",{className:"bg-black/40 border border-white/5 p-3 rounded-lg flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-500 uppercase",children:"Typ Eventu"}),e.jsx("span",{className:"text-white font-mono font-bold",children:(($=t.planetConfig)==null?void 0:$.landingEventType)||"UNKNOWN"})]})]})},Q=()=>{var M,$,G,ce;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-cyan-950/20 border border-cyan-500/30 p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-cyan-400",children:[e.jsx(Es,{className:"w-4 h-4 animate-pulse"}),e.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest",children:"Stanice Online"})]}),e.jsxs("p",{className:"text-xs text-zinc-300 italic mb-4",children:['"',((M=t.stationConfig)==null?void 0:M.welcomeMessage)||"V칤tejte na palub캩. Syst칠my jsou funk캜n칤.",'"']}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-3 rounded border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Nt,{className:"w-4 h-4 text-cyan-300"}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-300 uppercase",children:"Kysl칤k (O2)"})]}),e.jsx("div",{className:"text-green-500 font-mono text-xs font-bold flex items-center gap-1 uppercase",children:($=t.stationConfig)!=null&&$.refillO2?"DOPLN캨N칈 NA 100%":"---"})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-3 rounded border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-4 h-4 text-slate-300"}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-300 uppercase",children:"Oprava Pl치코t캩"})]}),e.jsxs("div",{className:"text-green-500 font-mono text-xs font-bold flex items-center gap-1",children:["+",((G=t.stationConfig)==null?void 0:G.repairAmount)||30," HP"]})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-3 rounded border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"w-4 h-4 text-orange-400"}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-300 uppercase",children:"Dopln캩n칤 Paliva"})]}),e.jsxs("div",{className:"text-green-500 font-mono text-xs font-bold flex items-center gap-1",children:["+",((ce=t.stationConfig)==null?void 0:ce.fuelReward)||50]})]})]})]}),e.jsx("p",{className:"text-[9px] text-green-500 text-center uppercase font-bold",children:"Odm캩na za p콏ist치n칤 na stanici"})]})},le=()=>{var M,$,G;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-yellow-900/10 border border-yellow-700/30 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-yellow-500 mb-2",children:"Obchodn칤 Status"}),e.jsxs("div",{className:"text-xs text-zinc-300 italic",children:['"',t.description,'"']})]}),e.jsxs("div",{className:"bg-black/40 border border-zinc-800 rounded-lg p-3",children:[e.jsx("h4",{className:"text-[10px] font-bold text-zinc-400 uppercase mb-3 border-b border-zinc-800 pb-1",children:"T콏칤dn칤 Slevy & Bonusy"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-[10px] font-bold uppercase",children:[e.jsx(js,{className:"w-3 h-3"})," V치le캜n칤k"]}),e.jsxs("div",{className:"text-white font-mono text-xs",children:[((M=t.tradeConfig)==null?void 0:M.warriorDiscount)||10,"% SLEVA"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-400 text-[10px] font-bold uppercase",children:[e.jsx(Ns,{className:"w-3 h-3"})," M치g (Svitky)"]}),e.jsxs("div",{className:"text-white font-mono text-xs",children:[(($=t.tradeConfig)==null?void 0:$.mageDiscount)||25,"% SLEVA"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-500 text-[10px] font-bold uppercase",children:[e.jsx(ys,{className:"w-3 h-3"})," Kn캩z (Heal)"]}),e.jsxs("div",{className:"text-white font-mono text-xs",children:[((G=t.tradeConfig)==null?void 0:G.clericDiscount)||45,"% SLEVA"]})]})]})]})]})},be=()=>{var M;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-[8px] text-white/30 uppercase font-black tracking-widest flex items-center gap-2 mb-2",children:[e.jsx(_t,{className:"w-3 h-3"})," Klikni na stat pro vysv캩tlen칤 vlivu"]}),t.isSellOnly&&e.jsxs("div",{className:"bg-red-950/20 border border-red-500/30 p-4 rounded-xl flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-3 bg-black border border-red-500/50 rounded-lg shadow-[0_0_15px_rgba(239,68,68,0.15)]",children:e.jsx(Ts,{className:"w-6 h-6 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-red-500 tracking-widest mb-1 flex items-center gap-2",children:"JEN PRO PRODEJ"}),e.jsx("p",{className:"text-[8px] text-zinc-400 font-mono leading-relaxed",children:"Tento p콏edm캩t nem치 쮂멳nou funk캜n칤 hodnotu. Lze jej pouze prodat obchodn칤k콢m za kredity."})]})]}),((M=t.resourceConfig)==null?void 0:M.isResourceContainer)&&e.jsxs("div",{className:"bg-orange-950/20 border border-orange-500/30 p-4 rounded-xl flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-3 bg-black border border-orange-500/50 rounded-lg shadow-[0_0_15px_rgba(249,115,22,0.15)]",children:e.jsx(Be,{className:"w-6 h-6 text-orange-500"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-orange-500 tracking-widest mb-1 flex items-center gap-2",children:[e.jsx(We,{className:"w-3 h-3"})," ",t.resourceConfig.customLabel||"Surovina k T캩쬭캩"]}),e.jsxs("p",{className:"text-lg font-mono font-bold text-white uppercase leading-none",children:[t.resourceConfig.resourceName," ",e.jsxs("span",{className:"text-orange-500 text-sm",children:["x",t.resourceConfig.resourceAmount]})]}),e.jsx("p",{className:"text-[8px] text-zinc-500 font-mono mt-1",children:"Lze pou쮂셦 pro crafting nebo prodej."})]})]}),t.stats&&t.stats.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.stats.map(($,G)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs(_.button,{onClick:()=>W($.label),className:`bg-white/5 border p-3 rounded-xl flex flex-col items-center transition-all ${ne===$.label?"border-signal-cyan bg-signal-cyan/5":"border-white/10"}`,children:[e.jsx("span",{className:"text-[9px] uppercase font-bold text-zinc-400",children:$.label}),e.jsx("span",{className:`text-lg font-black font-mono ${Z($.label)}`,children:$.value})]}),p($.label,$.value)]},G))}),e.jsxs("div",{className:"flex justify-between items-center bg-zinc-900 p-3 rounded-lg border border-zinc-700",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-400 uppercase",children:"Tr쬹칤 Hodnota"}),e.jsxs("div",{className:"flex items-center gap-2 text-yellow-500",children:[e.jsx(ze,{className:"w-4 h-4"}),e.jsx("span",{className:"font-mono font-bold text-lg",children:t.price??50})]})]})]})};return e.jsx(_.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:1.05,y:-20},className:"fixed inset-0 z-[150] bg-black/95 flex items-center justify-center p-6 backdrop-blur-md",children:e.jsxs("div",{className:`w-full max-w-sm ${U.bg} border-2 ${U.border} relative overflow-hidden flex flex-col shadow-2xl rounded-3xl max-h-[90vh]`,children:[e.jsxs("div",{className:"relative p-6 pb-4 z-10",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-32 bg-gradient-to-b from-white/10 to-transparent pointer-events-none"}),e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:`p-3 rounded-xl bg-black/40 border border-white/10 backdrop-blur-sm ${U.text}`,children:U.icon}),e.jsx("button",{onClick:s,className:"p-2 text-white/30 hover:text-white transition-colors bg-black/20 rounded-full",children:e.jsx(Me,{className:"w-6 h-6"})})]}),e.jsx("span",{className:`text-[9px] font-mono font-bold uppercase tracking-[0.3em] block mb-1 flex items-center gap-2 ${t.dilemmaScope==="GLOBAL"?"text-purple-400 animate-pulse":"text-white/30"}`,children:N?t.dilemmaScope==="GLOBAL"?e.jsxs(e.Fragment,{children:[e.jsx(ft,{className:"w-3 h-3"})," GLOB츼LN칈 K콎I콯OVATKA"]}):"TAKTICK칄 ROZHODNUT칈":`${t.type}`}),e.jsx("h2",{className:`text-3xl font-black uppercase tracking-tighter leading-none font-sans ${U.text} drop-shadow-md`,children:t.title}),!N&&e.jsx("div",{className:`inline-block mt-2 px-2 py-0.5 text-[8px] font-bold uppercase tracking-widest border rounded ${U.border} ${U.text} bg-black/40`,children:t.rarity})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar px-6 pb-6 relative z-10",children:[e.jsxs("div",{className:"mb-6 relative",children:[e.jsx("div",{className:`absolute top-0 left-0 w-1 h-full ${U.accent} opacity-50`}),e.jsxs("p",{className:"pl-4 text-xs text-zinc-300 italic leading-relaxed font-serif opacity-90",children:['"',t.description,'"']})]}),!N&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:[t.type===se.TRAP&&e.jsx(vn,{event:t,onClose:s,onPlayerDamage:x,playerClass:v,onClaimLoot:I}),u&&e.jsx(Nn,{event:t,onClose:s,playerHp:g,playerArmor:f,onArmorChange:y,onPlayerDamage:x,inventory:m,onUseItem:j,onClaimLoot:I}),t.type===se.MERCHANT&&le(),t.type===se.PLANET&&D(),(t.type===se.ITEM||t.type==="P콎EDM캨T")&&be(),t.type===se.SPACE_STATION&&Q()]}),N&&A==="CHOICE"&&e.jsxs("div",{className:"space-y-4 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ca,{className:"w-4 h-4 text-purple-400 animate-pulse"}),e.jsx("p",{className:"text-[10px] font-bold text-purple-400 uppercase tracking-[0.2em]",children:"Anal칳za Rozcest칤"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:(ue=t.dilemmaOptions)==null?void 0:ue.map((M,$)=>e.jsxs("button",{onClick:()=>X(M),className:"relative group p-0 overflow-hidden rounded-xl border border-purple-500/30 bg-purple-900/10 hover:border-purple-400 hover:bg-purple-900/20 transition-all active:scale-[0.98]",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-50",children:e.jsx(Ta,{className:"w-12 h-12 text-purple-500/20 group-hover:text-purple-400/30 transition-colors"})}),e.jsxs("div",{className:"p-4 flex flex-col items-start relative z-10",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsxs("span",{className:"text-[9px] font-black text-zinc-500 uppercase tracking-widest mb-1 group-hover:text-purple-300",children:["TRASA ",String.fromCharCode(65+$)]}),M.successChance!==void 0&&M.successChance<100&&e.jsxs("span",{className:"text-[9px] font-bold text-zinc-500 flex items-center gap-1",children:[e.jsx(Ea,{className:"w-3 h-3"})," ",M.successChance,"%"]})]}),e.jsx("span",{className:"text-sm font-bold text-white uppercase tracking-wider text-left w-full",children:M.label})]}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-purple-500/20 group-hover:bg-purple-400 transition-colors"})]},$))})]}),N&&A==="RESULT"&&e.jsxs("div",{className:"space-y-6 mt-4 animate-in slide-in-from-right-8 duration-300",children:[e.jsxs("div",{className:`p-5 rounded-2xl border relative overflow-hidden ${R==="success"?"bg-purple-900/20 border-purple-500/30":"bg-red-900/20 border-red-500/30"}`,children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-white/5 rounded-bl-full pointer-events-none"}),e.jsxs("div",{className:`flex items-center gap-2 mb-3 ${R==="success"?"text-purple-400":"text-red-400"}`,children:[R==="success"?e.jsx(_t,{className:"w-4 h-4"}):e.jsx(bt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:R==="success"?"Taktick칳 D콢sledek":"Selh치n칤 Operace"})]}),e.jsx("p",{className:"text-sm text-white font-medium leading-relaxed",children:R==="success"?w==null?void 0:w.consequenceText:(w==null?void 0:w.failMessage)||"Akce selhala."}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[R==="success"&&((ge=w==null?void 0:w.rewards)==null?void 0:ge.map((M,$)=>e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border bg-green-500/10 border-green-500/30 text-green-400",children:[M.type==="HP"?e.jsx(Ue,{className:"w-3 h-3"}):M.type==="GOLD"?e.jsx(ze,{className:"w-3 h-3"}):e.jsx(Je,{className:"w-3 h-3"}),e.jsxs("span",{children:["+",M.value," ",M.type]})]},$))),R==="success"&&!(w!=null&&w.rewards)&&(w==null?void 0:w.effectType)&&w.effectType!=="none"&&e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border ${(w.effectValue??0)>0?"bg-green-500/10 border-green-500/30 text-green-400":"bg-red-500/10 border-red-500/30 text-red-400"}`,children:[w.effectType==="hp"?e.jsx(Ue,{className:"w-3 h-3"}):e.jsx(ze,{className:"w-3 h-3"}),e.jsxs("span",{children:[(w.effectValue??0)>0?"+":"",w.effectValue," ",w.effectType.toUpperCase()]})]}),R==="fail"&&(w!=null&&w.failDamage)?e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border bg-red-500/10 border-red-500/30 text-red-400",children:[e.jsx(bt,{className:"w-3 h-3"}),e.jsxs("span",{children:["-",w.failDamage," HP"]})]}):null]})]}),(w==null?void 0:w.physicalInstruction)&&e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-signal-amber to-transparent opacity-30 blur rounded-lg"}),e.jsxs("div",{className:"relative bg-black border-l-4 border-signal-amber p-4 rounded-r-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-signal-amber mb-2",children:[e.jsx(Ia,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.3em]",children:"Rozkaz pro Desku"})]}),e.jsx("p",{className:"text-xs text-white font-mono font-bold leading-relaxed uppercase",children:w.physicalInstruction})]})]})]})]}),e.jsxs("div",{className:"p-4 bg-black/60 border-t border-white/5 flex flex-col gap-2 relative z-10 backdrop-blur-md",children:[e.jsxs("div",{className:"flex gap-3",children:[l&&A!=="RESULT"&&!N&&!((Pe=t.resourceConfig)!=null&&Pe.isResourceContainer)&&!t.isSellOnly&&!u&&!z&&t.type!==se.PLANET&&e.jsx("button",{onClick:l,className:`flex-1 py-4 text-black font-black uppercase text-[11px] tracking-[0.2em] hover:brightness-110 active:scale-95 transition-all font-mono rounded-xl shadow-lg ${U.accent}`,children:t.type===se.MERCHANT?"OTEV콎칈T OBCHOD":t.type===se.SPACE_STATION?"Dokovat a Doplnit":"Pou쮂셦"}),A==="RESULT"&&N&&e.jsxs("button",{onClick:s,className:"w-full py-4 bg-purple-600 hover:bg-purple-500 text-white font-black uppercase text-[11px] tracking-[0.2em] active:scale-95 transition-all rounded-xl shadow-lg shadow-purple-500/20 flex items-center justify-center gap-2",children:["Pokra캜ovat v Misi ",e.jsx(at,{className:"w-4 h-4"})]}),O&&h&&!c?e.jsx("button",{onClick:h,className:`flex-1 py-4 border ${(Ae=t.resourceConfig)!=null&&Ae.isResourceContainer?"border-orange-500 text-orange-500 bg-orange-950/20 hover:bg-orange-900/40":"border-white/20 text-white hover:bg-white/5"} font-black uppercase text-[11px] tracking-[0.2em] active:scale-95 transition-all font-mono rounded-xl flex items-center justify-center gap-2`,children:(Ke=t.resourceConfig)!=null&&Ke.isResourceContainer?e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"w-4 h-4"})," Vyt캩쬴t"]}):"Ulo쬴t"}):c&&!u&&!z&&(((fe=t.resourceConfig)==null?void 0:fe.isResourceContainer)||t.type===se.PLANET||t.isSellOnly)&&e.jsxs("div",{className:"flex-1 py-4 border border-white/10 bg-white/5 text-zinc-500 font-black uppercase text-[11px] tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 cursor-default",children:[e.jsx(We,{className:"w-4 h-4"})," VLASTN캨NO"]})]}),c&&n&&!N&&!u&&!z&&e.jsxs("button",{onClick:ae,className:`w-full py-3 border ${te?"bg-red-900/80 border-red-500 text-white":"border-white/5 bg-transparent text-zinc-500"} font-black uppercase text-[10px] tracking-[0.2em] active:scale-95 transition-all font-mono rounded-xl flex items-center justify-center gap-2`,children:[e.jsx(Ss,{className:"w-3 h-3"})," ",te?"POTVRDIT ZAHOZEN칈":"Zahodit"]})]})]})})},wn=({onComplete:t})=>{const[s,h]=a.useState("approach"),[n,l]=a.useState(8500),[r,c]=a.useState(34),[x,g]=a.useState([]);return a.useEffect(()=>{const f=setInterval(()=>{const y=Math.random().toString(16).substr(2,8).toUpperCase();g(v=>[`SYS_DAT: 0x${y}`,...v.slice(0,6)])},150);return()=>clearInterval(f)},[]),a.useEffect(()=>{k("open");const f=setInterval(()=>{l(y=>Math.max(0,y-150))},30);return setTimeout(()=>{h("align"),k("scan");const y=setInterval(()=>{c(v=>Math.min(100,v+2))},50);setTimeout(()=>clearInterval(y),2e3)},2e3),setTimeout(()=>{h("dock"),clearInterval(f),l(0),c(100),k("error"),ee([80,50,80,50])},4e3),setTimeout(()=>{h("flash"),k("success")},4800),setTimeout(()=>{t()},5500),()=>clearInterval(f)},[]),e.jsxs("div",{className:"fixed inset-0 z-[2000] bg-black overflow-hidden flex flex-col items-center justify-center font-mono cursor-none select-none",children:[e.jsxs("div",{className:"absolute inset-0 perspective-1000",children:[e.jsx(_.div,{className:"absolute bottom-0 left-[-50%] right-[-50%] h-[50vh] bg-[linear-gradient(transparent_0%,rgba(0,242,255,0.2)_1px,transparent_1px),linear-gradient(90deg,transparent_0%,rgba(0,242,255,0.2)_1px,transparent_1px)]",style:{backgroundSize:"100px 100px",transform:"rotateX(60deg)",transformOrigin:"bottom"},animate:{backgroundPositionY:["0px","1000px"]},transition:{duration:s==="approach"?1:5,repeat:1/0,ease:"linear"}}),s==="approach"&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:[...Array(8)].map((f,y)=>e.jsx(_.div,{className:"absolute w-0.5 h-1/2 bg-cyan-500/50",style:{left:`${50+(Math.random()*80-40)}%`,top:"50%",transformOrigin:"top"},animate:{scaleY:[0,2],opacity:[0,1,0],rotate:Math.random()*60-30},transition:{duration:.4,repeat:1/0,delay:Math.random()*.5}},y))})]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center w-full h-full",children:[e.jsxs(_.div,{initial:{scale:.1,opacity:0},animate:{scale:s==="approach"?.4:s==="align"?.9:1.2,opacity:1,rotate:s==="dock"?0:15},transition:{duration:4.5,ease:"circIn"},className:"relative",children:[e.jsx(gt,{className:"w-64 h-64 text-zinc-300 drop-shadow-[0_0_50px_rgba(0,242,255,0.2)]",strokeWidth:.5}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:[1,2,3].map(f=>e.jsx(_.div,{className:"absolute border border-cyan-500/30 rounded-full",style:{width:"100%",height:"100%"},animate:{scale:[.5,2],opacity:[0,1,0]},transition:{duration:2,repeat:1/0,delay:f*.6,ease:"linear"}},f))})]}),e.jsxs(_.div,{className:"absolute inset-0 pointer-events-none",animate:s==="dock"?{x:[-5,5,-5,5,0],y:[-5,5,-5,5,0]}:{},transition:{duration:.4},children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:`relative transition-all duration-500 ${s==="dock"?"scale-90":"scale-100"}`,children:[e.jsx("div",{className:"w-[280px] h-[280px] border border-cyan-500/30 rounded-full flex items-center justify-center border-dashed animate-spin-slow"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(ks,{className:`w-8 h-8 ${r===100?"text-green-500":"text-red-500"}`})}),e.jsxs("div",{className:"absolute top-[-40px] left-1/2 -translate-x-1/2 text-center w-full",children:[e.jsx("div",{className:"text-[10px] font-black text-cyan-500 uppercase tracking-widest bg-black/50 px-2",children:r<100?"KALIBRACE VEKTORU":"ZAM캨콎ENO"}),e.jsxs("div",{className:"text-xl font-bold text-white font-mono",children:[r,"%"]})]})]})}),e.jsxs("div",{className:"absolute top-12 w-full px-6 flex justify-between items-start",children:[e.jsxs("div",{className:"bg-black/60 border-l-4 border-cyan-500 p-2 pl-4 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-cyan-400 mb-1",children:[e.jsx(Es,{className:"w-4 h-4 animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"NEXUS_LINK"})]}),e.jsx("div",{className:"text-xs text-white font-bold uppercase",children:"Sign치l: SILN칗"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-black text-white font-mono tracking-tighter tabular-nums",children:[Math.floor(n),e.jsx("span",{className:"text-sm text-zinc-500 ml-1",children:"m"})]}),e.jsx("div",{className:"text-[10px] font-bold text-red-500 uppercase tracking-widest animate-pulse",children:s==="approach"?"P콎IBLI콯OV츼N칈 >>":s==="align"?"BRZD캨N칈...":"KONTAKT"})]})]}),e.jsxs("div",{className:"absolute left-6 bottom-24 w-40 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 text-zinc-500 mb-2 border-b border-zinc-800 pb-1",children:[e.jsx(Bt,{className:"w-3 h-3"}),e.jsx("span",{className:"text-[8px] font-black uppercase",children:"Telemetrie"})]}),e.jsx("div",{className:"space-y-1 font-mono text-[9px] text-cyan-500/70 h-24 flex flex-col-reverse opacity-80",children:x.map((f,y)=>e.jsx(_.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},children:f},y))})]}),e.jsxs("div",{className:"absolute right-6 bottom-24 w-32 text-right space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[8px] font-bold text-zinc-500 uppercase block mb-1",children:"Tlak Kabiny"}),e.jsx("div",{className:"w-full bg-zinc-800 h-1.5 rounded-full overflow-hidden",children:e.jsx(_.div,{className:"h-full bg-green-500",initial:{width:"90%"},animate:{width:["90%","92%","89%"]},transition:{repeat:1/0,duration:2}})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[8px] font-bold text-zinc-500 uppercase block mb-1",children:"Integrita Pl치코t캩"}),e.jsx("div",{className:"w-full bg-zinc-800 h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-cyan-500 w-full"})})]}),e.jsx("div",{className:"pt-2",children:s==="dock"||s==="flash"?e.jsxs("div",{className:"flex items-center justify-end gap-2 text-green-500",children:[e.jsx(Rt,{className:"w-4 h-4"})," ",e.jsx("span",{className:"font-black text-xs uppercase",children:"ZAM캛ENO"})]}):e.jsxs("div",{className:"flex items-center justify-end gap-2 text-yellow-500",children:[e.jsx(_a,{className:"w-4 h-4 animate-bounce"})," ",e.jsx("span",{className:"font-black text-xs uppercase",children:"DOKOV츼N칈"})]})})]}),e.jsxs("div",{className:"absolute bottom-10 left-10 right-10 flex flex-col items-center",children:[e.jsx("div",{className:"w-full max-w-md bg-zinc-900/50 h-2 rounded-full overflow-hidden border border-zinc-800",children:e.jsx(_.div,{className:`h-full ${s==="dock"?"bg-green-500":"bg-red-500"}`,animate:{width:s==="approach"?"80%":s==="align"?"20%":"0%"},transition:{duration:.5}})}),e.jsxs("div",{className:"flex justify-between w-full max-w-md mt-1 text-[8px] font-bold text-zinc-600 uppercase tracking-widest",children:[e.jsx("span",{children:"Rychlost"}),e.jsx("span",{children:s==="approach"?"850 m/s":s==="align"?"120 m/s":"0 m/s"})]})]})]})]}),s==="flash"&&e.jsx(_.div,{className:"absolute inset-0 bg-white z-[2100]",initial:{opacity:0},animate:{opacity:1},transition:{duration:.2,ease:"easeIn"}})]})},kn=({inventory:t,masterCatalog:s,onClose:h,onCraft:n})=>{var J,te,ie,ne;const l=t.filter(L=>{var u;return(u=L.resourceConfig)==null?void 0:u.isResourceContainer}),r=s.filter(L=>L.craftingRecipe&&L.craftingRecipe.enabled===!0),[c,x]=a.useState(null),[g,f]=a.useState(!1),[y,v]=a.useState(0),[m,j]=a.useState(0),I=a.useRef(null);a.useEffect(()=>()=>{I.current&&clearInterval(I.current)},[]);const A=L=>{g||(k("click"),x(L),v(0),j(0))},Y=L=>l.reduce((u,z)=>{var O;return((O=z.resourceConfig)==null?void 0:O.resourceName)===L?u+(z.resourceConfig.resourceAmount||0):u},0),w=L=>{var u;return(u=L.craftingRecipe)!=null&&u.requiredResources?L.craftingRecipe.requiredResources.every(z=>Y(z.resourceName)>=z.amount):!0},P=()=>{var W;if(!c||!n)return;if(!w(c)){k("error");return}f(!0),k("scan"),ee([50,100,50]);const L=((W=c.craftingRecipe)==null?void 0:W.craftingTimeSeconds)||10,u=L*1e3,z=50;let O=0;j(L),v(0),I.current=setInterval(()=>{O+=z;const Z=Math.min(100,O/u*100),F=Math.max(0,L-O/1e3);v(Z),j(F),O>=u&&(clearInterval(I.current),R())},z)},R=()=>{!c||!n||(n(c),k("success"),ee([50,50,50]),f(!1),v(0),j(0),x(null))};return e.jsxs("div",{className:"fixed inset-0 z-[250] bg-zinc-950 text-white flex flex-col font-sans overflow-hidden",children:[e.jsxs("header",{className:"bg-zinc-900 border-b border-orange-500/30 p-4 flex justify-between items-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"repeating-linear-gradient(45deg, #000 0, #000 10px, #f97316 10px, #f97316 20px)"}}),e.jsxs("div",{className:"flex items-center gap-3 relative z-10 text-orange-500",children:[e.jsx("div",{className:"p-2 bg-orange-500/10 border border-orange-500/30 rounded",children:e.jsx(Be,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black uppercase tracking-widest leading-none text-white",children:"V칳robn칤 Modul"}),e.jsx("p",{className:"text-[9px] font-mono font-bold uppercase tracking-[0.3em]",children:"Sekce: FAB-01"})]})]}),e.jsx("button",{onClick:h,disabled:g,className:`p-2 relative z-10 bg-zinc-800 rounded-full hover:bg-zinc-700 transition-colors ${g?"opacity-50 cursor-not-allowed":""}`,children:e.jsx(Me,{className:"w-6 h-6 text-zinc-400"})})]}),e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden relative",children:[e.jsxs("div",{className:"flex-1 border-b md:border-b-0 md:border-r border-zinc-800 bg-zinc-950/50 flex flex-col min-h-[40%] md:min-h-full",children:[e.jsxs("div",{className:"p-3 bg-zinc-900/50 border-b border-zinc-800 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-500 flex items-center gap-2",children:[e.jsx(We,{className:"w-4 h-4"})," Sklad Surovin"]}),e.jsxs("span",{className:"text-[9px] font-mono text-zinc-600",children:[l.length," jednotek"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 grid grid-cols-2 md:grid-cols-2 gap-3 content-start",children:l.length===0?e.jsxs("div",{className:"col-span-2 text-center py-10 opacity-30 flex flex-col items-center",children:[e.jsx(We,{className:"w-12 h-12 mb-2"}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"Sklad pr치zdn칳"})]}):l.map((L,u)=>{var z;return e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 p-3 rounded-lg flex flex-col items-center justify-center gap-1 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-orange-600/50"}),e.jsx(Be,{className:"w-5 h-5 text-orange-500/50 mb-1"}),e.jsx("span",{className:"text-xs font-bold text-white uppercase text-center leading-tight line-clamp-2",children:L.title}),e.jsxs("span",{className:"text-[10px] font-mono text-orange-400 bg-orange-950/30 px-2 py-0.5 rounded border border-orange-500/20",children:["x",((z=L.resourceConfig)==null?void 0:z.resourceAmount)||1]})]},u)})})]}),e.jsxs("div",{className:"flex-[1.5] bg-black flex flex-col",children:[e.jsxs("div",{className:"p-3 bg-zinc-900/50 border-b border-zinc-800 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-500 flex items-center gap-2",children:[e.jsx(Kt,{className:"w-4 h-4"})," Datab치ze Sch칠mat"]}),e.jsx("span",{className:"text-[9px] font-mono text-zinc-600",children:"Admin_Vault Access"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:r.length===0?e.jsx("div",{className:"text-center py-10 text-zinc-600 font-mono text-xs uppercase",children:"콯치dn치 sch칠mata k dispozici."}):r.map(L=>e.jsxs("button",{onClick:()=>A(L),className:"w-full text-left bg-zinc-900/40 border border-zinc-800 hover:border-orange-500/50 hover:bg-zinc-900 p-3 rounded-xl flex items-center gap-4 transition-all active:scale-[0.98] group",children:[e.jsx("div",{className:"w-10 h-10 bg-black border border-zinc-700 rounded-lg flex items-center justify-center group-hover:border-orange-500/50 transition-colors",children:e.jsx(Oa,{className:"w-5 h-5 text-zinc-500 group-hover:text-orange-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h4",{className:"text-xs font-bold text-white uppercase tracking-wider",children:L.title}),e.jsx("span",{className:"text-[9px] font-mono text-zinc-500",children:L.rarity})]}),e.jsx("p",{className:"text-[9px] text-zinc-500 line-clamp-1 italic",children:L.description})]})]},L.id))})]})]}),e.jsx(de,{children:c&&e.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-black/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(_.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-zinc-900 border border-orange-500/50 w-full max-w-sm rounded-2xl p-6 relative shadow-[0_0_50px_rgba(249,115,22,0.15)] flex flex-col max-h-[90vh]",children:[!g&&e.jsx("button",{onClick:()=>x(null),className:"absolute top-4 right-4 text-zinc-500 hover:text-white",children:e.jsx(Me,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[e.jsx("div",{className:"w-20 h-20 bg-black border-2 border-orange-500/30 rounded-xl flex items-center justify-center mb-4 relative overflow-hidden",children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-orange-500/20 z-0",style:{height:`${y}%`,bottom:0,top:"auto",transition:"height 0.1s linear"}}),e.jsxs("span",{className:"relative z-10 text-xl font-black text-white",children:[m.toFixed(1),"s"]})]}):e.jsx(Ma,{className:"w-8 h-8 text-orange-500"})}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter mb-1",children:c.title}),!g&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-orange-400 bg-orange-950/20 px-3 py-1 rounded-full border border-orange-500/20",children:[e.jsx(Pa,{className:"w-3 h-3"}),e.jsxs("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:["캛as v칳roby: ",((J=c.craftingRecipe)==null?void 0:J.craftingTimeSeconds)||10,"s"]})]})]}),e.jsxs("div",{className:"p-4 bg-black/40 rounded-xl border border-zinc-800 mb-6 flex-1 overflow-y-auto",children:[e.jsx("p",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-3 tracking-widest border-b border-zinc-800 pb-2",children:"Po쬬dovan칠 Suroviny"}),e.jsxs("div",{className:"space-y-2",children:[(ie=(te=c.craftingRecipe)==null?void 0:te.requiredResources)==null?void 0:ie.map((L,u)=>{const z=Y(L.resourceName),O=z>=L.amount;return e.jsxs("div",{className:"flex justify-between items-center bg-zinc-900/50 p-2 rounded",children:[e.jsx("span",{className:"text-xs text-zinc-300 font-mono",children:L.resourceName}),e.jsxs("div",{className:`flex items-center gap-2 text-xs font-mono font-bold ${O?"text-green-500":"text-red-500"}`,children:[e.jsxs("span",{children:[z," / ",L.amount]}),O?e.jsx(st,{className:"w-3 h-3"}):e.jsx(Ie,{className:"w-3 h-3"})]})]},u)}),(!((ne=c.craftingRecipe)!=null&&ne.requiredResources)||c.craftingRecipe.requiredResources.length===0)&&e.jsx("p",{className:"text-center text-zinc-600 text-xs italic",children:"콯치dn칠 suroviny nejsou pot콏eba."})]})]}),g?e.jsxs("div",{className:"w-full bg-zinc-800 rounded-full h-4 overflow-hidden border border-zinc-700 relative",children:[e.jsx(_.div,{className:"h-full bg-orange-500",style:{width:`${y}%`},transition:{duration:.1,ease:"linear"}}),e.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[8px] font-black uppercase text-white drop-shadow-md",children:"Fabrikace..."})]}):e.jsx("button",{onClick:P,disabled:!w(c),className:`w-full py-4 font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 transition-all ${w(c)?"bg-orange-600 hover:bg-orange-500 text-white shadow-lg shadow-orange-500/20":"bg-zinc-800 text-zinc-600 cursor-not-allowed border border-zinc-700"}`,children:w(c)?"VYROBIT P콎EDM캨T":"NEDOSTATEK SUROVIN"})]})})})]})},Sn=({onClose:t,masterCatalog:s,inventory:h,playerGold:n,playerClass:l,onBuy:r,onRecycle:c})=>{const[x,g]=a.useState("BUY"),[f,y]=a.useState(null),[v,m]=a.useState(!1),[j,I]=a.useState("ALL");a.useEffect(()=>{k("open")},[]);const A=a.useMemo(()=>{const u={};return s.forEach(z=>{var O;if((O=z.marketConfig)!=null&&O.saleChance){const W=Math.random()*100;u[z.id]=W<=z.marketConfig.saleChance}}),u},[s]),Y=a.useMemo(()=>{let u=s.filter(z=>{var O;return(O=z.marketConfig)==null?void 0:O.enabled});return j!=="ALL"&&(u=u.filter(z=>z.type===j)),u},[s,j]),w=a.useMemo(()=>h.filter(u=>{var z;return((z=u.marketConfig)==null?void 0:z.recyclingOutput)&&u.marketConfig.recyclingOutput.length>0}),[h]),P=u=>{var X,ae;const z=u.price??100;let O=z,W=null;const Z=A[u.id]||!1;if(Z&&((X=u.marketConfig)!=null&&X.marketPrice&&u.marketConfig.marketPrice>0?O=u.marketConfig.marketPrice:O=Math.floor(z*.7)),l&&((ae=u.marketConfig)!=null&&ae.classModifiers)){const C=u.marketConfig.classModifiers.find(U=>U.playerClass===l);C&&(O=Math.floor(O*C.priceMultiplier),C.priceMultiplier<1?W=`BONUS: ${l}`:C.priceMultiplier>1&&(W=`P콎IR츼콯KA: ${l}`))}return{finalPrice:Math.max(1,O),basePrice:z,discountLabel:W,isOnSale:Z}},R=u=>{var z;return(z=u.marketConfig)!=null&&z.recyclingOutput?u.marketConfig.recyclingOutput.map(O=>{const W=s.find(Z=>{var F;return((F=Z.resourceConfig)==null?void 0:F.isResourceContainer)&&Z.resourceConfig.resourceName===O.resourceName||Z.title===O.resourceName});return W?{resource:W,amount:O.amount}:null}).filter(O=>O!==null):[]},J=()=>{if(!(!f||v))if(m(!0),x==="BUY"){const{finalPrice:u}=P(f);if(n<u){k("error"),m(!1);return}k("success"),ee([50,50]),setTimeout(()=>{r(f,u),m(!1),y(null)},1e3)}else{const u=R(f);k("damage"),ee([100,50,200]),setTimeout(()=>{c(f,u),m(!1),y(null),k("success")},1500)}},te=u=>{const z=u.toUpperCase();return z.includes("HP")||z.includes("ZDRAV칈")?e.jsx(Ue,{className:"w-3 h-3 text-red-500"}):z.includes("MANA")||z.includes("ENERGIE")?e.jsx(Je,{className:"w-3 h-3 text-blue-400"}):z.includes("DMG")||z.includes("칔TOK")?e.jsx(vt,{className:"w-3 h-3 text-orange-500"}):z.includes("DEF")||z.includes("OBRANA")?e.jsx(Ge,{className:"w-3 h-3 text-slate-300"}):e.jsx(_e,{className:"w-3 h-3 text-zinc-400"})},ie="text-yellow-500",ne="border-yellow-500/30";return e.jsxs("div",{className:"fixed inset-0 z-[250] bg-zinc-950 text-white flex flex-col font-sans overflow-hidden",children:[e.jsxs("header",{className:`bg-zinc-900 border-b ${ne} p-4 flex justify-between items-center relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"repeating-linear-gradient(45deg, #000 0, #000 10px, #eab308 10px, #eab308 20px)"}}),e.jsxs("div",{className:`flex items-center gap-3 relative z-10 ${ie}`,children:[e.jsx("div",{className:`p-2 bg-yellow-950/20 border ${ne} rounded`,children:e.jsx(Mt,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black uppercase tracking-widest leading-none text-white",children:"Obchodn칤 Termin치l"}),e.jsx("p",{className:"text-[9px] font-mono font-bold uppercase tracking-[0.3em] text-zinc-400",children:"SEKTOR MARKET_V2"})]})]}),e.jsx("button",{onClick:t,className:"p-2 relative z-10 bg-zinc-800 rounded-full hover:bg-zinc-700 transition-colors",children:e.jsx(Me,{className:"w-6 h-6 text-zinc-400"})})]}),e.jsxs("div",{className:"flex flex-col border-b border-zinc-800",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-zinc-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-black border border-yellow-500/30 rounded-lg shadow-[0_0_15px_rgba(234,179,8,0.1)]",children:[e.jsx(ze,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"text-xl font-mono font-bold text-white",children:n})]}),e.jsxs("div",{className:"flex bg-black rounded-lg p-1 border border-zinc-800",children:[e.jsx("button",{onClick:()=>{g("BUY"),k("click")},className:`px-6 py-2 rounded-md text-xs font-bold uppercase tracking-wider transition-all ${x==="BUY"?"bg-yellow-600 text-black shadow-lg":"text-zinc-500 hover:text-white"}`,children:"N치kup"}),e.jsx("button",{onClick:()=>{g("RECYCLE"),k("click")},className:`px-6 py-2 rounded-md text-xs font-bold uppercase tracking-wider transition-all ${x==="RECYCLE"?"bg-orange-600 text-white shadow-lg":"text-zinc-500 hover:text-white"}`,children:"Drti캜ka"})]})]}),x==="BUY"&&e.jsxs("div",{className:"flex gap-2 p-2 px-4 bg-black overflow-x-auto no-scrollbar border-b border-zinc-800",children:[e.jsx(La,{className:"w-4 h-4 text-zinc-600 my-auto mr-2"}),["ALL","P콎EDM캨T","SUROVINA"].map(u=>e.jsx("button",{onClick:()=>I(u),className:`px-3 py-1 rounded text-[10px] font-bold uppercase border transition-colors whitespace-nowrap ${j===u?"border-yellow-500 text-yellow-500 bg-yellow-950/20":"border-zinc-800 text-zinc-500"}`,children:u==="ALL"?"V코e":u},u))]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-zinc-950 relative",children:x==="BUY"?Y.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full opacity-30",children:[e.jsx(Mt,{className:"w-16 h-16 mb-4 text-zinc-500"}),e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-zinc-500",children:"Sklad vyprod치n"})]}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Y.map(u=>{const{finalPrice:z,basePrice:O,discountLabel:W,isOnSale:Z}=P(u),F=n>=z,X=z<O;return e.jsxs("button",{onClick:()=>{y(u),k("click")},className:`relative flex flex-col text-left p-3 rounded-xl border transition-all active:scale-95 group ${F?"bg-zinc-900 border-zinc-800 hover:border-yellow-500/50":"bg-zinc-900/50 border-red-900/30 opacity-70"}`,children:[Z&&e.jsx("div",{className:"absolute top-2 right-2 bg-pink-600 text-white text-[8px] font-black px-1.5 py-0.5 rounded uppercase tracking-wider animate-pulse shadow-[0_0_10px_#db2777]",children:"AKCE"}),e.jsx("div",{className:"mb-2 p-3 bg-black rounded-lg border border-zinc-800 self-start group-hover:border-yellow-500/30 transition-colors",children:e.jsx(He,{className:`w-6 h-6 ${F?"text-zinc-200":"text-red-900"}`})}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("h4",{className:"text-xs font-bold text-white uppercase line-clamp-1 mb-1",children:u.title}),u.stats&&u.stats.length>0&&e.jsx("div",{className:"grid grid-cols-1 gap-1 mb-2",children:u.stats.slice(0,3).map((ae,C)=>e.jsxs("div",{className:"flex items-center justify-between text-[9px] bg-white/5 px-1.5 py-0.5 rounded border border-white/5",children:[e.jsxs("span",{className:"text-zinc-400 font-bold uppercase flex items-center gap-1",children:[te(ae.label)," ",ae.label.substring(0,3)]}),e.jsx("span",{className:"text-white font-mono font-bold",children:ae.value})]},C))})]}),e.jsxs("div",{className:"mt-auto pt-2 border-t border-zinc-800 w-full",children:[W&&e.jsx("span",{className:"text-[8px] text-green-500 font-bold uppercase block mb-1",children:W}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:`flex items-center gap-1 font-mono font-bold ${F?"text-yellow-500":"text-red-500"}`,children:[e.jsx("span",{children:z}),e.jsx(ze,{className:"w-3 h-3"})]}),X&&e.jsx("span",{className:"text-[9px] text-zinc-600 line-through decoration-red-500 font-mono",children:O})]})]})]},u.id)})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-orange-900/10 border border-orange-500/20 rounded-lg flex items-center gap-3 mb-4",children:[e.jsx(Da,{className:"w-5 h-5 text-orange-500"}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-mono leading-tight",children:"Vlo쬾e nepot콏ebn칠 p콏edm캩ty do drti캜ky a z칤skejte suroviny pro v칳robu."})]}),w.length===0?e.jsxs("div",{className:"text-center py-10 opacity-30",children:[e.jsx($a,{className:"w-12 h-12 mx-auto mb-2"}),e.jsx("p",{className:"text-xs font-bold uppercase",children:"콯치dn칳 recyklovateln칳 odpad"})]}):w.map(u=>e.jsxs("button",{onClick:()=>{y(u),k("click")},className:"w-full flex items-center gap-4 p-3 bg-zinc-900 border border-zinc-800 hover:border-orange-500/50 rounded-xl transition-all active:scale-95 group text-left",children:[e.jsx("div",{className:"p-2 bg-black border border-zinc-700 rounded text-zinc-500 group-hover:text-orange-500 transition-colors",children:e.jsx(He,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-bold text-white uppercase",children:u.title}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:R(u).map((z,O)=>e.jsxs("span",{className:"text-[9px] bg-orange-950/30 text-orange-400 px-1.5 py-0.5 rounded border border-orange-500/20",children:["+",z.amount," ",z.resource.title]},O))})]}),e.jsx(at,{className:"w-4 h-4 text-zinc-600 group-hover:text-orange-500"})]},u.id))]})}),e.jsx(de,{children:f&&e.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-black/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(_.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:`bg-zinc-900 border w-full max-w-sm rounded-2xl p-6 relative shadow-2xl flex flex-col ${x==="BUY"?"border-yellow-500/50":"border-orange-500/50"}`,children:[e.jsx("button",{onClick:()=>y(null),className:"absolute top-4 right-4 text-zinc-500 hover:text-white",children:e.jsx(Me,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[e.jsx("div",{className:`w-20 h-20 bg-black border-2 rounded-xl flex items-center justify-center mb-4 ${x==="BUY"?"border-yellow-500/30 text-yellow-500":"border-orange-500/30 text-orange-500"}`,children:x==="BUY"?e.jsx(He,{className:"w-10 h-10"}):e.jsx(Ss,{className:"w-10 h-10"})}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter mb-1",children:f.title}),e.jsx("p",{className:"text-[10px] font-mono text-zinc-500 uppercase",children:f.type})]}),x==="BUY"?e.jsxs("div",{className:"space-y-4",children:[f.stats&&f.stats.length>0&&e.jsxs("div",{className:"bg-white/5 p-3 rounded-lg border border-white/5 mb-2",children:[e.jsxs("p",{className:"text-[10px] font-bold text-zinc-400 uppercase mb-2 flex items-center gap-1",children:[e.jsx(_e,{className:"w-3 h-3"})," Statistiky Assetu"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:f.stats.map((u,z)=>e.jsxs("div",{className:"flex justify-between items-center bg-black px-2 py-1 rounded",children:[e.jsxs("span",{className:"text-[9px] text-zinc-500 font-bold uppercase flex items-center gap-1",children:[te(u.label)," ",u.label]}),e.jsx("span",{className:"text-xs font-mono font-bold text-white",children:u.value})]},z))})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-4 rounded-xl border border-zinc-800",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-bold text-zinc-400 uppercase",children:"Cena"}),P(f).finalPrice<P(f).basePrice&&e.jsxs("span",{className:"text-[10px] text-zinc-600 line-through decoration-red-500 font-mono",children:[P(f).basePrice," GOLD"]})]}),e.jsxs("div",{className:`flex items-center gap-2 text-xl font-mono font-black ${n>=P(f).finalPrice?"text-yellow-500":"text-red-500"}`,children:[P(f).finalPrice," ",e.jsx(ze,{className:"w-5 h-5"})]})]}),n<P(f).finalPrice&&e.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-[10px] font-bold uppercase justify-center bg-red-950/20 p-2 rounded",children:[e.jsx(Ie,{className:"w-3 h-3"})," Nedostatek prost콏edk콢"]})]}):e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("p",{className:"text-[10px] font-bold text-orange-500 uppercase tracking-widest mb-2 border-b border-orange-500/20 pb-1",children:"Z칤sk치te suroviny:"}),R(f).map((u,z)=>e.jsxs("div",{className:"flex justify-between items-center bg-orange-900/10 p-2 rounded border border-orange-500/20",children:[e.jsx("span",{className:"text-xs text-zinc-300 font-mono",children:u.resource.title}),e.jsxs("span",{className:"text-sm font-black text-white",children:["x",u.amount]})]},z))]}),e.jsx("button",{onClick:J,disabled:v||x==="BUY"&&n<P(f).finalPrice,className:`w-full py-4 mt-6 font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 transition-all ${v?"bg-zinc-800 text-zinc-500 cursor-not-allowed":x==="BUY"?n>=P(f).finalPrice?"bg-yellow-600 hover:bg-yellow-500 text-black shadow-lg shadow-yellow-500/20":"bg-zinc-800 text-zinc-600 cursor-not-allowed":"bg-orange-600 hover:bg-orange-500 text-white shadow-lg shadow-orange-500/20"}`,children:v?e.jsx("span",{className:"animate-pulse",children:"Zpracov치n칤..."}):x==="BUY"?e.jsxs(e.Fragment,{children:[n>=P(f).finalPrice?"POTVRDIT N츼KUP":"NEDOSTATEK KREDIT콡",e.jsx(Is,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["ROZEML칈T P콎EDM캨T ",e.jsx(Be,{className:"w-4 h-4"})]})})]})})})]})},zn="admin_test_vault@nexus.local",Cn=({station:t,onLeave:s,onClaimRewards:h,onCraft:n,inventory:l=[],masterCatalog:r=[],playerGold:c=0,playerClass:x=null,onInventoryUpdate:g,onGoldChange:f,isAdmin:y=!1,isTestMode:v=!1})=>{var X,ae,C,U;const[m,j]=a.useState(!0),[I,A]=a.useState(!1),[Y,w]=a.useState(null),[P,R]=a.useState(!1),[J,te]=a.useState(!1),[ie,ne]=a.useState(!1);a.useEffect(()=>{k("open");const N=setTimeout(()=>j(!1),2e3);return()=>clearTimeout(N)},[]);const L=()=>{!P&&h&&(h(t),R(!0))},u=()=>{k("click"),A(!0)},z=()=>{A(!1),s()},O=N=>{k("error"),w(N),setTimeout(()=>w(null),2e3)},W=()=>y&&v?zn:localStorage.getItem("nexus_current_user"),Z=async(N,p)=>{try{const D=W();D&&(f&&f(-Math.abs(p)),await Lt(D,{...N,id:`BOUGHT-${Date.now()}`}),g&&g())}catch{}},F=async(N,p)=>{try{const D=W();if(D){await Dt(D,N.id);for(const Q of p){const le={...Q.resource,id:`RES-${Date.now()}-${Math.random()}`,resourceConfig:{...Q.resource.resourceConfig,resourceAmount:Q.amount}};await Lt(D,le)}g&&g()}}catch{}};return m?e.jsx("div",{className:"fixed inset-0 z-[200] bg-black flex items-center justify-center font-mono",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(gt,{className:"w-16 h-16 text-cyan-500 animate-pulse mx-auto"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-cyan-500 uppercase tracking-[0.2em] font-bold",children:"Iniciace Servisn칤ch Protokol콢..."}),e.jsx("p",{className:"text-xl text-white font-black uppercase tracking-widest",children:t.title})]}),e.jsx("div",{className:"w-48 h-1 bg-zinc-800 rounded-full mx-auto overflow-hidden",children:e.jsx(_.div,{className:"h-full bg-cyan-500",initial:{width:0},animate:{width:"100%"},transition:{duration:1.5,ease:"easeInOut"}})})]})}):e.jsxs(_.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[200] bg-[#050608] text-white overflow-hidden flex flex-col font-sans",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-10",style:{backgroundImage:"linear-gradient(rgba(34, 211, 238, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(34, 211, 238, 0.1) 1px, transparent 1px)",backgroundSize:"40px 40px"}}),e.jsxs("header",{className:"relative z-10 bg-black/60 backdrop-blur-md border-b border-white/10 p-6 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-cyan-950/30 border border-cyan-500/50 rounded-lg flex items-center justify-center",children:e.jsx(gt,{className:"w-6 h-6 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black uppercase tracking-tighter leading-none",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsxs("span",{className:"text-[10px] font-mono text-cyan-500/80 uppercase tracking-widest",children:["P콏ipojen칤 Stabiln칤  ID: ",t.id]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[y&&v&&e.jsx("div",{className:"px-3 py-1 bg-orange-900/30 border border-orange-500/30 rounded text-[9px] font-bold uppercase text-orange-500 animate-pulse hidden md:block",children:"TESTOVAC칈 RE콯IM AKTIVN칈"}),e.jsxs("div",{className:"text-right hidden md:block",children:[e.jsx("p",{className:"text-[10px] text-zinc-500 uppercase font-bold tracking-widest",children:"Lok치ln칤 캛as"}),e.jsx("p",{className:"text-sm font-mono font-bold text-zinc-300",children:new Date().toLocaleTimeString()})]})]})]}),e.jsxs("main",{className:"flex-1 relative z-10 p-6 overflow-y-auto no-scrollbar pb-32",children:[e.jsxs("div",{className:"mb-8 p-6 bg-gradient-to-r from-cyan-900/20 to-transparent border-l-4 border-cyan-500 rounded-r-xl",children:[e.jsx("h2",{className:"text-lg font-bold text-cyan-100 mb-1",children:"Diagnostika lodi."}),e.jsxs("p",{className:"text-sm text-cyan-400/60 font-mono",children:['"',((X=t.stationConfig)==null?void 0:X.welcomeMessage)||"Dostupn칠 servisn칤 칰kony nalezeny.",'"']})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("h3",{className:"text-xs font-black text-white/40 uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4"})," Dostupn칳 Servis"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[((ae=t.stationConfig)==null?void 0:ae.refillO2)&&e.jsxs(_.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:`p-5 rounded-xl flex items-center gap-4 border transition-colors ${P?"bg-green-900/20 border-green-500/50":"bg-black/40 border-white/10"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${P?"bg-green-900/20 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:e.jsx(Nt,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest",children:"Podpora 콯ivota"}),e.jsx("p",{className:"text-lg font-black text-white uppercase",children:"Dopln캩n칤 O2"})]}),P&&e.jsx(st,{className:"w-6 h-6 text-green-500 ml-auto"})]}),((C=t.stationConfig)==null?void 0:C.fuelReward)&&e.jsxs(_.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:`p-5 rounded-xl flex items-center gap-4 border transition-colors ${P?"bg-green-900/20 border-green-500/50":"bg-black/40 border-white/10"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${P?"bg-green-900/20 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:e.jsx(Ft,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest",children:"Tankov치n칤"}),e.jsxs("p",{className:"text-lg font-black text-white uppercase",children:["+",t.stationConfig.fuelReward," Paliva"]})]}),P&&e.jsx(st,{className:"w-6 h-6 text-green-500 ml-auto"})]}),((U=t.stationConfig)==null?void 0:U.repairAmount)&&e.jsxs(_.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:`p-5 rounded-xl flex items-center gap-4 border transition-colors ${P?"bg-green-900/20 border-green-500/50":"bg-black/40 border-white/10"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${P?"bg-green-900/20 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:e.jsx(Ge,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest",children:"Opravy"}),e.jsxs("p",{className:"text-lg font-black text-white uppercase",children:["+",t.stationConfig.repairAmount," HP/Hull"]})]}),P&&e.jsx(st,{className:"w-6 h-6 text-green-500 ml-auto"})]})]}),e.jsx("button",{onClick:L,disabled:P,className:`w-full py-5 font-black uppercase text-sm tracking-[0.3em] rounded-xl flex items-center justify-center gap-3 transition-all shadow-lg ${P?"bg-green-600 text-white cursor-default":"bg-white text-black hover:bg-cyan-400 active:scale-95"}`,children:P?e.jsxs(e.Fragment,{children:[e.jsx(jt,{className:"w-5 h-5"})," SERVISN칈 칔KONY DOKON캛ENY"]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"w-5 h-5"})," PROV칄ST KOMPLETN칈 SERVIS"]})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-xs font-black text-white/40 uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4"})," Dopl켿kov칠 Slu쬭y"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>ne(!0),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(Mt,{className:"w-6 h-6 text-zinc-500 group-hover:text-cyan-400 transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400 group-hover:text-white",children:"Tr쬴코t캩 & Scrap"})]}),e.jsxs("button",{onClick:()=>te(!0),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(Be,{className:"w-6 h-6 text-zinc-500 group-hover:text-orange-500 transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400 group-hover:text-white",children:"V칳roba (Factory)"})]}),e.jsxs("button",{onClick:()=>O("Lod캩nice"),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(Va,{className:"w-6 h-6 text-zinc-500 group-hover:text-signal-cyan transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400",children:"Vylep코it Lo캞"})]}),e.jsxs("button",{onClick:()=>O("Kartografie"),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(ft,{className:"w-6 h-6 text-zinc-500 group-hover:text-purple-500 transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400",children:"Registr Planet"})]})]})]}),e.jsx("div",{className:"w-full h-0.5 bg-signal-amber mb-6 shadow-[0_0_10px_#ff9d00]"}),e.jsxs("div",{className:"pt-2",children:[e.jsxs("h3",{className:"text-xs font-black text-signal-amber uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4"})," Protokol 칔dr쬭y"]}),e.jsxs("div",{className:"font-mono text-[10px] text-zinc-500 space-y-1.5 p-4 bg-black/40 rounded-xl border border-white/5",children:[e.jsxs("p",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-700",children:"08:00"})," ",e.jsx("span",{children:"> Nav치z치no spojen칤 s centr치ln칤m serverem..."})]}),e.jsxs("p",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-700",children:"08:01"})," ",e.jsx("span",{children:"> Autorizace jednotky: 칔SP캨CH"})]}),e.jsxs("p",{className:"flex gap-2 text-green-500",children:[e.jsx("span",{className:"text-green-900",children:"08:02"})," ",e.jsx("span",{children:"> Zah치jen칤 automatick칳ch oprav..."})]}),e.jsxs("p",{className:"flex gap-2 text-green-500",children:[e.jsx("span",{className:"text-green-900",children:"08:05"})," ",e.jsx("span",{children:"> Dopln캩n칤 z치sob..."})]}),e.jsxs("p",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-700",children:"08:10"})," ",e.jsx("span",{children:"> Odpojen칤 servisn칤ch ramen."})]}),e.jsxs("p",{className:"flex gap-2 animate-pulse text-signal-cyan",children:[e.jsx("span",{className:"text-cyan-900",children:"08:11"})," ",e.jsx("span",{children:"> P콏ipraveno k odletu."})]})]})]})]}),e.jsx("footer",{className:"relative z-10 p-6 bg-black/80 backdrop-blur-xl border-t border-white/10",children:e.jsxs("button",{onClick:u,className:"w-full py-4 bg-cyan-600/10 hover:bg-cyan-600/20 border border-cyan-600/30 text-cyan-400 font-black uppercase text-sm tracking-[0.3em] rounded-xl flex items-center justify-center gap-3 transition-all active:scale-95 shadow-[0_0_20px_rgba(8,145,178,0.2)]",children:[e.jsx(rs,{className:"w-5 h-5"}),"Opustit Stanici (Undock)"]})}),e.jsx(de,{children:I&&e.jsx("div",{className:"fixed inset-0 z-[250] bg-black/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(_.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-zinc-900 border border-white/10 p-6 rounded-2xl w-full max-w-xs text-center shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-signal-cyan"}),e.jsx("div",{className:"w-16 h-16 bg-cyan-500/10 rounded-full flex items-center justify-center mx-auto mb-4 text-cyan-500 border border-cyan-500/30",children:e.jsx(rs,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-wider mb-2",children:"Opustit Dok?"}),e.jsx("p",{className:"text-xs text-zinc-400 mb-6 font-mono leading-relaxed",children:"Opravdu chcete opustit stanici? Ujist캩te se, 쬰 m치te dopln캩no palivo a z치soby."}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>A(!1),className:"py-3 bg-zinc-800 text-zinc-400 font-bold uppercase text-[10px] rounded-lg hover:bg-zinc-700 transition-colors",children:"Z콢stat"}),e.jsx("button",{onClick:z,className:"py-3 bg-cyan-600 text-white font-bold uppercase text-[10px] rounded-lg hover:bg-cyan-500 transition-colors shadow-lg shadow-cyan-500/20",children:"Odlet캩t"})]})]})})}),e.jsx(de,{children:Y&&e.jsxs(_.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},className:"fixed bottom-24 left-1/2 -translate-x-1/2 z-[300] bg-black/90 border border-orange-500/50 px-6 py-3 rounded-full shadow-[0_0_30px_rgba(249,115,22,0.3)] flex items-center gap-3",children:[e.jsx(Ha,{className:"w-5 h-5 text-orange-500 animate-pulse"}),e.jsxs("span",{className:"text-xs font-bold text-orange-500 uppercase tracking-widest whitespace-nowrap",children:["Modul ",Y," ve v칳stavb캩"]})]})}),e.jsx(de,{children:J&&e.jsx(_.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-[250]",children:e.jsx(kn,{inventory:l,masterCatalog:r,onClose:()=>te(!1),onCraft:n})})}),e.jsx(de,{children:ie&&e.jsx(_.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-[250]",children:e.jsx(Sn,{onClose:()=>ne(!1),masterCatalog:r,inventory:l,playerGold:c,playerClass:x,onBuy:(N,p)=>{Z(N,p)},onRecycle:(N,p)=>{F(N,p)}})})})]})},Tn=({merchant:t,userGold:s,adminEmail:h,inventory:n,playerClass:l,onClose:r,onBuy:c,onSell:x,onAddFreeItem:g,masterCatalog:f=[]})=>{const[y,v]=a.useState("buy"),[m,j]=a.useState([]),[I,A]=a.useState({}),[Y,w]=a.useState(!0),[P,R]=a.useState(null),[J,te]=a.useState(null),[ie,ne]=a.useState("thinking"),[L,u]=a.useState(0),z=t.tradeConfig||{warriorDiscount:10,clericDiscount:45,mageDiscount:25,rogueStealChance:30},O=a.useMemo(()=>{var U;const C={};return(U=t.merchantItems)==null||U.forEach(N=>{if(N.saleChance&&N.saleChance>0){const p=Math.random()*100;C[N.id]=p<=N.saleChance}}),C},[t.id]);a.useEffect(()=>{(async()=>{if(!t.merchantItems||t.merchantItems.length===0){w(!1);return}w(!0);const U={},N=[];for(const p of t.merchantItems){U[p.id]=p.stock;const D=p.id.trim();let Q=f.find(le=>le.id===D);if(Q||(Q=f.find(le=>le.id.split("__")[0]===D)),!Q)try{Q=await $t(h,D)||void 0}catch{}Q&&N.push({...Q,price:p.price!==void 0&&p.price>0?p.price:Q.price,_merchantEntry:p})}A(U),j(N),w(!1)})()},[t,h,f]);const W=C=>{var le,be;const U=C.price??100;let N=U,p=null;const D=((le=C._merchantEntry)==null?void 0:le.id)||C.id,Q=O[D]||!1;if(Q&&(N=Math.floor(U*.7),p="SALE"),l===Oe.WARRIOR){const ue=(100-z.warriorDiscount)/100;N=Math.floor(N*ue),p||(p="CLASS")}if(l===Oe.CLERIC&&((be=C.stats)==null?void 0:be.some(ge=>["HP","HEAL","L칄캛EN칈","ZDRAV칈"].some(Pe=>ge.label.toUpperCase().includes(Pe))))){const ge=(100-z.clericDiscount)/100;N=Math.floor(N*ge),p||(p="CLASS")}if(l===Oe.MAGE&&(C.isConsumable||C.type===se.ITEM)){const ue=(100-z.mageDiscount)/100;N=Math.floor(N*ue),p||(p="CLASS")}return{finalPrice:Math.max(1,N),basePrice:U,discountType:p,isOnSale:Q}},Z=C=>{var D;const U=((D=C._merchantEntry)==null?void 0:D.id)||C.id,N=I[U]||0,{finalPrice:p}=W(C);if(N>0&&s>=p){let Q=1;l===Oe.ROGUE&&N>=2&&g&&Math.random()*100<z.rogueStealChance&&(Q=2,g(C),k("success"),R(`Z칤skal jsi ${C.title} nav칤c zdarma! (Kr치de)`),setTimeout(()=>R(null),3e3)),A(be=>({...be,[U]:Math.max(0,be[U]-Q)}));const le={...C,price:p};c(le)}},F=C=>{te(C),ne("thinking"),k("scan"),setTimeout(()=>{var p;const U=C.id.split("__")[0],N=(p=t.merchantItems)==null?void 0:p.find(D=>D.id===C.id||D.id===U);N&&N.sellPrice&&N.sellPrice>0?(u(N.sellPrice),ne("offer"),k("success")):(ne("reject"),k("error"))},1500)},X=()=>{J&&x&&(x(J,L),k("success"),te(null))},ae=C=>!C||C.length===0?null:e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:C.map((U,N)=>{let p=e.jsx(_e,{className:"w-3 h-3"}),D="text-zinc-400";const Q=U.label.toUpperCase();return(Q.includes("HP")||Q.includes("HEAL"))&&(p=e.jsx(Ue,{className:"w-3 h-3"}),D="text-red-400"),(Q.includes("DMG")||Q.includes("ATK"))&&(p=e.jsx(vt,{className:"w-3 h-3"}),D="text-orange-400"),(Q.includes("DEF")||Q.includes("ARMOR"))&&(p=e.jsx(Ge,{className:"w-3 h-3"}),D="text-blue-400"),Q.includes("MANA")&&(p=e.jsx(Je,{className:"w-3 h-3"}),D="text-cyan-400"),e.jsxs("div",{className:`flex items-center gap-1 text-[9px] bg-black/60 px-2 py-1 rounded border border-white/10 ${D} font-bold`,children:[p," ",U.label,": ",U.value]},N)})});return e.jsxs(_.div,{initial:{opacity:0,y:"100%"},animate:{opacity:1,y:0},exit:{opacity:0,y:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed inset-0 z-[60] bg-zinc-950/95 flex flex-col pt-28",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-5 z-0",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"30px 30px"}}),e.jsxs("div",{className:"p-4 bg-black border-b border-zinc-800 shadow-xl z-20 flex flex-col gap-4 relative",children:[e.jsx(de,{children:P&&e.jsxs(_.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},className:"absolute top-2 left-2 right-2 bg-green-900/90 border border-green-500 text-green-100 p-3 rounded-xl z-50 flex items-center gap-2 shadow-xl",children:[e.jsx(vs,{className:"w-5 h-5 text-green-400"}),e.jsx("span",{className:"text-xs font-bold uppercase",children:P})]})}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-2xl font-display font-black text-white uppercase tracking-wider leading-none",children:t.title})}),e.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 bg-red-900/20 border border-red-500/50 rounded-lg text-red-500 hover:bg-red-900/40 active:scale-95 transition-all",children:[e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Odej칤t"}),e.jsx(Me,{className:"w-4 h-4"})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-zinc-900 p-3 rounded-xl border border-zinc-800",children:[e.jsx("span",{className:"text-xs text-zinc-400 font-bold uppercase tracking-widest",children:"Dostupn칳 Kredit"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"text-xl font-mono font-black text-white",children:s})]})]}),t.canSellToMerchant&&e.jsxs("div",{className:"flex bg-zinc-900 p-1 rounded-lg border border-zinc-800",children:[e.jsx("button",{onClick:()=>v("buy"),className:`flex-1 py-2 text-xs font-bold uppercase rounded-md transition-all ${y==="buy"?"bg-zinc-800 text-white shadow":"text-zinc-500 hover:text-zinc-200"}`,children:"N치kup"}),e.jsx("button",{onClick:()=>v("sell"),className:`flex-1 py-2 text-xs font-bold uppercase rounded-md transition-all ${y==="sell"?"bg-zinc-800 text-white shadow":"text-zinc-500 hover:text-zinc-200"}`,children:"Prodej"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-zinc-950 pb-20 relative z-10",children:y==="buy"?Y?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 gap-4",children:[e.jsx(Ve,{className:"w-8 h-8 text-signal-cyan animate-spin"}),e.jsx("p",{className:"text-xs text-zinc-400 uppercase tracking-widest font-bold",children:"Nasklad켿ov치n칤 zbo쮂..."})]}):m.length===0?e.jsxs("div",{className:"text-center py-10 opacity-50",children:[e.jsx(Ot,{className:"w-16 h-16 mx-auto mb-4 text-zinc-600"}),e.jsx("p",{className:"text-zinc-300 font-bold uppercase tracking-widest",children:"Vyprod치no"}),e.jsx("p",{className:"text-[10px] text-zinc-500 mt-2 max-w-xs mx-auto",children:"Obchodn칤k nem치 na sklad캩 쮂멳n칠 zbo쮂 odpov칤daj칤c칤 zadan칳m ID. Zkontrolujte Fabrikaci."})]}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:m.map(C=>{var ge;const U=((ge=C._merchantEntry)==null?void 0:ge.id)||C.id,N=I[U]||0,p=N<=0,{finalPrice:D,basePrice:Q,discountType:le,isOnSale:be}=W(C),ue=s>=D;return e.jsxs("div",{className:`bg-zinc-900 border border-zinc-800 p-4 rounded-xl relative overflow-hidden transition-all ${p?"opacity-50 grayscale":"hover:border-zinc-600"}`,children:[be&&!p&&e.jsx("div",{className:"absolute top-0 right-0 bg-pink-600 text-white text-[9px] font-black px-2 py-1 rounded-bl-xl uppercase tracking-wider animate-pulse shadow-[0_0_10px_#db2777]",children:"BLESKOV츼 AKCE"}),e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${C.rarity==="Legendary"?"bg-yellow-500":C.rarity==="Epic"?"bg-purple-500":C.rarity==="Rare"?"bg-blue-500":"bg-zinc-600"}`}),e.jsxs("div",{className:"pl-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h3",{className:"font-bold text-white text-lg leading-tight",children:C.title}),e.jsxs("div",{className:`flex items-center gap-1 text-[10px] px-1.5 py-0.5 rounded font-bold uppercase border ${p?"bg-red-900/20 text-red-500 border-red-900/40":"bg-zinc-800 text-zinc-200 border-zinc-700"}`,children:[e.jsx(He,{className:"w-3 h-3"}),p?"Vyprod치no":`Skladem: ${N}`]})]}),e.jsxs("span",{className:"text-[10px] text-zinc-400 uppercase tracking-wider font-bold block mb-2",children:[C.type,"  ",C.rarity]}),e.jsxs("p",{className:"text-xs text-zinc-300 line-clamp-2 font-serif leading-relaxed mb-2 italic opacity-80",children:['"',C.description,'"']}),ae(C.stats)]}),e.jsxs("div",{className:"pl-3 mt-3 pt-3 border-t border-zinc-800 flex justify-between items-end",children:[e.jsxs("div",{className:"flex flex-col",children:[D<Q&&e.jsxs("span",{className:"text-[10px] text-zinc-500 line-through decoration-red-500 font-mono mb-0.5",children:[Q," GOLD"]}),e.jsxs("div",{className:`flex items-center gap-1 font-mono font-black text-xl ${ue?"text-yellow-500":"text-red-500"}`,children:[D," ",e.jsx(ze,{className:"w-4 h-4"})]}),le&&e.jsx("span",{className:"text-[8px] text-green-500 font-bold uppercase",children:le==="SALE"?"Sleva":"T콏칤dn칤 Bonus"})]}),e.jsx("button",{onClick:()=>Z(C),disabled:p||!ue,className:`px-6 py-3 rounded-lg font-bold uppercase tracking-widest text-xs transition-all shadow-lg flex items-center justify-center gap-2 ${p?"bg-zinc-800 text-zinc-500 cursor-not-allowed border border-zinc-700":ue?"bg-signal-cyan text-black hover:bg-white shadow-[0_0_15px_rgba(0,242,255,0.4)] active:scale-95":"bg-zinc-900 text-zinc-600 cursor-not-allowed border border-zinc-800"}`,children:p?"Vyprod치no":ue?e.jsxs(e.Fragment,{children:[e.jsx(Ot,{className:"w-4 h-4"})," Koupit"]}):"Drah칠"})]})]},C.id)})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"mb-4 bg-zinc-900 border border-zinc-800 p-3 rounded-lg flex items-center gap-3",children:[e.jsx(Ga,{className:"w-5 h-5 text-green-500"}),e.jsx("p",{className:"text-xs text-zinc-200 font-bold leading-relaxed",children:"Vyberte p콏edm캩t k prodeji."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[(n||[]).filter(C=>C.type===se.ITEM||C.type==="P콎EDM캨T").map(C=>e.jsxs("button",{onClick:()=>F(C),className:"bg-zinc-900 border border-zinc-800 p-3 rounded-xl flex flex-col gap-2 relative overflow-hidden hover:border-green-500/50 transition-colors text-left group active:scale-95",children:[e.jsx("div",{className:"flex justify-between items-start w-full",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-black p-2 rounded-lg border border-zinc-800 group-hover:border-green-500/30 transition-colors",children:e.jsx(He,{className:"w-5 h-5 text-zinc-400 group-hover:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white text-sm uppercase tracking-tight",children:C.title}),e.jsx("span",{className:"text-[9px] font-bold uppercase bg-black/40 px-1.5 rounded text-zinc-400 border border-white/10",children:C.rarity})]})]})}),ae(C.stats)]},C.id)),(!n||n.filter(C=>C.type===se.ITEM||C.type==="P콎EDM캨T").length===0)&&e.jsx("p",{className:"col-span-1 text-center text-zinc-500 text-xs py-10 uppercase font-bold tracking-widest",children:"V치코 batoh je pr치zdn칳."})]})]})}),e.jsx(de,{children:J&&e.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-black/95 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(_.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-zinc-900 border border-zinc-700 rounded-2xl p-6 w-full max-w-sm text-center relative overflow-hidden",children:[e.jsx("button",{onClick:()=>te(null),className:"absolute top-4 right-4 text-zinc-400 hover:text-white",children:e.jsx(Me,{className:"w-5 h-5"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-1 uppercase tracking-tighter",children:J.title}),e.jsx("div",{className:"flex justify-center mb-4",children:ae(J.stats)}),ie==="thinking"&&e.jsxs("div",{className:"py-8 flex flex-col items-center gap-4",children:[e.jsx(Ua,{className:"w-12 h-12 text-neon-purple animate-pulse"}),e.jsx("p",{className:"text-sm font-bold text-neon-purple uppercase tracking-widest animate-pulse",children:"Obchodn칤k p콏em칳코l칤..."})]}),ie==="reject"&&e.jsxs("div",{className:"py-4 flex flex-col items-center gap-4",children:[e.jsx(Ts,{className:"w-12 h-12 text-red-500"}),e.jsx("div",{className:"bg-black/60 p-4 rounded-xl border-l-4 border-red-500 text-left w-full border border-zinc-800",children:e.jsx("p",{className:"text-sm italic text-zinc-100 leading-relaxed font-serif",children:'"Tohle? To je bezcenn칳 kr치m. O to nem치m z치jem. P콏ines mi n캩co po콏치dn칠ho, co m치m na seznamu."'})}),e.jsx("button",{onClick:()=>te(null),className:"w-full py-3 bg-zinc-800 text-white font-bold uppercase rounded-lg border border-zinc-700 tracking-widest text-xs",children:"Zp캩t k Batohu"})]}),ie==="offer"&&e.jsxs("div",{className:"py-4 flex flex-col items-center gap-4",children:[e.jsx(Is,{className:"w-12 h-12 text-green-500"}),e.jsxs("div",{className:"bg-black/60 p-4 rounded-xl border-l-4 border-green-500 text-left w-full border border-zinc-800",children:[e.jsx("p",{className:"text-sm italic text-zinc-200 mb-4 font-serif leading-relaxed",children:'"Hmm, zaj칤mav칠. O tohle bych z치jem m캩l."'}),e.jsxs("div",{className:"flex justify-between items-center bg-black/50 p-3 rounded border border-zinc-800",children:[e.jsx("span",{className:"text-xs font-bold uppercase text-zinc-300 tracking-wider",children:"Nab칤dka:"}),e.jsxs("span",{className:"text-xl font-mono font-bold text-green-500 flex items-center gap-1",children:[L," ",e.jsx(ze,{className:"w-4 h-4"})]})]})]}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx("button",{onClick:()=>te(null),className:"flex-1 py-3 bg-zinc-800 text-zinc-300 font-bold uppercase rounded-lg border border-zinc-700 text-xs tracking-widest",children:"Odm칤tnout"}),e.jsx("button",{onClick:X,className:"flex-1 py-3 bg-green-600 hover:bg-green-500 text-white font-bold uppercase rounded-lg shadow-[0_0_15px_rgba(34,197,94,0.4)] text-xs tracking-widest",children:"PRODAT"})]})]})]})})})]})},Ls=()=>Qe(()=>import("./InventoryView-BDbPwm56.js"),__vite__mapDeps([0,1,2]),import.meta.url),Ds=()=>Qe(()=>import("./Generator-C1raaoqF.js"),__vite__mapDeps([3,1,2]),import.meta.url),$s=()=>Qe(()=>import("./CharacterManagement-BPfGiF8h.js"),__vite__mapDeps([4,1,2]),import.meta.url),Vs=()=>Qe(()=>import("./Room-DKCP_HST.js"),__vite__mapDeps([5,1,2]),import.meta.url),Hs=()=>Qe(()=>import("./SettingsView-CW0Lfad7.js"),__vite__mapDeps([6,1]),import.meta.url),Gs=()=>Qe(()=>import("./SpaceshipView-DspdBIlj.js"),__vite__mapDeps([7,1,2]),import.meta.url),En=a.lazy(Ls),In=a.lazy(Ds),An=a.lazy($s),Rn=a.lazy(Vs),_n=a.lazy(Hs),On=a.lazy(Gs);class Mn extends a.Component{constructor(){super(...arguments);ns(this,"state",{hasError:!1})}static getDerivedStateFromError(h){return{hasError:!0}}componentDidCatch(h,n){}render(){return this.state.hasError?e.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center bg-black p-10 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-950/20 border border-red-500/50 rounded-full flex items-center justify-center mb-6 shadow-[0_0_20px_rgba(239,68,68,0.2)]",children:e.jsx(Ie,{className:"w-8 h-8 text-red-500"})}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-widest mb-2",children:"Chyba_Segmentu"}),e.jsxs("p",{className:"text-zinc-500 text-[10px] font-mono uppercase tracking-widest mb-8 leading-relaxed",children:["Nepoda콏ilo se st치hnout hern칤 modul.",e.jsx("br",{}),"Mo쬹치 ztr치ta sign치lu se sektorem."]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"button-primary py-4 px-10 text-[10px]",children:"Restartovat HUD"})]}):this.props.children}}const Pn=()=>e.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center bg-black gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"w-12 h-12 text-signal-cyan animate-spin opacity-50"}),e.jsx(_.div,{animate:{scale:[1,1.2,1],opacity:[.3,1,.3]},transition:{duration:1.5,repeat:1/0},className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-signal-cyan rounded-full shadow-[0_0_10px_#00f2ff]"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-black text-signal-cyan uppercase tracking-[0.4em] animate-pulse",children:"Synchronizace_Dat"}),e.jsx("span",{className:"text-[8px] font-mono text-zinc-600 uppercase mt-1",children:"Stahov치n칤_Segmentu..."})]})]}),Ln=()=>{const t=hn(),[s,h]=a.useState(()=>sessionStorage.getItem("nexus_boot_done")==="true"),[n,l]=a.useState(.85),[r,c]=a.useState(navigator.onLine);a.useEffect(()=>{s&&t.userEmail&&r&&(Ls().catch(()=>{}),Vs().catch(()=>{}),Gs().catch(()=>{}),t.isAdmin&&(Ds().catch(()=>{}),t.userEmail==="zbynekbal97@gmail.com"&&$s().catch(()=>{})),Hs().catch(()=>{}))},[s,t.userEmail,r,t.isAdmin]),a.useEffect(()=>{const m=()=>c(navigator.onLine);return window.addEventListener("online",m),window.addEventListener("offline",m),"getBattery"in navigator&&navigator.getBattery().then(j=>{const I=()=>l(j.level);return I(),j.addEventListener("levelchange",I),()=>j.removeEventListener("levelchange",I)}),()=>{window.removeEventListener("online",m),window.removeEventListener("offline",m)}},[]);const x=()=>{h(!0),sessionStorage.setItem("nexus_boot_done","true")},g=()=>{k("message"),ee(15);const m=t.isNight,j=m?"NO캛N칈 PROTOKOL AKTIVN칈":"DENN칈 PROTOKOL AKTIVN칈",I=m?"20:00  06:00":"06:00  20:00",A=m?"Zv칳코en치 aktivita biotick칳ch hrozeb. No캜n칤 varianty karet maj칤 bonus k po코kozen칤 (+5 DMG). Viditelnost skeneru omezena.":"Stabiln칤 atmosf칠rick칠 podm칤nky. Standardn칤 loot tabulky a bezpe캜n칠 obchodn칤 trasy. Bonus k regeneraci kysl칤ku.";t.setNotification({id:"cycle-"+Date.now(),message:`${j}
캛as: ${I}

${A}`,type:"info"})},f=m=>{let j=0;m.forEach(I=>{const Y=String(I.value).replace(/[^0-9-]/g,""),w=parseInt(Y),P=String(I.label).toUpperCase().trim();!isNaN(w)&&w!==0&&(["HP","ZDRAV칈","HEAL"].some(R=>P.includes(R))?(t.handleHpChange(w),j++):["MANA","ENERGIE"].some(R=>P.includes(R))?(t.handleManaChange(w),j++):["PALIVO","FUEL"].some(R=>P.includes(R))?(t.handleFuelChange(w),j++):["GOLD","ZLATO","MINCE"].some(R=>P.includes(R))?(t.handleGoldChange(w),j++):["O2","KYSL칈K"].some(R=>P.includes(R))?(t.setPlayerOxygen(R=>Math.min(100,Math.max(0,R+w))),j++):["ARMOR","BRN캨N칈"].some(R=>P.includes(R))&&(t.setPlayerArmor(R=>Math.max(0,R+w)),j++))}),j>0&&t.setNotification({id:"loot-claim-"+Date.now(),type:"success",message:"Ko콏ist byla 칰sp캩코n캩 p콏ips치na."})},y=m=>{t.setPlayerArmor(j=>Math.max(0,j+m))},v=(m,j)=>{var w,P;const I=t.inventory.find(R=>{var J;return R.type===se.PLANET&&((J=R.planetConfig)==null?void 0:J.planetId)===m});if((w=I==null?void 0:I.planetConfig)!=null&&w.phases&&I.planetConfig.phases.length>0){const R=I.planetProgress||0;if(R<I.planetConfig.phases.length){const J=I.planetConfig.phases[R],te=t.masterCatalog.find(ie=>ie.id===J);if(te){t.setCurrentEvent({...te});return}}}if((P=I==null?void 0:I.planetConfig)!=null&&P.landingEventId){const R=t.masterCatalog.find(J=>J.id===I.planetConfig.landingEventId);if(R){t.setCurrentEvent({...R,id:`LIVE-${Date.now()}`});return}}const A=t.masterCatalog.filter(R=>R.type===j);let Y=null;if(A.length>0){const R=Math.floor(Math.random()*A.length);Y={...A[R],id:`LANDING-${Date.now()}`}}else Y={id:`GEN-${Date.now()}`,title:"Pr콢zkum Sektoru",description:`Narazili jste na nezn치mou aktivitu typu ${j}.`,type:j,rarity:"Common",stats:[],isConsumable:!1};t.setCurrentEvent(Y)};return s?t.userEmail?e.jsxs("div",{className:"h-screen w-screen bg-black overflow-hidden flex flex-col font-sans text-white relative",children:[e.jsx(de,{children:t.notification&&e.jsx("div",{className:"fixed inset-0 z-[20000] pointer-events-none",children:e.jsx(jn,{data:t.notification,onClose:()=>t.setNotification(null)})})}),!t.isServerReady&&!t.isGuest?e.jsx(Ps,{onConnected:()=>t.setIsServerReady(!0),onSwitchToOffline:t.handleSwitchToOffline}):!t.roomState.isNicknameSet||!t.playerClass?e.jsx(gn,{initialNickname:t.roomState.nickname,onConfirmSetup:t.handleGameSetup,isGuest:t.isGuest}):e.jsxs(e.Fragment,{children:[e.jsx(de,{children:t.screenFlash&&e.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-[999] pointer-events-none mix-blend-overlay ${t.screenFlash==="red"?"bg-red-600/40":t.screenFlash==="green"?"bg-green-500/30":t.screenFlash==="blue"?"bg-blue-500/30":"bg-orange-500/50"}`})}),e.jsxs("div",{className:"h-36 bg-zinc-950/95 border-b border-white/10 flex flex-col z-[100] shadow-[0_5px_20px_rgba(0,0,0,0.8)]",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-1 border-b border-white/5 bg-white/[0.01] relative",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-1 h-1 rounded-full ${r?"bg-green-500 animate-pulse":"bg-red-500 shadow-[0_0_8px_red] animate-ping"}`}),t.isAdmin&&e.jsxs("div",{className:`ml-2 px-2 py-0.5 rounded border-[0.5px] text-[6px] font-black uppercase tracking-wider flex items-center gap-1 ${t.isTestMode?"border-orange-500/50 text-orange-500 bg-orange-950/30 shadow-[0_0_10px_rgba(249,115,22,0.2)]":"border-purple-500/50 text-purple-400 bg-purple-950/30 shadow-[0_0_10px_rgba(168,85,247,0.2)]"}`,children:[t.isTestMode?e.jsx(Ba,{className:"w-2 h-2"}):e.jsx(Kt,{className:"w-2 h-2"}),t.isTestMode?"TEST_ENV":"LIVE_DB"]})]}),t.roomState.isInRoom&&t.roomState.isGameStarted&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center gap-2",children:e.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-0.5 rounded-full border animate-pulse shadow-[0_0_10px_rgba(0,0,0,0.1)] ${t.isMyTurn?"bg-green-500/10 border-green-500/50 text-green-500 shadow-[0_0_15px_rgba(34,197,94,0.3)]":"bg-signal-amber/10 border-signal-amber/30 text-signal-amber"}`,children:[t.isMyTurn?e.jsx(_e,{className:"w-2 h-2 text-green-500 animate-pulse"}):e.jsx(Ve,{className:"w-2 h-2 text-signal-amber animate-spin"}),e.jsx("span",{className:"text-[8px] font-black uppercase tracking-[0.2em]",children:t.isMyTurn?"JSI NA TAHU":`NA TAHU: ${t.roomState.turnOrder[t.roomState.turnIndex]||"---"}`})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:g,className:"flex items-center gap-1.5 active:scale-95 transition-transform",children:[t.isNight?e.jsx(Ka,{className:"w-3 h-3 text-indigo-400"}):e.jsx(Fa,{className:"w-3 h-3 text-signal-amber"}),e.jsx("span",{className:"text-[8px] font-mono text-zinc-400 uppercase tracking-widest",children:t.isNight?"Night_Cycle":"Day_Cycle"})]}),e.jsx("div",{className:"w-8 h-1.5 bg-white/5 relative rounded-full overflow-hidden border border-white/10",children:e.jsx("div",{className:"h-full bg-signal-amber shadow-[0_0_50px_#ff9d00]",style:{width:`${n*100}%`}})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-1 p-1 bg-black/40",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-1",children:[e.jsx(qe,{icon:e.jsx(Ue,{className:"w-4 h-4"}),value:t.playerHp,max:150,color:"#ef4444",label:"HP"}),e.jsx(qe,{icon:e.jsx(Je,{className:"w-4 h-4"}),value:t.playerMana,max:100,color:"#00f2ff",label:"MANA"}),e.jsx(qe,{icon:e.jsx(Ft,{className:"w-4 h-4"}),value:t.playerFuel,max:100,color:"#f97316",label:"PALIVO"})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-1",children:[e.jsx(qe,{icon:e.jsx(ze,{className:"w-4 h-4"}),value:t.playerGold,color:"#fbbf24",label:"GOLD"}),e.jsx(qe,{icon:e.jsx(Ge,{className:"w-4 h-4"}),value:t.playerArmor,color:"#a1a1aa",label:"ARMOR"}),e.jsx(qe,{icon:e.jsx(Nt,{className:"w-4 h-4"}),value:t.playerOxygen,max:100,color:"#22d3ee",label:"O2"})]})]})]}),e.jsx("div",{className:"flex-1 relative overflow-hidden",children:e.jsx(Mn,{children:e.jsxs(a.Suspense,{fallback:e.jsx(Pn,{}),children:[t.activeTab===me.SCANNER&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(Ms,{onScanCode:t.handleScanCode,isAIThinking:t.isAIThinking,isPaused:t.isScannerPaused})}),t.activeTab===me.INVENTORY&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(En,{inventory:t.inventory,loadingInventory:!1,isRefreshing:t.isRefreshing,isAdmin:t.isAdmin,isNight:t.isNight,adminNightOverride:t.adminNightOverride,playerClass:t.playerClass,giftTarget:t.giftTarget,onRefresh:t.handleRefreshDatabase,onItemClick:t.handleOpenInventoryItem,isTestMode:t.isTestMode,getAdjustedItem:t.getAdjustedItem})}),t.activeTab===me.GENERATOR&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(In,{onSaveCard:m=>{t.handleSaveEvent(m,!0)},userEmail:t.userEmail||"",initialData:t.editingEvent,onClearData:()=>t.setEditingEvent(null),onDelete:m=>{t.handleDeleteEvent(m)},masterCatalog:t.masterCatalog})}),t.activeTab===me.ROOM&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(Rn,{roomState:t.roomState,inventory:t.inventory,playerHp:t.playerHp,scanLog:t.scanLog,onExitToMenu:t.handleExitToMenu,onSendMessage:t.handleSendMessage,onStartGame:t.handleStartGame,onInspectItem:t.handleInspectItem,onSwapItems:t.handleSwapItems,userEmail:t.userEmail||void 0,playerClass:t.playerClass,onToggleReady:t.handleToggleReady,onKickPlayer:t.handleKickPlayer,activeCharacter:t.activeCharacter,isNight:t.isNight})}),t.activeTab===me.SETTINGS&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(_n,{onBack:()=>t.setActiveTab(me.SCANNER),onLogout:t.handleLogout,soundEnabled:t.soundEnabled,vibrationEnabled:t.vibrationEnabled,onToggleSound:t.handleToggleSound,onToggleVibration:t.handleToggleVibration,userEmail:t.userEmail,isAdmin:t.isAdmin,isTestMode:t.isTestMode,onToggleTestMode:t.toggleTestMode,onHardReset:t.handleHardReset,onWipeTestVault:t.handleWipeTestVault})}),t.activeTab===me.SPACESHIP&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(On,{playerFuel:t.playerFuel,inventory:t.inventory,onPlanetLand:v,onFuelConsume:m=>t.handleFuelChange(m),onProgressPlanet:m=>{t.handlePlanetProgress(m)},masterCatalog:t.masterCatalog})}),t.activeTab===me.CHARACTERS&&e.jsx("div",{className:"absolute inset-0 bg-black",children:e.jsx(An,{userEmail:t.userEmail||""})})]})})}),e.jsxs("div",{className:"h-20 bg-zinc-950 border-t-2 border-signal-cyan/40 flex items-center justify-around px-2 pb-2 relative z-50 shadow-[0_-12px_35px_rgba(0,242,255,0.25)]",children:[e.jsx($e,{active:t.activeTab===me.SCANNER,onClick:()=>t.setActiveTab(me.SCANNER),icon:e.jsx(zs,{}),label:"Sken"}),e.jsx($e,{active:t.activeTab===me.INVENTORY,onClick:()=>t.setActiveTab(me.INVENTORY),icon:e.jsx(We,{}),label:t.isAdmin&&!t.isTestMode?"Datab치ze":"Batoh"}),e.jsx($e,{active:t.activeTab===me.SPACESHIP,onClick:()=>t.setActiveTab(me.SPACESHIP),icon:e.jsx(Cs,{}),label:"Lo캞"}),t.isAdmin&&!t.isTestMode&&e.jsx($e,{active:t.activeTab===me.GENERATOR,onClick:()=>t.setActiveTab(me.GENERATOR),icon:e.jsx(Be,{}),label:"Fab"}),t.userEmail==="zbynekbal97@gmail.com"&&!t.isTestMode&&e.jsx($e,{active:t.activeTab===me.CHARACTERS,onClick:()=>t.setActiveTab(me.CHARACTERS),icon:e.jsx(Za,{}),label:"Postavy"}),e.jsx($e,{active:t.activeTab===me.ROOM,onClick:()=>t.setActiveTab(me.ROOM),icon:e.jsx(ws,{}),label:"T칳m"}),e.jsx($e,{active:t.activeTab===me.SETTINGS,onClick:()=>t.setActiveTab(me.SETTINGS),icon:e.jsx(qa,{}),label:"Sys"})]}),e.jsx(de,{children:t.isDocking&&e.jsx(wn,{onComplete:t.handleDockingComplete})}),e.jsx(de,{children:t.activeMerchant&&e.jsx(Tn,{merchant:t.activeMerchant,userGold:t.playerGold,adminEmail:t.isTestMode?"test1@nexus.cz":"zbynekbal97@gmail.com",inventory:t.inventory,playerClass:t.playerClass,onClose:()=>t.setActiveMerchant(null),onBuy:t.handleBuyItem,onSell:t.handleSellItem,onAddFreeItem:m=>t.handleSaveEvent(m,!1),masterCatalog:t.masterCatalog})}),e.jsx(de,{children:t.activeStation&&e.jsx(Cn,{station:t.activeStation,onLeave:t.handleLeaveStation,onClaimRewards:t.handleClaimStationRewards,inventory:t.inventory,masterCatalog:t.masterCatalog,onCraft:m=>{t.handleCraftItem(m.id,[],m)},playerGold:t.playerGold,playerClass:t.playerClass,onInventoryUpdate:t.handleRefreshDatabase,isAdmin:t.isAdmin,isTestMode:t.isTestMode,onGoldChange:t.handleGoldChange})}),e.jsx(de,{children:t.currentEvent&&!t.isDocking&&!t.activeStation&&!t.activeMerchant&&e.jsx(yn,{event:t.currentEvent,onClose:()=>t.closeEvent(),onSave:()=>{t.handleSaveEvent(t.currentEvent,!1)},onUse:()=>{t.handleUseEvent(t.currentEvent)},onDiscard:()=>{t.handleDeleteEvent(t.currentEvent.id)},onResolveDilemma:t.handleResolveDilemma,isSaved:t.inventory.some(m=>{var j;return m.id===((j=t.currentEvent)==null?void 0:j.id)}),onPlayerDamage:t.handleHpChange,playerHp:t.playerHp,playerArmor:t.playerArmor,onArmorChange:y,playerClass:t.playerClass,inventory:t.inventory,onUseItem:m=>t.handleUseEvent(m),onClaimLoot:f})})]}),e.jsx("style",{children:`
        .stat-glow-box {
          box-shadow: inset 0 0 10px var(--slot-color-alpha);
          border-color: var(--slot-color-border);
        }
        .animate-spin-slow {
          animation: spin 6s linear infinite;
        }
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]}):e.jsx(fn,{onLogin:t.handleLogin}):e.jsx(bn,{onComplete:x})},qe=({icon:t,value:s,max:h,color:n,label:l})=>{const r=h?Math.min(100,Math.max(0,s/h*100)):100;return e.jsxs("div",{className:"relative overflow-hidden rounded-md bg-zinc-950/80 border border-white/5 flex flex-col items-center justify-center py-1 h-[48px] group",children:[e.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-10 transition-opacity duration-500",style:{backgroundColor:n}}),e.jsxs("div",{className:"flex flex-col items-center gap-0.5 z-10 relative w-full px-2",children:[e.jsxs("div",{className:"flex items-end justify-center gap-1.5 w-full",children:[e.jsx("div",{className:"mb-0.5 opacity-80",style:{color:n},children:t}),e.jsx("span",{className:"font-mono font-black text-lg leading-none text-white tracking-tighter",style:{textShadow:`0 0 10px ${n}40`},children:s})]}),e.jsx("span",{className:"text-[7px] font-bold text-zinc-500 uppercase tracking-[0.2em]",children:l})]}),h&&e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-[2px] bg-white/5",children:e.jsx("div",{className:"h-full transition-all duration-700 ease-out relative",style:{width:`${r}%`,backgroundColor:n},children:e.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-1 h-1 rounded-full bg-white opacity-50 blur-[1px]"})})})]})},$e=({active:t,onClick:s,icon:h,label:n})=>e.jsxs("button",{onClick:s,className:`flex flex-col items-center gap-1 transition-all duration-300 ${t?"text-signal-cyan scale-110":"text-zinc-500"}`,children:[e.jsx("div",{className:`p-2 rounded-xl transition-colors ${t?"bg-signal-cyan/10 border border-signal-cyan/20":""}`,children:h}),e.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest",children:n})]}),Us=document.getElementById("root");if(!Us)throw new Error("Could not find root element to mount to");"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").then(t=>{}).catch(t=>{})});const hs="263088388062-9dgio8dv930qsefdokl2g0uqekvrvs2c.apps.googleusercontent.com";window.onerror=function(t,s,h,n,l){const r=document.createElement("div");return r.style.position="fixed",r.style.top="0",r.style.left="0",r.style.width="100vw",r.style.height="100vh",r.style.backgroundColor="#000000",r.style.color="#ff0000",r.style.zIndex="999999",r.style.padding="20px",r.style.fontFamily="monospace",r.style.whiteSpace="pre-wrap",r.style.overflow="auto",r.innerHTML=`<h1>CRITICAL ERROR</h1><h3>${t}</h3><p>${s}:${h}:${n}</p><pre>${(l==null?void 0:l.stack)||"No stack"}</pre>`,document.body.appendChild(r),!1};window.onunhandledrejection=function(t){var h;const s=document.createElement("div");s.style.position="fixed",s.style.top="50%",s.style.left="0",s.style.width="100vw",s.style.height="50vh",s.style.backgroundColor="#1a0000",s.style.color="#ff5555",s.style.zIndex="999999",s.style.padding="20px",s.style.fontFamily="monospace",s.style.whiteSpace="pre-wrap",s.style.borderTop="2px solid red",s.style.overflow="auto",s.innerHTML=`<h1>UNHANDLED PROMISE REJECTION</h1><pre>${((h=t.reason)==null?void 0:h.stack)||t.reason}</pre>`,document.body.appendChild(s)};const fs=Pt.createRoot(Us);hs.length<10?fs.render(e.jsxs("div",{className:"h-screen w-screen bg-zinc-950 flex flex-col items-center justify-center p-8 text-center text-white",children:[e.jsx("div",{className:"w-20 h-20 bg-red-900/20 rounded-full flex items-center justify-center border border-red-500/50 mb-6",children:e.jsx(Ie,{className:"w-10 h-10 text-red-500"})}),e.jsx("h1",{className:"text-2xl font-black uppercase tracking-widest mb-2",children:"Chyba Konfigurace"}),e.jsxs("p",{className:"text-sm text-zinc-400 font-mono mb-6 max-w-md",children:["Aplikace postr치d치 ",e.jsx("strong",{children:"VITE_GOOGLE_CLIENT_ID"}),".",e.jsx("br",{}),"Vytvo콏te soubor ",e.jsx("code",{children:".env"})," v ko콏enov칠m adres치콏i a p콏idejte va코e Google Client ID."]}),e.jsx("div",{className:"bg-black p-4 rounded border border-zinc-800 text-xs font-mono text-zinc-500",children:"VITE_GOOGLE_CLIENT_ID=va코e-id-z-google-cloud.apps.googleusercontent.com"})]})):fs.render(e.jsx(Ya.StrictMode,{children:e.jsx(Qa,{clientId:hs,children:e.jsx(Ln,{})})}));export{se as G,Oe as P,qn as a,Wn as b,Zn as d,Yn as g,k as p,Jn as s,ee as v};
