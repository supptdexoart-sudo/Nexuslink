const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./InventoryView-BCvUrcOC.js","./vendor-D0m_jY5z.js","./utils-CiN0I5A8.js","./Generator-Bwj1m05-.js","./Room-7z78Kx_7.js","./SettingsView-TgEdZf7x.js","./SpaceshipView-zh67IdI9.js"])))=>i.map(i=>d[i]);
var Is=Object.defineProperty;var As=(t,s,m)=>s in t?Is(t,s,{enumerable:!0,configurable:!0,writable:!0,value:m}):t[s]=m;var yt=(t,s,m)=>As(t,typeof s!="symbol"?s+"":s,m);import{a as Os,r as l,j as e,T as pe,C as Rs,A as Q,m as k,L as He,K as Ps,W as Ls,S as Ds,b as Ms,c as Mt,P as $s,d as $t,e as Vs,U as Vt,f as dt,g as Ze,D as xt,h as Bt,i as Bs,k as Gt,l as Ut,F as Ht,n as Kt,o as Ft,p as rt,H as Gs,G as mt,q as Us,E as Hs,s as Ks,X as ke,I as it,M as Fs,t as qs,u as _e,v as Zs,N as Js,w as Ys,x as st,y as Ce,z as he,Z as Ke,B as Ws,J as je,O as Ie,Q as qt,V as Xs,Y as Fe,_ as Qs,$ as lt,a0 as ea,a1 as Zt,a2 as Ae,a3 as Jt,a4 as ta,a5 as Yt,a6 as ut,a7 as pt,a8 as sa,a9 as aa,aa as na,ab as ra,ac as ia,ad as ot,ae as la,af as at,ag as oa,ah as ca,ai as we,aj as da,ak as xa,al as wt,am as ma,an as ua,ao as pa,ap as ha,aq as fa,R as ga}from"./vendor-D0m_jY5z.js";import{Html5Qrcode as ba,Html5QrcodeSupportedFormats as Me}from"html5-qrcode";import{G as ja,a as Na}from"./utils-CiN0I5A8.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))a(x);new MutationObserver(x=>{for(const d of x)if(d.type==="childList")for(const n of d.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function m(x){const d={};return x.integrity&&(d.integrity=x.integrity),x.referrerPolicy&&(d.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?d.credentials="include":x.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(x){if(x.ep)return;x.ep=!0;const d=m(x);fetch(x.href,d)}})();var ct={},kt=Os;ct.createRoot=kt.createRoot,ct.hydrateRoot=kt.hydrateRoot;const va="modulepreload",ya=function(t,s){return new URL(t,s).href},St={},Oe=function(s,m,a){let x=Promise.resolve();if(m&&m.length>0){const n=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),b=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));x=Promise.allSettled(m.map(i=>{if(i=ya(i,a),i in St)return;St[i]=!0;const h=i.endsWith(".css"),u=h?'[rel="stylesheet"]':"";if(!!a)for(let P=n.length-1;P>=0;P--){const I=n[P];if(I.href===i&&(!h||I.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${u}`))return;const j=document.createElement("link");if(j.rel=h?"stylesheet":va,h||(j.as="script"),j.crossOrigin="",j.href=i,b&&j.setAttribute("nonce",b),document.head.appendChild(j),h)return new Promise((P,I)=>{j.addEventListener("load",P),j.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${i}`)))})}))}function d(n){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=n,window.dispatchEvent(o),!o.defaultPrevented)throw n}return x.then(n=>{for(const o of n||[])o.status==="rejected"&&d(o.reason);return s().catch(d)})};var R=(t=>(t.ITEM="PŘEDMĚT",t.ENCOUNTER="SETKÁNÍ",t.TRAP="NÁSTRAHA",t.MERCHANT="OBCHODNÍK",t.DILEMA="DILEMA",t.BOSS="BOSS",t.SPACE_STATION="VESMÍRNÁ_STANICE",t.PLANET="PLANETA",t))(R||{}),Ee=(t=>(t.WARRIOR="Válečník",t.MAGE="Mág",t.ROGUE="Zloděj",t.CLERIC="Kněz",t))(Ee||{});const K="https://nexus-backend-m492.onrender.com/api",Wt="nexus_admin_token",wa="263088388062-9dgio8dv930qsefdokl2g0uqekvrvs2c.apps.googleusercontent.com",X=async(t,s={},m=!1)=>{if(!navigator.onLine)throw new Error("OFFLINE_MODE");try{const a=sessionStorage.getItem(Wt),x=localStorage.getItem("nexus_current_user"),d=new Headers(s.headers||{});a&&d.set("x-admin-key",a),x&&d.set("x-user-email",x),!d.has("Content-Type")&&!(s.body instanceof FormData)&&d.set("Content-Type","application/json");const n=await fetch(t,{...s,headers:d});if(!n.ok){const o=await n.json().catch(()=>({message:n.statusText}));throw new Error(o.message||`API Error: ${n.status}`)}return await n.json()}catch(a){throw a}},ka=async()=>{if(!navigator.onLine)return!1;try{const t=new AbortController,s=setTimeout(()=>t.abort(),2e3),m=await fetch(`${K}/health`,{signal:t.signal});return clearTimeout(s),m.ok}catch{return!1}},Nn=async()=>{if(!navigator.onLine)throw new Error("Nelze zálohovat v offline režimu.");const t=sessionStorage.getItem(Wt),s=await fetch(`${K}/admin/backup`,{method:"GET",headers:{"x-admin-key":t||""}});if(!s.ok)throw new Error("Chyba při stahování zálohy (Access Denied?)");const m=await s.blob(),a=window.URL.createObjectURL(m),x=document.createElement("a");x.href=a,x.download=`nexus_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(x),x.click(),window.URL.revokeObjectURL(a),document.body.removeChild(x)},vn=async t=>X(`${K}/admin/purge/${encodeURIComponent(t)}`,{method:"DELETE"}),zt=async t=>X(`${K}/inventory/validate`,{method:"POST",body:JSON.stringify({items:t})}),Sa=async(t,s,m,a)=>X(`${K}/inventory/swap`,{method:"POST",body:JSON.stringify({player1Email:t,player2Email:s,item1Id:m,item2Id:a})}),Tt=async t=>{await X(`${K}/rooms/${t}/start-game`,{method:"POST"})},za=async(t,s)=>{await X(`${K}/rooms/${t}/acknowledge-round`,{method:"POST",body:JSON.stringify({userName:s})})},Ta=async t=>{const s=`${K}/auth/google`;return X(s,{method:"POST",body:JSON.stringify({credential:t,clientId:wa})})},$e=async t=>X(`${K}/inventory/${t}`),qe=async(t,s)=>X(`${K}/inventory/${t}`,{method:"POST",body:JSON.stringify(s)}),Ue=async(t,s)=>X(`${K}/inventory/${t}/${encodeURIComponent(s)}`,{method:"DELETE"}),Et=async()=>X(`${K}/inventory/zbynekbal97@gmail.com`),_t=async(t,s)=>{try{return await X(`${K}/inventory/${t}/${encodeURIComponent(s)}`,void 0,!0)}catch{return null}},Ea=async t=>X(`${K}/rooms/${t}/status`),_a=async(t,s,m)=>{X(`${K}/rooms/${t}/status`,{method:"POST",body:JSON.stringify({userName:s,hp:m})},!0).catch(()=>{})},Ca=async t=>X(`${K}/rooms/${t}/next-turn`,{method:"POST"}),Ct=async(t,s)=>{X(`${K}/rooms/${t}/leave`,{method:"POST",body:JSON.stringify({userName:s})},!0).catch(()=>{})},It=async(t,s,m)=>X(`${K}/rooms/${t}/messages`,{method:"POST",body:JSON.stringify({sender:s,text:m})},!0),Ia=async t=>X(`${K}/rooms/${t}/messages`),Aa=async(t,s,m)=>X(`${K}/rooms`,{method:"POST",body:JSON.stringify({roomId:t,hostName:s,password:m})}),Oa=async(t,s,m,a,x)=>X(`${K}/rooms/${t}/join`,{method:"POST",body:JSON.stringify({userName:s,email:x,hp:m||100,password:a})}),Ra=[{id:"ITEM-01",title:"Základní Lékárnička",description:"Stará plechová krabička s nápisem 'První pomoc'. Obsahuje čisté obvazy.",type:R.ITEM,rarity:"Common",isConsumable:!0,stats:[{label:"HP",value:"+20"}],price:15},{id:"ITEM-02",title:"Energetický Článek",description:"Standardní baterie pro Nexus zařízení. Trochu jiskří.",type:R.ITEM,rarity:"Common",isConsumable:!0,stats:[{label:"MANA",value:"+25"}],price:25},{id:"BOSS-01",title:"Strážce Brány",description:"Masivní mechanický konstrukt, který nepustí nikoho bez propustky.",type:R.BOSS,rarity:"Legendary",stats:[{label:"HP",value:"500"},{label:"ATK",value:"25"}],bossPhases:[{name:"Obranný režim",triggerType:"HP_PERCENT",triggerValue:50,description:"Strážce aktivuje štíty.",damageBonus:10}]},{id:"DILEMA-01",title:"Rezavé Dveře",description:"Stojíš před dveřmi, které vedou do neznáma. Slyšíš z nich podivné škrábání.",type:R.DILEMA,rarity:"Common",dilemmaOptions:[{label:"Vykopnout dveře",successChance:100,consequenceText:"Dveře povolí, ale hluk přilákal nepřátele!",effectType:"hp",effectValue:-10},{label:"Opatrně otevřít",successChance:100,consequenceText:"Podařilo se ti vklouznout dovnitř tiše.",effectType:"none",effectValue:0}]},{id:"TRAP-01",title:"Elektrický Oblouk",description:"Ze stěny šlehají blesky. Musíš proběhnout ve správný moment!",type:R.TRAP,rarity:"Rare",trapConfig:{difficulty:12,damage:30,disarmClass:"Zloděj",successMessage:"Proklouzl jsi bez škrábnutí!",failMessage:"Dostal jsi ránu proudem!"}},{id:"PLANET-01",title:"Nav Data: Terra Nova",description:"Souřadnice k obyvatelné planetě s bujnou vegetací. Bezpečná zóna pro obchod.",type:R.PLANET,rarity:"Rare",planetConfig:{planetId:"p1",landingEventType:R.MERCHANT}},{id:"PLANET-02",title:"Nav Data: Kepler-186f",description:"Vzdálená exoplaneta pokrytá ledem. Detekovány staré ruiny.",type:R.PLANET,rarity:"Epic",planetConfig:{planetId:"p2",landingEventType:R.DILEMA}},{id:"PLANET-03",title:"Nav Data: Mars Outpost",description:"Vojenská základna na Marsu. Vysoké riziko konfliktu.",type:R.PLANET,rarity:"Rare",planetConfig:{planetId:"p3",landingEventType:R.ENCOUNTER}},{id:"PLANET-04",title:"Nav Data: Black Nebula",description:"Nestabilní sektor plný anomálií. Pouze pro zkušené piloty.",type:R.PLANET,rarity:"Legendary",planetConfig:{planetId:"p4",landingEventType:R.BOSS}}];let xe=null,ze=null,ue=null,Ve=null,Be=null,ht=localStorage.getItem("nexus_sound_enabled")!=="false",ft=localStorage.getItem("nexus_vibration_enabled")!=="false";const Pa=()=>ht,La=()=>ft,Da=t=>{ht=t,localStorage.setItem("nexus_sound_enabled",String(t)),t&&S("click")},Ma=t=>{ft=t,localStorage.setItem("nexus_vibration_enabled",String(t)),t&&H(50)},$a=()=>(xe||(xe=new(window.AudioContext||window.webkitAudioContext),ze=xe.createGain(),ze.gain.value=.5,ue=xe.createDynamicsCompressor(),ue.threshold.value=-24,ue.knee.value=30,ue.ratio.value=12,ue.attack.value=.003,ue.release.value=.25,Ve=xe.createDelay(1),Ve.delayTime.value=.35,Be=xe.createGain(),Be.gain.value=.25,ze.connect(ue),ze.connect(Ve),Ve.connect(Be),Be.connect(ue),ue.connect(xe.destination)),xe.state==="suspended"&&xe.resume(),{ctx:xe,master:ze}),H=t=>{ft&&typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(t)},S=t=>{if(ht)try{const{ctx:s,master:m}=$a();if(!s||!m)return;const a=s.currentTime,x=(d,n,o,b,i=.1,h=0)=>{const u=s.createOscillator(),g=s.createGain(),j=s.createBiquadFilter();return u.type=n,u.frequency.value=d,u.detune.value=h,j.type="lowpass",j.frequency.setValueAtTime(3e3,o),j.Q.value=1,u.connect(j),j.connect(g),g.connect(m),g.gain.setValueAtTime(0,o),g.gain.linearRampToValueAtTime(i,o+.01),g.gain.exponentialRampToValueAtTime(.001,o+b),u.start(o),u.stop(o+b),{osc:u,gain:g,filter:j}};switch(t){case"click":{const{filter:d}=x(800,"square",a,.08,.05);d.frequency.setValueAtTime(2e3,a),d.frequency.exponentialRampToValueAtTime(100,a+.08)}break;case"open":{const d=x(220,"sawtooth",a,.4,.08,-5),n=x(220,"sawtooth",a,.4,.08,5);d.filter.frequency.setValueAtTime(100,a),d.filter.frequency.exponentialRampToValueAtTime(4e3,a+.3),n.filter.frequency.setValueAtTime(100,a),n.filter.frequency.exponentialRampToValueAtTime(4e3,a+.3)}break;case"scan":[880,1108,1318,1760].forEach((n,o)=>{const b=a+o*.06,{filter:i}=x(n,"square",b,.05,.04);i.frequency.value=3e3});break;case"error":{const d=s.createOscillator(),n=s.createGain(),o=s.createBiquadFilter();d.type="sawtooth",d.frequency.setValueAtTime(110,a),d.frequency.linearRampToValueAtTime(55,a+.3),o.type="lowpass",o.frequency.setValueAtTime(800,a),o.frequency.linearRampToValueAtTime(100,a+.3),d.connect(o),o.connect(n),n.connect(m),n.gain.setValueAtTime(.3,a),n.gain.exponentialRampToValueAtTime(.001,a+.3),d.start(a),d.stop(a+.35)}break;case"success":case"gift":{[523.25,659.25,783.99,1046.5].forEach((i,h)=>{const u=a+h*.08,g=s.createOscillator(),j=s.createGain();g.type="sine",g.frequency.setValueAtTime(i,u),g.connect(j),j.connect(m),j.gain.setValueAtTime(0,u),j.gain.linearRampToValueAtTime(.2,u+.02),j.gain.exponentialRampToValueAtTime(.001,u+.6),g.start(u),g.stop(u+.6)});const n=s.createOscillator(),o=s.createGain(),b=s.createBiquadFilter();n.type="triangle",n.frequency.setValueAtTime(261.63,a),b.type="lowpass",b.frequency.value=600,n.connect(b),b.connect(o),o.connect(m),o.gain.setValueAtTime(0,a),o.gain.linearRampToValueAtTime(.25,a+.05),o.gain.exponentialRampToValueAtTime(.001,a+.8),n.start(a),n.stop(a+.8)}break;case"heal":{const d=s.createOscillator(),n=s.createGain();d.type="sine",d.frequency.setValueAtTime(440,a);const o=s.sampleRate*2,b=s.createBuffer(1,o,s.sampleRate),i=b.getChannelData(0);for(let j=0;j<o;j++)i[j]=Math.random()*2-1;const h=s.createBufferSource();h.buffer=b;const u=s.createBiquadFilter();u.type="bandpass",u.frequency.value=1e3;const g=s.createGain();d.connect(n),h.connect(u),u.connect(g),g.connect(n),n.connect(m),n.gain.setValueAtTime(0,a),n.gain.linearRampToValueAtTime(.2,a+.8),n.gain.linearRampToValueAtTime(0,a+2),g.gain.value=.1,d.start(a),h.start(a),d.stop(a+2),h.stop(a+2)}break;case"damage":{const d=s.sampleRate,n=s.createBuffer(1,d,s.sampleRate),o=n.getChannelData(0);for(let u=0;u<d;u++)o[u]=Math.random()*2-1;const b=s.createBufferSource();b.buffer=n;const i=s.createBiquadFilter();i.type="lowpass",i.frequency.setValueAtTime(1e3,a),i.frequency.exponentialRampToValueAtTime(50,a+.4);const h=s.createGain();h.gain.setValueAtTime(.8,a),h.gain.exponentialRampToValueAtTime(.001,a+.4),b.connect(i),i.connect(h),h.connect(m),b.start(a),b.stop(a+.4),x(60,"square",a,.3,.3)}break;case"message":x(1200,"sine",a,.1,.05),x(1800,"sine",a+.1,.1,.05);break;case"siren":{const d=s.createOscillator(),n=s.createGain(),o=s.createBiquadFilter();d.type="sawtooth",d.frequency.value=150,d.detune.value=10,o.type="lowpass",o.Q.value=15;const b=s.createOscillator();b.type="sine",b.frequency.value=2;const i=s.createGain();i.gain.value=600,b.connect(i),i.connect(o.frequency),o.frequency.value=800,d.connect(o),o.connect(n),n.connect(m),n.gain.setValueAtTime(0,a),n.gain.linearRampToValueAtTime(.3,a+.5),n.gain.linearRampToValueAtTime(0,a+2.5),d.start(a),b.start(a),d.stop(a+2.5),b.stop(a+2.5)}break}}catch{}},Te="zbynekbal97@gmail.com",Ge="admin_test_vault@nexus.local",At=100,Ot=100,Rt=100,Va=100;var Y=(t=>(t.SCANNER="scanner",t.INVENTORY="inventory",t.GENERATOR="generator",t.ROOM="room",t.SETTINGS="settings",t.SPACESHIP="spaceship",t))(Y||{});const Ba=()=>{const t=new Date().getHours();return t>=20||t<6},nt=(t,s,m)=>{var x;let a={...t};if(s&&((x=t.timeVariant)!=null&&x.enabled)&&(a={...a,title:t.timeVariant.nightTitle||a.title,description:t.timeVariant.nightDescription||a.description,type:t.timeVariant.nightType||a.type,stats:t.timeVariant.nightStats||a.stats}),m&&t.classVariants&&t.classVariants[m]){const d=t.classVariants[m];a={...a,title:d.overrideTitle||a.title,description:d.overrideDescription||a.description,type:d.overrideType||a.type,stats:d.bonusStats?[...a.stats||[],...d.bonusStats]:a.stats}}return a},Ga=()=>{const[t,s]=l.useState(()=>localStorage.getItem("nexus_current_user")),m=t===Te,a=t==="guest",[x,d]=l.useState(()=>localStorage.getItem("nexus_admin_test_mode")==="true"),n=m&&x?Ge:t,[o,b]=l.useState(!1),i=Ba(),[h,u]=l.useState(null),[g,j]=l.useState(Pa()),[P,I]=l.useState(La()),[F,L]=l.useState(()=>t===Te?"generator":"scanner"),[_,G]=l.useState(()=>{const r=localStorage.getItem("nexus_master_catalog");return r?JSON.parse(r):Ra}),[W,q]=l.useState(null),[le,M]=l.useState(null),[T,f]=l.useState(null),[,c]=l.useState(null),[E,V]=l.useState(null),[ee,U]=l.useState(!1),[oe,se]=l.useState(!1),[Z,J]=l.useState(()=>{const r=localStorage.getItem(`nexus_inv_${n||"guest"}`);return r?JSON.parse(r):[]});l.useEffect(()=>{if(n){const r=localStorage.getItem(`nexus_inv_${n}`);J(r?JSON.parse(r):[]),a||$e(n).then(async p=>{if(p.length>0)try{const v=p.map(z=>({id:z.id,title:z.title})),{validIds:w}=await zt(v);if(w){const z=_.map(B=>B.id),D=p.filter(B=>{const O=B.id.split("__")[0];return w.includes(B.id)||z.includes(O)});J(D),localStorage.setItem(`nexus_inv_${n}`,JSON.stringify(D))}}catch{J(p),localStorage.setItem(`nexus_inv_${n}`,JSON.stringify(p))}else J([]),localStorage.setItem(`nexus_inv_${n}`,JSON.stringify([]))}).catch(()=>{})}},[n,a]);const[te,ne]=l.useState([]),[re,y]=l.useState(!1),[C,N]=l.useState(null),[$,me]=l.useState(!1),[ae]=l.useState(!1),[Se,Re]=l.useState(!1),[fe,ge]=l.useState(()=>parseInt(localStorage.getItem("nexus_player_hp")||String(At))),[ns,rs]=l.useState(()=>parseInt(localStorage.getItem("nexus_player_mana")||String(Ot))),[gt,is]=l.useState(()=>parseInt(localStorage.getItem("nexus_player_fuel")||String(Rt))),[ls,os]=l.useState(()=>parseInt(localStorage.getItem("nexus_player_gold")||String(Va))),[cs,ds]=l.useState(()=>parseInt(localStorage.getItem("nexus_player_armor")||"0")),[xs,bt]=l.useState(()=>parseInt(localStorage.getItem("nexus_player_oxygen")||"100")),[Je,ms]=l.useState(()=>{const r=localStorage.getItem(`nexus_class_${t||"guest"}`);return r||null}),[A,be]=l.useState({id:localStorage.getItem("nexus_last_room_id")||"",isInRoom:localStorage.getItem("nexus_is_in_room")==="true",messages:[],nickname:localStorage.getItem(`nexus_nickname_${t}`)||"",isNicknameSet:!!localStorage.getItem(`nexus_nickname_${t}`),members:[],turnIndex:0,isGameStarted:!1,roundNumber:0,turnOrder:[],readyForNextRound:[],host:""}),[Ye,Pe]=l.useState(()=>localStorage.getItem("nexus_solo_mode")==="true"),[us,ps]=l.useState(null),hs=l.useRef([]),jt=!Ye&&A.isGameStarted&&A.turnOrder[A.turnIndex]===A.nickname,Nt=!m&&!Ye&&(!A.isGameStarted||!jt),fs=()=>{if(!m)return;const r=!x;d(r),localStorage.setItem("nexus_admin_test_mode",String(r)),S("open"),N({id:"mode-"+Date.now(),type:"info",message:r?"AKTIVOVÁN TESTOVACÍ BATOH":"AKTIVOVÁNA MASTER DATABÁZE"})},de=r=>{ne(p=>[r,...p].slice(0,50))},Ne=r=>{ge(p=>{const v=Math.max(0,Math.min(At,p+r));return localStorage.setItem("nexus_player_hp",String(v)),v}),r<0?(V("red"),S("damage"),H([200]),setTimeout(()=>V(null),500)):r>0&&(V("green"),S("heal"),setTimeout(()=>V(null),500))},We=r=>{rs(p=>{const v=Math.max(0,Math.min(Ot,p+r));return localStorage.setItem("nexus_player_mana",String(v)),v})},Le=r=>{is(p=>{const v=Number(p)||0,w=Number(r)||0,z=Math.max(0,Math.min(Rt,v+w));return localStorage.setItem("nexus_player_fuel",String(z)),z}),r<0&&(V("amber"),S("error"),H([50,100,50]),N({id:"fuel-"+Date.now(),type:"error",message:`VAROVÁNÍ: Spotřeba Paliva ${r}%`}),setTimeout(()=>V(null),800))},Xe=r=>{os(p=>{const v=Math.max(0,p+r);return localStorage.setItem("nexus_player_gold",String(v)),v})},gs=async(r,p=!1)=>{var v;try{let w={...r};if(!p&&!((v=w.resourceConfig)!=null&&v.isResourceContainer)){const z=w.id.split("__")[0],D=`${Date.now()}_${Math.random().toString(36).substring(2,6)}`;w.id=`${z}__${D}`}if(a||!t)J(z=>{var B;if((B=w.resourceConfig)!=null&&B.isResourceContainer){const O=z.findIndex(ie=>ie.id===w.id);if(O>=0){const ie=[...z];return ie[O]=w,localStorage.setItem("nexus_inv_guest",JSON.stringify(ie)),ie}}const D=[...z,w];return localStorage.setItem("nexus_inv_guest",JSON.stringify(D)),D}),de(`Archivováno (Local): ${w.title}`),N({id:"save-local-"+Date.now(),message:"Asset uložen lokálně.",type:"success"});else{const z=p?Te:n;if(!z)throw new Error("No target email");const D=await qe(z,w),B={...D,...w,id:D.id};z===n&&J(O=>{const ie=O.findIndex(ce=>ce.id===B.id);if(ie>=0){const ce=[...O];return ce[ie]=B,localStorage.setItem(`nexus_inv_${n}`,JSON.stringify(ce)),ce}else{const ce=[...O,B];return localStorage.setItem(`nexus_inv_${n}`,JSON.stringify(ce)),ce}}),p&&m?(G(O=>{const ce=O.find(De=>De.id===B.id)?O.map(De=>De.id===B.id?B:De):[...O,B];return localStorage.setItem("nexus_master_catalog",JSON.stringify(ce)),ce}),de(`DB UPDATE: ${w.title}`),N({id:"db-save-"+Date.now(),message:"Zapsáno do Master Databáze.",type:"success"})):(de(`Archivováno: ${w.title}`),N({id:"save-"+Date.now(),message:"Asset uložen do Batohu.",type:"success"}))}}catch{N({id:"err-"+Date.now(),message:"Chyba ukládání.",type:"error"})}},bs=async r=>{const p=Z.find(v=>v.id===r);if(p){const v={...p,planetProgress:(p.planetProgress||0)+1};if(J(w=>w.map(z=>z.id===r?v:z)),a||!n)localStorage.setItem("nexus_inv_guest",JSON.stringify(Z.map(w=>w.id===r?v:w)));else try{await qe(n,v),localStorage.setItem(`nexus_inv_${n}`,JSON.stringify(Z.map(w=>w.id===r?v:w)))}catch{}}},js=async(r,p,v,w)=>{if(!(a||!n)){U(!0);try{await Sa(r,p,v,w);const z=await $e(n);J(z),localStorage.setItem(`nexus_inv_${n}`,JSON.stringify(z)),await It(A.id,"SYSTEM","BURZA_SUCCESS: Výměna assetů byla dokončena."),N({id:"swap-ok",type:"success",message:"Výměna assetů byla úspěšná!"}),S("success")}catch(z){N({id:"swap-err",type:"error",message:z.message||"Chyba při výměně dat."})}finally{U(!1)}}},Qe=async r=>{try{const p=Z.find(v=>v.id===r);!a&&n&&await Ue(n,r),J(v=>{const w=v.filter(z=>z.id!==r);return localStorage.setItem(`nexus_inv_${n||"guest"}`,JSON.stringify(w)),w}),p&&de(`Zahozeno z Batohu: ${p.title}`),N({id:"del-"+Date.now(),message:"Asset odstraněn.",type:"success"})}catch{N({id:"err-"+Date.now(),message:"Chyba při mazání.",type:"error"})}},Ns=async r=>{var p;(p=r.craftingRecipe)!=null&&p.requiredResources},vt=async()=>{y(!0),S("scan");try{let r=[],p=[];if(a?(r=[...Z],p=await Et()):n&&(r=await $e(n),p=await Et()),r.length>0)try{const w=r.map(D=>({id:D.id,title:D.title})),{validIds:z}=await zt(w);if(z){const D=_.map(O=>O.id),B=r.filter(O=>{const ie=O.id.split("__")[0];return!z.includes(O.id)&&!D.includes(ie)});r=r.filter(O=>{const ie=O.id.split("__")[0];return z.includes(O.id)||D.includes(ie)}),B.length>0&&!a&&n&&Promise.all(B.map(O=>Ue(n,O.id))).then(()=>{}).catch(O=>{})}}catch{}const v=a?"nexus_inv_guest":`nexus_inv_${n}`;localStorage.removeItem(v),localStorage.removeItem("nexus_master_catalog"),localStorage.setItem(v,JSON.stringify(r)),localStorage.setItem("nexus_master_catalog",JSON.stringify(p)),J(r),G(p),N({id:"sync-ok-"+Date.now(),message:"Kompletní synchronizace dat.",type:"success"}),S("success")}catch{N({id:"sync-err-"+Date.now(),message:"Chyba synchronizace.",type:"error"}),S("error")}finally{y(!1)}},vs=async()=>{if(!(!x||!m)&&confirm("VAROVÁNÍ: Opravdu chcete smazat CELÝ inventář v Testovacím Režimu? Tato akce je nevratná.")){y(!0),S("error");try{const r=await $e(Ge);await Promise.all(r.map(p=>Ue(Ge,p.id))),J([]),localStorage.setItem(`nexus_inv_${Ge}`,JSON.stringify([])),N({id:"wipe-ok",message:"Testovací batoh byl kompletně vymazán.",type:"success"}),S("success")}catch{N({id:"wipe-err",message:"Chyba při mazání testovacích dat.",type:"error"})}finally{y(!1)}}},ys=async()=>{if(a){if(!confirm("VAROVÁNÍ: Jste v režimu Host. Vynucená synchronizace SMAŽE všechna lokální data a nenávratně ztratíte inventář. Pokračovat?"))return;J([]),localStorage.removeItem("nexus_inv_guest"),localStorage.removeItem("nexus_master_catalog"),N({id:"hard-reset",message:"Lokální data smazána.",type:"info"}),window.location.reload();return}await vt()},ws=async(r,p,v,w)=>{if(localStorage.setItem(`nexus_nickname_${t}`,r),localStorage.setItem(`nexus_class_${t||"guest"}`,p),ms(p),v==="solo"){Pe(!0),localStorage.setItem("nexus_solo_mode","true"),localStorage.setItem("nexus_is_in_room","false"),be(z=>({...z,nickname:r,isNicknameSet:!0,isInRoom:!1,id:""})),de(`Systém aktivován. Batoh připraven, ${r}.`);return}try{let z=v;v==="create"||v==="solo-online"?(z=(v==="solo-online"?"SOLO-":"")+Math.random().toString(36).substring(2,7).toUpperCase(),await Aa(z,r,w),be(D=>({...D,id:z,nickname:r,isNicknameSet:!0,isInRoom:!0,host:r})),v==="solo-online"&&de(`Online mise zahájena v sektoru ${z}.`)):(await Oa(z,r,fe,w,t||void 0),be(D=>({...D,id:z,nickname:r,isNicknameSet:!0,isInRoom:!0}))),localStorage.setItem("nexus_last_room_id",z),localStorage.setItem("nexus_is_in_room","true"),Pe(v==="solo-online"),localStorage.setItem("nexus_solo_mode",v==="solo-online"?"true":"false"),v==="solo-online"&&setTimeout(async()=>{try{await Tt(z)}catch{}},1e3)}catch(z){throw N({id:"room-err",type:"error",message:z.message}),z}},ks=async()=>{A.id&&A.nickname&&await Ct(A.id,A.nickname),be(r=>({...r,isInRoom:!1,id:""})),localStorage.removeItem("nexus_last_room_id"),localStorage.removeItem("nexus_is_in_room"),Pe(!0),localStorage.setItem("nexus_solo_mode","true"),ne([])},Ss=async()=>{if(A.id&&A.nickname)try{await Ct(A.id,A.nickname)}catch{}be(r=>({...r,isInRoom:!1,id:"",isNicknameSet:!1})),localStorage.removeItem("nexus_last_room_id"),localStorage.removeItem("nexus_is_in_room"),Pe(!1),localStorage.setItem("nexus_solo_mode","false"),ne([])},zs=async r=>{if(!(!A.id||!A.nickname))try{await It(A.id,A.nickname,r)}catch{}},Ts=async r=>{U(!0);try{let p=_.find(v=>v.id===r);p||(p=await _t(Te,r)),p?(c("inspect"),q(nt(p,i,Je)),de(`Inspekce: ${p.title}`)):N({id:"inspect-err",type:"error",message:"Data assetu nelze dekódovat."})}catch{N({id:"inspect-err",type:"error",message:"Chyba spojení s Batohem."})}finally{U(!1)}};l.useEffect(()=>{if(!A.isInRoom||!A.id||!o)return;const r=setInterval(async()=>{try{const p=await Ea(A.id),v=await Ia(A.id);hs.current=p.members,be(w=>({...w,members:p.members,turnIndex:p.turnIndex,messages:v,isGameStarted:p.isGameStarted,roundNumber:p.roundNumber,turnOrder:p.turnOrder,readyForNextRound:p.readyForNextRound,host:p.host})),await _a(A.id,A.nickname,fe)}catch{}},2e3);return()=>clearInterval(r)},[A.isInRoom,A.id,A.nickname,fe,a,o]);const Es=async()=>{if(A.host===A.nickname&&!(A.members.length<1))try{await Tt(A.id),S("success")}catch{N({id:"err",type:"error",message:"Nepodařilo se spustit misi."})}},_s=async r=>{if(Nt&&!r.startsWith("friend:")){const w=A.isGameStarted?"NEMŮŽEŠ SKENOVAT: Nejseš na tahu!":"MISE NEZAČALA: Čekejte na hostitele.";N({id:"block",type:"error",message:w}),H([100,50,100]),S("error");return}if(gt<=0&&!r.startsWith("friend:")){N({id:"no-fuel",type:"error",message:"NEDOSTATEK PALIVA: Loď nemůže manévrovat (skenovat)."}),S("error"),H([200,200,200]);return}U(!0),H(50),S("scan");const p=Z.find(w=>w.id.split("__")[0].toLowerCase()===r.toLowerCase()||w.id.toLowerCase()===r.toLowerCase());if(p){et(p,"scanner");return}const v=_.find(w=>w.id.toLowerCase()===r.toLowerCase());if(v){et(v,"scanner");return}if(navigator.onLine)try{const w=await _t(Te,r);if(w){et(w,"scanner");return}}catch{}U(!1),N({id:"not-found-"+Date.now(),type:"error",message:"ID karty nenalezeno."}),S("error")},et=(r,p=null)=>{p==="scanner"&&(Le(-5),de("Manévr lodi: -5% Paliva"));const v=nt(r,i,Je);if(v.type===R.SPACE_STATION&&p==="scanner"){U(!1),se(!0),q(v),c(p);return}q(v),p&&c(p),de(p==="scanner"?`Skenováno: ${v.title}`:`Zobrazeno: ${v.title}`),U(!1)},Cs=()=>{se(!1),W&&W.type===R.SPACE_STATION&&(M(W),q(null),de(`Dokováno: ${W.title}`),S("success"))},tt=()=>{q(null),c(null)};return{userEmail:t,isAdmin:m,isGuest:a,isServerReady:o,setIsServerReady:b,isNight:i,adminNightOverride:h,setAdminNightOverride:u,activeTab:F,setActiveTab:L,currentEvent:W,setCurrentEvent:q,editingEvent:T,setEditingEvent:f,screenFlash:E,inventory:Z,isRefreshing:re,notification:C,setNotification:N,showEndTurnPrompt:$,playerHp:fe,playerMana:ns,playerFuel:gt,playerGold:ls,playerArmor:cs,playerOxygen:xs,playerClass:Je,roomState:A,isSoloMode:Ye,giftTarget:us,setGiftTarget:ps,isScannerPaused:!!W||ae||Se||oe||!!le,isAIThinking:ee,showTurnAlert:ae,showRoundEndAlert:Se,handleAcknowledgeRound:async()=>{if(A.id&&A.nickname)try{await za(A.id,A.nickname),Re(!1)}catch{}},isMyTurn:jt,isBlocked:Nt,handleStartGame:Es,isDocking:oe,handleDockingComplete:Cs,activeStation:le,handleLeaveStation:()=>{M(null),S("open")},handleClaimStationRewards:r=>{r.stationConfig&&(r.stationConfig.fuelReward&&Le(r.stationConfig.fuelReward),r.stationConfig.repairAmount&&Ne(r.stationConfig.repairAmount),r.stationConfig.refillO2&&bt(100),S("success"),N({id:"station-reward",type:"success",message:"Servis dokončen."}))},masterCatalog:_,handleLogin:(r,p)=>{localStorage.setItem("nexus_current_user",r),p&&(localStorage.setItem(`nexus_nickname_${r}`,p),be(v=>({...v,nickname:p}))),s(r),b(!1)},handleLogout:()=>{localStorage.clear(),sessionStorage.clear(),window.location.reload()},handleScanCode:_s,handleSaveEvent:gs,handlePlanetProgress:bs,handleDeleteEvent:Qe,handleUseEvent:async r=>{if(r.isSellOnly){N({id:"sell-only",message:"Tento předmět nelze použít, pouze prodat.",type:"error"});return}let p=!1;r.stats&&r.stats.length>0&&r.stats.forEach(v=>{const z=String(v.value).replace(/[^0-9-]/g,""),D=parseInt(z),B=String(v.label).toUpperCase().trim();!isNaN(D)&&D!==0&&(["HP","ZDRAVÍ","HEAL"].some(O=>B.includes(O))?(Ne(D),p=!0):["MANA","ENERGIE"].some(O=>B.includes(O))?(We(D),p=!0):["PALIVO","FUEL"].some(O=>B.includes(O))?(Le(D),p=!0):["GOLD","ZLATO"].some(O=>B.includes(O))?(Xe(D),p=!0):["O2","KYSLÍK"].some(O=>B.includes(O))?(bt(O=>Math.min(100,Math.max(0,O+D))),p=!0):["ARMOR","BRNĚNÍ"].some(O=>B.includes(O))&&(ds(O=>Math.max(0,O+D)),p=!0))}),p?(S("heal"),N({id:"use-success-"+Date.now(),message:"Předmět použit.",type:"success"}),r.isConsumable?await Qe(r.id):tt()):r.isConsumable?(await Qe(r.id),N({id:"consumed",message:"Předmět spotřebován.",type:"info"}),tt()):(N({id:"no-effect",message:"Tento předmět nemá žádný okamžitý efekt.",type:"info"}),H(50))},handleRefreshDatabase:vt,handleGameSetup:ws,handleLeaveRoom:ks,handleExitToMenu:Ss,handleResolveDilemma:(r,p)=>{var v;p==="success"?((v=r.rewards)==null||v.forEach(w=>{w.type==="HP"&&Ne(w.value),w.type==="MANA"&&We(w.value),w.type==="GOLD"&&Xe(w.value)}),r.effectType==="hp"&&Ne(r.effectValue||0)):r.failDamage&&Ne(-r.failDamage)},handleEndTurn:async()=>{if(A.id)try{await Ca(A.id),me(!1)}catch{}},handleSendMessage:zs,closeEvent:tt,handleHpChange:Ne,handleManaChange:We,handleGoldChange:Xe,handleFuelChange:Le,handleOpenInventoryItem:r=>{m&&!x?(f(r),L("generator")):(c("inventory"),q(r))},getAdjustedItem:nt,handleSwapItems:js,soundEnabled:g,vibrationEnabled:P,handleToggleSound:()=>{Da(!g),j(!g)},handleToggleVibration:()=>{Ma(!P),I(!P)},handleInspectItem:Ts,handleCraftItem:Ns,handleHardReset:ys,handleWipeTestVault:vs,scanLog:te,isTestMode:x,toggleTestMode:fs}},Ua=({onScanCode:t,isAIThinking:s,isPaused:m})=>{const[a,x]=l.useState("idle"),[d,n]=l.useState(""),[o,b]=l.useState(!1),[i,h]=l.useState(""),u=l.useRef(null),g=l.useRef(!1);l.useEffect(()=>(u.current=new ba("qr-reader",{verbose:!1}),()=>{P()}),[]),l.useEffect(()=>{(m||s)&&g.current&&P()},[m,s]);const j=async()=>{if(!(!u.current||g.current))try{x("active"),g.current=!0,await u.current.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250},aspectRatio:1,formatsToSupport:[Me.QR_CODE,Me.EAN_13,Me.CODE_128,Me.CODE_39]},I=>{m||s||(t(I),H(50))},()=>{})}catch(I){x("error"),n(I.message||"Přístup ke kameře zamítnut."),g.current=!1}},P=async()=>{if(u.current&&g.current)try{await u.current.stop(),u.current.clear()}catch{}finally{g.current=!1,x("idle")}};return e.jsxs("div",{className:"relative h-full w-full bg-black flex flex-col items-center justify-center p-6",children:[e.jsx("div",{className:"absolute top-10 left-0 right-0 z-20 flex justify-center pointer-events-none",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur px-4 py-2 border border-white/10 rounded-full flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${a==="active"?"bg-green-500 animate-pulse":"bg-red-500"}`}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-white/70",children:s?"AI_DEKÓDOVÁN...":a==="active"?"OPTIKA_AKTIVNÍ":"SENZOR_OFFLINE"})]})}),e.jsxs("div",{className:"relative w-full aspect-square max-w-sm",children:[e.jsx("div",{className:"absolute -inset-2 border-2 border-signal-cyan/20 rounded-3xl pointer-events-none z-10"}),e.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-signal-cyan rounded-tl-xl z-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-signal-cyan rounded-tr-xl z-10"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-signal-cyan rounded-bl-xl z-10"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-signal-cyan rounded-br-xl z-10"}),e.jsxs("div",{className:"w-full h-full bg-zinc-900 rounded-2xl overflow-hidden relative shadow-2xl",children:[e.jsx("div",{id:"qr-reader",className:"w-full h-full object-cover"}),a!=="active"&&e.jsxs("div",{className:"absolute inset-0 z-20 flex flex-col items-center justify-center p-10 text-center gap-6 bg-zinc-900",children:[a==="error"?e.jsx(pe,{className:"w-12 h-12 text-red-500"}):e.jsx(Rs,{className:"w-12 h-12 text-white/20"}),e.jsx("p",{className:"text-xs text-white/40 uppercase font-bold tracking-widest leading-relaxed",children:a==="error"?d:"Kamera v pohotovostním režimu"}),e.jsxs("button",{onClick:j,className:"button-primary py-3 px-8 text-xs relative overflow-hidden group",children:[e.jsx("span",{className:"relative z-10",children:a==="error"?"Zkusit znovu":"Aktivovat Senzor"}),e.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform"})]})]}),e.jsx(Q,{children:s&&e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-30 bg-signal-cyan/20 backdrop-blur-sm flex flex-col items-center justify-center gap-4",children:[e.jsx(He,{className:"w-12 h-12 text-white animate-spin"}),e.jsx("span",{className:"text-xs font-black text-white uppercase tracking-[0.3em]",children:"Analyzuji_Data..."})]})})]})]}),e.jsxs("button",{onClick:()=>b(!0),className:"mt-12 flex items-center gap-3 text-white/40 hover:text-white transition-colors text-xs font-bold uppercase tracking-widest active:scale-95",children:[e.jsx(Ps,{className:"w-5 h-5"})," Manuální Identifikace"]}),e.jsx(Q,{children:o&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-xl flex items-center justify-center p-8",children:e.jsxs("div",{className:"w-full max-w-xs space-y-6",children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase text-center tracking-widest",children:"Zadejte_ID"}),e.jsx("input",{type:"text",autoFocus:!0,value:i,onChange:I=>h(I.target.value),placeholder:"NAPŘ. ITEM-01",className:"w-full bg-white/5 border border-white/10 p-4 text-white text-center text-xl font-mono uppercase rounded-xl outline-none focus:border-signal-cyan placeholder-white/20"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>b(!1),className:"flex-1 py-4 text-xs font-bold text-white/40 uppercase hover:text-white transition-colors",children:"Zrušit"}),e.jsx("button",{onClick:()=>{t(i),b(!1)},className:"flex-1 button-primary py-4 text-xs shadow-lg shadow-signal-amber/20",children:"Potvrdit"})]})]})})}),e.jsx("style",{children:`
        #qr-reader video { 
            object-fit: cover; 
            width: 100%; 
            height: 100%; 
            border-radius: 1rem;
        }
      `})]})},Pt=["Inicializace protokolu...","Hledání signálu Nexus...","Propojování.##.%./*_#..","Ověřování integrity dat...","Navazování zabezpečeného spojení..."],Ha=({onConnected:t,onSwitchToOffline:s})=>{const[m,a]=l.useState(0),[x,d]=l.useState(1),[n,o]=l.useState(!1),[b,i]=l.useState(!navigator.onLine);return l.useEffect(()=>{const h=()=>i(!navigator.onLine);window.addEventListener("online",h),window.addEventListener("offline",h);const u=setInterval(()=>{a(g=>(g+1)%Pt.length)},3e3);return()=>{window.removeEventListener("online",h),window.removeEventListener("offline",h),clearInterval(u)}},[]),l.useEffect(()=>{let h=!0,u;const g=async()=>{if(h){if(!navigator.onLine){o(!0);return}try{if(await ka()&&h){t();return}}catch{}h&&(d(j=>j+1),x>3&&o(!0),u=setTimeout(g,2500))}};return g(),()=>{h=!1,clearTimeout(u)}},[t,x]),e.jsxs("div",{className:"fixed inset-0 z-[200] bg-zinc-950 flex flex-col items-center justify-center p-6 text-white font-sans overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 z-0 opacity-10 pointer-events-none",style:{backgroundImage:"radial-gradient(#222 1px, transparent 1px)",backgroundSize:"20px 20px"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center max-w-sm w-full",children:[e.jsxs("div",{className:"relative mb-12",children:[e.jsx(k.div,{animate:{scale:[1,2.5],opacity:[.5,0]},transition:{duration:2,repeat:1/0,ease:"easeOut"},className:`absolute inset-0 ${b?"bg-amber-500/20":"bg-neon-blue/20"} rounded-full blur-md`}),e.jsxs("div",{className:`relative w-24 h-24 bg-zinc-900 rounded-2xl border ${b?"border-amber-500/50":"border-zinc-700"} flex items-center justify-center shadow-[0_0_30px_rgba(0,243,255,0.2)]`,children:[b?e.jsx(Ls,{className:"w-10 h-10 text-amber-500"}):e.jsx(Ds,{className:"w-10 h-10 text-neon-blue"}),e.jsx("div",{className:"absolute -top-1 -right-1",children:e.jsxs("span",{className:"relative flex h-3 w-3",children:[e.jsx("span",{className:`animate-ping absolute inline-flex h-full w-full rounded-full ${b?"bg-amber-500":"bg-green-500"} opacity-75`}),e.jsx("span",{className:`relative inline-flex rounded-full h-3 w-3 ${b?"bg-amber-500":"bg-green-500"}`})]})})]})]}),e.jsx("div",{className:"w-full h-1 bg-zinc-900 rounded-full overflow-hidden mb-6 relative",children:e.jsx(k.div,{animate:{x:["-100%","100%"]},transition:{duration:1.5,repeat:1/0,ease:"linear"},className:`absolute inset-y-0 left-0 w-1/2 bg-gradient-to-r from-transparent ${b?"via-amber-500":"via-neon-blue"} to-transparent`})}),e.jsx("h2",{className:"text-xl font-display font-bold uppercase tracking-widest mb-2 text-center",children:b?"OFFLINE_REŽIM":"PŘIPOJOVÁNÍ"}),e.jsx(k.p,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"text-xs text-zinc-500 font-mono uppercase tracking-wider text-center h-4",children:b?"Lokální protokoly aktivní":Pt[m]},m),e.jsxs("div",{className:"mt-8 flex gap-4 text-[10px] text-zinc-600 font-mono uppercase",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ms,{className:`w-3 h-3 ${b?"":"animate-spin"}`}),e.jsx("span",{children:b?"Senzory vypnuty":`Pokus #${x}`})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Mt,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{children:"Local_Vault OK"})]})]}),n&&e.jsxs(k.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},onClick:s,className:"mt-12 py-4 px-8 bg-amber-500/10 border border-amber-500/40 hover:bg-amber-500/20 rounded-xl flex items-center gap-3 text-xs font-black uppercase tracking-widest text-amber-500 hover:text-white transition-all shadow-[0_0_20px_rgba(245,158,11,0.1)]",children:[e.jsx($s,{className:"w-5 h-5"}),"Aktivovat Offline Nasazení"]})]})]})},Ka=({onLogin:t})=>{const[s,m]=l.useState(""),[a,x]=l.useState(!1),[d,n]=l.useState(!1),[o,b]=l.useState(null),i=g=>{if(g.preventDefault(),s.trim().length<3){b("Identifikátor (Nick) musí mít alespoň 3 znaky."),H(100),S("error");return}b(null),n(!0)},h=()=>{n(!1),S("click"),localStorage.setItem("nexus_nickname_guest",s.toUpperCase()),x(!0),setTimeout(()=>{t("guest",s.toUpperCase())},1500)},u=async g=>{if(g.credential){x(!0),b(null),S("click");try{const j=await Ta(g.credential);H([50,50]),t(j.email)}catch(j){x(!1);let P="Chyba Google ověření.";j.message&&j.message.includes("Failed to fetch")?P="Nelze se spojit se serverem (Backend spí nebo blokován).":j.message&&(P=`Server Error: ${j.message}`),b(P),S("error")}}};return a?e.jsx(Ha,{onConnected:()=>{},onSwitchToOffline:()=>{x(!1),b("Odkaz přerušen.")}}):e.jsxs("div",{className:"h-screen w-screen bg-[#0a0b0d] flex flex-col items-center justify-center p-8 relative overflow-hidden font-sans",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-10",children:e.jsxs("div",{className:"flex justify-between w-full p-8 font-mono text-[10px] text-signal-cyan",children:[e.jsx("span",{children:"SIGNÁL: VYHLEDÁVÁNÍ..."}),e.jsx("span",{children:"POZ: HLAVNÍ_BRÁNA"})]})}),e.jsxs(k.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},className:"w-full max-w-sm z-10",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"relative inline-block mb-8",children:e.jsxs("div",{className:"w-24 h-24 tactical-card flex items-center justify-center border-signal-cyan/40 bg-black/40",children:[e.jsx("div",{className:"corner-accent top-left !border-2"}),e.jsx("div",{className:"corner-accent bottom-right !border-2"}),e.jsx($t,{className:"w-12 h-12 text-signal-cyan"})]})}),e.jsx("h1",{className:"text-5xl font-black text-white tracking-tighter uppercase mb-2 chromatic-text",children:"Nexus_Auth"}),e.jsx("p",{className:"text-signal-cyan font-mono text-[10px] uppercase tracking-[0.5em] font-black",children:"Hybridní desková hra"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 justify-center",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-green-500",children:"Doporučeno: Cloud Save (Všechna zařízení)"})]}),e.jsx("div",{className:"flex flex-col justify-center gap-2",children:e.jsx(ja,{onSuccess:u,onError:()=>b("Google Login selhal na úrovni klienta."),theme:"filled_black",shape:"pill",size:"large",text:"signin_with",width:"100%"})})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"h-px bg-white/10 flex-1"}),e.jsx("span",{className:"text-[10px] text-white/30 uppercase font-mono tracking-widest font-black",children:"NEBO HOST (LOCAL SAVE)"}),e.jsx("div",{className:"h-px bg-white/10 flex-1"})]}),e.jsxs("form",{onSubmit:i,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[11px] font-black text-white/50 uppercase tracking-[0.2em] ml-1 font-mono flex justify-between",children:[e.jsx("span",{children:"Identifikace Jednotky"}),e.jsxs("span",{className:"text-zinc-500 flex items-center gap-1",children:[e.jsx(Vs,{className:"w-3 h-3"})," Ukládání v prohlížeči"]})]}),e.jsx("div",{className:"tactical-card p-0 overflow-hidden border-white/10 focus-within:border-white/40 transition-colors bg-white/5",children:e.jsxs("div",{className:"flex items-center px-5 py-5 gap-4",children:[e.jsx(Vt,{className:"w-6 h-6 text-zinc-500"}),e.jsx("input",{type:"text",required:!0,value:s,onChange:g=>m(g.target.value),className:"w-full bg-transparent text-white placeholder-white/20 focus:outline-none font-mono text-sm uppercase font-bold",placeholder:"ZADEJTE PŘEZDÍVKU...",maxLength:12})]})})]}),o&&e.jsxs("div",{className:"p-4 bg-signal-hazard/10 border border-signal-hazard/40 text-signal-hazard text-[11px] uppercase font-black tracking-widest text-center animate-pulse",children:[e.jsx(pe,{className:"w-4 h-4 inline mr-2 mb-0.5"})," ",o]}),e.jsxs("button",{type:"submit",className:"w-full py-5 border border-white/10 bg-zinc-900 hover:bg-zinc-800 text-white font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-3 transition-all active:scale-95",children:[e.jsx(dt,{className:"w-4 h-4 text-zinc-500"}),"Vstoupit jako Host",e.jsx(Ze,{className:"w-4 h-4 text-zinc-500"})]})]})]}),e.jsx(Q,{children:d&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-[#0a0b0d]/95 backdrop-blur-md flex items-center justify-center p-6",children:e.jsxs(k.div,{initial:{scale:.96,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.96,opacity:0},className:"tactical-card w-full max-w-sm border-zinc-700 p-0 overflow-hidden bg-black/90 shadow-2xl",children:[e.jsxs("div",{className:"bg-zinc-900 p-8 border-b border-white/10 flex items-center gap-6",children:[e.jsx(Mt,{className:"w-12 h-12 text-zinc-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tighter leading-none",children:"Lokální Profil"}),e.jsx("p",{className:"text-zinc-500 font-mono text-[10px] uppercase tracking-[0.4em] font-black mt-2",children:"Database Access: OK"})]})]}),e.jsxs("div",{className:"p-8 space-y-6 text-[12px] text-white/70 leading-relaxed font-sans",children:[e.jsxs("div",{className:"p-4 bg-blue-900/20 border border-blue-500/30 rounded-sm",children:[e.jsxs("p",{className:"text-blue-400 font-black uppercase tracking-widest mb-2 flex items-center gap-2 text-xs",children:[e.jsx(xt,{className:"w-4 h-4"})," Status: Online"]}),e.jsxs("p",{children:["Jako ",e.jsx("span",{className:"text-white font-bold",children:"HOST"})," máte přístup k databázi karet a online funkcím. Váš inventář se však ukládá pouze do ",e.jsx("span",{className:"text-white font-bold",children:"tohoto zařízení"}),"."]})]}),e.jsxs("ul",{className:"space-y-4 font-bold text-zinc-400",children:[e.jsxs("li",{className:"flex gap-4",children:[e.jsx(Bt,{className:"w-4 h-4 text-green-500 shrink-0 mt-0.5"}),e.jsx("span",{children:"Přístup k Master Databázi karet."})]}),e.jsxs("li",{className:"flex gap-4",children:[e.jsx(pe,{className:"w-4 h-4 text-orange-500 shrink-0 mt-0.5"}),e.jsx("span",{children:"Žádná synchronizace mezi zařízeními (Cloud Save)."})]})]})]}),e.jsxs("div",{className:"p-8 bg-black border-t border-white/10 flex flex-col gap-3",children:[e.jsx("button",{onClick:h,className:"button-primary w-full py-4 text-xs !bg-zinc-200 !text-black",children:"Rozumím, Spustit Misi"}),e.jsx("button",{onClick:()=>n(!1),className:"w-full py-3 text-zinc-500 hover:text-white text-[10px] uppercase font-black tracking-[0.2em] transition-colors",children:"Zpět"})]})]})})})]})},Fa=({onComplete:t})=>{const[s,m]=l.useState("init"),[a,x]=l.useState(0);l.useEffect(()=>{const n=setTimeout(()=>{d()},1500);return()=>clearTimeout(n)},[]);const d=()=>{m("boot"),S("open"),H([40,40])};return l.useEffect(()=>{if(s==="boot"){const n=setInterval(()=>{x(o=>o>=100?(clearInterval(n),setTimeout(()=>{m("complete"),S("success"),H([100,50,100]),setTimeout(t,1400)},500),100):o+2)},35);return()=>clearInterval(n)}},[s]),e.jsx("div",{className:"fixed inset-0 z-[9999] bg-[#0a0b0d] flex flex-col items-center justify-center font-sans overflow-hidden p-6",children:e.jsxs(Q,{mode:"wait",children:[s==="init"&&e.jsxs(k.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,y:20},className:"flex flex-col items-center gap-10 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx(k.div,{animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{repeat:1/0,duration:2.5},className:"absolute inset-0 bg-[#00f2ff]/20 blur-3xl rounded-full"}),e.jsx("div",{className:"w-24 h-24 border-2 border-[#ff9d00] rounded-full flex items-center justify-center shadow-[0_0_30px_rgba(255,157,0,0.25)] relative z-10 bg-[#0a0b0d]",children:e.jsx(Bs,{className:"w-10 h-10 text-[#ff9d00]"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-[#00f2ff] font-mono text-[9px] uppercase tracking-[0.4em] mb-2 font-bold opacity-80",children:"NEXUS // JÁDRO_SÍTĚ"}),e.jsx("h1",{className:"text-3xl font-black uppercase tracking-tighter chromatic-text leading-none",children:"Systém_Připraven"})]}),e.jsx("div",{className:"text-signal-cyan font-mono text-[9px] uppercase tracking-[0.2em] font-black animate-pulse opacity-50",children:"Navazování spojení..."})]})]},"init"),s==="boot"&&e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},className:"w-full max-w-[280px] flex flex-col items-center gap-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[e.jsx(dt,{className:"w-12 h-12 text-[#00f2ff] animate-pulse"}),e.jsx("span",{className:"text-[#00f2ff] font-mono text-[10px] uppercase tracking-[0.3em] font-black",children:"Probouzení_Sítě"})]}),e.jsxs("div",{className:"w-full space-y-3",children:[e.jsxs("div",{className:"flex justify-between font-mono text-[10px] text-[#ff9d00] font-bold",children:[e.jsx("span",{children:"ZAVÁDĚNÍ_PROTOKOLŮ"}),e.jsxs("span",{className:"tabular-nums",children:[a,"%"]})]}),e.jsx("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden border border-white/5",children:e.jsx(k.div,{initial:{width:0},animate:{width:`${a}%`},className:"h-full bg-gradient-to-r from-[#ff9d00] to-[#fff] shadow-[0_0_10px_rgba(255,157,0,0.8)]"})})]}),e.jsxs("div",{className:"text-[9px] font-mono text-white/30 uppercase tracking-[0.2em] text-center leading-relaxed font-bold",children:["Načítání_Taktických_Vrstev...",e.jsx("br",{}),"Kalibrace_Signální_Matice..."]})]},"boot"),s==="complete"&&e.jsxs(k.div,{initial:{scale:1.1,opacity:0},animate:{scale:1,opacity:1},className:"flex flex-col items-center gap-6",children:[e.jsxs("div",{className:"p-8 tactical-card border-[#00f2ff] shadow-[0_0_50px_rgba(0,242,255,0.15)] bg-black/80",children:[e.jsx("div",{className:"corner-accent top-left !border-4"}),e.jsx("div",{className:"corner-accent bottom-right !border-4"}),e.jsx($t,{className:"w-16 h-16 text-[#00f2ff]"})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-3xl font-black uppercase tracking-[0.1em] chromatic-text",children:"Autorizováno"}),e.jsx("p",{className:"text-[#00f2ff] font-mono text-[11px] uppercase tracking-[0.3em] font-black opacity-80",children:"Jednotka_Aktivní_V_Sektoru"})]})]},"complete")]})})},qa=({initialNickname:t,onConfirmSetup:s,isGuest:m})=>{const[a,x]=l.useState(t?"class":"nickname"),[d,n]=l.useState(t||""),[o,b]=l.useState(null),[i,h]=l.useState(""),[u,g]=l.useState(!1),[j,P]=l.useState(null),[I,F]=l.useState(""),[L,_]=l.useState(!1),[G,W]=l.useState(!1),q=c=>{c.preventDefault(),d.trim().length>=3&&x("class")},le=c=>{b(c),m?(g(!0),s(d,c,"solo").catch(()=>g(!1))):setTimeout(()=>x("action"),300)},M=async c=>{if(o){if(c==="join_mode"){F(""),P(null),x("join");return}g(!0),P(null);try{await s(d,o,c,c==="create"&&G?I:void 0)}catch{g(!1)}}},T=async c=>{if(c.preventDefault(),!(!i.trim()||!o)){g(!0),P(null);try{await s(d,o,i.toUpperCase().trim(),I||void 0)}catch(E){P(E.message||"Nepodařilo se připojit. Zkontrolujte ID místnosti."),g(!1)}}},f=[{id:Ee.WARRIOR,icon:e.jsx(Gt,{className:"w-6 h-6"}),desc:"Mistr boje zblízka. Vysoká odolnost.",color:"text-red-500",border:"border-red-500"},{id:Ee.MAGE,icon:e.jsx(Ut,{className:"w-6 h-6"}),desc:"Vidí magické aury a skryté zprávy.",color:"text-blue-400",border:"border-blue-400"},{id:Ee.ROGUE,icon:e.jsx(Ht,{className:"w-6 h-6"}),desc:"Najde loot tam, kde ostatní vidí stín.",color:"text-green-500",border:"border-green-500"},{id:Ee.CLERIC,icon:e.jsx(Kt,{className:"w-6 h-6"}),desc:"Léčitel a ochránce před temnotou.",color:"text-yellow-500",border:"border-yellow-500"}];return u&&m?e.jsxs("div",{className:"h-screen w-screen bg-zinc-950 flex flex-col items-center justify-center",children:[e.jsx(He,{className:"w-12 h-12 text-white animate-spin mb-4"}),e.jsx("p",{className:"text-white font-mono text-xs uppercase tracking-widest",children:"Generování offline prostředí..."})]}):e.jsxs("div",{className:"h-screen w-screen bg-zinc-950 flex flex-col items-center justify-start p-6 pt-12 relative overflow-hidden overflow-y-auto no-scrollbar",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1/2 bg-gradient-to-b from-signal-cyan/5 to-transparent"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1/2 bg-gradient-to-t from-signal-amber/5 to-transparent"})]}),e.jsxs(k.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"w-full max-w-sm relative z-10 pb-10",children:[a==="nickname"&&e.jsxs("div",{className:"text-center mt-20",children:[e.jsx("div",{className:"w-20 h-20 bg-zinc-900 rounded-full flex items-center justify-center mx-auto mb-6 border border-zinc-700 shadow-xl",children:e.jsx(Vt,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-2xl font-black text-white mb-2 uppercase tracking-widest",children:"Identifikace"}),e.jsx("p",{className:"text-zinc-400 text-sm mb-8 font-bold tracking-tight",children:"Zadejte svou herní přezdívku."}),e.jsxs("form",{onSubmit:q,children:[e.jsx("input",{type:"text",value:d,onChange:c=>n(c.target.value),placeholder:"Přezdívka...",className:"w-full bg-zinc-900 border border-zinc-700 p-4 rounded-xl text-white font-display text-center text-lg focus:border-signal-cyan outline-none mb-4 uppercase font-bold",maxLength:12,autoFocus:!0}),e.jsx("button",{type:"submit",disabled:d.length<3,className:"button-primary w-full py-5 text-sm",children:"Pokračovat"})]})]}),a==="class"&&e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-black text-white mb-1 uppercase tracking-tighter",children:"Zvolte Třídu"}),e.jsx("p",{className:"text-zinc-400 text-xs font-bold uppercase tracking-wider",children:"Vaše role ovlivní herní mechaniky."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3 overflow-y-auto pr-1 no-scrollbar",children:f.map(c=>e.jsxs("button",{onClick:()=>le(c.id),className:`p-4 rounded-xl border-2 text-left transition-all relative overflow-hidden group ${o===c.id?`bg-zinc-900 ${c.border}`:"bg-black border-zinc-800 hover:border-zinc-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:`p-3 rounded-lg bg-zinc-900 ${c.color} border border-white/5`,children:c.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-black uppercase tracking-widest ${c.color}`,children:c.id}),e.jsx("p",{className:"text-[11px] text-zinc-300 font-bold leading-tight mt-1",children:c.desc})]})]}),o===c.id&&e.jsx(k.div,{layoutId:"class-highlight",className:`absolute inset-0 opacity-10 ${c.color.replace("text-","bg-")}`})]},c.id))})]}),a==="action"&&!m&&e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("button",{onClick:()=>x("class"),className:"text-[10px] text-zinc-500 uppercase tracking-widest hover:text-white mb-2 font-bold underline underline-offset-4",children:"Změnit Třídu"}),e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-wider",children:"PŘÍPRAVA"}),e.jsxs("div",{className:"flex justify-center items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-white font-bold tracking-tight",children:d}),e.jsx("span",{className:"text-zinc-600",children:"•"}),e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded bg-zinc-900 border border-zinc-700 text-signal-cyan uppercase font-black tracking-widest",children:o})]})]}),e.jsxs("div",{className:"p-5 bg-zinc-900/90 border-2 border-zinc-800 hover:border-signal-cyan rounded-2xl transition-all shadow-xl backdrop-blur-sm",children:[e.jsx("div",{onClick:()=>!G&&M("create"),className:`cursor-pointer ${G?"":"flex flex-col"}`,children:e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx(Ft,{className:"w-7 h-7 text-signal-cyan"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-tighter",children:"Založit_Sektor"}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-bold uppercase tracking-wider",children:"Nová místnost pro skupinu."})]})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-zinc-800 space-y-4",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-[9px] font-black text-zinc-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(rt,{className:"w-3 h-3"})," Soukromý_Sektor"]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:G,onChange:c=>{W(c.target.checked),c.target.checked||F("")}}),e.jsx("div",{className:"w-9 h-5 bg-zinc-800 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-signal-cyan"})]})]}),G&&e.jsx("div",{className:"animate-in slide-in-from-top-2 bg-black/40 p-3 rounded-lg border border-white/5",children:e.jsx("input",{type:"text",placeholder:"Vstupní klíč...",value:I,onChange:c=>F(c.target.value),className:"w-full bg-transparent p-2 text-white text-sm outline-none focus:border-signal-cyan font-mono uppercase font-bold"})}),G&&e.jsx("button",{onClick:()=>M("create"),disabled:u||G&&I.length<3,className:"w-full py-4 bg-zinc-900 border-2 border-signal-cyan/50 text-signal-cyan font-black uppercase rounded-xl text-xs mt-2 disabled:opacity-50 tracking-[0.2em] shadow-[0_0_20px_rgba(0,242,255,0.15)] active:scale-95 transition-transform",children:"Inicializovat Soukromý Sektor"})]})]}),e.jsxs("button",{onClick:()=>M("join_mode"),disabled:u,className:"group relative overflow-hidden w-full p-5 bg-zinc-900/80 border-2 border-zinc-800 hover:border-signal-amber rounded-2xl text-left transition-all active:scale-[0.98] shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-signal-amber/10 to-transparent translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-500"}),e.jsx(Gs,{className:"w-7 h-7 text-signal-amber mb-2 relative z-10"}),e.jsx("h3",{className:"text-lg font-bold text-white relative z-10 uppercase tracking-tighter",children:"Vstoupit do Sektoru"}),e.jsx("p",{className:"text-[10px] text-zinc-400 mt-1 relative z-10 font-bold uppercase tracking-wider",children:"Připojit se k existující jednotce."})]}),e.jsxs("button",{onClick:()=>M("solo-online"),disabled:u,className:"group relative overflow-hidden w-full p-5 bg-zinc-900/80 border-2 border-zinc-800 hover:border-white rounded-2xl text-left transition-all active:scale-[0.98] shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/5 to-transparent translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-500"}),e.jsx(mt,{className:"w-7 h-7 text-white mb-2 relative z-10"}),e.jsx("h3",{className:"text-lg font-bold text-white relative z-10 uppercase tracking-tighter",children:"Samostatná_Mise (Online)"}),e.jsx("p",{className:"text-[10px] text-zinc-400 mt-1 relative z-10 font-bold uppercase tracking-wider",children:"Solo hra se synchronizací Vaultu."})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[e.jsx("div",{className:"h-px bg-zinc-800 flex-1"}),e.jsx("span",{className:"text-[10px] text-zinc-600 uppercase font-black",children:"Nebo"}),e.jsx("div",{className:"h-px bg-zinc-800 flex-1"})]}),e.jsxs("button",{onClick:()=>M("solo"),className:"w-full py-3 text-zinc-500 hover:text-white text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-colors",children:[e.jsx(Us,{className:"w-4 h-4"})," Samostatná_Mise (Offline)"]})]}),a==="join"&&!m&&e.jsxs("div",{className:"text-center mt-10",children:[e.jsx("button",{onClick:()=>x("action"),className:"text-zinc-500 text-[10px] font-black uppercase mb-6 hover:text-white tracking-widest underline underline-offset-4",children:"← Zpět do Lobby"}),e.jsx("h2",{className:"text-xl font-black text-white mb-6 uppercase tracking-widest",children:"Připojení k Sektoru"}),j&&e.jsxs("div",{className:"p-3 bg-red-900/20 border border-red-500/50 rounded-lg text-red-400 text-xs text-center mb-4 font-bold animate-pulse flex items-center justify-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),j]}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{type:"text",value:i,onChange:c=>{h(c.target.value),j&&P(null)},placeholder:"A1B2C",className:"w-full bg-black border border-zinc-700 p-6 rounded-xl text-white font-mono text-center text-3xl uppercase focus:border-signal-amber outline-none tracking-[0.5em]",maxLength:5,autoFocus:!0}),e.jsx("p",{className:"text-[10px] text-zinc-500 mt-2 uppercase tracking-widest font-bold",children:"Unikátní Kód Sektoru"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(rt,{className:"h-4 w-4 text-zinc-600"})}),e.jsx("input",{type:L?"text":"password",value:I,onChange:c=>F(c.target.value),placeholder:"Přístupový klíč (pokud je vyžadován)",className:"w-full bg-zinc-900 border border-zinc-700 p-4 pl-10 pr-10 rounded-xl text-white outline-none focus:border-signal-amber text-sm font-bold uppercase"}),e.jsx("button",{type:"button",onClick:()=>_(!L),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-zinc-500 hover:text-white",children:L?e.jsx(Hs,{className:"h-4 w-4"}):e.jsx(Ks,{className:"h-4 w-4"})})]}),e.jsxs("button",{type:"submit",disabled:u||i.length<1,className:"button-primary w-full py-5 text-sm !bg-signal-amber shadow-none",children:[u?e.jsx(He,{className:"w-5 h-5 animate-spin"}):"Navázat Spojení"," ",e.jsx(Ze,{className:"w-5 h-5 ml-2"})]})]})]})]},a)]})},Za=({data:t,onClose:s})=>{l.useEffect(()=>{const x=setTimeout(()=>{s()},4e3);return()=>clearTimeout(x)},[t.id]);const a=(()=>{switch(t.type){case"success":return{bg:"bg-[#22c55e] text-black",icon:e.jsx(_e,{className:"w-5 h-5"}),label:"POTVRZENO"};case"error":return{bg:"bg-signal-hazard text-white",icon:e.jsx(pe,{className:"w-5 h-5"}),label:"KRITICKÉ"};case"gift":return{bg:"bg-purple-600 text-white",icon:e.jsx(qs,{className:"w-5 h-5"}),label:"PŘENOS"};case"message":return{bg:"bg-signal-cyan text-black",icon:e.jsx(Fs,{className:"w-5 h-5"}),label:"SIGNÁL"};default:return{bg:"bg-white text-black",icon:e.jsx(it,{className:"w-5 h-5"}),label:"INFO"}}})();return l.createElement(k.div,{layout:!0,initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9,transition:{duration:.1}},key:t.id,className:`fixed top-4 left-4 right-4 z-[10000] shadow-[0_10px_40px_rgba(0,0,0,0.6)] border-l-8 border-black font-mono overflow-hidden ${a.bg} rounded-l-lg mx-auto max-w-sm`},e.jsxs("div",{className:"p-4 flex flex-col gap-2 relative",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-black/10 pb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a.icon,e.jsx("span",{className:"text-[10px] font-black tracking-[0.3em]",children:a.label})]}),e.jsx("button",{onClick:x=>{x.stopPropagation(),s()},className:"opacity-40 hover:opacity-100 transition-opacity p-1",children:e.jsx(ke,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-[12px] font-bold uppercase leading-tight py-1",children:t.message}),e.jsx(k.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:4,ease:"linear"},className:"absolute bottom-0 left-0 h-1 bg-black/20"})]}))},Ja=({event:t,onClose:s,onSave:m,onDiscard:a,onUse:x,onResolveDilemma:d,isSaved:n})=>{var se,Z,J,te,ne,re;const[o,b]=l.useState("CHOICE"),[i,h]=l.useState(null),[u,g]=l.useState("success"),[j,P]=l.useState(!1),[I,F]=l.useState(null);l.useEffect(()=>{S("open")},[t]);const L=y=>{F(I===y?null:y),S("click"),H(10)},_=y=>{const C=y.toUpperCase();return["HP","ZDRAVÍ","HEAL","HEALTH"].some(N=>C.includes(N))?"text-green-400":["DMG","ATK","ÚTOK","UTOK","ATTACK"].some(N=>C.includes(N))?"text-signal-hazard":["GOLD","MINCE","KREDITY","CREDITS"].some(N=>C.includes(N))?"text-signal-amber":["MANA","ENERGIE","ENERGY"].some(N=>C.includes(N))?"text-signal-cyan":"text-white"},G=(y,C)=>{const N=y.toUpperCase(),$=String(C),me=$.includes("+")||!$.includes("-")&&parseInt($)>0;return["HP","ZDRAVÍ","HEAL","HEALTH"].some(ae=>N.includes(ae))?me?`Okamžitě obnovuje ${$} jednotek biologické integrity.`:`Způsobuje přímé poškození tkání ve výši ${$} HP.`:["DMG","ATK","ÚTOK","UTOK","ATTACK"].some(ae=>N.includes(ae))?`Zvyšuje sílu příštího úderu nebo automatického útoku o ${$}.`:["GOLD","MINCE","KREDITY","CREDITS"].some(ae=>N.includes(ae))?`Transakční kredity v hodnotě ${$} byly připsány do tvého účtu.`:["MANA","ENERGIE","ENERGY"].some(ae=>N.includes(ae))?`Obnovuje ${$} jednotek energie pro použití schopností nebo svitků.`:["ARMOR","OBRANA","BRNĚNÍ"].some(ae=>N.includes(ae))?`Zvyšuje tvou statickou ochranu o ${$}. Snižuje příchozí DMG.`:`Speciální modifikátor sektoru ovlivňující parametr ${y} o ${$}.`},W=y=>{h(y);const N=Math.random()*100<(y.successChance??100),$=N?"success":"fail";g($),b("RESULT"),N?(S("success"),H([50,50])):(S("error"),H([100,100])),d&&d(y,$)},q=()=>{j&&a?(a(),S("error"),s()):(P(!0),H(20))},M=((y,C)=>{var $,me;if(y===R.BOSS)return{bg:"bg-gradient-to-b from-red-950/90 to-black",border:"border-red-600 shadow-[0_0_60px_rgba(220,38,38,0.4)]",text:"text-red-500",accent:"bg-red-600",icon:e.jsx(Xs,{className:"w-8 h-8 text-red-500"})};if(y===R.SPACE_STATION)return{bg:"bg-gradient-to-b from-slate-900/90 to-black",border:"border-cyan-400 shadow-[0_0_40px_rgba(34,211,238,0.2)]",text:"text-cyan-400",accent:"bg-cyan-500",icon:e.jsx(Fe,{className:"w-8 h-8 text-cyan-400"})};if(y===R.PLANET)return{bg:"bg-gradient-to-b from-indigo-950/90 to-black",border:"border-indigo-500 shadow-[0_0_40px_rgba(99,102,241,0.2)]",text:"text-indigo-400",accent:"bg-indigo-500",icon:e.jsx(mt,{className:"w-8 h-8 text-indigo-400"})};if(y===R.TRAP)return{bg:"bg-gradient-to-b from-orange-950/90 to-black",border:"border-orange-500 shadow-[0_0_30px_rgba(249,115,22,0.3)]",text:"text-orange-500",accent:"bg-orange-500",icon:e.jsx(Ke,{className:"w-8 h-8 text-orange-500"})};if(y===R.MERCHANT)return{bg:"bg-gradient-to-b from-yellow-950/90 to-black",border:"border-yellow-500 shadow-[0_0_30px_rgba(234,179,8,0.3)]",text:"text-yellow-500",accent:"bg-yellow-500",icon:e.jsx(Qs,{className:"w-8 h-8 text-yellow-500"})};if(y===R.ENCOUNTER)return{bg:"bg-gradient-to-b from-rose-950/90 to-black",border:"border-rose-500 shadow-[0_0_30px_rgba(244,63,94,0.3)]",text:"text-rose-500",accent:"bg-rose-500",icon:e.jsx(lt,{className:"w-8 h-8 text-rose-500"})};if(y===R.DILEMA)return{bg:"bg-[#0a0b0d]",border:"border-purple-500/50 shadow-[0_0_40px_rgba(168,85,247,0.2)]",text:"text-purple-400",accent:"bg-purple-500",icon:e.jsx(ea,{className:"w-8 h-8 text-purple-400"})};const N={Legendary:"border-signal-amber text-signal-amber shadow-[0_0_30px_rgba(255,157,0,0.3)]",Epic:"border-purple-400 text-purple-400 shadow-[0_0_20px_rgba(192,132,252,0.3)]",Rare:"border-signal-cyan text-signal-cyan shadow-[0_0_20px_rgba(0,242,255,0.2)]",Common:"border-white/30 text-white/60"};return{bg:"bg-[#0a0b0d]",border:N[C]||N.Common,text:(($=N[C])==null?void 0:$.split(" ")[1])||"text-white",accent:((me=N[C])==null?void 0:me.split(" ")[1].replace("text-","bg-"))||"bg-white",icon:e.jsx(Zt,{className:"w-8 h-8"})}})(t.type,t.rarity),T=t.type===R.DILEMA,f=(y,C)=>e.jsx(Q,{children:I===y&&e.jsx(k.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx("div",{className:"mt-2 p-2 bg-black/60 border border-white/10 rounded-lg text-[10px] text-zinc-300 leading-tight italic",children:G(y,C)})})}),c=()=>{var y,C;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-indigo-950/30 border border-indigo-500/30 rounded-xl flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-black border border-indigo-500/50 rounded-full shadow-[0_0_20px_rgba(99,102,241,0.2)]",children:e.jsx(Jt,{className:"w-6 h-6 text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-indigo-400 tracking-widest mb-1",children:"Navigační Data"}),e.jsx("p",{className:"text-xs text-zinc-300 font-mono leading-relaxed",children:"Uložte tuto kartu do batohu. Odemkne vám novou destinaci v navigačním systému lodi."})]})]}),e.jsxs("div",{className:"bg-black/40 border border-white/5 p-3 rounded-lg flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-500 uppercase",children:"Sektor ID"}),e.jsx("span",{className:"text-white font-mono font-bold",children:((y=t.planetConfig)==null?void 0:y.planetId)||"N/A"})]}),e.jsxs("div",{className:"bg-black/40 border border-white/5 p-3 rounded-lg flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-500 uppercase",children:"Typ Eventu"}),e.jsx("span",{className:"text-white font-mono font-bold",children:((C=t.planetConfig)==null?void 0:C.landingEventType)||"UNKNOWN"})]})]})},E=()=>{var y,C,N,$;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-cyan-950/20 border border-cyan-500/30 p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-cyan-400",children:[e.jsx(Yt,{className:"w-4 h-4 animate-pulse"}),e.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest",children:"Stanice Online"})]}),e.jsxs("p",{className:"text-xs text-zinc-300 italic mb-4",children:['"',((y=t.stationConfig)==null?void 0:y.welcomeMessage)||"Vítejte na palubě. Systémy jsou funkční.",'"']}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-3 rounded border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ut,{className:"w-4 h-4 text-cyan-300"}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-300 uppercase",children:"Kyslík (O2)"})]}),e.jsx("div",{className:"text-green-500 font-mono text-xs font-bold flex items-center gap-1 uppercase",children:(C=t.stationConfig)!=null&&C.refillO2?"DOPLNĚNÍ NA 100%":"---"})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-3 rounded border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-4 h-4 text-slate-300"}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-300 uppercase",children:"Oprava Pláště"})]}),e.jsxs("div",{className:"text-green-500 font-mono text-xs font-bold flex items-center gap-1",children:["+",((N=t.stationConfig)==null?void 0:N.repairAmount)||30," HP"]})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-3 rounded border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pt,{className:"w-4 h-4 text-orange-400"}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-300 uppercase",children:"Doplnění Paliva"})]}),e.jsxs("div",{className:"text-green-500 font-mono text-xs font-bold flex items-center gap-1",children:["+",(($=t.stationConfig)==null?void 0:$.fuelReward)||50]})]})]})]}),e.jsx("p",{className:"text-[9px] text-green-500 text-center uppercase font-bold",children:"Odměna za přistání na stanici"})]})},V=()=>{var y,C,N,$;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-orange-900/20 border border-orange-500/50 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] uppercase font-bold text-orange-400",children:"Obtížnost (Hod kostkou)"}),e.jsxs("span",{className:"text-3xl font-black text-white",children:[((y=t.trapConfig)==null?void 0:y.difficulty)||10,"+"]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-[10px] uppercase font-bold text-red-400",children:"Poškození při selhání"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(st,{className:"w-5 h-5 text-red-500"}),e.jsxs("span",{className:"text-3xl font-black text-red-500",children:["-",((C=t.trapConfig)==null?void 0:C.damage)||0]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-zinc-900 border border-zinc-700 rounded-lg",children:[e.jsx("div",{className:"p-2 bg-zinc-800 rounded",children:e.jsx(Ht,{className:"w-4 h-4 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase text-zinc-500 font-bold",children:"Možnost Zneškodnění"}),e.jsx("p",{className:"text-xs font-bold text-white",children:((N=t.trapConfig)==null?void 0:N.disarmClass)==="ANY"?"Kdokoliv":`Pouze třída: ${($=t.trapConfig)==null?void 0:$.disarmClass}`})]})]})]})},ee=()=>{var $,me,ae,Se,Re,fe;const y=((me=($=t.stats)==null?void 0:$.find(ge=>ge.label.toUpperCase()==="HP"))==null?void 0:me.value)||"??",C=((Se=(ae=t.stats)==null?void 0:ae.find(ge=>ge.label.toUpperCase()==="ATK"))==null?void 0:Se.value)||"??",N=((fe=(Re=t.stats)==null?void 0:Re.find(ge=>ge.label.toUpperCase()==="DEF"))==null?void 0:fe.value)||"??";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs(k.button,{onClick:()=>L("HP"),className:`bg-red-950/30 border p-2 rounded flex flex-col items-center transition-all ${I==="HP"?"border-red-500":"border-red-500/30"}`,children:[e.jsx(Ce,{className:"w-4 h-4 text-red-500 mb-1"}),e.jsx("span",{className:"text-xl font-black text-white",children:y}),e.jsx("span",{className:"text-[8px] uppercase font-bold text-red-400",children:"HP"})]}),e.jsxs(k.button,{onClick:()=>L("ATK"),className:`bg-orange-950/30 border p-2 rounded flex flex-col items-center transition-all ${I==="ATK"?"border-orange-500":"border-orange-500/30"}`,children:[e.jsx(lt,{className:"w-4 h-4 text-orange-500 mb-1"}),e.jsx("span",{className:"text-xl font-black text-white",children:C}),e.jsx("span",{className:"text-[8px] uppercase font-bold text-red-400",children:"Útok"})]}),e.jsxs(k.button,{onClick:()=>L("DEF"),className:`bg-blue-950/30 border p-2 rounded flex flex-col items-center transition-all ${I==="DEF"?"border-blue-500":"border-blue-500/30"}`,children:[e.jsx(Ae,{className:"w-4 h-4 text-blue-500 mb-1"}),e.jsx("span",{className:"text-xl font-black text-white",children:N}),e.jsx("span",{className:"text-[8px] uppercase font-bold text-blue-400",children:"Obrana"})]})]}),I&&["HP","ATK","DEF"].includes(I)&&e.jsx("div",{className:"bg-black/40 p-2 rounded-lg border border-white/5 text-[10px] text-zinc-400 italic",children:I==="HP"?"Celková životní síla nepřítele. Snížením na 0 je eliminován.":I==="ATK"?"Základní poškození, které nepřítel způsobí při úspěšném zásahu.":"Snižuje poškození obdržené od hodu hráče."}),t.enemyLoot&&e.jsxs("div",{className:"bg-zinc-900/80 p-3 rounded-lg border border-zinc-700",children:[e.jsxs("h4",{className:"text-[10px] font-bold text-zinc-400 uppercase mb-2 flex items-center gap-2",children:[e.jsx(he,{className:"w-3 h-3"})," Odměna za likvidaci"]}),e.jsxs("div",{className:"flex justify-between items-center text-xs font-mono font-bold",children:[e.jsxs("span",{className:"text-yellow-500",children:[t.enemyLoot.goldReward," Gold"]}),e.jsxs("span",{className:"text-purple-400",children:[t.enemyLoot.xpReward," XP"]}),e.jsxs("span",{className:"text-zinc-400",children:["Drop: ",t.enemyLoot.dropItemChance,"%"]})]})]})]})},U=()=>{var y,C,N;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-yellow-900/10 border border-yellow-700/30 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-yellow-500 mb-2",children:"Obchodní Status"}),e.jsxs("div",{className:"text-xs text-zinc-300 italic",children:['"',t.description,'"']})]}),e.jsxs("div",{className:"bg-black/40 border border-zinc-800 rounded-lg p-3",children:[e.jsx("h4",{className:"text-[10px] font-bold text-zinc-400 uppercase mb-3 border-b border-zinc-800 pb-1",children:"Třídní Slevy & Bonusy"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-[10px] font-bold uppercase",children:[e.jsx(Gt,{className:"w-3 h-3"})," Válečník"]}),e.jsxs("div",{className:"text-white font-mono text-xs",children:[((y=t.tradeConfig)==null?void 0:y.warriorDiscount)||10,"% SLEVA"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-400 text-[10px] font-bold uppercase",children:[e.jsx(Ut,{className:"w-3 h-3"})," Mág (Svitky)"]}),e.jsxs("div",{className:"text-white font-mono text-xs",children:[((C=t.tradeConfig)==null?void 0:C.mageDiscount)||25,"% SLEVA"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-500 text-[10px] font-bold uppercase",children:[e.jsx(Kt,{className:"w-3 h-3"})," Kněz (Heal)"]}),e.jsxs("div",{className:"text-white font-mono text-xs",children:[((N=t.tradeConfig)==null?void 0:N.clericDiscount)||45,"% SLEVA"]})]})]})]})]})},oe=()=>{var y;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-[8px] text-white/30 uppercase font-black tracking-widest flex items-center gap-2 mb-2",children:[e.jsx(it,{className:"w-3 h-3"})," Klikni na stat pro vysvětlení vlivu"]}),t.isSellOnly&&e.jsxs("div",{className:"bg-red-950/20 border border-red-500/30 p-4 rounded-xl flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-3 bg-black border border-red-500/50 rounded-lg shadow-[0_0_15px_rgba(239,68,68,0.15)]",children:e.jsx(ta,{className:"w-6 h-6 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-red-500 tracking-widest mb-1 flex items-center gap-2",children:"JEN PRO PRODEJ"}),e.jsx("p",{className:"text-[8px] text-zinc-400 font-mono leading-relaxed",children:"Tento předmět nemá žádnou funkční hodnotu. Lze jej pouze prodat obchodníkům za kredity."})]})]}),((y=t.resourceConfig)==null?void 0:y.isResourceContainer)&&e.jsxs("div",{className:"bg-orange-950/20 border border-orange-500/30 p-4 rounded-xl flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-3 bg-black border border-orange-500/50 rounded-lg shadow-[0_0_15px_rgba(249,115,22,0.15)]",children:e.jsx(je,{className:"w-6 h-6 text-orange-500"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-orange-500 tracking-widest mb-1 flex items-center gap-2",children:[e.jsx(Ie,{className:"w-3 h-3"})," ",t.resourceConfig.customLabel||"Surovina k Těžbě"]}),e.jsxs("p",{className:"text-lg font-mono font-bold text-white uppercase leading-none",children:[t.resourceConfig.resourceName," ",e.jsxs("span",{className:"text-orange-500 text-sm",children:["x",t.resourceConfig.resourceAmount]})]}),e.jsx("p",{className:"text-[8px] text-zinc-500 font-mono mt-1",children:"Lze použít pro crafting nebo prodej."})]})]}),t.stats&&t.stats.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.stats.map((C,N)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs(k.button,{onClick:()=>L(C.label),className:`bg-white/5 border p-3 rounded-xl flex flex-col items-center transition-all ${I===C.label?"border-signal-cyan bg-signal-cyan/5":"border-white/10"}`,children:[e.jsx("span",{className:"text-[9px] uppercase font-bold text-zinc-400",children:C.label}),e.jsx("span",{className:`text-lg font-black font-mono ${_(C.label)}`,children:C.value})]}),f(C.label,C.value)]},N))}),e.jsxs("div",{className:"flex justify-between items-center bg-zinc-900 p-3 rounded-lg border border-zinc-700",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-400 uppercase",children:"Tržní Hodnota"}),e.jsxs("div",{className:"flex items-center gap-2 text-yellow-500",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsx("span",{className:"font-mono font-bold text-lg",children:t.price??50})]})]})]})};return e.jsx(k.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:1.05,y:-20},className:"fixed inset-0 z-[150] bg-black/95 flex items-center justify-center p-6 backdrop-blur-md",children:e.jsxs("div",{className:`w-full max-w-sm ${M.bg} border-2 ${M.border} relative overflow-hidden flex flex-col shadow-2xl rounded-3xl max-h-[90vh]`,children:[e.jsxs("div",{className:"relative p-6 pb-4 z-10",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-32 bg-gradient-to-b from-white/10 to-transparent pointer-events-none"}),e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:`p-3 rounded-xl bg-black/40 border border-white/10 backdrop-blur-sm ${M.text}`,children:M.icon}),e.jsx("button",{onClick:s,className:"p-2 text-white/30 hover:text-white transition-colors bg-black/20 rounded-full",children:e.jsx(ke,{className:"w-6 h-6"})})]}),e.jsx("span",{className:"text-[9px] font-mono font-bold text-white/30 uppercase tracking-[0.3em] block mb-1",children:T?"TAKTICKÉ ROZHODNUTÍ":`${t.type}`}),e.jsx("h2",{className:`text-3xl font-black uppercase tracking-tighter leading-none font-sans ${M.text} drop-shadow-md`,children:t.title}),!T&&e.jsx("div",{className:`inline-block mt-2 px-2 py-0.5 text-[8px] font-bold uppercase tracking-widest border rounded ${M.border} ${M.text} bg-black/40`,children:t.rarity})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar px-6 pb-6 relative z-10",children:[e.jsxs("div",{className:"mb-6 relative",children:[e.jsx("div",{className:`absolute top-0 left-0 w-1 h-full ${M.accent} opacity-50`}),e.jsxs("p",{className:"pl-4 text-xs text-zinc-300 italic leading-relaxed font-serif opacity-90",children:['"',t.description,'"']})]}),!T&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:[t.type===R.TRAP&&V(),(t.type===R.ENCOUNTER||t.type===R.BOSS)&&ee(),t.type===R.MERCHANT&&U(),t.type===R.PLANET&&c(),(t.type===R.ITEM||t.type==="PŘEDMĚT")&&oe(),t.type===R.SPACE_STATION&&E()]}),T&&o==="CHOICE"&&e.jsxs("div",{className:"space-y-4 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Zs,{className:"w-4 h-4 text-purple-400 animate-pulse"}),e.jsx("p",{className:"text-[10px] font-bold text-purple-400 uppercase tracking-[0.2em]",children:"Analýza Rozcestí"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:(se=t.dilemmaOptions)==null?void 0:se.map((y,C)=>e.jsxs("button",{onClick:()=>W(y),className:"relative group p-0 overflow-hidden rounded-xl border border-purple-500/30 bg-purple-900/10 hover:border-purple-400 hover:bg-purple-900/20 transition-all active:scale-[0.98]",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-50",children:e.jsx(Js,{className:"w-12 h-12 text-purple-500/20 group-hover:text-purple-400/30 transition-colors"})}),e.jsxs("div",{className:"p-4 flex flex-col items-start relative z-10",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsxs("span",{className:"text-[9px] font-black text-zinc-500 uppercase tracking-widest mb-1 group-hover:text-purple-300",children:["TRASA ",String.fromCharCode(65+C)]}),y.successChance!==void 0&&y.successChance<100&&e.jsxs("span",{className:"text-[9px] font-bold text-zinc-500 flex items-center gap-1",children:[e.jsx(Ys,{className:"w-3 h-3"})," ",y.successChance,"%"]})]}),e.jsx("span",{className:"text-sm font-bold text-white uppercase tracking-wider text-left w-full",children:y.label})]}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-purple-500/20 group-hover:bg-purple-400 transition-colors"})]},C))})]}),T&&o==="RESULT"&&e.jsxs("div",{className:"space-y-6 mt-4 animate-in slide-in-from-right-8 duration-300",children:[e.jsxs("div",{className:`p-5 rounded-2xl border relative overflow-hidden ${u==="success"?"bg-purple-900/20 border-purple-500/30":"bg-red-900/20 border-red-500/30"}`,children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-white/5 rounded-bl-full pointer-events-none"}),e.jsxs("div",{className:`flex items-center gap-2 mb-3 ${u==="success"?"text-purple-400":"text-red-400"}`,children:[u==="success"?e.jsx(it,{className:"w-4 h-4"}):e.jsx(st,{className:"w-4 h-4"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:u==="success"?"Taktický Důsledek":"Selhání Operace"})]}),e.jsx("p",{className:"text-sm text-white font-medium leading-relaxed",children:u==="success"?i==null?void 0:i.consequenceText:(i==null?void 0:i.failMessage)||"Akce selhala."}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[u==="success"&&((Z=i==null?void 0:i.rewards)==null?void 0:Z.map((y,C)=>e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border bg-green-500/10 border-green-500/30 text-green-400",children:[y.type==="HP"?e.jsx(Ce,{className:"w-3 h-3"}):y.type==="GOLD"?e.jsx(he,{className:"w-3 h-3"}):e.jsx(Ke,{className:"w-3 h-3"}),e.jsxs("span",{children:["+",y.value," ",y.type]})]},C))),u==="success"&&!(i!=null&&i.rewards)&&(i==null?void 0:i.effectType)&&i.effectType!=="none"&&e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border ${(i.effectValue??0)>0?"bg-green-500/10 border-green-500/30 text-green-400":"bg-red-500/10 border-red-500/30 text-red-400"}`,children:[i.effectType==="hp"?e.jsx(Ce,{className:"w-3 h-3"}):e.jsx(he,{className:"w-3 h-3"}),e.jsxs("span",{children:[(i.effectValue??0)>0?"+":"",i.effectValue," ",i.effectType.toUpperCase()]})]}),u==="fail"&&(i!=null&&i.failDamage)?e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border bg-red-500/10 border-red-500/30 text-red-400",children:[e.jsx(st,{className:"w-3 h-3"}),e.jsxs("span",{children:["-",i.failDamage," HP"]})]}):null]})]}),(i==null?void 0:i.physicalInstruction)&&e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-signal-amber to-transparent opacity-30 blur rounded-lg"}),e.jsxs("div",{className:"relative bg-black border-l-4 border-signal-amber p-4 rounded-r-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-signal-amber mb-2",children:[e.jsx(Ws,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.3em]",children:"Rozkaz pro Desku"})]}),e.jsx("p",{className:"text-xs text-white font-mono font-bold leading-relaxed uppercase",children:i.physicalInstruction})]})]})]})]}),e.jsxs("div",{className:"p-4 bg-black/60 border-t border-white/5 flex flex-col gap-2 relative z-10 backdrop-blur-md",children:[e.jsxs("div",{className:"flex gap-3",children:[x&&o!=="RESULT"&&!T&&!((J=t.resourceConfig)!=null&&J.isResourceContainer)&&!t.isSellOnly&&t.type!==R.PLANET&&e.jsx("button",{onClick:x,className:`flex-1 py-4 text-black font-black uppercase text-[11px] tracking-[0.2em] hover:brightness-110 active:scale-95 transition-all font-mono rounded-xl shadow-lg ${M.accent}`,children:t.type===R.TRAP?"Pokusit se Odejít":t.type===R.ENCOUNTER?"Zahájit Boj":t.type===R.MERCHANT?"Otevřít Obchod":t.type===R.SPACE_STATION?"Dokovat a Doplnit":"Použít"}),o==="RESULT"&&T&&e.jsxs("button",{onClick:s,className:"w-full py-4 bg-purple-600 hover:bg-purple-500 text-white font-black uppercase text-[11px] tracking-[0.2em] active:scale-95 transition-all rounded-xl shadow-lg shadow-purple-500/20 flex items-center justify-center gap-2",children:["Pokračovat v Misi ",e.jsx(Ze,{className:"w-4 h-4"})]}),m&&!n?e.jsx("button",{onClick:m,className:`flex-1 py-4 border ${(te=t.resourceConfig)!=null&&te.isResourceContainer?"border-orange-500 text-orange-500 bg-orange-950/20 hover:bg-orange-900/40":"border-white/20 text-white hover:bg-white/5"} font-black uppercase text-[11px] tracking-[0.2em] active:scale-95 transition-all font-mono rounded-xl flex items-center justify-center gap-2`,children:(ne=t.resourceConfig)!=null&&ne.isResourceContainer?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"w-4 h-4"})," Vytěžit"]}):"Uložit"}):n&&(((re=t.resourceConfig)==null?void 0:re.isResourceContainer)||t.type===R.PLANET||t.isSellOnly)&&e.jsxs("div",{className:"flex-1 py-4 border border-white/10 bg-white/5 text-zinc-500 font-black uppercase text-[11px] tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 cursor-default",children:[e.jsx(Ie,{className:"w-4 h-4"})," VLASTNĚNO"]})]}),n&&a&&!T&&e.jsxs("button",{onClick:q,className:`w-full py-3 border ${j?"bg-red-900/80 border-red-500 text-white":"border-white/5 bg-transparent text-zinc-500"} font-black uppercase text-[10px] tracking-[0.2em] active:scale-95 transition-all font-mono rounded-xl flex items-center justify-center gap-2`,children:[e.jsx(qt,{className:"w-3 h-3"})," ",j?"POTVRDIT ZAHOZENÍ":"Zahodit"]})]})]})})},Ya=({onComplete:t})=>{const[s,m]=l.useState("approach"),[a,x]=l.useState(8500),[d,n]=l.useState(34),[o,b]=l.useState([]);return l.useEffect(()=>{const i=setInterval(()=>{const h=Math.random().toString(16).substr(2,8).toUpperCase();b(u=>[`SYS_DAT: 0x${h}`,...u.slice(0,6)])},150);return()=>clearInterval(i)},[]),l.useEffect(()=>{S("open");const i=setInterval(()=>{x(h=>Math.max(0,h-150))},30);return setTimeout(()=>{m("align"),S("scan");const h=setInterval(()=>{n(u=>Math.min(100,u+2))},50);setTimeout(()=>clearInterval(h),2e3)},2e3),setTimeout(()=>{m("dock"),clearInterval(i),x(0),n(100),S("error"),H([80,50,80,50])},4e3),setTimeout(()=>{m("flash"),S("success")},4800),setTimeout(()=>{t()},5500),()=>clearInterval(i)},[]),e.jsxs("div",{className:"fixed inset-0 z-[2000] bg-black overflow-hidden flex flex-col items-center justify-center font-mono cursor-none select-none",children:[e.jsxs("div",{className:"absolute inset-0 perspective-1000",children:[e.jsx(k.div,{className:"absolute bottom-0 left-[-50%] right-[-50%] h-[50vh] bg-[linear-gradient(transparent_0%,rgba(0,242,255,0.2)_1px,transparent_1px),linear-gradient(90deg,transparent_0%,rgba(0,242,255,0.2)_1px,transparent_1px)]",style:{backgroundSize:"100px 100px",transform:"rotateX(60deg)",transformOrigin:"bottom"},animate:{backgroundPositionY:["0px","1000px"]},transition:{duration:s==="approach"?1:5,repeat:1/0,ease:"linear"}}),s==="approach"&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:[...Array(8)].map((i,h)=>e.jsx(k.div,{className:"absolute w-0.5 h-1/2 bg-cyan-500/50",style:{left:`${50+(Math.random()*80-40)}%`,top:"50%",transformOrigin:"top"},animate:{scaleY:[0,2],opacity:[0,1,0],rotate:Math.random()*60-30},transition:{duration:.4,repeat:1/0,delay:Math.random()*.5}},h))})]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center w-full h-full",children:[e.jsxs(k.div,{initial:{scale:.1,opacity:0},animate:{scale:s==="approach"?.4:s==="align"?.9:1.2,opacity:1,rotate:s==="dock"?0:15},transition:{duration:4.5,ease:"circIn"},className:"relative",children:[e.jsx(Fe,{className:"w-64 h-64 text-zinc-300 drop-shadow-[0_0_50px_rgba(0,242,255,0.2)]",strokeWidth:.5}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:[1,2,3].map(i=>e.jsx(k.div,{className:"absolute border border-cyan-500/30 rounded-full",style:{width:"100%",height:"100%"},animate:{scale:[.5,2],opacity:[0,1,0]},transition:{duration:2,repeat:1/0,delay:i*.6,ease:"linear"}},i))})]}),e.jsxs(k.div,{className:"absolute inset-0 pointer-events-none",animate:s==="dock"?{x:[-5,5,-5,5,0],y:[-5,5,-5,5,0]}:{},transition:{duration:.4},children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:`relative transition-all duration-500 ${s==="dock"?"scale-90":"scale-100"}`,children:[e.jsx("div",{className:"w-[280px] h-[280px] border border-cyan-500/30 rounded-full flex items-center justify-center border-dashed animate-spin-slow"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(sa,{className:`w-8 h-8 ${d===100?"text-green-500":"text-red-500"}`})}),e.jsxs("div",{className:"absolute top-[-40px] left-1/2 -translate-x-1/2 text-center w-full",children:[e.jsx("div",{className:"text-[10px] font-black text-cyan-500 uppercase tracking-widest bg-black/50 px-2",children:d<100?"KALIBRACE VEKTORU":"ZAMĚŘENO"}),e.jsxs("div",{className:"text-xl font-bold text-white font-mono",children:[d,"%"]})]})]})}),e.jsxs("div",{className:"absolute top-12 w-full px-6 flex justify-between items-start",children:[e.jsxs("div",{className:"bg-black/60 border-l-4 border-cyan-500 p-2 pl-4 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-cyan-400 mb-1",children:[e.jsx(Yt,{className:"w-4 h-4 animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"NEXUS_LINK"})]}),e.jsx("div",{className:"text-xs text-white font-bold uppercase",children:"Signál: SILNÝ"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-black text-white font-mono tracking-tighter tabular-nums",children:[Math.floor(a),e.jsx("span",{className:"text-sm text-zinc-500 ml-1",children:"m"})]}),e.jsx("div",{className:"text-[10px] font-bold text-red-500 uppercase tracking-widest animate-pulse",children:s==="approach"?"PŘIBLIŽOVÁNÍ >>":s==="align"?"BRZDĚNÍ...":"KONTAKT"})]})]}),e.jsxs("div",{className:"absolute left-6 bottom-24 w-40 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 text-zinc-500 mb-2 border-b border-zinc-800 pb-1",children:[e.jsx(dt,{className:"w-3 h-3"}),e.jsx("span",{className:"text-[8px] font-black uppercase",children:"Telemetrie"})]}),e.jsx("div",{className:"space-y-1 font-mono text-[9px] text-cyan-500/70 h-24 flex flex-col-reverse opacity-80",children:o.map((i,h)=>e.jsx(k.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},children:i},h))})]}),e.jsxs("div",{className:"absolute right-6 bottom-24 w-32 text-right space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[8px] font-bold text-zinc-500 uppercase block mb-1",children:"Tlak Kabiny"}),e.jsx("div",{className:"w-full bg-zinc-800 h-1.5 rounded-full overflow-hidden",children:e.jsx(k.div,{className:"h-full bg-green-500",initial:{width:"90%"},animate:{width:["90%","92%","89%"]},transition:{repeat:1/0,duration:2}})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[8px] font-bold text-zinc-500 uppercase block mb-1",children:"Integrita Pláště"}),e.jsx("div",{className:"w-full bg-zinc-800 h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-cyan-500 w-full"})})]}),e.jsx("div",{className:"pt-2",children:s==="dock"||s==="flash"?e.jsxs("div",{className:"flex items-center justify-end gap-2 text-green-500",children:[e.jsx(rt,{className:"w-4 h-4"})," ",e.jsx("span",{className:"font-black text-xs uppercase",children:"ZAMČENO"})]}):e.jsxs("div",{className:"flex items-center justify-end gap-2 text-yellow-500",children:[e.jsx(aa,{className:"w-4 h-4 animate-bounce"})," ",e.jsx("span",{className:"font-black text-xs uppercase",children:"DOKOVÁNÍ"})]})})]}),e.jsxs("div",{className:"absolute bottom-10 left-10 right-10 flex flex-col items-center",children:[e.jsx("div",{className:"w-full max-w-md bg-zinc-900/50 h-2 rounded-full overflow-hidden border border-zinc-800",children:e.jsx(k.div,{className:`h-full ${s==="dock"?"bg-green-500":"bg-red-500"}`,animate:{width:s==="approach"?"80%":s==="align"?"20%":"0%"},transition:{duration:.5}})}),e.jsxs("div",{className:"flex justify-between w-full max-w-md mt-1 text-[8px] font-bold text-zinc-600 uppercase tracking-widest",children:[e.jsx("span",{children:"Rychlost"}),e.jsx("span",{children:s==="approach"?"850 m/s":s==="align"?"120 m/s":"0 m/s"})]})]})]})]}),s==="flash"&&e.jsx(k.div,{className:"absolute inset-0 bg-white z-[2100]",initial:{opacity:0},animate:{opacity:1},transition:{duration:.2,ease:"easeIn"}})]})},Wa=({inventory:t,masterCatalog:s,onClose:m,onCraft:a})=>{var W,q,le,M;const x=t.filter(T=>{var f;return(f=T.resourceConfig)==null?void 0:f.isResourceContainer}),d=s.filter(T=>T.craftingRecipe&&T.craftingRecipe.enabled===!0),[n,o]=l.useState(null),[b,i]=l.useState(!1),[h,u]=l.useState(0),[g,j]=l.useState(0),P=l.useRef(null);l.useEffect(()=>()=>{P.current&&clearInterval(P.current)},[]);const I=T=>{b||(S("click"),o(T),u(0),j(0))},F=T=>x.reduce((f,c)=>{var E;return((E=c.resourceConfig)==null?void 0:E.resourceName)===T?f+(c.resourceConfig.resourceAmount||0):f},0),L=T=>{var f;return(f=T.craftingRecipe)!=null&&f.requiredResources?T.craftingRecipe.requiredResources.every(c=>F(c.resourceName)>=c.amount):!0},_=()=>{var V;if(!n||!a)return;if(!L(n)){S("error");return}i(!0),S("scan"),H([50,100,50]);const T=((V=n.craftingRecipe)==null?void 0:V.craftingTimeSeconds)||10,f=T*1e3,c=50;let E=0;j(T),u(0),P.current=setInterval(()=>{E+=c;const ee=Math.min(100,E/f*100),U=Math.max(0,T-E/1e3);u(ee),j(U),E>=f&&(clearInterval(P.current),G())},c)},G=()=>{!n||!a||(a(n),S("success"),H([50,50,50]),i(!1),u(0),j(0),o(null))};return e.jsxs("div",{className:"fixed inset-0 z-[250] bg-zinc-950 text-white flex flex-col font-sans overflow-hidden",children:[e.jsxs("header",{className:"bg-zinc-900 border-b border-orange-500/30 p-4 flex justify-between items-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"repeating-linear-gradient(45deg, #000 0, #000 10px, #f97316 10px, #f97316 20px)"}}),e.jsxs("div",{className:"flex items-center gap-3 relative z-10 text-orange-500",children:[e.jsx("div",{className:"p-2 bg-orange-500/10 border border-orange-500/30 rounded",children:e.jsx(je,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black uppercase tracking-widest leading-none text-white",children:"Výrobní Modul"}),e.jsx("p",{className:"text-[9px] font-mono font-bold uppercase tracking-[0.3em]",children:"Sekce: FAB-01"})]})]}),e.jsx("button",{onClick:m,disabled:b,className:`p-2 relative z-10 bg-zinc-800 rounded-full hover:bg-zinc-700 transition-colors ${b?"opacity-50 cursor-not-allowed":""}`,children:e.jsx(ke,{className:"w-6 h-6 text-zinc-400"})})]}),e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden relative",children:[e.jsxs("div",{className:"flex-1 border-b md:border-b-0 md:border-r border-zinc-800 bg-zinc-950/50 flex flex-col min-h-[40%] md:min-h-full",children:[e.jsxs("div",{className:"p-3 bg-zinc-900/50 border-b border-zinc-800 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-500 flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4"})," Sklad Surovin"]}),e.jsxs("span",{className:"text-[9px] font-mono text-zinc-600",children:[x.length," jednotek"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 grid grid-cols-2 md:grid-cols-2 gap-3 content-start",children:x.length===0?e.jsxs("div",{className:"col-span-2 text-center py-10 opacity-30 flex flex-col items-center",children:[e.jsx(Ie,{className:"w-12 h-12 mb-2"}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"Sklad prázdný"})]}):x.map((T,f)=>{var c;return e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 p-3 rounded-lg flex flex-col items-center justify-center gap-1 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-orange-600/50"}),e.jsx(je,{className:"w-5 h-5 text-orange-500/50 mb-1"}),e.jsx("span",{className:"text-xs font-bold text-white uppercase text-center leading-tight line-clamp-2",children:T.title}),e.jsxs("span",{className:"text-[10px] font-mono text-orange-400 bg-orange-950/30 px-2 py-0.5 rounded border border-orange-500/20",children:["x",((c=T.resourceConfig)==null?void 0:c.resourceAmount)||1]})]},f)})})]}),e.jsxs("div",{className:"flex-[1.5] bg-black flex flex-col",children:[e.jsxs("div",{className:"p-3 bg-zinc-900/50 border-b border-zinc-800 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-500 flex items-center gap-2",children:[e.jsx(xt,{className:"w-4 h-4"})," Databáze Schémat"]}),e.jsx("span",{className:"text-[9px] font-mono text-zinc-600",children:"Admin_Vault Access"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:d.length===0?e.jsx("div",{className:"text-center py-10 text-zinc-600 font-mono text-xs uppercase",children:"Žádná schémata k dispozici."}):d.map(T=>e.jsxs("button",{onClick:()=>I(T),className:"w-full text-left bg-zinc-900/40 border border-zinc-800 hover:border-orange-500/50 hover:bg-zinc-900 p-3 rounded-xl flex items-center gap-4 transition-all active:scale-[0.98] group",children:[e.jsx("div",{className:"w-10 h-10 bg-black border border-zinc-700 rounded-lg flex items-center justify-center group-hover:border-orange-500/50 transition-colors",children:e.jsx(na,{className:"w-5 h-5 text-zinc-500 group-hover:text-orange-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h4",{className:"text-xs font-bold text-white uppercase tracking-wider",children:T.title}),e.jsx("span",{className:"text-[9px] font-mono text-zinc-500",children:T.rarity})]}),e.jsx("p",{className:"text-[9px] text-zinc-500 line-clamp-1 italic",children:T.description})]})]},T.id))})]})]}),e.jsx(Q,{children:n&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-black/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(k.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-zinc-900 border border-orange-500/50 w-full max-w-sm rounded-2xl p-6 relative shadow-[0_0_50px_rgba(249,115,22,0.15)] flex flex-col max-h-[90vh]",children:[!b&&e.jsx("button",{onClick:()=>o(null),className:"absolute top-4 right-4 text-zinc-500 hover:text-white",children:e.jsx(ke,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[e.jsx("div",{className:"w-20 h-20 bg-black border-2 border-orange-500/30 rounded-xl flex items-center justify-center mb-4 relative overflow-hidden",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-orange-500/20 z-0",style:{height:`${h}%`,bottom:0,top:"auto",transition:"height 0.1s linear"}}),e.jsxs("span",{className:"relative z-10 text-xl font-black text-white",children:[g.toFixed(1),"s"]})]}):e.jsx(ra,{className:"w-8 h-8 text-orange-500"})}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter mb-1",children:n.title}),!b&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-orange-400 bg-orange-950/20 px-3 py-1 rounded-full border border-orange-500/20",children:[e.jsx(ia,{className:"w-3 h-3"}),e.jsxs("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:["Čas výroby: ",((W=n.craftingRecipe)==null?void 0:W.craftingTimeSeconds)||10,"s"]})]})]}),e.jsxs("div",{className:"p-4 bg-black/40 rounded-xl border border-zinc-800 mb-6 flex-1 overflow-y-auto",children:[e.jsx("p",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-3 tracking-widest border-b border-zinc-800 pb-2",children:"Požadované Suroviny"}),e.jsxs("div",{className:"space-y-2",children:[(le=(q=n.craftingRecipe)==null?void 0:q.requiredResources)==null?void 0:le.map((T,f)=>{const c=F(T.resourceName),E=c>=T.amount;return e.jsxs("div",{className:"flex justify-between items-center bg-zinc-900/50 p-2 rounded",children:[e.jsx("span",{className:"text-xs text-zinc-300 font-mono",children:T.resourceName}),e.jsxs("div",{className:`flex items-center gap-2 text-xs font-mono font-bold ${E?"text-green-500":"text-red-500"}`,children:[e.jsxs("span",{children:[c," / ",T.amount]}),E?e.jsx(_e,{className:"w-3 h-3"}):e.jsx(pe,{className:"w-3 h-3"})]})]},f)}),(!((M=n.craftingRecipe)!=null&&M.requiredResources)||n.craftingRecipe.requiredResources.length===0)&&e.jsx("p",{className:"text-center text-zinc-600 text-xs italic",children:"Žádné suroviny nejsou potřeba."})]})]}),b?e.jsxs("div",{className:"w-full bg-zinc-800 rounded-full h-4 overflow-hidden border border-zinc-700 relative",children:[e.jsx(k.div,{className:"h-full bg-orange-500",style:{width:`${h}%`},transition:{duration:.1,ease:"linear"}}),e.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[8px] font-black uppercase text-white drop-shadow-md",children:"Fabrikace..."})]}):e.jsx("button",{onClick:_,disabled:!L(n),className:`w-full py-4 font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 transition-all ${L(n)?"bg-orange-600 hover:bg-orange-500 text-white shadow-lg shadow-orange-500/20":"bg-zinc-800 text-zinc-600 cursor-not-allowed border border-zinc-700"}`,children:L(n)?"VYROBIT PŘEDMĚT":"NEDOSTATEK SUROVIN"})]})})})]})},Xa=({onClose:t,masterCatalog:s,inventory:m,playerGold:a,playerClass:x,onBuy:d,onRecycle:n})=>{const[o,b]=l.useState("BUY"),[i,h]=l.useState(null),[u,g]=l.useState(!1),[j,P]=l.useState("ALL");l.useEffect(()=>{S("open")},[]);const I=l.useMemo(()=>{const f={};return s.forEach(c=>{var E;if((E=c.marketConfig)!=null&&E.saleChance){const V=Math.random()*100;f[c.id]=V<=c.marketConfig.saleChance}}),f},[s]),F=l.useMemo(()=>{let f=s.filter(c=>{var E;return(E=c.marketConfig)==null?void 0:E.enabled});return j!=="ALL"&&(f=f.filter(c=>c.type===j)),f},[s,j]),L=l.useMemo(()=>m.filter(f=>{var c;return((c=f.marketConfig)==null?void 0:c.recyclingOutput)&&f.marketConfig.recyclingOutput.length>0}),[m]),_=f=>{var oe,se;const c=f.price??100;let E=c,V=null;const ee=I[f.id]||!1;if(ee&&((oe=f.marketConfig)!=null&&oe.marketPrice&&f.marketConfig.marketPrice>0?E=f.marketConfig.marketPrice:E=Math.floor(c*.7)),x&&((se=f.marketConfig)!=null&&se.classModifiers)){const Z=f.marketConfig.classModifiers.find(J=>J.playerClass===x);Z&&(E=Math.floor(E*Z.priceMultiplier),Z.priceMultiplier<1?V=`BONUS: ${x}`:Z.priceMultiplier>1&&(V=`PŘIRÁŽKA: ${x}`))}return{finalPrice:Math.max(1,E),basePrice:c,discountLabel:V,isOnSale:ee}},G=f=>{var c;return(c=f.marketConfig)!=null&&c.recyclingOutput?f.marketConfig.recyclingOutput.map(E=>{const V=s.find(ee=>{var U;return((U=ee.resourceConfig)==null?void 0:U.isResourceContainer)&&ee.resourceConfig.resourceName===E.resourceName||ee.title===E.resourceName});return V?{resource:V,amount:E.amount}:null}).filter(E=>E!==null):[]},W=()=>{if(!(!i||u))if(g(!0),o==="BUY"){const{finalPrice:f}=_(i);if(a<f){S("error"),g(!1);return}S("success"),H([50,50]),setTimeout(()=>{d(i,f),g(!1),h(null)},1e3)}else{const f=G(i);S("damage"),H([100,50,200]),setTimeout(()=>{n(i,f),g(!1),h(null),S("success")},1500)}},q=f=>{const c=f.toUpperCase();return c.includes("HP")||c.includes("ZDRAVÍ")?e.jsx(Ce,{className:"w-3 h-3 text-red-500"}):c.includes("MANA")||c.includes("ENERGIE")?e.jsx(Ke,{className:"w-3 h-3 text-blue-400"}):c.includes("DMG")||c.includes("ÚTOK")?e.jsx(lt,{className:"w-3 h-3 text-orange-500"}):c.includes("DEF")||c.includes("OBRANA")?e.jsx(Ae,{className:"w-3 h-3 text-slate-300"}):e.jsx(we,{className:"w-3 h-3 text-zinc-400"})},le="text-yellow-500",M="border-yellow-500/30";return e.jsxs("div",{className:"fixed inset-0 z-[250] bg-zinc-950 text-white flex flex-col font-sans overflow-hidden",children:[e.jsxs("header",{className:`bg-zinc-900 border-b ${M} p-4 flex justify-between items-center relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"repeating-linear-gradient(45deg, #000 0, #000 10px, #eab308 10px, #eab308 20px)"}}),e.jsxs("div",{className:`flex items-center gap-3 relative z-10 ${le}`,children:[e.jsx("div",{className:`p-2 bg-yellow-950/20 border ${M} rounded`,children:e.jsx(ot,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black uppercase tracking-widest leading-none text-white",children:"Obchodní Terminál"}),e.jsx("p",{className:"text-[9px] font-mono font-bold uppercase tracking-[0.3em] text-zinc-400",children:"SEKTOR MARKET_V2"})]})]}),e.jsx("button",{onClick:t,className:"p-2 relative z-10 bg-zinc-800 rounded-full hover:bg-zinc-700 transition-colors",children:e.jsx(ke,{className:"w-6 h-6 text-zinc-400"})})]}),e.jsxs("div",{className:"flex flex-col border-b border-zinc-800",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-zinc-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-black border border-yellow-500/30 rounded-lg shadow-[0_0_15px_rgba(234,179,8,0.1)]",children:[e.jsx(he,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"text-xl font-mono font-bold text-white",children:a})]}),e.jsxs("div",{className:"flex bg-black rounded-lg p-1 border border-zinc-800",children:[e.jsx("button",{onClick:()=>{b("BUY"),S("click")},className:`px-6 py-2 rounded-md text-xs font-bold uppercase tracking-wider transition-all ${o==="BUY"?"bg-yellow-600 text-black shadow-lg":"text-zinc-500 hover:text-white"}`,children:"Nákup"}),e.jsx("button",{onClick:()=>{b("RECYCLE"),S("click")},className:`px-6 py-2 rounded-md text-xs font-bold uppercase tracking-wider transition-all ${o==="RECYCLE"?"bg-orange-600 text-white shadow-lg":"text-zinc-500 hover:text-white"}`,children:"Drtička"})]})]}),o==="BUY"&&e.jsxs("div",{className:"flex gap-2 p-2 px-4 bg-black overflow-x-auto no-scrollbar border-b border-zinc-800",children:[e.jsx(la,{className:"w-4 h-4 text-zinc-600 my-auto mr-2"}),["ALL","PŘEDMĚT","SUROVINA"].map(f=>e.jsx("button",{onClick:()=>P(f),className:`px-3 py-1 rounded text-[10px] font-bold uppercase border transition-colors whitespace-nowrap ${j===f?"border-yellow-500 text-yellow-500 bg-yellow-950/20":"border-zinc-800 text-zinc-500"}`,children:f==="ALL"?"Vše":f},f))]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-zinc-950 relative",children:o==="BUY"?F.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full opacity-30",children:[e.jsx(ot,{className:"w-16 h-16 mb-4 text-zinc-500"}),e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-zinc-500",children:"Sklad vyprodán"})]}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:F.map(f=>{const{finalPrice:c,basePrice:E,discountLabel:V,isOnSale:ee}=_(f),U=a>=c,oe=c<E;return e.jsxs("button",{onClick:()=>{h(f),S("click")},className:`relative flex flex-col text-left p-3 rounded-xl border transition-all active:scale-95 group ${U?"bg-zinc-900 border-zinc-800 hover:border-yellow-500/50":"bg-zinc-900/50 border-red-900/30 opacity-70"}`,children:[ee&&e.jsx("div",{className:"absolute top-2 right-2 bg-pink-600 text-white text-[8px] font-black px-1.5 py-0.5 rounded uppercase tracking-wider animate-pulse shadow-[0_0_10px_#db2777]",children:"AKCE"}),e.jsx("div",{className:"mb-2 p-3 bg-black rounded-lg border border-zinc-800 self-start group-hover:border-yellow-500/30 transition-colors",children:e.jsx(at,{className:`w-6 h-6 ${U?"text-zinc-200":"text-red-900"}`})}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("h4",{className:"text-xs font-bold text-white uppercase line-clamp-1 mb-1",children:f.title}),f.stats&&f.stats.length>0&&e.jsx("div",{className:"grid grid-cols-1 gap-1 mb-2",children:f.stats.slice(0,3).map((se,Z)=>e.jsxs("div",{className:"flex items-center justify-between text-[9px] bg-white/5 px-1.5 py-0.5 rounded border border-white/5",children:[e.jsxs("span",{className:"text-zinc-400 font-bold uppercase flex items-center gap-1",children:[q(se.label)," ",se.label.substring(0,3)]}),e.jsx("span",{className:"text-white font-mono font-bold",children:se.value})]},Z))})]}),e.jsxs("div",{className:"mt-auto pt-2 border-t border-zinc-800 w-full",children:[V&&e.jsx("span",{className:"text-[8px] text-green-500 font-bold uppercase block mb-1",children:V}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:`flex items-center gap-1 font-mono font-bold ${U?"text-yellow-500":"text-red-500"}`,children:[e.jsx("span",{children:c}),e.jsx(he,{className:"w-3 h-3"})]}),oe&&e.jsx("span",{className:"text-[9px] text-zinc-600 line-through decoration-red-500 font-mono",children:E})]})]})]},f.id)})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-orange-900/10 border border-orange-500/20 rounded-lg flex items-center gap-3 mb-4",children:[e.jsx(oa,{className:"w-5 h-5 text-orange-500"}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-mono leading-tight",children:"Vložte nepotřebné předměty do drtičky a získejte suroviny pro výrobu."})]}),L.length===0?e.jsxs("div",{className:"text-center py-10 opacity-30",children:[e.jsx(ca,{className:"w-12 h-12 mx-auto mb-2"}),e.jsx("p",{className:"text-xs font-bold uppercase",children:"Žádný recyklovatelný odpad"})]}):L.map(f=>e.jsxs("button",{onClick:()=>{h(f),S("click")},className:"w-full flex items-center gap-4 p-3 bg-zinc-900 border border-zinc-800 hover:border-orange-500/50 rounded-xl transition-all active:scale-95 group text-left",children:[e.jsx("div",{className:"p-2 bg-black border border-zinc-700 rounded text-zinc-500 group-hover:text-orange-500 transition-colors",children:e.jsx(at,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-bold text-white uppercase",children:f.title}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:G(f).map((c,E)=>e.jsxs("span",{className:"text-[9px] bg-orange-950/30 text-orange-400 px-1.5 py-0.5 rounded border border-orange-500/20",children:["+",c.amount," ",c.resource.title]},E))})]}),e.jsx(Ze,{className:"w-4 h-4 text-zinc-600 group-hover:text-orange-500"})]},f.id))]})}),e.jsx(Q,{children:i&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-black/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(k.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:`bg-zinc-900 border w-full max-w-sm rounded-2xl p-6 relative shadow-2xl flex flex-col ${o==="BUY"?"border-yellow-500/50":"border-orange-500/50"}`,children:[e.jsx("button",{onClick:()=>h(null),className:"absolute top-4 right-4 text-zinc-500 hover:text-white",children:e.jsx(ke,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[e.jsx("div",{className:`w-20 h-20 bg-black border-2 rounded-xl flex items-center justify-center mb-4 ${o==="BUY"?"border-yellow-500/30 text-yellow-500":"border-orange-500/30 text-orange-500"}`,children:o==="BUY"?e.jsx(at,{className:"w-10 h-10"}):e.jsx(qt,{className:"w-10 h-10"})}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter mb-1",children:i.title}),e.jsx("p",{className:"text-[10px] font-mono text-zinc-500 uppercase",children:i.type})]}),o==="BUY"?e.jsxs("div",{className:"space-y-4",children:[i.stats&&i.stats.length>0&&e.jsxs("div",{className:"bg-white/5 p-3 rounded-lg border border-white/5 mb-2",children:[e.jsxs("p",{className:"text-[10px] font-bold text-zinc-400 uppercase mb-2 flex items-center gap-1",children:[e.jsx(we,{className:"w-3 h-3"})," Statistiky Assetu"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.stats.map((f,c)=>e.jsxs("div",{className:"flex justify-between items-center bg-black px-2 py-1 rounded",children:[e.jsxs("span",{className:"text-[9px] text-zinc-500 font-bold uppercase flex items-center gap-1",children:[q(f.label)," ",f.label]}),e.jsx("span",{className:"text-xs font-mono font-bold text-white",children:f.value})]},c))})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-4 rounded-xl border border-zinc-800",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-bold text-zinc-400 uppercase",children:"Cena"}),_(i).finalPrice<_(i).basePrice&&e.jsxs("span",{className:"text-[10px] text-zinc-600 line-through decoration-red-500 font-mono",children:[_(i).basePrice," GOLD"]})]}),e.jsxs("div",{className:`flex items-center gap-2 text-xl font-mono font-black ${a>=_(i).finalPrice?"text-yellow-500":"text-red-500"}`,children:[_(i).finalPrice," ",e.jsx(he,{className:"w-5 h-5"})]})]}),a<_(i).finalPrice&&e.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-[10px] font-bold uppercase justify-center bg-red-950/20 p-2 rounded",children:[e.jsx(pe,{className:"w-3 h-3"})," Nedostatek prostředků"]})]}):e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("p",{className:"text-[10px] font-bold text-orange-500 uppercase tracking-widest mb-2 border-b border-orange-500/20 pb-1",children:"Získáte suroviny:"}),G(i).map((f,c)=>e.jsxs("div",{className:"flex justify-between items-center bg-orange-900/10 p-2 rounded border border-orange-500/20",children:[e.jsx("span",{className:"text-xs text-zinc-300 font-mono",children:f.resource.title}),e.jsxs("span",{className:"text-sm font-black text-white",children:["x",f.amount]})]},c))]}),e.jsx("button",{onClick:W,disabled:u||o==="BUY"&&a<_(i).finalPrice,className:`w-full py-4 mt-6 font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 transition-all ${u?"bg-zinc-800 text-zinc-500 cursor-not-allowed":o==="BUY"?a>=_(i).finalPrice?"bg-yellow-600 hover:bg-yellow-500 text-black shadow-lg shadow-yellow-500/20":"bg-zinc-800 text-zinc-600 cursor-not-allowed":"bg-orange-600 hover:bg-orange-500 text-white shadow-lg shadow-orange-500/20"}`,children:u?e.jsx("span",{className:"animate-pulse",children:"Zpracování..."}):o==="BUY"?e.jsxs(e.Fragment,{children:[a>=_(i).finalPrice?"POTVRDIT NÁKUP":"NEDOSTATEK KREDITŮ",e.jsx(da,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["ROZEMLÍT PŘEDMĚT ",e.jsx(je,{className:"w-4 h-4"})]})})]})})})]})},Qa="admin_test_vault@nexus.local",en=({station:t,onLeave:s,onClaimRewards:m,onCraft:a,inventory:x=[],masterCatalog:d=[],playerGold:n=0,playerClass:o=null,onInventoryUpdate:b,onGoldChange:i,isAdmin:h=!1,isTestMode:u=!1})=>{var oe,se,Z,J;const[g,j]=l.useState(!0),[P,I]=l.useState(!1),[F,L]=l.useState(null),[_,G]=l.useState(!1),[W,q]=l.useState(!1),[le,M]=l.useState(!1);l.useEffect(()=>{S("open");const te=setTimeout(()=>j(!1),2e3);return()=>clearTimeout(te)},[]);const T=()=>{!_&&m&&(m(t),G(!0))},f=()=>{S("click"),I(!0)},c=()=>{I(!1),s()},E=te=>{S("error"),L(te),setTimeout(()=>L(null),2e3)},V=()=>h&&u?Qa:localStorage.getItem("nexus_current_user"),ee=async(te,ne)=>{try{const re=V();re&&(i&&i(-Math.abs(ne)),await qe(re,{...te,id:`BOUGHT-${Date.now()}`}),b&&b())}catch{}},U=async(te,ne)=>{try{const re=V();if(re){await Ue(re,te.id);for(const y of ne){const C={...y.resource,id:`RES-${Date.now()}-${Math.random()}`,resourceConfig:{...y.resource.resourceConfig,resourceAmount:y.amount}};await qe(re,C)}b&&b()}}catch{}};return g?e.jsx("div",{className:"fixed inset-0 z-[200] bg-black flex items-center justify-center font-mono",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(Fe,{className:"w-16 h-16 text-cyan-500 animate-pulse mx-auto"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-cyan-500 uppercase tracking-[0.2em] font-bold",children:"Iniciace Servisních Protokolů..."}),e.jsx("p",{className:"text-xl text-white font-black uppercase tracking-widest",children:t.title})]}),e.jsx("div",{className:"w-48 h-1 bg-zinc-800 rounded-full mx-auto overflow-hidden",children:e.jsx(k.div,{className:"h-full bg-cyan-500",initial:{width:0},animate:{width:"100%"},transition:{duration:1.5,ease:"easeInOut"}})})]})}):e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[200] bg-[#050608] text-white overflow-hidden flex flex-col font-sans",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-10",style:{backgroundImage:"linear-gradient(rgba(34, 211, 238, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(34, 211, 238, 0.1) 1px, transparent 1px)",backgroundSize:"40px 40px"}}),e.jsxs("header",{className:"relative z-10 bg-black/60 backdrop-blur-md border-b border-white/10 p-6 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-cyan-950/30 border border-cyan-500/50 rounded-lg flex items-center justify-center",children:e.jsx(Fe,{className:"w-6 h-6 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black uppercase tracking-tighter leading-none",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsxs("span",{className:"text-[10px] font-mono text-cyan-500/80 uppercase tracking-widest",children:["Připojení Stabilní • ID: ",t.id]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[h&&u&&e.jsx("div",{className:"px-3 py-1 bg-orange-900/30 border border-orange-500/30 rounded text-[9px] font-bold uppercase text-orange-500 animate-pulse hidden md:block",children:"TESTOVACÍ REŽIM AKTIVNÍ"}),e.jsxs("div",{className:"text-right hidden md:block",children:[e.jsx("p",{className:"text-[10px] text-zinc-500 uppercase font-bold tracking-widest",children:"Lokální Čas"}),e.jsx("p",{className:"text-sm font-mono font-bold text-zinc-300",children:new Date().toLocaleTimeString()})]})]})]}),e.jsxs("main",{className:"flex-1 relative z-10 p-6 overflow-y-auto no-scrollbar pb-32",children:[e.jsxs("div",{className:"mb-8 p-6 bg-gradient-to-r from-cyan-900/20 to-transparent border-l-4 border-cyan-500 rounded-r-xl",children:[e.jsx("h2",{className:"text-lg font-bold text-cyan-100 mb-1",children:"Diagnostika lodi."}),e.jsxs("p",{className:"text-sm text-cyan-400/60 font-mono",children:['"',((oe=t.stationConfig)==null?void 0:oe.welcomeMessage)||"Dostupné servisní úkony nalezeny.",'"']})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("h3",{className:"text-xs font-black text-white/40 uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"})," Dostupný Servis"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[((se=t.stationConfig)==null?void 0:se.refillO2)&&e.jsxs(k.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:`p-5 rounded-xl flex items-center gap-4 border transition-colors ${_?"bg-green-900/20 border-green-500/50":"bg-black/40 border-white/10"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${_?"bg-green-900/20 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:e.jsx(ut,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest",children:"Podpora Života"}),e.jsx("p",{className:"text-lg font-black text-white uppercase",children:"Doplnění O2"})]}),_&&e.jsx(_e,{className:"w-6 h-6 text-green-500 ml-auto"})]}),((Z=t.stationConfig)==null?void 0:Z.fuelReward)&&e.jsxs(k.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:`p-5 rounded-xl flex items-center gap-4 border transition-colors ${_?"bg-green-900/20 border-green-500/50":"bg-black/40 border-white/10"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${_?"bg-green-900/20 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:e.jsx(pt,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest",children:"Tankování"}),e.jsxs("p",{className:"text-lg font-black text-white uppercase",children:["+",t.stationConfig.fuelReward," Paliva"]})]}),_&&e.jsx(_e,{className:"w-6 h-6 text-green-500 ml-auto"})]}),((J=t.stationConfig)==null?void 0:J.repairAmount)&&e.jsxs(k.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:`p-5 rounded-xl flex items-center gap-4 border transition-colors ${_?"bg-green-900/20 border-green-500/50":"bg-black/40 border-white/10"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${_?"bg-green-900/20 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:e.jsx(Ae,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest",children:"Opravy"}),e.jsxs("p",{className:"text-lg font-black text-white uppercase",children:["+",t.stationConfig.repairAmount," HP/Hull"]})]}),_&&e.jsx(_e,{className:"w-6 h-6 text-green-500 ml-auto"})]})]}),e.jsx("button",{onClick:T,disabled:_,className:`w-full py-5 font-black uppercase text-sm tracking-[0.3em] rounded-xl flex items-center justify-center gap-3 transition-all shadow-lg ${_?"bg-green-600 text-white cursor-default":"bg-white text-black hover:bg-cyan-400 active:scale-95"}`,children:_?e.jsxs(e.Fragment,{children:[e.jsx(Bt,{className:"w-5 h-5"})," SERVISNÍ ÚKONY DOKONČENY"]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-5 h-5"})," PROVÉST KOMPLETNÍ SERVIS"]})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-xs font-black text-white/40 uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"})," Doplňkové Služby"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>M(!0),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(ot,{className:"w-6 h-6 text-zinc-500 group-hover:text-cyan-400 transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400 group-hover:text-white",children:"Tržiště & Scrap"})]}),e.jsxs("button",{onClick:()=>q(!0),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(je,{className:"w-6 h-6 text-zinc-500 group-hover:text-orange-500 transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400 group-hover:text-white",children:"Výroba (Factory)"})]}),e.jsxs("button",{onClick:()=>E("Loděnice"),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(xa,{className:"w-6 h-6 text-zinc-500 group-hover:text-signal-cyan transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400",children:"Vylepšit Loď"})]}),e.jsxs("button",{onClick:()=>E("Kartografie"),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(mt,{className:"w-6 h-6 text-zinc-500 group-hover:text-purple-500 transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400",children:"Registr Planet"})]})]})]}),e.jsx("div",{className:"w-full h-0.5 bg-signal-amber mb-6 shadow-[0_0_10px_#ff9d00]"}),e.jsxs("div",{className:"pt-2",children:[e.jsxs("h3",{className:"text-xs font-black text-signal-amber uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"})," Protokol Údržby"]}),e.jsxs("div",{className:"font-mono text-[10px] text-zinc-500 space-y-1.5 p-4 bg-black/40 rounded-xl border border-white/5",children:[e.jsxs("p",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-700",children:"08:00"})," ",e.jsx("span",{children:"> Navázáno spojení s centrálním serverem..."})]}),e.jsxs("p",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-700",children:"08:01"})," ",e.jsx("span",{children:"> Autorizace jednotky: ÚSPĚCH"})]}),e.jsxs("p",{className:"flex gap-2 text-green-500",children:[e.jsx("span",{className:"text-green-900",children:"08:02"})," ",e.jsx("span",{children:"> Zahájení automatických oprav..."})]}),e.jsxs("p",{className:"flex gap-2 text-green-500",children:[e.jsx("span",{className:"text-green-900",children:"08:05"})," ",e.jsx("span",{children:"> Doplnění zásob..."})]}),e.jsxs("p",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-700",children:"08:10"})," ",e.jsx("span",{children:"> Odpojení servisních ramen."})]}),e.jsxs("p",{className:"flex gap-2 animate-pulse text-signal-cyan",children:[e.jsx("span",{className:"text-cyan-900",children:"08:11"})," ",e.jsx("span",{children:"> Připraveno k odletu."})]})]})]})]}),e.jsx("footer",{className:"relative z-10 p-6 bg-black/80 backdrop-blur-xl border-t border-white/10",children:e.jsxs("button",{onClick:f,className:"w-full py-4 bg-cyan-600/10 hover:bg-cyan-600/20 border border-cyan-600/30 text-cyan-400 font-black uppercase text-sm tracking-[0.3em] rounded-xl flex items-center justify-center gap-3 transition-all active:scale-95 shadow-[0_0_20px_rgba(8,145,178,0.2)]",children:[e.jsx(wt,{className:"w-5 h-5"}),"Opustit Stanici (Undock)"]})}),e.jsx(Q,{children:P&&e.jsx("div",{className:"fixed inset-0 z-[250] bg-black/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(k.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-zinc-900 border border-white/10 p-6 rounded-2xl w-full max-w-xs text-center shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-signal-cyan"}),e.jsx("div",{className:"w-16 h-16 bg-cyan-500/10 rounded-full flex items-center justify-center mx-auto mb-4 text-cyan-500 border border-cyan-500/30",children:e.jsx(wt,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-wider mb-2",children:"Opustit Dok?"}),e.jsx("p",{className:"text-xs text-zinc-400 mb-6 font-mono leading-relaxed",children:"Opravdu chcete opustit stanici? Ujistěte se, že máte doplněno palivo a zásoby."}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>I(!1),className:"py-3 bg-zinc-800 text-zinc-400 font-bold uppercase text-[10px] rounded-lg hover:bg-zinc-700 transition-colors",children:"Zůstat"}),e.jsx("button",{onClick:c,className:"py-3 bg-cyan-600 text-white font-bold uppercase text-[10px] rounded-lg hover:bg-cyan-500 transition-colors shadow-lg shadow-cyan-500/20",children:"Odletět"})]})]})})}),e.jsx(Q,{children:F&&e.jsxs(k.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},className:"fixed bottom-24 left-1/2 -translate-x-1/2 z-[300] bg-black/90 border border-orange-500/50 px-6 py-3 rounded-full shadow-[0_0_30px_rgba(249,115,22,0.3)] flex items-center gap-3",children:[e.jsx(ma,{className:"w-5 h-5 text-orange-500 animate-pulse"}),e.jsxs("span",{className:"text-xs font-bold text-orange-500 uppercase tracking-widest whitespace-nowrap",children:["Modul ",F," ve výstavbě"]})]})}),e.jsx(Q,{children:W&&e.jsx(k.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-[250]",children:e.jsx(Wa,{inventory:x,masterCatalog:d,onClose:()=>q(!1),onCraft:a})})}),e.jsx(Q,{children:le&&e.jsx(k.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-[250]",children:e.jsx(Xa,{onClose:()=>M(!1),masterCatalog:d,inventory:x,playerGold:n,playerClass:o,onBuy:(te,ne)=>{ee(te,ne)},onRecycle:(te,ne)=>{U(te,ne)}})})})]})},Xt=()=>Oe(()=>import("./InventoryView-BCvUrcOC.js"),__vite__mapDeps([0,1,2]),import.meta.url),Qt=()=>Oe(()=>import("./Generator-Bwj1m05-.js"),__vite__mapDeps([3,1,2]),import.meta.url),es=()=>Oe(()=>import("./Room-7z78Kx_7.js"),__vite__mapDeps([4,1,2]),import.meta.url),ts=()=>Oe(()=>import("./SettingsView-TgEdZf7x.js"),__vite__mapDeps([5,1]),import.meta.url),ss=()=>Oe(()=>import("./SpaceshipView-zh67IdI9.js"),__vite__mapDeps([6,1,2]),import.meta.url),tn=l.lazy(Xt),sn=l.lazy(Qt),an=l.lazy(es),nn=l.lazy(ts),rn=l.lazy(ss);class ln extends l.Component{constructor(){super(...arguments);yt(this,"state",{hasError:!1})}static getDerivedStateFromError(m){return{hasError:!0}}componentDidCatch(m,a){}render(){return this.state.hasError?e.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center bg-black p-10 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-950/20 border border-red-500/50 rounded-full flex items-center justify-center mb-6 shadow-[0_0_20px_rgba(239,68,68,0.2)]",children:e.jsx(pe,{className:"w-8 h-8 text-red-500"})}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-widest mb-2",children:"Chyba_Segmentu"}),e.jsxs("p",{className:"text-zinc-500 text-[10px] font-mono uppercase tracking-widest mb-8 leading-relaxed",children:["Nepodařilo se stáhnout herní modul.",e.jsx("br",{}),"Možná ztráta signálu se sektorem."]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"button-primary py-4 px-10 text-[10px]",children:"Restartovat HUD"})]}):this.props.children}}const on=()=>e.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center bg-black gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"w-12 h-12 text-signal-cyan animate-spin opacity-50"}),e.jsx(k.div,{animate:{scale:[1,1.2,1],opacity:[.3,1,.3]},transition:{duration:1.5,repeat:1/0},className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-signal-cyan rounded-full shadow-[0_0_10px_#00f2ff]"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-black text-signal-cyan uppercase tracking-[0.4em] animate-pulse",children:"Synchronizace_Dat"}),e.jsx("span",{className:"text-[8px] font-mono text-zinc-600 uppercase mt-1",children:"Stahování_Segmentu..."})]})]}),cn=()=>{const t=Ga(),[s,m]=l.useState(()=>sessionStorage.getItem("nexus_boot_done")==="true"),[a,x]=l.useState(.85),[d,n]=l.useState(navigator.onLine);l.useEffect(()=>{s&&t.userEmail&&d&&(Xt().catch(()=>{}),es().catch(()=>{}),ss().catch(()=>{}),t.isAdmin&&Qt().catch(()=>{}),ts().catch(()=>{}))},[s,t.userEmail,d,t.isAdmin]),l.useEffect(()=>{const h=()=>n(navigator.onLine);return window.addEventListener("online",h),window.addEventListener("offline",h),"getBattery"in navigator&&navigator.getBattery().then(u=>{const g=()=>x(u.level);return g(),u.addEventListener("levelchange",g),()=>u.removeEventListener("levelchange",g)}),()=>{window.removeEventListener("online",h),window.removeEventListener("offline",h)}},[]);const o=()=>{m(!0),sessionStorage.setItem("nexus_boot_done","true")},b=()=>{S("message"),H(15);const h=t.isNight,u=h?"NOČNÍ PROTOKOL AKTIVNÍ":"DENNÍ PROTOKOL AKTIVNÍ",g=h?"20:00 — 06:00":"06:00 — 20:00",j=h?"Zvýšená aktivita biotických hrozeb. Noční varianty karet mají bonus k poškození (+5 DMG). Viditelnost skeneru omezena.":"Stabilní atmosférické podmínky. Standardní loot tabulky a bezpečné obchodní trasy. Bonus k regeneraci kyslíku.";t.setNotification({id:"cycle-"+Date.now(),message:`${u}
Čas: ${g}

${j}`,type:"info"})},i=(h,u)=>{var I,F;const g=t.inventory.find(L=>{var _;return L.type===R.PLANET&&((_=L.planetConfig)==null?void 0:_.planetId)===h});if((I=g==null?void 0:g.planetConfig)!=null&&I.phases&&g.planetConfig.phases.length>0){const L=g.planetProgress||0;if(L<g.planetConfig.phases.length){const _=g.planetConfig.phases[L],G=t.masterCatalog.find(W=>W.id===_);if(G){t.setCurrentEvent({...G});return}}}if((F=g==null?void 0:g.planetConfig)!=null&&F.landingEventId){const L=t.masterCatalog.find(_=>_.id===g.planetConfig.landingEventId);if(L){t.setCurrentEvent({...L,id:`LIVE-${Date.now()}`});return}}const j=t.masterCatalog.filter(L=>L.type===u);let P=null;if(j.length>0){const L=Math.floor(Math.random()*j.length);P={...j[L],id:`LANDING-${Date.now()}`}}else P={id:`GEN-${Date.now()}`,title:"Průzkum Sektoru",description:`Narazili jste na neznámou aktivitu typu ${u}.`,type:u,rarity:"Common",stats:[],isConsumable:!1};t.setCurrentEvent(P)};return s?t.userEmail?!t.roomState.isNicknameSet||!t.playerClass?e.jsx(qa,{initialNickname:t.roomState.nickname,onConfirmSetup:t.handleGameSetup,isGuest:t.isGuest}):e.jsxs("div",{className:"h-screen w-screen bg-black overflow-hidden flex flex-col font-sans text-white relative",children:[e.jsx(Q,{children:t.screenFlash&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-[999] pointer-events-none mix-blend-overlay ${t.screenFlash==="red"?"bg-red-600/40":t.screenFlash==="green"?"bg-green-500/30":t.screenFlash==="blue"?"bg-blue-500/30":"bg-orange-500/50"}`})}),e.jsxs("div",{className:"h-28 bg-zinc-950/95 border-b border-white/10 flex flex-col z-[100] shadow-[0_5px_20px_rgba(0,0,0,0.8)]",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-1 border-b border-white/5 bg-white/[0.01]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[7px] font-black text-signal-cyan uppercase tracking-[0.2em] opacity-80",children:"Nexus_OS_v1.4"}),e.jsx("div",{className:`w-1 h-1 rounded-full ${d?"bg-green-500 animate-pulse":"bg-red-500 shadow-[0_0_8px_red] animate-ping"}`}),t.isAdmin&&e.jsxs("div",{className:`ml-2 px-2 py-0.5 rounded border-[0.5px] text-[6px] font-black uppercase tracking-wider flex items-center gap-1 ${t.isTestMode?"border-orange-500/50 text-orange-500 bg-orange-950/30 shadow-[0_0_10px_rgba(249,115,22,0.2)]":"border-purple-500/50 text-purple-400 bg-purple-950/30 shadow-[0_0_10px_rgba(168,85,247,0.2)]"}`,children:[t.isTestMode?e.jsx(ua,{className:"w-2 h-2"}):e.jsx(xt,{className:"w-2 h-2"}),t.isTestMode?"TEST_ENV":"LIVE_DB"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:b,className:"flex items-center gap-1.5 active:scale-95 transition-transform",children:[t.isNight?e.jsx(pa,{className:"w-3 h-3 text-indigo-400"}):e.jsx(ha,{className:"w-3 h-3 text-signal-amber"}),e.jsx("span",{className:"text-[8px] font-mono text-zinc-400 uppercase tracking-widest",children:t.isNight?"Night_Cycle":"Day_Cycle"})]}),e.jsx("div",{className:"w-8 h-1.5 bg-white/5 relative rounded-full overflow-hidden border border-white/10",children:e.jsx("div",{className:"h-full bg-signal-amber shadow-[0_0_50px_#ff9d00]",style:{width:`${a*100}%`}})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-1 p-1 bg-black/40",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-1",children:[e.jsx(ve,{icon:e.jsx(Ce,{className:"w-4 h-4"}),value:t.playerHp,color:"#ef4444",label:"HP"}),e.jsx(ve,{icon:e.jsx(Ke,{className:"w-4 h-4"}),value:t.playerMana,color:"#00f2ff",label:"MANA"}),e.jsx(ve,{icon:e.jsx(pt,{className:"w-4 h-4"}),value:t.playerFuel,color:"#f97316",label:"PALIVO"})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-1",children:[e.jsx(ve,{icon:e.jsx(he,{className:"w-3 h-3"}),value:t.playerGold,color:"#fbbf24",label:"GOLD",small:!0}),e.jsx(ve,{icon:e.jsx(Ae,{className:"w-3 h-3"}),value:t.playerArmor,color:"#a1a1aa",label:"ARMOR",small:!0}),e.jsx(ve,{icon:e.jsx(ut,{className:"w-3 h-3"}),value:t.playerOxygen,color:"#22d3ee",label:"O2",small:!0})]})]})]}),e.jsx("div",{className:"flex-1 relative overflow-hidden",children:e.jsx(ln,{children:e.jsx(l.Suspense,{fallback:e.jsx(on,{}),children:e.jsxs(Q,{mode:"wait",children:[t.activeTab===Y.SCANNER&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:e.jsx(Ua,{onScanCode:t.handleScanCode,isAIThinking:t.isAIThinking,isPaused:t.isScannerPaused})},"scanner"),t.activeTab===Y.INVENTORY&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:e.jsx(tn,{inventory:t.inventory,loadingInventory:!1,isRefreshing:t.isRefreshing,isAdmin:t.isAdmin,isNight:t.isNight,adminNightOverride:t.adminNightOverride,playerClass:t.playerClass,giftTarget:t.giftTarget,onRefresh:t.handleRefreshDatabase,onItemClick:t.handleOpenInventoryItem,isTestMode:t.isTestMode})},"inventory"),t.activeTab===Y.GENERATOR&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:e.jsx(sn,{onSaveCard:h=>t.handleSaveEvent(h,!0),userEmail:t.userEmail||"",initialData:t.editingEvent,onClearData:()=>t.setEditingEvent(null),onDelete:t.handleDeleteEvent,masterCatalog:t.masterCatalog})},"generator"),t.activeTab===Y.ROOM&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1,exit:{opacity:0}},className:"absolute inset-0",children:e.jsx(an,{roomState:t.roomState,inventory:t.inventory,playerHp:t.playerHp,scanLog:t.scanLog,onExitToMenu:t.handleExitToMenu,onSendMessage:t.handleSendMessage,onStartGame:t.handleStartGame,onInspectItem:t.handleInspectItem,onSwapItems:t.handleSwapItems,userEmail:t.userEmail||void 0})},"room"),t.activeTab===Y.SETTINGS&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1,exit:{opacity:0}},className:"absolute inset-0",children:e.jsx(nn,{onBack:()=>t.setActiveTab(Y.SCANNER),onLogout:t.handleLogout,soundEnabled:t.soundEnabled,vibrationEnabled:t.vibrationEnabled,onToggleSound:t.handleToggleSound,onToggleVibration:t.handleToggleVibration,userEmail:t.userEmail,isAdmin:t.isAdmin,isTestMode:t.isTestMode,onToggleTestMode:t.toggleTestMode,onHardReset:t.handleHardReset,onWipeTestVault:t.handleWipeTestVault})},"settings"),t.activeTab===Y.SPACESHIP&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1,exit:{opacity:0}},className:"absolute inset-0",children:e.jsx(rn,{playerFuel:t.playerFuel,inventory:t.inventory,onPlanetLand:i,onFuelConsume:h=>t.handleFuelChange(h),onProgressPlanet:t.handlePlanetProgress,masterCatalog:t.masterCatalog})},"spaceship")]})})})}),e.jsxs("div",{className:"h-20 bg-zinc-950 border-t-2 border-signal-cyan/40 flex items-center justify-around px-2 pb-2 relative z-50 shadow-[0_-12px_35px_rgba(0,242,255,0.25)]",children:[e.jsx(ye,{active:t.activeTab===Y.SCANNER,onClick:()=>t.setActiveTab(Y.SCANNER),icon:e.jsx(Zt,{}),label:"Sken"}),e.jsx(ye,{active:t.activeTab===Y.INVENTORY,onClick:()=>t.setActiveTab(Y.INVENTORY),icon:e.jsx(Ie,{}),label:"Batoh"}),e.jsx(ye,{active:t.activeTab===Y.SPACESHIP,onClick:()=>t.setActiveTab(Y.SPACESHIP),icon:e.jsx(Jt,{}),label:"Loď"}),t.isAdmin&&e.jsx(ye,{active:t.activeTab===Y.GENERATOR,onClick:()=>t.setActiveTab(Y.GENERATOR),icon:e.jsx(je,{}),label:"Fab"}),e.jsx(ye,{active:t.activeTab===Y.ROOM,onClick:()=>t.setActiveTab(Y.ROOM),icon:e.jsx(Ft,{}),label:"Tým"}),e.jsx(ye,{active:t.activeTab===Y.SETTINGS,onClick:()=>t.setActiveTab(Y.SETTINGS),icon:e.jsx(fa,{}),label:"Sys"})]}),e.jsx(Q,{children:t.isDocking&&e.jsx(Ya,{onComplete:t.handleDockingComplete})}),e.jsx(Q,{children:t.activeStation&&e.jsx(en,{station:t.activeStation,onLeave:t.handleLeaveStation,onClaimRewards:t.handleClaimStationRewards,inventory:t.inventory,masterCatalog:t.masterCatalog,onCraft:t.handleCraftItem,playerGold:t.playerGold,playerClass:t.playerClass,onInventoryUpdate:t.handleRefreshDatabase,isAdmin:t.isAdmin,isTestMode:t.isTestMode,onGoldChange:t.handleGoldChange})}),e.jsx(Q,{children:t.currentEvent&&!t.isDocking&&!t.activeStation&&e.jsx(Ja,{event:t.currentEvent,onClose:t.closeEvent,onSave:()=>t.handleSaveEvent(t.currentEvent,!1),onUse:()=>t.handleUseEvent(t.currentEvent),onDiscard:()=>t.handleDeleteEvent(t.currentEvent.id),onResolveDilemma:t.handleResolveDilemma,isSaved:t.inventory.some(h=>{var u;return h.id===((u=t.currentEvent)==null?void 0:u.id)})})}),e.jsx(Q,{children:t.notification&&e.jsx(Za,{data:t.notification,onClose:()=>t.setNotification(null)})}),e.jsx("style",{children:`
        .stat-glow-box {
          box-shadow: inset 0 0 10px var(--slot-color-alpha);
          border-color: var(--slot-color-border);
        }
        .animate-spin-slow {
          animation: spin 6s linear infinite;
        }
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]}):e.jsx(Ka,{onLogin:t.handleLogin}):e.jsx(Fa,{onComplete:o})},ve=({icon:t,value:s,color:m,label:a,small:x})=>e.jsxs("div",{className:`flex flex-col items-center justify-center rounded-lg border bg-black/60 transition-all stat-glow-box ${x?"py-0.5":"py-1"}`,style:{"--slot-color-alpha":`${m}15`,"--slot-color-border":`${m}40`},children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{style:{color:m},children:t}),e.jsx("span",{className:`${x?"text-xs":"text-sm"} font-black font-mono tracking-tighter text-white drop-shadow-sm`,children:s})]}),e.jsx("span",{className:"text-[6px] font-black uppercase tracking-[0.2em] opacity-50 text-white leading-none mt-0.5",children:a})]}),ye=({active:t,onClick:s,icon:m,label:a})=>e.jsxs("button",{onClick:s,className:`flex flex-col items-center gap-1 transition-all duration-300 ${t?"text-signal-cyan scale-110":"text-zinc-500"}`,children:[e.jsx("div",{className:`p-2 rounded-xl transition-colors ${t?"bg-signal-cyan/10 border border-signal-cyan/20":""}`,children:m}),e.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest",children:a})]}),as=document.getElementById("root");if(!as)throw new Error("Could not find root element to mount to");"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").then(t=>{}).catch(t=>{})});const Lt="263088388062-9dgio8dv930qsefdokl2g0uqekvrvs2c.apps.googleusercontent.com",Dt=ct.createRoot(as);Lt.length<10?Dt.render(e.jsxs("div",{className:"h-screen w-screen bg-zinc-950 flex flex-col items-center justify-center p-8 text-center text-white",children:[e.jsx("div",{className:"w-20 h-20 bg-red-900/20 rounded-full flex items-center justify-center border border-red-500/50 mb-6",children:e.jsx(pe,{className:"w-10 h-10 text-red-500"})}),e.jsx("h1",{className:"text-2xl font-black uppercase tracking-widest mb-2",children:"Chyba Konfigurace"}),e.jsxs("p",{className:"text-sm text-zinc-400 font-mono mb-6 max-w-md",children:["Aplikace postrádá ",e.jsx("strong",{children:"VITE_GOOGLE_CLIENT_ID"}),".",e.jsx("br",{}),"Vytvořte soubor ",e.jsx("code",{children:".env"})," v kořenovém adresáři a přidejte vaše Google Client ID."]}),e.jsx("div",{className:"bg-black p-4 rounded border border-zinc-800 text-xs font-mono text-zinc-500",children:"VITE_GOOGLE_CLIENT_ID=vaše-id-z-google-cloud.apps.googleusercontent.com"})]})):Dt.render(e.jsx(ga.StrictMode,{children:e.jsx(Na,{clientId:Lt,children:e.jsx(cn,{})})}));export{R as G,Ee as P,vn as a,Nn as d,S as p,H as v};
