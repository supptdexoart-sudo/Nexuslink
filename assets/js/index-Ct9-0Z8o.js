const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./InventoryView-CSmHJOXD.js","./vendor-Dgu-9KXE.js","./utils-BOwlEK-f.js","./Generator-CHmcwILc.js","./Room-DWqlth8Z.js","./SettingsView-E6z1kldW.js","./SpaceshipView-yvOXTdZc.js"])))=>i.map(i=>d[i]);
var Vs=Object.defineProperty;var Bs=(t,s,m)=>s in t?Vs(t,s,{enumerable:!0,configurable:!0,writable:!0,value:m}):t[s]=m;var Bt=(t,s,m)=>Bs(t,typeof s!="symbol"?s+"":s,m);import{a as Hs,r as n,j as e,T as _e,C as Ks,A as ce,m as C,L as Xe,K as Ct,W as Us,S as Gs,b as Fs,c as Et,P as Zs,d as It,e as qs,U as as,f as _t,g as Qe,D as At,h as gt,i as Ys,k as ns,l as rs,F as ls,n as is,o as cs,p as yt,H as Js,G as pt,q as Ws,E as Xs,s as Qs,X as Ae,I as wt,M as ea,t as ta,u as We,v as sa,w as De,x as $e,y as Ve,z as ut,B as os,J as Ge,N as bt,O as jt,Z as Fe,Q as aa,V as Re,Y as ke,_ as Ze,$ as na,a0 as ra,a1 as la,a2 as ia,a3 as ca,a4 as Be,a5 as ds,a6 as oa,a7 as ht,a8 as kt,a9 as da,aa as xs,ab as ms,ac as ps,ad as us,ae as Ot,af as xa,ag as ma,ah as pa,ai as ua,aj as St,ak as ha,al as fa,am as ga,an as hs,ao as ba,ap as Ht,aq as ja,ar as Na,as as va,at as ya,au as wa,av as ka,aw as Sa,R as za}from"./vendor-Dgu-9KXE.js";import{Html5Qrcode as Ta,Html5QrcodeSupportedFormats as lt}from"html5-qrcode";import{G as Ca,a as Ea}from"./utils-BOwlEK-f.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const i of c)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function m(c){const i={};return c.integrity&&(i.integrity=c.integrity),c.referrerPolicy&&(i.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?i.credentials="include":c.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(c){if(c.ep)return;c.ep=!0;const i=m(c);fetch(c.href,i)}})();var zt={},Kt=Hs;zt.createRoot=Kt.createRoot,zt.hydrateRoot=Kt.hydrateRoot;const Ia="modulepreload",_a=function(t,s){return new URL(t,s).href},Ut={},et=function(s,m,a){let c=Promise.resolve();if(m&&m.length>0){const r=document.getElementsByTagName("link"),d=document.querySelector("meta[property=csp-nonce]"),b=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));c=Promise.allSettled(m.map(x=>{if(x=_a(x,a),x in Ut)return;Ut[x]=!0;const g=x.endsWith(".css"),j=g?'[rel="stylesheet"]':"";if(!!a)for(let E=r.length-1;E>=0;E--){const k=r[E];if(k.href===x&&(!g||k.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${x}"]${j}`))return;const f=document.createElement("link");if(f.rel=g?"stylesheet":Ia,g||(f.as="script"),f.crossOrigin="",f.href=x,b&&f.setAttribute("nonce",b),document.head.appendChild(f),g)return new Promise((E,k)=>{f.addEventListener("load",E),f.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${x}`)))})}))}function i(r){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=r,window.dispatchEvent(d),!d.defaultPrevented)throw r}return c.then(r=>{for(const d of r||[])d.status==="rejected"&&i(d.reason);return s().catch(i)})};var H=(t=>(t.ITEM="PŘEDMĚT",t.ENCOUNTER="SETKÁNÍ",t.TRAP="NÁSTRAHA",t.MERCHANT="OBCHODNÍK",t.DILEMA="DILEMA",t.BOSS="BOSS",t.SPACE_STATION="VESMÍRNÁ_STANICE",t.PLANET="PLANETA",t))(H||{}),Ie=(t=>(t.WARRIOR="Válečník",t.MAGE="Mág",t.ROGUE="Zloděj",t.CLERIC="Kněz",t))(Ie||{});const xe="https://nexus-backend-m492.onrender.com/api",fs="nexus_admin_token",Aa="263088388062-9dgio8dv930qsefdokl2g0uqekvrvs2c.apps.googleusercontent.com",ue=async(t,s={},m=!1)=>{if(!navigator.onLine)throw new Error("OFFLINE_MODE");try{const a=sessionStorage.getItem(fs),c=localStorage.getItem("nexus_current_user"),i=new Headers(s.headers||{});a&&i.set("x-admin-key",a),c&&i.set("x-user-email",c),!i.has("Content-Type")&&!(s.body instanceof FormData)&&i.set("Content-Type","application/json");const r=await fetch(t,{...s,headers:i});if(!r.ok){const d=await r.json().catch(()=>({message:r.statusText}));throw new Error(d.message||`API Error: ${r.status}`)}return await r.json()}catch(a){throw a}},Oa=async()=>{if(!navigator.onLine)return!1;try{const t=new AbortController,s=setTimeout(()=>t.abort(),2e3),m=await fetch(`${xe}/health`,{signal:t.signal});return clearTimeout(s),m.ok}catch{return!1}},Rn=async()=>{if(!navigator.onLine)throw new Error("Nelze zálohovat v offline režimu.");const t=sessionStorage.getItem(fs),s=await fetch(`${xe}/admin/backup`,{method:"GET",headers:{"x-admin-key":t||""}});if(!s.ok)throw new Error("Chyba při stahování zálohy (Access Denied?)");const m=await s.blob(),a=window.URL.createObjectURL(m),c=document.createElement("a");c.href=a,c.download=`nexus_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(a),document.body.removeChild(c)},Mn=async t=>ue(`${xe}/admin/purge/${encodeURIComponent(t)}`,{method:"DELETE"}),Gt=async t=>ue(`${xe}/inventory/validate`,{method:"POST",body:JSON.stringify({items:t})}),Ra=async(t,s,m,a)=>ue(`${xe}/inventory/swap`,{method:"POST",body:JSON.stringify({player1Email:t,player2Email:s,item1Id:m,item2Id:a})}),Ft=async t=>{await ue(`${xe}/rooms/${t}/start-game`,{method:"POST"})},Ma=async(t,s)=>{await ue(`${xe}/rooms/${t}/acknowledge-round`,{method:"POST",body:JSON.stringify({userName:s})})},Pa=async t=>{const s=`${xe}/auth/google`;return ue(s,{method:"POST",body:JSON.stringify({credential:t,clientId:Aa})})},it=async t=>ue(`${xe}/inventory/${t}`),ft=async(t,s)=>ue(`${xe}/inventory/${t}`,{method:"POST",body:JSON.stringify(s)}),mt=async(t,s)=>ue(`${xe}/inventory/${t}/${encodeURIComponent(s)}`,{method:"DELETE"}),Zt=async()=>ue(`${xe}/inventory/zbynekbal97@gmail.com`),Tt=async(t,s)=>{try{return await ue(`${xe}/inventory/${t}/${encodeURIComponent(s)}`,void 0,!0)}catch{return null}},La=async t=>ue(`${xe}/rooms/${t}/status`),Da=async(t,s,m)=>{ue(`${xe}/rooms/${t}/status`,{method:"POST",body:JSON.stringify({userName:s,hp:m})},!0).catch(()=>{})},$a=async t=>ue(`${xe}/rooms/${t}/next-turn`,{method:"POST"}),qt=async(t,s)=>{ue(`${xe}/rooms/${t}/leave`,{method:"POST",body:JSON.stringify({userName:s})},!0).catch(()=>{})},Yt=async(t,s,m)=>ue(`${xe}/rooms/${t}/messages`,{method:"POST",body:JSON.stringify({sender:s,text:m})},!0),Va=async t=>ue(`${xe}/rooms/${t}/messages`),Ba=async(t,s,m)=>ue(`${xe}/rooms`,{method:"POST",body:JSON.stringify({roomId:t,hostName:s,password:m})}),Ha=async(t,s,m,a,c)=>ue(`${xe}/rooms/${t}/join`,{method:"POST",body:JSON.stringify({userName:s,email:c,hp:m||100,password:a})}),Jt=async(t,s)=>{await ue(`${xe}/rooms/${t}/encounter`,{method:"POST",body:JSON.stringify({encounter:s})},!0).catch(()=>{})},Ka=[{id:"ITEM-01",title:"Základní Lékárnička",description:"Stará plechová krabička s nápisem 'První pomoc'. Obsahuje čisté obvazy.",type:H.ITEM,rarity:"Common",isConsumable:!0,stats:[{label:"HP",value:"+20"}],price:15},{id:"ITEM-02",title:"Energetický Článek",description:"Standardní baterie pro Nexus zařízení. Trochu jiskří.",type:H.ITEM,rarity:"Common",isConsumable:!0,stats:[{label:"MANA",value:"+25"}],price:25},{id:"BOSS-01",title:"Strážce Brány",description:"Masivní mechanický konstrukt, který nepustí nikoho bez propustky.",type:H.BOSS,rarity:"Legendary",stats:[{label:"HP",value:"500"},{label:"ATK",value:"25"}],bossPhases:[{name:"Obranný režim",triggerType:"HP_PERCENT",triggerValue:50,description:"Strážce aktivuje štíty.",damageBonus:10}]},{id:"DILEMA-01",title:"Rezavé Dveře",description:"Stojíš před dveřmi, které vedou do neznáma. Slyšíš z nich podivné škrábání.",type:H.DILEMA,rarity:"Common",dilemmaOptions:[{label:"Vykopnout dveře",successChance:100,consequenceText:"Dveře povolí, ale hluk přilákal nepřátele!",effectType:"hp",effectValue:-10},{label:"Opatrně otevřít",successChance:100,consequenceText:"Podařilo se ti vklouznout dovnitř tiše.",effectType:"none",effectValue:0}]},{id:"TRAP-01",title:"Elektrický Oblouk",description:"Ze stěny šlehají blesky. Musíš proběhnout ve správný moment!",type:H.TRAP,rarity:"Rare",trapConfig:{difficulty:12,damage:30,disarmClass:"Zloděj",successMessage:"Proklouzl jsi bez škrábnutí!",failMessage:"Dostal jsi ránu proudem!"}},{id:"PLANET-01",title:"Nav Data: Terra Nova",description:"Souřadnice k obyvatelné planetě s bujnou vegetací. Bezpečná zóna pro obchod.",type:H.PLANET,rarity:"Rare",planetConfig:{planetId:"p1",landingEventType:H.MERCHANT}},{id:"PLANET-02",title:"Nav Data: Kepler-186f",description:"Vzdálená exoplaneta pokrytá ledem. Detekovány staré ruiny.",type:H.PLANET,rarity:"Epic",planetConfig:{planetId:"p2",landingEventType:H.DILEMA}},{id:"PLANET-03",title:"Nav Data: Mars Outpost",description:"Vojenská základna na Marsu. Vysoké riziko konfliktu.",type:H.PLANET,rarity:"Rare",planetConfig:{planetId:"p3",landingEventType:H.ENCOUNTER}},{id:"PLANET-04",title:"Nav Data: Black Nebula",description:"Nestabilní sektor plný anomálií. Pouze pro zkušené piloty.",type:H.PLANET,rarity:"Legendary",planetConfig:{planetId:"p4",landingEventType:H.BOSS}}];let Te=null,Ye=null,Ee=null,ct=null,ot=null,Rt=localStorage.getItem("nexus_sound_enabled")!=="false",Mt=localStorage.getItem("nexus_vibration_enabled")!=="false";const Ua=()=>Rt,Ga=()=>Mt,Fa=t=>{Rt=t,localStorage.setItem("nexus_sound_enabled",String(t)),t&&N("click")},Za=t=>{Mt=t,localStorage.setItem("nexus_vibration_enabled",String(t)),t&&Q(50)},qa=()=>(Te||(Te=new(window.AudioContext||window.webkitAudioContext),Ye=Te.createGain(),Ye.gain.value=.5,Ee=Te.createDynamicsCompressor(),Ee.threshold.value=-24,Ee.knee.value=30,Ee.ratio.value=12,Ee.attack.value=.003,Ee.release.value=.25,ct=Te.createDelay(1),ct.delayTime.value=.35,ot=Te.createGain(),ot.gain.value=.25,Ye.connect(Ee),Ye.connect(ct),ct.connect(ot),ot.connect(Ee),Ee.connect(Te.destination)),Te.state==="suspended"&&Te.resume(),{ctx:Te,master:Ye}),Q=t=>{Mt&&typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(t)},N=t=>{if(Rt)try{const{ctx:s,master:m}=qa();if(!s||!m)return;const a=s.currentTime,c=(i,r,d,b,x=.1,g=0)=>{const j=s.createOscillator(),u=s.createGain(),f=s.createBiquadFilter();return j.type=r,j.frequency.value=i,j.detune.value=g,f.type="lowpass",f.frequency.setValueAtTime(3e3,d),f.Q.value=1,j.connect(f),f.connect(u),u.connect(m),u.gain.setValueAtTime(0,d),u.gain.linearRampToValueAtTime(x,d+.01),u.gain.exponentialRampToValueAtTime(.001,d+b),j.start(d),j.stop(d+b),{osc:j,gain:u,filter:f}};switch(t){case"click":{const{filter:i}=c(800,"square",a,.08,.05);i.frequency.setValueAtTime(2e3,a),i.frequency.exponentialRampToValueAtTime(100,a+.08)}break;case"open":{const i=c(220,"sawtooth",a,.4,.08,-5),r=c(220,"sawtooth",a,.4,.08,5);i.filter.frequency.setValueAtTime(100,a),i.filter.frequency.exponentialRampToValueAtTime(4e3,a+.3),r.filter.frequency.setValueAtTime(100,a),r.filter.frequency.exponentialRampToValueAtTime(4e3,a+.3)}break;case"scan":[880,1108,1318,1760].forEach((r,d)=>{const b=a+d*.06,{filter:x}=c(r,"square",b,.05,.04);x.frequency.value=3e3});break;case"error":{const i=s.createOscillator(),r=s.createGain(),d=s.createBiquadFilter();i.type="sawtooth",i.frequency.setValueAtTime(110,a),i.frequency.linearRampToValueAtTime(55,a+.3),d.type="lowpass",d.frequency.setValueAtTime(800,a),d.frequency.linearRampToValueAtTime(100,a+.3),i.connect(d),d.connect(r),r.connect(m),r.gain.setValueAtTime(.3,a),r.gain.exponentialRampToValueAtTime(.001,a+.3),i.start(a),i.stop(a+.35)}break;case"success":case"gift":{[523.25,659.25,783.99,1046.5].forEach((x,g)=>{const j=a+g*.08,u=s.createOscillator(),f=s.createGain();u.type="sine",u.frequency.setValueAtTime(x,j),u.connect(f),f.connect(m),f.gain.setValueAtTime(0,j),f.gain.linearRampToValueAtTime(.2,j+.02),f.gain.exponentialRampToValueAtTime(.001,j+.6),u.start(j),u.stop(j+.6)});const r=s.createOscillator(),d=s.createGain(),b=s.createBiquadFilter();r.type="triangle",r.frequency.setValueAtTime(261.63,a),b.type="lowpass",b.frequency.value=600,r.connect(b),b.connect(d),d.connect(m),d.gain.setValueAtTime(0,a),d.gain.linearRampToValueAtTime(.25,a+.05),d.gain.exponentialRampToValueAtTime(.001,a+.8),r.start(a),r.stop(a+.8)}break;case"heal":{const i=s.createOscillator(),r=s.createGain();i.type="sine",i.frequency.setValueAtTime(440,a);const d=s.sampleRate*2,b=s.createBuffer(1,d,s.sampleRate),x=b.getChannelData(0);for(let f=0;f<d;f++)x[f]=Math.random()*2-1;const g=s.createBufferSource();g.buffer=b;const j=s.createBiquadFilter();j.type="bandpass",j.frequency.value=1e3;const u=s.createGain();i.connect(r),g.connect(j),j.connect(u),u.connect(r),r.connect(m),r.gain.setValueAtTime(0,a),r.gain.linearRampToValueAtTime(.2,a+.8),r.gain.linearRampToValueAtTime(0,a+2),u.gain.value=.1,i.start(a),g.start(a),i.stop(a+2),g.stop(a+2)}break;case"damage":{const i=s.sampleRate,r=s.createBuffer(1,i,s.sampleRate),d=r.getChannelData(0);for(let j=0;j<i;j++)d[j]=Math.random()*2-1;const b=s.createBufferSource();b.buffer=r;const x=s.createBiquadFilter();x.type="lowpass",x.frequency.setValueAtTime(1e3,a),x.frequency.exponentialRampToValueAtTime(50,a+.4);const g=s.createGain();g.gain.setValueAtTime(.8,a),g.gain.exponentialRampToValueAtTime(.001,a+.4),b.connect(x),x.connect(g),g.connect(m),b.start(a),b.stop(a+.4),c(60,"square",a,.3,.3)}break;case"message":c(1200,"sine",a,.1,.05),c(1800,"sine",a+.1,.1,.05);break;case"siren":{const i=s.createOscillator(),r=s.createGain(),d=s.createBiquadFilter();i.type="sawtooth",i.frequency.value=150,i.detune.value=10,d.type="lowpass",d.Q.value=15;const b=s.createOscillator();b.type="sine",b.frequency.value=2;const x=s.createGain();x.gain.value=600,b.connect(x),x.connect(d.frequency),d.frequency.value=800,i.connect(d),d.connect(r),r.connect(m),r.gain.setValueAtTime(0,a),r.gain.linearRampToValueAtTime(.3,a+.5),r.gain.linearRampToValueAtTime(0,a+2.5),i.start(a),b.start(a),i.stop(a+2.5),b.stop(a+2.5)}break;case"crit":c(1500,"triangle",a,.3,.2).osc.frequency.exponentialRampToValueAtTime(3e3,a+.1),c(2e3,"sine",a+.05,.4,.2);break;case"miss":{const i=c(400,"sawtooth",a,.3,.1);i.filter.frequency.setValueAtTime(800,a),i.filter.frequency.exponentialRampToValueAtTime(100,a+.2),i.osc.frequency.linearRampToValueAtTime(100,a+.2)}break}}catch{}},Je="zbynekbal97@gmail.com",dt="admin_test_vault@nexus.local",Wt=100,Xt=100,Qt=100,Ya=100;var pe=(t=>(t.SCANNER="scanner",t.INVENTORY="inventory",t.GENERATOR="generator",t.ROOM="room",t.SETTINGS="settings",t.SPACESHIP="spaceship",t))(pe||{});const Ja=()=>{const t=new Date().getHours();return t>=20||t<6},xt=(t,s,m)=>{var c;let a={...t};if(s&&((c=t.timeVariant)!=null&&c.enabled)&&(a={...a,title:t.timeVariant.nightTitle||a.title,description:t.timeVariant.nightDescription||a.description,type:t.timeVariant.nightType||a.type,stats:t.timeVariant.nightStats||a.stats}),m&&t.classVariants&&t.classVariants[m]){const i=t.classVariants[m];a={...a,title:i.overrideTitle||a.title,description:i.overrideDescription||a.description,type:i.overrideType||a.type,stats:i.bonusStats?[...a.stats||[],...i.bonusStats]:a.stats}}return a},Wa=()=>{const[t,s]=n.useState(()=>localStorage.getItem("nexus_current_user")),m=t===Je,a=t==="guest",[c,i]=n.useState(()=>localStorage.getItem("nexus_admin_test_mode")==="true"),r=m&&c?dt:t,[d,b]=n.useState(!1),x=Ja(),[g,j]=n.useState(null),[u,f]=n.useState(Ua()),[E,k]=n.useState(Ga()),[X,w]=n.useState(()=>t===Je?"generator":"scanner"),[A,T]=n.useState(()=>{const l=localStorage.getItem("nexus_master_catalog");return l?JSON.parse(l):Ka}),[D,Z]=n.useState(null),[le,ee]=n.useState(null),[L,p]=n.useState(null),[o,O]=n.useState(null),[,J]=n.useState(null),[re,$]=n.useState(null),[ne,te]=n.useState(!1),[y,K]=n.useState(!1),[I,z]=n.useState(()=>{const l=localStorage.getItem(`nexus_inv_${r||"guest"}`);return l?JSON.parse(l):[]});n.useEffect(()=>{if(r){const l=localStorage.getItem(`nexus_inv_${r}`);z(l?JSON.parse(l):[]),a||it(r).then(async h=>{if(h.length>0)try{const S=h.map(P=>({id:P.id,title:P.title})),{validIds:_}=await Gt(S);if(_){const P=A.map(ie=>ie.id),ae=h.filter(ie=>{const F=ie.id.split("__")[0];return _.includes(ie.id)||P.includes(F)});z(ae),localStorage.setItem(`nexus_inv_${r}`,JSON.stringify(ae))}}catch{z(h),localStorage.setItem(`nexus_inv_${r}`,JSON.stringify(h))}else z([]),localStorage.setItem(`nexus_inv_${r}`,JSON.stringify([]))}).catch(h=>{})}},[r,a]);const[q,Y]=n.useState([]),[me,he]=n.useState(!1),[fe,U]=n.useState(null),[Oe,Me]=n.useState(!1),[Pe]=n.useState(!1),[Le,M]=n.useState(!1),[V,W]=n.useState(()=>parseInt(localStorage.getItem("nexus_player_hp")||String(Wt))),[oe,Ce]=n.useState(()=>parseInt(localStorage.getItem("nexus_player_mana")||String(Xt))),[v,B]=n.useState(()=>parseInt(localStorage.getItem("nexus_player_fuel")||String(Qt))),[G,se]=n.useState(()=>parseInt(localStorage.getItem("nexus_player_gold")||String(Ya))),[de,je]=n.useState(()=>parseInt(localStorage.getItem("nexus_player_armor")||"0")),[be,ve]=n.useState(()=>parseInt(localStorage.getItem("nexus_player_oxygen")||"100")),[ye,Pt]=n.useState(()=>{const l=localStorage.getItem(`nexus_class_${t||"guest"}`);return l||null}),[R,Se]=n.useState({id:localStorage.getItem("nexus_last_room_id")||"",isInRoom:localStorage.getItem("nexus_is_in_room")==="true",messages:[],nickname:localStorage.getItem(`nexus_nickname_${t}`)||"",isNicknameSet:!!localStorage.getItem(`nexus_nickname_${t}`),members:[],turnIndex:0,isGameStarted:!1,roundNumber:0,turnOrder:[],readyForNextRound:[],host:""}),[ge,tt]=n.useState(()=>localStorage.getItem("nexus_solo_mode")==="true"),[ws,ks]=n.useState(null),Ss=n.useRef([]),Lt=!ge&&R.isGameStarted&&R.turnOrder[R.turnIndex]===R.nickname,Dt=!m&&!ge&&(!R.isGameStarted||!Lt);n.useEffect(()=>{localStorage.setItem("nexus_player_armor",String(de))},[de]),n.useEffect(()=>{localStorage.setItem("nexus_player_oxygen",String(be))},[be]);const zs=()=>{if(!m)return;const l=!c;i(l),localStorage.setItem("nexus_admin_test_mode",String(l)),N("open"),U({id:"mode-"+Date.now(),type:"info",message:l?"AKTIVOVÁN TESTOVACÍ BATOH":"AKTIVOVÁNA MASTER DATABÁZE"})},ze=l=>{Y(h=>[l,...h].slice(0,50))},He=l=>{W(h=>{const S=Math.max(0,Math.min(Wt,h+l));return localStorage.setItem("nexus_player_hp",String(S)),S}),l<0?($("red"),N("damage"),Q([200]),setTimeout(()=>$(null),500)):l>0&&($("green"),N("heal"),setTimeout(()=>$(null),500))},Nt=l=>{Ce(h=>{const S=Math.max(0,Math.min(Xt,h+l));return localStorage.setItem("nexus_player_mana",String(S)),S})},st=l=>{B(h=>{const S=Number(h)||0,_=Number(l)||0,P=Math.max(0,Math.min(Qt,S+_));return localStorage.setItem("nexus_player_fuel",String(P)),P}),l<0&&($("amber"),N("error"),Q([50,100,50]),U({id:"fuel-"+Date.now(),type:"error",message:`VAROVÁNÍ: Spotřeba Paliva ${l}%`}),setTimeout(()=>$(null),800))},qe=l=>{se(h=>{const S=Math.max(0,h+l);return localStorage.setItem("nexus_player_gold",String(S)),S})},$t=async(l,h=!1)=>{var S;try{const _={...l};if(!h&&!((S=_.resourceConfig)!=null&&S.isResourceContainer)){const P=_.id.split("__")[0],ae=`${Date.now()}_${Math.random().toString(36).substring(2,6)}`;_.id=`${P}__${ae}`}if(a||!t)z(P=>{var ie;if((ie=_.resourceConfig)!=null&&ie.isResourceContainer){const F=P.findIndex(Ne=>Ne.id===_.id);if(F>=0){const Ne=[...P];return Ne[F]=_,localStorage.setItem("nexus_inv_guest",JSON.stringify(Ne)),Ne}}const ae=[...P,_];return localStorage.setItem("nexus_inv_guest",JSON.stringify(ae)),ae}),ze(`Archivováno (Local): ${_.title}`),U({id:"save-local-"+Date.now(),message:"Asset uložen lokálně.",type:"success"});else{const P=h?Je:r;if(!P)throw new Error("No target email");const ae=await ft(P,_),ie={...ae,..._,id:ae.id};P===r&&z(F=>{const Ne=F.findIndex(we=>we.id===ie.id);if(Ne>=0){const we=[...F];return we[Ne]=ie,localStorage.setItem(`nexus_inv_${r}`,JSON.stringify(we)),we}else{const we=[...F,ie];return localStorage.setItem(`nexus_inv_${r}`,JSON.stringify(we)),we}}),h&&m?(T(F=>{const we=F.find(rt=>rt.id===ie.id)?F.map(rt=>rt.id===ie.id?ie:rt):[...F,ie];return localStorage.setItem("nexus_master_catalog",JSON.stringify(we)),we}),ze(`DB UPDATE: ${_.title}`),U({id:"db-save-"+Date.now(),message:"Zapsáno do Master Databáze.",type:"success"})):(ze(`Archivováno: ${_.title}`),U({id:"save-"+Date.now(),message:"Asset uložen do Batohu.",type:"success"}))}}catch{U({id:"err-"+Date.now(),message:"Chyba ukládání.",type:"error"})}},Ts=async l=>{const h=I.find(S=>S.id===l);if(h){const S={...h,planetProgress:(h.planetProgress||0)+1};if(z(_=>_.map(P=>P.id===l?S:P)),a||!r)localStorage.setItem("nexus_inv_guest",JSON.stringify(I.map(_=>_.id===l?S:_)));else try{await ft(r,S),localStorage.setItem(`nexus_inv_${r}`,JSON.stringify(I.map(_=>_.id===l?S:_)))}catch{}}},Cs=async(l,h,S,_)=>{if(!(a||!r)){te(!0);try{await Ra(l,h,S,_);const P=await it(r);z(P),localStorage.setItem(`nexus_inv_${r}`,JSON.stringify(P)),await Yt(R.id,"SYSTEM","BURZA_SUCCESS: Výměna assetů byla dokončena."),U({id:"swap-ok",type:"success",message:"Výměna assetů byla úspěšná!"}),N("success")}catch(P){U({id:"swap-err",type:"error",message:P.message||"Chyba při výměně dat."})}finally{te(!1)}}},at=async l=>{try{const h=I.find(S=>S.id===l);!a&&r&&await mt(r,l),z(S=>{const _=S.filter(P=>P.id!==l);return localStorage.setItem(`nexus_inv_${r||"guest"}`,JSON.stringify(_)),_}),h&&ze(`Zahozeno z Batohu: ${h.title}`),U({id:"del-"+Date.now(),message:"Asset odstraněn.",type:"success"})}catch{U({id:"err-"+Date.now(),message:"Chyba při mazání.",type:"error"})}},Es=async l=>{var h;(h=l.craftingRecipe)!=null&&h.requiredResources},Vt=async()=>{he(!0),N("scan");try{let l=[],h=[];if(a?(l=[...I],h=await Zt()):r&&(l=await it(r),h=await Zt()),l.length>0)try{const _=l.map(ae=>({id:ae.id,title:ae.title})),{validIds:P}=await Gt(_);if(P){const ae=A.map(F=>F.id),ie=l.filter(F=>{const Ne=F.id.split("__")[0];return!P.includes(F.id)&&!ae.includes(Ne)});l=l.filter(F=>{const Ne=F.id.split("__")[0];return P.includes(F.id)||ae.includes(Ne)}),ie.length>0&&!a&&r&&Promise.all(ie.map(F=>mt(r,F.id))).then(()=>{}).catch(F=>{})}}catch{}const S=a?"nexus_inv_guest":`nexus_inv_${r}`;localStorage.removeItem(S),localStorage.removeItem("nexus_master_catalog"),localStorage.setItem(S,JSON.stringify(l)),localStorage.setItem("nexus_master_catalog",JSON.stringify(h)),z(l),T(h),U({id:"sync-ok-"+Date.now(),message:"Kompletní synchronizace dat.",type:"success"}),N("success")}catch{U({id:"sync-err-"+Date.now(),message:"Chyba synchronizace.",type:"error"}),N("error")}finally{he(!1)}},Is=async()=>{if(!(!c||!m)&&confirm("VAROVÁNÍ: Opravdu chcete smazat CELÝ inventář v Testovacím Režimu? Tato akce je nevratná.")){he(!0),N("error");try{const l=await it(dt);await Promise.all(l.map(h=>mt(dt,h.id))),z([]),localStorage.setItem(`nexus_inv_${dt}`,JSON.stringify([])),U({id:"wipe-ok",message:"Testovací batoh byl kompletně vymazán.",type:"success"}),N("success")}catch{U({id:"wipe-err",message:"Chyba při mazání testovacích dat.",type:"error"})}finally{he(!1)}}},_s=async()=>{if(a){if(!confirm("VAROVÁNÍ: Jste v režimu Host. Vynucená synchronizace SMAŽE všechna lokální data a nenávratně ztratíte inventář. Pokračovat?"))return;z([]),localStorage.removeItem("nexus_inv_guest"),localStorage.removeItem("nexus_master_catalog"),U({id:"hard-reset",message:"Lokální data smazána.",type:"info"}),window.location.reload();return}await Vt()},As=async(l,h,S,_)=>{if(localStorage.setItem(`nexus_nickname_${t}`,l),localStorage.setItem(`nexus_class_${t||"guest"}`,h),Pt(h),S==="solo"){tt(!0),localStorage.setItem("nexus_solo_mode","true"),localStorage.setItem("nexus_is_in_room","false"),Se(P=>({...P,nickname:l,isNicknameSet:!0,isInRoom:!1,id:""})),ze(`Systém aktivován. Batoh připraven, ${l}.`);return}try{let P=S;S==="create"||S==="solo-online"?(P=(S==="solo-online"?"SOLO-":"")+Math.random().toString(36).substring(2,7).toUpperCase(),await Ba(P,l,_),Se(ae=>({...ae,id:P,nickname:l,isNicknameSet:!0,isInRoom:!0,host:l})),S==="solo-online"&&ze(`Online mise zahájena v sektoru ${P}.`)):(await Ha(P,l,V,_,t||void 0),Se(ae=>({...ae,id:P,nickname:l,isNicknameSet:!0,isInRoom:!0}))),localStorage.setItem("nexus_last_room_id",P),localStorage.setItem("nexus_is_in_room","true"),tt(S==="solo-online"),localStorage.setItem("nexus_solo_mode",S==="solo-online"?"true":"false"),S==="solo-online"&&setTimeout(async()=>{try{await Ft(P)}catch{}},1e3)}catch(P){throw U({id:"room-err",type:"error",message:P.message}),P}},Os=async()=>{R.id&&R.nickname&&await qt(R.id,R.nickname),Se(l=>({...l,isInRoom:!1,id:""})),localStorage.removeItem("nexus_last_room_id"),localStorage.removeItem("nexus_is_in_room"),tt(!0),localStorage.setItem("nexus_solo_mode","true"),Y([])},Rs=async()=>{if(R.id&&R.nickname)try{await qt(R.id,R.nickname)}catch{}Se(l=>({...l,isInRoom:!1,id:"",isNicknameSet:!1})),localStorage.removeItem("nexus_last_room_id"),localStorage.removeItem("nexus_is_in_room"),tt(!1),localStorage.setItem("nexus_solo_mode","false"),Y([])},Ms=async l=>{if(!(!R.id||!R.nickname))try{await Yt(R.id,R.nickname,l)}catch{}},Ps=async l=>{te(!0);try{let h=A.find(S=>S.id===l);h||(h=await Tt(Je,l)),h?(J("inspect"),Z(xt(h,x,ye)),ze(`Inspekce: ${h.title}`)):U({id:"inspect-err",type:"error",message:"Data assetu nelze dekódovat."})}catch{U({id:"inspect-err",type:"error",message:"Chyba spojení s Batohem."})}finally{te(!1)}};n.useEffect(()=>{if(!R.isInRoom||!R.id||!d)return;const l=setInterval(async()=>{try{const h=await La(R.id),S=await Va(R.id);if(Ss.current=h.members,Se(_=>({..._,members:h.members,turnIndex:h.turnIndex,messages:S,isGameStarted:h.isGameStarted,roundNumber:h.roundNumber,turnOrder:h.turnOrder,readyForNextRound:h.readyForNextRound,host:h.host})),h.activeEncounter){if(!D||D.id!==h.activeEncounter.id){const _=xt(h.activeEncounter,x,ye);Z(_),J("scanner"),N("error"),Q([200,100,200])}}else D&&D.dilemmaScope==="GLOBAL"&&(Z(null),J(null));await Da(R.id,R.nickname,V)}catch{}},2e3);return()=>clearInterval(l)},[R.isInRoom,R.id,R.nickname,V,a,d]);const Ls=async()=>{if(R.host===R.nickname&&!(R.members.length<1))try{await Ft(R.id),N("success")}catch{U({id:"err",type:"error",message:"Nepodařilo se spustit misi."})}},Ds=async l=>{if(Dt&&!l.startsWith("friend:")){const _=R.isGameStarted?"NEMŮŽEŠ SKENOVAT: Nejseš na tahu!":"MISE NEZAČALA: Čekejte na hostitele.";U({id:"block",type:"error",message:_}),Q([100,50,100]),N("error");return}if(v<=0&&!l.startsWith("friend:")){U({id:"no-fuel",type:"error",message:"NEDOSTATEK PALIVA: Loď nemůže manévrovat (skenovat)."}),N("error"),Q([200,200,200]);return}te(!0),Q(50),N("scan");const h=I.find(_=>_.id.split("__")[0].toLowerCase()===l.toLowerCase()||_.id.toLowerCase()===l.toLowerCase());if(h){vt(h,"scanner");return}const S=A.find(_=>_.id.toLowerCase()===l.toLowerCase());if(S){vt(S,"scanner");return}if(navigator.onLine)try{const _=await Tt(Je,l);if(_){vt(_,"scanner");return}}catch{}te(!1),U({id:"not-found-"+Date.now(),type:"error",message:"ID karty nenalezeno."}),N("error")},vt=(l,h=null)=>{h==="scanner"&&(st(-5),ze("Manévr lodi: -5% Paliva"));const S=xt(l,x,ye);if(S.type===H.SPACE_STATION&&h==="scanner"){te(!1),K(!0),Z(S),J(h);return}Z(S),h&&J(h),S.type===H.DILEMA&&S.dilemmaScope==="GLOBAL"&&R.isInRoom&&Jt(R.id,l),ze(h==="scanner"?`Skenováno: ${S.title}`:`Zobrazeno: ${S.title}`),te(!1)},$s=()=>{K(!1),D&&D.type===H.SPACE_STATION&&(ee(D),Z(null),ze(`Dokováno: ${D.title}`),N("success"))},nt=()=>{(D==null?void 0:D.dilemmaScope)==="GLOBAL"&&R.isInRoom&&Jt(R.id,null),Z(null),J(null)};return{userEmail:t,isAdmin:m,isGuest:a,isServerReady:d,setIsServerReady:b,isNight:x,adminNightOverride:g,setAdminNightOverride:j,activeTab:X,setActiveTab:w,currentEvent:D,setCurrentEvent:Z,editingEvent:o,setEditingEvent:O,screenFlash:re,inventory:I,isRefreshing:me,notification:fe,setNotification:U,showEndTurnPrompt:Oe,playerHp:V,playerMana:oe,playerFuel:v,playerGold:G,playerArmor:de,playerOxygen:be,playerClass:ye,setPlayerArmor:je,setPlayerOxygen:ve,roomState:R,isSoloMode:ge,giftTarget:ws,setGiftTarget:ks,isScannerPaused:!!D||Pe||Le||y||!!le||!!L,isAIThinking:ne,showTurnAlert:Pe,showRoundEndAlert:Le,handleAcknowledgeRound:async()=>{if(R.id&&R.nickname)try{await Ma(R.id,R.nickname),M(!1)}catch{}},isMyTurn:Lt,isBlocked:Dt,handleStartGame:Ls,isDocking:y,handleDockingComplete:$s,activeStation:le,handleLeaveStation:()=>{ee(null),N("open")},handleClaimStationRewards:l=>{l.stationConfig&&(l.stationConfig.fuelReward&&st(l.stationConfig.fuelReward),l.stationConfig.repairAmount&&He(l.stationConfig.repairAmount),l.stationConfig.refillO2&&ve(100),N("success"),U({id:"station-reward",type:"success",message:"Servis dokončen."}))},activeMerchant:L,setActiveMerchant:p,handleBuyItem:async l=>{qe(-(l.price||0)),await $t(l,!1),N("success"),U({id:"buy-success",type:"success",message:`Zakoupeno: ${l.title}`})},handleSellItem:async(l,h)=>{qe(h),await at(l.id),N("success"),U({id:"sell-success",type:"success",message:`Prodáno: ${l.title} (+${h} G)`})},masterCatalog:A,handleLogin:(l,h)=>{localStorage.setItem("nexus_current_user",l),h&&(localStorage.setItem(`nexus_nickname_${l}`,h),Se(S=>({...S,nickname:h}))),s(l),b(!1)},handleLogout:()=>{localStorage.clear(),sessionStorage.clear(),window.location.reload()},handleScanCode:Ds,handleSaveEvent:$t,handlePlanetProgress:Ts,handleDeleteEvent:at,handleUseEvent:async l=>{if(l.isSellOnly){U({id:"sell-only",message:"Tento předmět nelze použít, pouze prodat.",type:"error"});return}if(l.type===H.MERCHANT){p(l),nt(),N("open");return}let h=!1;l.stats&&l.stats.length>0&&l.stats.forEach(S=>{const P=String(S.value).replace(/[^0-9-]/g,""),ae=parseInt(P),ie=String(S.label).toUpperCase().trim();!isNaN(ae)&&ae!==0&&(["HP","ZDRAVÍ","HEAL"].some(F=>ie.includes(F))?(He(ae),h=!0):["MANA","ENERGIE"].some(F=>ie.includes(F))?(Nt(ae),h=!0):["PALIVO","FUEL"].some(F=>ie.includes(F))?(st(ae),h=!0):["GOLD","ZLATO"].some(F=>ie.includes(F))?(qe(ae),h=!0):["O2","KYSLÍK"].some(F=>ie.includes(F))?(ve(F=>Math.min(100,Math.max(0,F+ae))),h=!0):["ARMOR","BRNĚNÍ"].some(F=>ie.includes(F))&&(je(F=>Math.max(0,F+ae)),h=!0))}),h?(N("heal"),U({id:"use-success-"+Date.now(),message:"Předmět použit.",type:"success"}),l.isConsumable?await at(l.id):nt()):l.isConsumable?(await at(l.id),U({id:"consumed",message:"Předmět spotřebován.",type:"info"}),nt()):(U({id:"no-effect",message:"Tento předmět nemá žádný okamžitý efekt.",type:"info"}),Q(50))},handleRefreshDatabase:Vt,handleGameSetup:As,handleLeaveRoom:Os,handleExitToMenu:Rs,handleResolveDilemma:(l,h)=>{var S;h==="success"?((S=l.rewards)==null||S.forEach(_=>{_.type==="HP"&&He(_.value),_.type==="MANA"&&Nt(_.value),_.type==="GOLD"&&qe(_.value)}),l.effectType==="hp"&&He(l.effectValue||0)):l.failDamage&&He(-l.failDamage)},handleEndTurn:async()=>{if(R.id)try{await $a(R.id),Me(!1)}catch{}},handleSendMessage:Ms,closeEvent:nt,handleHpChange:He,handleManaChange:Nt,handleGoldChange:qe,handleFuelChange:st,handleOpenInventoryItem:l=>{m&&!c?(O(l),w("generator")):(J("inventory"),Z(l))},getAdjustedItem:xt,handleSwapItems:Cs,soundEnabled:u,vibrationEnabled:E,handleToggleSound:()=>{Fa(!u),f(!u)},handleToggleVibration:()=>{Za(!E),k(!E)},handleInspectItem:Ps,handleCraftItem:Es,handleHardReset:_s,handleWipeTestVault:Is,scanLog:q,isTestMode:c,toggleTestMode:zs}},Xa=({onScanCode:t,isAIThinking:s,isPaused:m})=>{const[a,c]=n.useState("idle"),[i,r]=n.useState(""),[d,b]=n.useState(!1),[x,g]=n.useState(""),j=n.useRef(null),u=n.useRef(!1);n.useEffect(()=>(j.current=new Ta("qr-reader",{verbose:!1}),()=>{E()}),[]),n.useEffect(()=>{(m||s)&&u.current&&E()},[m,s]);const f=async()=>{if(!(!j.current||u.current))try{c("active"),u.current=!0,await j.current.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250},aspectRatio:1,formatsToSupport:[lt.QR_CODE,lt.EAN_13,lt.CODE_128,lt.CODE_39]},k=>{m||s||(t(k),Q(50))},()=>{})}catch(k){c("error"),r(k.message||"Přístup ke kameře zamítnut."),u.current=!1}},E=async()=>{if(j.current&&u.current)try{await j.current.stop(),j.current.clear()}catch{}finally{u.current=!1,c("idle")}};return e.jsxs("div",{className:"relative h-full w-full bg-black flex flex-col items-center justify-center p-6",children:[e.jsx("div",{className:"absolute top-10 left-0 right-0 z-20 flex justify-center pointer-events-none",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur px-4 py-2 border border-white/10 rounded-full flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${a==="active"?"bg-green-500 animate-pulse":"bg-red-500"}`}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-white/70",children:s?"AI_DEKÓDOVÁN...":a==="active"?"OPTIKA_AKTIVNÍ":"SENZOR_OFFLINE"})]})}),e.jsxs("div",{className:"relative w-full aspect-square max-w-sm",children:[e.jsx("div",{className:"absolute -inset-2 border-2 border-signal-cyan/20 rounded-3xl pointer-events-none z-10"}),e.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-signal-cyan rounded-tl-xl z-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-signal-cyan rounded-tr-xl z-10"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-signal-cyan rounded-bl-xl z-10"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-signal-cyan rounded-br-xl z-10"}),e.jsxs("div",{className:"w-full h-full bg-zinc-900 rounded-2xl overflow-hidden relative shadow-2xl",children:[e.jsx("div",{id:"qr-reader",className:"w-full h-full object-cover"}),a!=="active"&&e.jsxs("div",{className:"absolute inset-0 z-20 flex flex-col items-center justify-center p-10 text-center gap-6 bg-zinc-900",children:[a==="error"?e.jsx(_e,{className:"w-12 h-12 text-red-500"}):e.jsx(Ks,{className:"w-12 h-12 text-white/20"}),e.jsx("p",{className:"text-xs text-white/40 uppercase font-bold tracking-widest leading-relaxed",children:a==="error"?i:"Kamera v pohotovostním režimu"}),e.jsxs("button",{onClick:f,className:"button-primary py-3 px-8 text-xs relative overflow-hidden group",children:[e.jsx("span",{className:"relative z-10",children:a==="error"?"Zkusit znovu":"Aktivovat Senzor"}),e.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform"})]})]}),e.jsx(ce,{children:s&&e.jsxs(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-30 bg-signal-cyan/20 backdrop-blur-sm flex flex-col items-center justify-center gap-4",children:[e.jsx(Xe,{className:"w-12 h-12 text-white animate-spin"}),e.jsx("span",{className:"text-xs font-black text-white uppercase tracking-[0.3em]",children:"Analyzuji_Data..."})]})})]})]}),e.jsxs("button",{onClick:()=>b(!0),className:"mt-12 flex items-center gap-3 text-white/40 hover:text-white transition-colors text-xs font-bold uppercase tracking-widest active:scale-95",children:[e.jsx(Ct,{className:"w-5 h-5"})," Manuální Identifikace"]}),e.jsx(ce,{children:d&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-xl flex items-center justify-center p-8",children:e.jsxs("div",{className:"w-full max-w-xs space-y-6",children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase text-center tracking-widest",children:"Zadejte_ID"}),e.jsx("input",{type:"text",autoFocus:!0,value:x,onChange:k=>g(k.target.value),placeholder:"NAPŘ. ITEM-01",className:"w-full bg-white/5 border border-white/10 p-4 text-white text-center text-xl font-mono uppercase rounded-xl outline-none focus:border-signal-cyan placeholder-white/20"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>b(!1),className:"flex-1 py-4 text-xs font-bold text-white/40 uppercase hover:text-white transition-colors",children:"Zrušit"}),e.jsx("button",{onClick:()=>{t(x),b(!1)},className:"flex-1 button-primary py-4 text-xs shadow-lg shadow-signal-amber/20",children:"Potvrdit"})]})]})})}),e.jsx("style",{children:`
        #qr-reader video { 
            object-fit: cover; 
            width: 100%; 
            height: 100%; 
            border-radius: 1rem;
        }
      `})]})},es=["Inicializace protokolu...","Hledání signálu Nexus...","Propojování.##.%./*_#..","Ověřování integrity dat...","Navazování zabezpečeného spojení..."],Qa=({onConnected:t,onSwitchToOffline:s})=>{const[m,a]=n.useState(0),[c,i]=n.useState(1),[r,d]=n.useState(!1),[b,x]=n.useState(!navigator.onLine);return n.useEffect(()=>{const g=()=>x(!navigator.onLine);window.addEventListener("online",g),window.addEventListener("offline",g);const j=setInterval(()=>{a(u=>(u+1)%es.length)},3e3);return()=>{window.removeEventListener("online",g),window.removeEventListener("offline",g),clearInterval(j)}},[]),n.useEffect(()=>{let g=!0,j;const u=async()=>{if(g){if(!navigator.onLine){d(!0);return}try{if(await Oa()&&g){t();return}}catch{}g&&(i(f=>f+1),c>3&&d(!0),j=setTimeout(u,2500))}};return u(),()=>{g=!1,clearTimeout(j)}},[t,c]),e.jsxs("div",{className:"fixed inset-0 z-[200] bg-zinc-950 flex flex-col items-center justify-center p-6 text-white font-sans overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 z-0 opacity-10 pointer-events-none",style:{backgroundImage:"radial-gradient(#222 1px, transparent 1px)",backgroundSize:"20px 20px"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center max-w-sm w-full",children:[e.jsxs("div",{className:"relative mb-12",children:[e.jsx(C.div,{animate:{scale:[1,2.5],opacity:[.5,0]},transition:{duration:2,repeat:1/0,ease:"easeOut"},className:`absolute inset-0 ${b?"bg-amber-500/20":"bg-neon-blue/20"} rounded-full blur-md`}),e.jsxs("div",{className:`relative w-24 h-24 bg-zinc-900 rounded-2xl border ${b?"border-amber-500/50":"border-zinc-700"} flex items-center justify-center shadow-[0_0_30px_rgba(0,243,255,0.2)]`,children:[b?e.jsx(Us,{className:"w-10 h-10 text-amber-500"}):e.jsx(Gs,{className:"w-10 h-10 text-neon-blue"}),e.jsx("div",{className:"absolute -top-1 -right-1",children:e.jsxs("span",{className:"relative flex h-3 w-3",children:[e.jsx("span",{className:`animate-ping absolute inline-flex h-full w-full rounded-full ${b?"bg-amber-500":"bg-green-500"} opacity-75`}),e.jsx("span",{className:`relative inline-flex rounded-full h-3 w-3 ${b?"bg-amber-500":"bg-green-500"}`})]})})]})]}),e.jsx("div",{className:"w-full h-1 bg-zinc-900 rounded-full overflow-hidden mb-6 relative",children:e.jsx(C.div,{animate:{x:["-100%","100%"]},transition:{duration:1.5,repeat:1/0,ease:"linear"},className:`absolute inset-y-0 left-0 w-1/2 bg-gradient-to-r from-transparent ${b?"via-amber-500":"via-neon-blue"} to-transparent`})}),e.jsx("h2",{className:"text-xl font-display font-bold uppercase tracking-widest mb-2 text-center",children:b?"OFFLINE_REŽIM":"PŘIPOJOVÁNÍ"}),e.jsx(C.p,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"text-xs text-zinc-500 font-mono uppercase tracking-wider text-center h-4",children:b?"Lokální protokoly aktivní":es[m]},m),e.jsxs("div",{className:"mt-8 flex gap-4 text-[10px] text-zinc-600 font-mono uppercase",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Fs,{className:`w-3 h-3 ${b?"":"animate-spin"}`}),e.jsx("span",{children:b?"Senzory vypnuty":`Pokus #${c}`})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Et,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{children:"Local_Vault OK"})]})]}),r&&e.jsxs(C.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},onClick:s,className:"mt-12 py-4 px-8 bg-amber-500/10 border border-amber-500/40 hover:bg-amber-500/20 rounded-xl flex items-center gap-3 text-xs font-black uppercase tracking-widest text-amber-500 hover:text-white transition-all shadow-[0_0_20px_rgba(245,158,11,0.1)]",children:[e.jsx(Zs,{className:"w-5 h-5"}),"Aktivovat Offline Nasazení"]})]})]})},en=({onLogin:t})=>{const[s,m]=n.useState(""),[a,c]=n.useState(!1),[i,r]=n.useState(!1),[d,b]=n.useState(null),x=u=>{if(u.preventDefault(),s.trim().length<3){b("Identifikátor (Nick) musí mít alespoň 3 znaky."),Q(100),N("error");return}b(null),r(!0)},g=()=>{r(!1),N("click"),localStorage.setItem("nexus_nickname_guest",s.toUpperCase()),c(!0),setTimeout(()=>{t("guest",s.toUpperCase())},1500)},j=async u=>{if(u.credential){c(!0),b(null),N("click");try{const f=await Pa(u.credential);Q([50,50]),t(f.email)}catch(f){c(!1);let E="Chyba Google ověření.";f.message&&f.message.includes("Failed to fetch")?E="Nelze se spojit se serverem (Backend spí nebo blokován).":f.message&&(E=`Server Error: ${f.message}`),b(E),N("error")}}};return a?e.jsx(Qa,{onConnected:()=>{},onSwitchToOffline:()=>{c(!1),b("Odkaz přerušen.")}}):e.jsxs("div",{className:"h-screen w-screen bg-[#0a0b0d] flex flex-col items-center justify-center p-8 relative overflow-hidden font-sans",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-5 z-0",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"30px 30px"}}),e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-10",children:e.jsxs("div",{className:"flex justify-between w-full p-8 font-mono text-[10px] text-signal-cyan",children:[e.jsx("span",{children:"SIGNÁL: VYHLEDÁVÁNÍ..."}),e.jsx("span",{children:"POZ: HLAVNÍ_BRÁNA"})]})}),e.jsxs(C.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},className:"w-full max-w-sm z-10",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"relative inline-block mb-8",children:e.jsxs("div",{className:"w-24 h-24 tactical-card flex items-center justify-center border-signal-cyan/40 bg-black/40",children:[e.jsx("div",{className:"corner-accent top-left !border-2"}),e.jsx("div",{className:"corner-accent bottom-right !border-2"}),e.jsx(It,{className:"w-12 h-12 text-signal-cyan"})]})}),e.jsx("h1",{className:"text-5xl font-black text-white tracking-tighter uppercase mb-2 chromatic-text",children:"Nexus_Auth"}),e.jsx("p",{className:"text-signal-cyan font-mono text-[10px] uppercase tracking-[0.5em] font-black",children:"Hybridní desková hra"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 justify-center",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-green-500",children:"Doporučeno: Cloud Save (Všechna zařízení)"})]}),e.jsx("div",{className:"flex flex-col justify-center gap-2",children:e.jsx(Ca,{onSuccess:j,onError:()=>b("Google Login selhal na úrovni klienta."),theme:"filled_black",shape:"pill",size:"large",text:"signin_with",width:"100%"})})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"h-px bg-white/10 flex-1"}),e.jsx("span",{className:"text-[10px] text-white/30 uppercase font-mono tracking-widest font-black",children:"NEBO HOST (LOCAL SAVE)"}),e.jsx("div",{className:"h-px bg-white/10 flex-1"})]}),e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[11px] font-black text-white/50 uppercase tracking-[0.2em] ml-1 font-mono flex justify-between",children:[e.jsx("span",{children:"Identifikace Jednotky"}),e.jsxs("span",{className:"text-zinc-500 flex items-center gap-1",children:[e.jsx(qs,{className:"w-3 h-3"})," Ukládání v prohlížeči"]})]}),e.jsx("div",{className:"tactical-card p-0 overflow-hidden border-white/10 focus-within:border-white/40 transition-colors bg-white/5",children:e.jsxs("div",{className:"flex items-center px-5 py-5 gap-4",children:[e.jsx(as,{className:"w-6 h-6 text-zinc-500"}),e.jsx("input",{type:"text",required:!0,value:s,onChange:u=>m(u.target.value),className:"w-full bg-transparent text-white placeholder-white/20 focus:outline-none font-mono text-sm uppercase font-bold",placeholder:"ZADEJTE PŘEZDÍVKU...",maxLength:12})]})})]}),d&&e.jsxs("div",{className:"p-4 bg-signal-hazard/10 border border-signal-hazard/40 text-signal-hazard text-[11px] uppercase font-black tracking-widest text-center animate-pulse",children:[e.jsx(_e,{className:"w-4 h-4 inline mr-2 mb-0.5"})," ",d]}),e.jsxs("button",{type:"submit",className:"w-full py-5 border border-white/10 bg-zinc-900 hover:bg-zinc-800 text-white font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-3 transition-all active:scale-95",children:[e.jsx(_t,{className:"w-4 h-4 text-zinc-500"}),"Vstoupit jako Host",e.jsx(Qe,{className:"w-4 h-4 text-zinc-500"})]})]})]}),e.jsx(ce,{children:i&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-[#0a0b0d]/95 backdrop-blur-md flex items-center justify-center p-6",children:e.jsxs(C.div,{initial:{scale:.96,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.96,opacity:0},className:"tactical-card w-full max-w-sm border-zinc-700 p-0 overflow-hidden bg-black/90 shadow-2xl",children:[e.jsxs("div",{className:"bg-zinc-900 p-8 border-b border-white/10 flex items-center gap-6",children:[e.jsx(Et,{className:"w-12 h-12 text-zinc-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tighter leading-none",children:"Lokální Profil"}),e.jsx("p",{className:"text-zinc-500 font-mono text-[10px] uppercase tracking-[0.4em] font-black mt-2",children:"Database Access: OK"})]})]}),e.jsxs("div",{className:"p-8 space-y-6 text-[12px] text-white/70 leading-relaxed font-sans",children:[e.jsxs("div",{className:"p-4 bg-blue-900/20 border border-blue-500/30 rounded-sm",children:[e.jsxs("p",{className:"text-blue-400 font-black uppercase tracking-widest mb-2 flex items-center gap-2 text-xs",children:[e.jsx(At,{className:"w-4 h-4"})," Status: Online"]}),e.jsxs("p",{children:["Jako ",e.jsx("span",{className:"text-white font-bold",children:"HOST"})," máte přístup k databázi karet a online funkcím. Váš inventář se však ukládá pouze do ",e.jsx("span",{className:"text-white font-bold",children:"tohoto zařízení"}),"."]})]}),e.jsxs("ul",{className:"space-y-4 font-bold text-zinc-400",children:[e.jsxs("li",{className:"flex gap-4",children:[e.jsx(gt,{className:"w-4 h-4 text-green-500 shrink-0 mt-0.5"}),e.jsx("span",{children:"Přístup k Master Databázi karet."})]}),e.jsxs("li",{className:"flex gap-4",children:[e.jsx(_e,{className:"w-4 h-4 text-orange-500 shrink-0 mt-0.5"}),e.jsx("span",{children:"Žádná synchronizace mezi zařízeními (Cloud Save)."})]})]})]}),e.jsxs("div",{className:"p-8 bg-black border-t border-white/10 flex flex-col gap-3",children:[e.jsx("button",{onClick:g,className:"button-primary w-full py-4 text-xs !bg-zinc-200 !text-black",children:"Rozumím, Spustit Misi"}),e.jsx("button",{onClick:()=>r(!1),className:"w-full py-3 text-zinc-500 hover:text-white text-[10px] uppercase font-black tracking-[0.2em] transition-colors",children:"Zpět"})]})]})})})]})},tn=({onComplete:t})=>{const[s,m]=n.useState("init"),[a,c]=n.useState(0);n.useEffect(()=>{const r=setTimeout(()=>{i()},1500);return()=>clearTimeout(r)},[]);const i=()=>{m("boot"),N("open"),Q([40,40])};return n.useEffect(()=>{if(s==="boot"){const r=setInterval(()=>{c(d=>d>=100?(clearInterval(r),setTimeout(()=>{m("complete"),N("success"),Q([100,50,100]),setTimeout(t,1400)},500),100):d+2)},35);return()=>clearInterval(r)}},[s]),e.jsx("div",{className:"fixed inset-0 z-[9999] bg-[#0a0b0d] flex flex-col items-center justify-center font-sans overflow-hidden p-6",children:e.jsxs(ce,{mode:"wait",children:[s==="init"&&e.jsxs(C.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,y:20},className:"flex flex-col items-center gap-10 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx(C.div,{animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{repeat:1/0,duration:2.5},className:"absolute inset-0 bg-[#00f2ff]/20 blur-3xl rounded-full"}),e.jsx("div",{className:"w-24 h-24 border-2 border-[#ff9d00] rounded-full flex items-center justify-center shadow-[0_0_30px_rgba(255,157,0,0.25)] relative z-10 bg-[#0a0b0d]",children:e.jsx(Ys,{className:"w-10 h-10 text-[#ff9d00]"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-[#00f2ff] font-mono text-[9px] uppercase tracking-[0.4em] mb-2 font-bold opacity-80",children:"NEXUS // JÁDRO_SÍTĚ"}),e.jsx("h1",{className:"text-3xl font-black uppercase tracking-tighter chromatic-text leading-none",children:"Systém_Připraven"})]}),e.jsx("div",{className:"text-signal-cyan font-mono text-[9px] uppercase tracking-[0.2em] font-black animate-pulse opacity-50",children:"Navazování spojení..."})]})]},"init"),s==="boot"&&e.jsxs(C.div,{initial:{opacity:0},animate:{opacity:1},className:"w-full max-w-[280px] flex flex-col items-center gap-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[e.jsx(_t,{className:"w-12 h-12 text-[#00f2ff] animate-pulse"}),e.jsx("span",{className:"text-[#00f2ff] font-mono text-[10px] uppercase tracking-[0.3em] font-black",children:"Probouzení_Sítě"})]}),e.jsxs("div",{className:"w-full space-y-3",children:[e.jsxs("div",{className:"flex justify-between font-mono text-[10px] text-[#ff9d00] font-bold",children:[e.jsx("span",{children:"ZAVÁDĚNÍ_PROTOKOLŮ"}),e.jsxs("span",{className:"tabular-nums",children:[a,"%"]})]}),e.jsx("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden border border-white/5",children:e.jsx(C.div,{initial:{width:0},animate:{width:`${a}%`},className:"h-full bg-gradient-to-r from-[#ff9d00] to-[#fff] shadow-[0_0_10px_rgba(255,157,0,0.8)]"})})]}),e.jsxs("div",{className:"text-[9px] font-mono text-white/30 uppercase tracking-[0.2em] text-center leading-relaxed font-bold",children:["Načítání_Taktických_Vrstev...",e.jsx("br",{}),"Kalibrace_Signální_Matice..."]})]},"boot"),s==="complete"&&e.jsxs(C.div,{initial:{scale:1.1,opacity:0},animate:{scale:1,opacity:1},className:"flex flex-col items-center gap-6",children:[e.jsxs("div",{className:"p-8 tactical-card border-[#00f2ff] shadow-[0_0_50px_rgba(0,242,255,0.15)] bg-black/80",children:[e.jsx("div",{className:"corner-accent top-left !border-4"}),e.jsx("div",{className:"corner-accent bottom-right !border-4"}),e.jsx(It,{className:"w-16 h-16 text-[#00f2ff]"})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-3xl font-black uppercase tracking-[0.1em] chromatic-text",children:"Autorizováno"}),e.jsx("p",{className:"text-[#00f2ff] font-mono text-[11px] uppercase tracking-[0.3em] font-black opacity-80",children:"Jednotka_Aktivní_V_Sektoru"})]})]},"complete")]})})},sn=({initialNickname:t,onConfirmSetup:s,isGuest:m})=>{const[a,c]=n.useState(t?"class":"nickname"),[i,r]=n.useState(t||""),[d,b]=n.useState(null),[x,g]=n.useState(""),[j,u]=n.useState(!1),[f,E]=n.useState(null),[k,X]=n.useState(""),[w,A]=n.useState(!1),[T,D]=n.useState(!1),Z=o=>{o.preventDefault(),i.trim().length>=3&&c("class")},le=o=>{b(o),m?(u(!0),s(i,o,"solo").catch(()=>u(!1))):setTimeout(()=>c("action"),300)},ee=async o=>{if(d){if(o==="join_mode"){X(""),E(null),c("join");return}u(!0),E(null);try{await s(i,d,o,o==="create"&&T?k:void 0)}catch{u(!1)}}},L=async o=>{if(o.preventDefault(),!(!x.trim()||!d)){u(!0),E(null);try{await s(i,d,x.toUpperCase().trim(),k||void 0)}catch(O){E(O.message||"Nepodařilo se připojit. Zkontrolujte ID místnosti."),u(!1)}}},p=[{id:Ie.WARRIOR,icon:e.jsx(ns,{className:"w-6 h-6"}),desc:"Mistr boje zblízka. Vysoká odolnost.",color:"text-red-500",border:"border-red-500"},{id:Ie.MAGE,icon:e.jsx(rs,{className:"w-6 h-6"}),desc:"Vidí magické aury a skryté zprávy.",color:"text-blue-400",border:"border-blue-400"},{id:Ie.ROGUE,icon:e.jsx(ls,{className:"w-6 h-6"}),desc:"Najde loot tam, kde ostatní vidí stín.",color:"text-green-500",border:"border-green-500"},{id:Ie.CLERIC,icon:e.jsx(is,{className:"w-6 h-6"}),desc:"Léčitel a ochránce před temnotou.",color:"text-yellow-500",border:"border-yellow-500"}];return j&&m?e.jsxs("div",{className:"h-screen w-screen bg-zinc-950 flex flex-col items-center justify-center",children:[e.jsx(Xe,{className:"w-12 h-12 text-white animate-spin mb-4"}),e.jsx("p",{className:"text-white font-mono text-xs uppercase tracking-widest",children:"Generování offline prostředí..."})]}):e.jsxs("div",{className:"h-screen w-screen bg-zinc-950 flex flex-col items-center justify-start p-6 pt-12 relative overflow-hidden overflow-y-auto no-scrollbar",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-5 z-0",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"30px 30px"}}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1/2 bg-gradient-to-b from-signal-cyan/5 to-transparent"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1/2 bg-gradient-to-t from-signal-amber/5 to-transparent"})]}),e.jsxs(C.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"w-full max-w-sm relative z-10 pb-10",children:[a==="nickname"&&e.jsxs("div",{className:"text-center mt-20",children:[e.jsx("div",{className:"w-20 h-20 bg-zinc-900 rounded-full flex items-center justify-center mx-auto mb-6 border border-zinc-700 shadow-xl",children:e.jsx(as,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-2xl font-black text-white mb-2 uppercase tracking-widest",children:"Identifikace"}),e.jsx("p",{className:"text-zinc-400 text-sm mb-8 font-bold tracking-tight",children:"Zadejte svou herní přezdívku."}),e.jsxs("form",{onSubmit:Z,children:[e.jsx("input",{type:"text",value:i,onChange:o=>r(o.target.value),placeholder:"Přezdívka...",className:"w-full bg-zinc-900 border border-zinc-700 p-4 rounded-xl text-white font-display text-center text-lg focus:border-signal-cyan outline-none mb-4 uppercase font-bold",maxLength:12,autoFocus:!0}),e.jsx("button",{type:"submit",disabled:i.length<3,className:"button-primary w-full py-5 text-sm",children:"Pokračovat"})]})]}),a==="class"&&e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-black text-white mb-1 uppercase tracking-tighter",children:"Zvolte Třídu"}),e.jsx("p",{className:"text-zinc-400 text-xs font-bold uppercase tracking-wider",children:"Vaše role ovlivní herní mechaniky."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3 overflow-y-auto pr-1 no-scrollbar",children:p.map(o=>e.jsxs("button",{onClick:()=>le(o.id),className:`p-4 rounded-xl border-2 text-left transition-all relative overflow-hidden group ${d===o.id?`bg-zinc-900 ${o.border}`:"bg-black border-zinc-800 hover:border-zinc-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:`p-3 rounded-lg bg-zinc-900 ${o.color} border border-white/5`,children:o.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-black uppercase tracking-widest ${o.color}`,children:o.id}),e.jsx("p",{className:"text-[11px] text-zinc-300 font-bold leading-tight mt-1",children:o.desc})]})]}),d===o.id&&e.jsx(C.div,{layoutId:"class-highlight",className:`absolute inset-0 opacity-10 ${o.color.replace("text-","bg-")}`})]},o.id))})]}),a==="action"&&!m&&e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("button",{onClick:()=>c("class"),className:"text-[10px] text-zinc-500 uppercase tracking-widest hover:text-white mb-2 font-bold underline underline-offset-4",children:"Změnit Třídu"}),e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-wider",children:"PŘÍPRAVA"}),e.jsxs("div",{className:"flex justify-center items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-white font-bold tracking-tight",children:i}),e.jsx("span",{className:"text-zinc-600",children:"•"}),e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded bg-zinc-900 border border-zinc-700 text-signal-cyan uppercase font-black tracking-widest",children:d})]})]}),e.jsxs("div",{className:"p-5 bg-zinc-900/90 border-2 border-zinc-800 hover:border-signal-cyan rounded-2xl transition-all shadow-xl backdrop-blur-sm",children:[e.jsx("div",{onClick:()=>!T&&ee("create"),className:`cursor-pointer ${T?"":"flex flex-col"}`,children:e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx(cs,{className:"w-7 h-7 text-signal-cyan"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-tighter",children:"Založit_Sektor"}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-bold uppercase tracking-wider",children:"Nová místnost pro skupinu."})]})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-zinc-800 space-y-4",onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-[9px] font-black text-zinc-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(yt,{className:"w-3 h-3"})," Soukromý_Sektor"]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:T,onChange:o=>{D(o.target.checked),o.target.checked||X("")}}),e.jsx("div",{className:"w-9 h-5 bg-zinc-800 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-signal-cyan"})]})]}),T&&e.jsx("div",{className:"animate-in slide-in-from-top-2 bg-black/40 p-3 rounded-lg border border-white/5",children:e.jsx("input",{type:"text",placeholder:"Vstupní klíč...",value:k,onChange:o=>X(o.target.value),className:"w-full bg-transparent p-2 text-white text-sm outline-none focus:border-signal-cyan font-mono uppercase font-bold"})}),T&&e.jsx("button",{onClick:()=>ee("create"),disabled:j||T&&k.length<3,className:"w-full py-4 bg-zinc-900 border-2 border-signal-cyan/50 text-signal-cyan font-black uppercase rounded-xl text-xs mt-2 disabled:opacity-50 tracking-[0.2em] shadow-[0_0_20px_rgba(0,242,255,0.15)] active:scale-95 transition-transform",children:"Inicializovat Soukromý Sektor"})]})]}),e.jsxs("button",{onClick:()=>ee("join_mode"),disabled:j,className:"group relative overflow-hidden w-full p-5 bg-zinc-900/80 border-2 border-zinc-800 hover:border-signal-amber rounded-2xl text-left transition-all active:scale-[0.98] shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-signal-amber/10 to-transparent translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-500"}),e.jsx(Js,{className:"w-7 h-7 text-signal-amber mb-2 relative z-10"}),e.jsx("h3",{className:"text-lg font-bold text-white relative z-10 uppercase tracking-tighter",children:"Vstoupit do Sektoru"}),e.jsx("p",{className:"text-[10px] text-zinc-400 mt-1 relative z-10 font-bold uppercase tracking-wider",children:"Připojit se k existující jednotce."})]}),e.jsxs("button",{onClick:()=>ee("solo-online"),disabled:j,className:"group relative overflow-hidden w-full p-5 bg-zinc-900/80 border-2 border-zinc-800 hover:border-white rounded-2xl text-left transition-all active:scale-[0.98] shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/5 to-transparent translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-500"}),e.jsx(pt,{className:"w-7 h-7 text-white mb-2 relative z-10"}),e.jsx("h3",{className:"text-lg font-bold text-white relative z-10 uppercase tracking-tighter",children:"Samostatná_Mise (Online)"}),e.jsx("p",{className:"text-[10px] text-zinc-400 mt-1 relative z-10 font-bold uppercase tracking-wider",children:"Solo hra se synchronizací Vaultu."})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[e.jsx("div",{className:"h-px bg-zinc-800 flex-1"}),e.jsx("span",{className:"text-[10px] text-zinc-600 uppercase font-black",children:"Nebo"}),e.jsx("div",{className:"h-px bg-zinc-800 flex-1"})]}),e.jsxs("button",{onClick:()=>ee("solo"),className:"w-full py-3 text-zinc-500 hover:text-white text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-colors",children:[e.jsx(Ws,{className:"w-4 h-4"})," Samostatná_Mise (Offline)"]})]}),a==="join"&&!m&&e.jsxs("div",{className:"text-center mt-10",children:[e.jsx("button",{onClick:()=>c("action"),className:"text-zinc-500 text-[10px] font-black uppercase mb-6 hover:text-white tracking-widest underline underline-offset-4",children:"← Zpět do Lobby"}),e.jsx("h2",{className:"text-xl font-black text-white mb-6 uppercase tracking-widest",children:"Připojení k Sektoru"}),f&&e.jsxs("div",{className:"p-3 bg-red-900/20 border border-red-500/50 rounded-lg text-red-400 text-xs text-center mb-4 font-bold animate-pulse flex items-center justify-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4"}),f]}),e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{type:"text",value:x,onChange:o=>{g(o.target.value),f&&E(null)},placeholder:"A1B2C",className:"w-full bg-black border border-zinc-700 p-6 rounded-xl text-white font-mono text-center text-3xl uppercase focus:border-signal-amber outline-none tracking-[0.5em]",maxLength:5,autoFocus:!0}),e.jsx("p",{className:"text-[10px] text-zinc-500 mt-2 uppercase tracking-widest font-bold",children:"Unikátní Kód Sektoru"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(yt,{className:"h-4 w-4 text-zinc-600"})}),e.jsx("input",{type:w?"text":"password",value:k,onChange:o=>X(o.target.value),placeholder:"Přístupový klíč (pokud je vyžadován)",className:"w-full bg-zinc-900 border border-zinc-700 p-4 pl-10 pr-10 rounded-xl text-white outline-none focus:border-signal-amber text-sm font-bold uppercase"}),e.jsx("button",{type:"button",onClick:()=>A(!w),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-zinc-500 hover:text-white",children:w?e.jsx(Xs,{className:"h-4 w-4"}):e.jsx(Qs,{className:"h-4 w-4"})})]}),e.jsxs("button",{type:"submit",disabled:j||x.length<1,className:"button-primary w-full py-5 text-sm !bg-signal-amber shadow-none",children:[j?e.jsx(Xe,{className:"w-5 h-5 animate-spin"}):"Navázat Spojení"," ",e.jsx(Qe,{className:"w-5 h-5 ml-2"})]})]})]})]},a)]})},an=({data:t,onClose:s})=>{n.useEffect(()=>{const c=setTimeout(()=>{s()},4e3);return()=>clearTimeout(c)},[t.id]);const a=(()=>{switch(t.type){case"success":return{bg:"bg-[#22c55e] text-black",icon:e.jsx(We,{className:"w-5 h-5"}),label:"POTVRZENO"};case"error":return{bg:"bg-signal-hazard text-white",icon:e.jsx(_e,{className:"w-5 h-5"}),label:"KRITICKÉ"};case"gift":return{bg:"bg-purple-600 text-white",icon:e.jsx(ta,{className:"w-5 h-5"}),label:"PŘENOS"};case"message":return{bg:"bg-signal-cyan text-black",icon:e.jsx(ea,{className:"w-5 h-5"}),label:"SIGNÁL"};default:return{bg:"bg-white text-black",icon:e.jsx(wt,{className:"w-5 h-5"}),label:"INFO"}}})();return n.createElement(C.div,{layout:!0,initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9,transition:{duration:.1}},key:t.id,className:`fixed top-4 left-4 right-4 z-[10000] shadow-[0_10px_40px_rgba(0,0,0,0.6)] border-l-8 border-black font-mono overflow-hidden ${a.bg} rounded-l-lg mx-auto max-w-sm`},e.jsxs("div",{className:"p-4 flex flex-col gap-2 relative",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-black/10 pb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a.icon,e.jsx("span",{className:"text-[10px] font-black tracking-[0.3em]",children:a.label})]}),e.jsx("button",{onClick:c=>{c.stopPropagation(),s()},className:"opacity-40 hover:opacity-100 transition-opacity p-1",children:e.jsx(Ae,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-[12px] font-bold uppercase leading-tight py-1",children:t.message}),e.jsx(C.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:4,ease:"linear"},className:"absolute bottom-0 left-0 h-1 bg-black/20"})]}))},nn=({event:t,onClose:s,onPlayerDamage:m,playerHp:a=100,playerArmor:c=0,onArmorChange:i,inventory:r,onUseItem:d,onClaimLoot:b})=>{var W,oe,Ce;const[x,g]=n.useState(["Nepřítel detekován. Připravte se k boji."]),[j,u]=n.useState(0),[f,E]=n.useState(0),[k,X]=n.useState(!1),[w,A]=n.useState(null),[T,D]=n.useState(!1),[Z,le]=n.useState(""),[ee,L]=n.useState(!1),[p,o]=n.useState(null),[O,J]=n.useState(!1),[re,$]=n.useState(!1),[ne,te]=n.useState(!1),y=n.useRef(null);n.useEffect(()=>{var G,se;const v=(se=(G=t.stats)==null?void 0:G.find(de=>["HP","ZDRAVÍ"].includes(de.label.toUpperCase())))==null?void 0:se.value,B=parseInt(String(v))||50;u(B),E(B)},[t]),n.useEffect(()=>{var v;(v=y.current)==null||v.scrollIntoView({behavior:"smooth"})},[x]);const K=()=>{switch((t.rarity||"Common").toLowerCase()){case"legendary":return 10;case"epic":return 40;case"rare":return 60;default:return 80}},I=()=>{var G,se,de,je;const v=parseInt(String(((se=(G=t.stats)==null?void 0:G.find(be=>be.label.toUpperCase()==="DEF"))==null?void 0:se.value)||"0")),B=parseInt(String(((je=(de=t.stats)==null?void 0:de.find(be=>be.label.toUpperCase()==="ATK"))==null?void 0:je.value)||"10"));return{def:v,atk:B}},z=()=>{var B;const v=((B=t.enemyLoot)==null?void 0:B.lootStats)||[];return v.length===0&&t.enemyLoot&&t.enemyLoot.goldReward&&v.push({label:"ZLATO",value:`+${t.enemyLoot.goldReward}`}),v},q=()=>{if(O||re||j<=0)return;$(!0),J(!0);const v=K(),B=Math.floor(Math.random()*100)+1;g(G=>[...G,`POKUS O ÚTĚK (Šance ${v}%)...`]),N("scan"),setTimeout(()=>{B<=v?(N("open"),g(G=>[...G,`ÚSPĚCH! (Hod: ${B}) Unikl jsi z boje.`]),setTimeout(s,800)):(N("error"),Q(100),g(G=>[...G,`SELHÁNÍ! (Hod: ${B}) Nepřítel blokuje ústup.`]),$(!1),fe(!0))},1500)},Y=()=>{if(k||j<=0||re)return;X(!0),D(!1),N("scan");let v=0;const B=setInterval(()=>{A([Math.floor(Math.random()*6)+1,Math.floor(Math.random()*6)+1]),v++,v>10&&(clearInterval(B),he())},50)},me=()=>{const v=parseInt(Z);if(isNaN(v)||v<2||v>12){N("error");return}D(!1);const B=Math.floor(v/2),G=v-B;A([B,G]),he(v)},he=v=>{var Se;let B=0,G=0,se=0;v!==void 0?(se=v,B=Math.floor(v/2),G=v-B):(B=Math.floor(Math.random()*6)+1,G=Math.floor(Math.random()*6)+1,se=B+G),A([B,G]);const{def:de}=I(),je=((Se=t.combatConfig)==null?void 0:Se.defBreakChance)||0;let be=!1;je>0&&Math.random()*100<je&&(be=!0);const ve=se===12,ye=se===2;let R=Math.max(0,se-(be?0:de));ve&&(R*=2),ye&&(R=0),R>0?(u(ge=>Math.max(0,ge-R)),be&&(g(ge=>[...ge,`🎯 PENETRACE OBRANY! (Ignorováno ${de} DEF)`]),N("crit")),ve?(N("crit"),Q([50,50,50,100]),g(ge=>[...ge,`KRITICKÝ ZÁSAH! (12) -> ${R} DMG`])):(N("damage"),Q(20),g(ge=>[...ge,`ÚTOK: Hod ${se} vs ${be?"0 (BROKEN)":de} DEF -> ${R} DMG`]))):(N("miss"),Q(50),g(ge=>[...ge,`MINUTÍ: Hod ${se} neprošel přes obranu.`])),setTimeout(()=>{j-R>0?fe():(g(ge=>[...ge,"CÍL ELIMINOVÁN."]),N("success")),X(!1),le("")},1e3)},fe=(v=!1)=>{const{atk:B}=I();let G=Math.max(0,B);if(G>0){const se=v?"NEPŘÍTEL (VOLNÝ ÚTOK)":"NEPŘÍTEL";if(c>0){const de=Math.min(c,G);G-=de,i&&i(-de),g(je=>[...je,`🛡️ ŠTÍT ZASAŽEN: -${de} Armor`]),N("error")}G>0?(m&&m(-G),g(de=>[...de,`${se}: Zásah za ${G} HP!`]),Q([100])):g(de=>[...de,`${se}: Útok plně pohlcen štítem!`])}},U=()=>{var B;if(!p)return;const v=(B=p.stats)==null?void 0:B.find(G=>["DMG","ATK","POŠKOZENÍ"].some(se=>G.label.toUpperCase().includes(se)));if(v){const G=parseInt(String(v.value).replace(/[^0-9-]/g,""));G>0&&(u(se=>Math.max(0,se-G)),g(se=>[...se,`POUŽIT PŘEDMĚT: ${p.title} -> ${G} DMG!`]),N("damage"),Q(50),j-G<=0&&setTimeout(()=>{g(se=>[...se,"CÍL ELIMINOVÁN PŘEDMĚTEM."]),N("success")},500))}d&&d(p),o(null)},Oe=()=>{if(ne)return;te(!0);const v=z();b&&b(v),N("success"),Q([50,50,100]),setTimeout(s,1e3)},Me=(r==null?void 0:r.filter(v=>{var B;return!((B=v.resourceConfig)!=null&&B.isResourceContainer||v.type!==H.ITEM&&v.type!=="PŘEDMĚT")}))||[],{atk:Pe,def:Le}=I(),M=j<=0,V=((W=t.combatConfig)==null?void 0:W.defBreakChance)&&t.combatConfig.defBreakChance>0;if(M){const v=z();return e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 space-y-6 animate-in zoom-in duration-500 text-center",children:[e.jsx(sa,{className:"w-24 h-24 text-yellow-500 animate-bounce drop-shadow-[0_0_20px_rgba(234,179,8,0.5)]"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-3xl font-display font-black text-yellow-500 uppercase tracking-widest",children:"VÍTĚZSTVÍ"}),e.jsx("p",{className:"text-zinc-400 font-mono text-xs uppercase tracking-widest",children:"Nepřítel poražen. Kořist dostupná."})]}),e.jsxs("div",{className:"w-full bg-zinc-900/80 border border-yellow-500/30 rounded-xl p-4 space-y-3",children:[e.jsx("h3",{className:"text-[10px] font-black uppercase text-zinc-500 tracking-[0.2em] border-b border-zinc-800 pb-2 mb-2",children:"Nalezené Suroviny & Data"}),v.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-2",children:v.map((B,G)=>e.jsxs("div",{className:"bg-black p-2 rounded border border-zinc-800 flex items-center justify-between",children:[e.jsx("span",{className:"text-[9px] font-bold text-zinc-400 uppercase",children:B.label}),e.jsx("span",{className:"text-sm font-mono font-black text-yellow-500",children:B.value})]},G))}):e.jsx("p",{className:"text-xs text-zinc-600 italic",children:"Žádná kořist nalezena."})]}),e.jsx("button",{onClick:Oe,disabled:ne,className:`w-full py-4 font-black uppercase text-sm tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 shadow-lg transition-all ${ne?"bg-green-600 text-white":"bg-yellow-500 hover:bg-yellow-400 text-black active:scale-95"}`,children:ne?e.jsxs(e.Fragment,{children:[e.jsx(gt,{className:"w-5 h-5"})," VYZVEDNUTO"]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"w-5 h-5"})," VYZVEDNOUT KOŘIST"]})})]})}return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 p-3 bg-zinc-900/50 border border-zinc-700 rounded-xl flex flex-col justify-end relative",children:[e.jsxs("div",{className:"flex justify-between items-end mb-1 relative z-10",children:[e.jsx("span",{className:"text-[8px] font-black uppercase text-zinc-500 tracking-widest flex items-center gap-1",children:"TY"}),e.jsxs("div",{className:"text-right",children:[c>0&&e.jsxs("div",{className:"flex items-center justify-end gap-1 text-zinc-400 mb-0.5",children:[e.jsx($e,{className:"w-3 h-3"}),e.jsx("span",{className:"text-[9px] font-mono font-bold",children:c})]}),e.jsxs("div",{className:"flex items-center justify-end gap-1 text-red-500",children:[e.jsx(Ve,{className:"w-3 h-3 fill-current"}),e.jsxs("span",{className:"text-[10px] font-mono font-bold",children:[a," HP"]})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[c>0&&e.jsx("div",{className:"h-1 bg-black rounded-full overflow-hidden border border-zinc-700",children:e.jsx(C.div,{className:"h-full bg-zinc-400",initial:{width:"100%"},animate:{width:`${Math.min(100,c)}%`}})}),e.jsx("div",{className:"h-1.5 bg-black rounded-full overflow-hidden border border-red-900/50",children:e.jsx(C.div,{className:"h-full bg-red-600",initial:{width:"100%"},animate:{width:`${Math.min(100,a)}%`}})})]})]}),e.jsxs("div",{className:"flex-1 p-3 bg-red-950/30 border border-red-500/30 rounded-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("span",{className:"text-[8px] font-black uppercase text-red-400 tracking-widest flex items-center gap-1",children:[e.jsx(ut,{className:"w-3 h-3"})," Nepřítel"]}),e.jsxs("span",{className:"text-[10px] font-mono font-bold text-white",children:[j," HP"]})]}),e.jsx("div",{className:"h-1.5 bg-black rounded-full overflow-hidden border border-red-900/50 mt-auto",children:e.jsx(C.div,{className:"h-full bg-red-600",initial:{width:"100%"},animate:{width:`${j/f*100}%`}})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-black/40 border border-zinc-800 p-2 rounded flex justify-between items-center",children:[e.jsx("span",{className:"text-[9px] text-zinc-500 uppercase font-bold",children:"Enemy Útok (ATK)"}),e.jsx("span",{className:"text-sm font-black text-orange-500",children:Pe})]}),e.jsxs("div",{className:"bg-black/40 border border-zinc-800 p-2 rounded flex justify-between items-center relative overflow-hidden",children:[e.jsx("span",{className:"text-[9px] text-zinc-500 uppercase font-bold",children:"Enemy Obrana (DEF)"}),e.jsx("span",{className:`text-sm font-black text-blue-400 ${V?"pr-6":""}`,children:Le}),V&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 bg-green-900/50 w-6 flex items-center justify-center border-l border-green-500/50",title:`Weakness: ${(oe=t.combatConfig)==null?void 0:oe.defBreakChance}%`,children:e.jsx(os,{className:"w-3 h-3 text-green-500 animate-pulse"})})]})]}),e.jsxs("div",{className:"bg-black border border-white/10 rounded-xl p-4 relative overflow-hidden",children:[e.jsx(ce,{children:T&&e.jsxs(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute inset-0 z-30 bg-black flex flex-col items-center justify-center p-4 space-y-3",children:[e.jsx("h4",{className:"text-xs font-black text-white uppercase tracking-widest",children:"Zadejte součet 2 kostek"}),e.jsx("input",{type:"number",autoFocus:!0,value:Z,onChange:v=>le(v.target.value),placeholder:"2-12",className:"w-24 bg-zinc-900 border border-zinc-700 p-3 text-center text-xl font-bold text-white rounded-xl outline-none focus:border-signal-cyan"}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx("button",{onClick:()=>D(!1),className:"flex-1 py-3 bg-zinc-800 text-zinc-400 font-bold text-[10px] uppercase rounded-lg",children:"Zrušit"}),e.jsx("button",{onClick:me,className:"flex-1 py-3 bg-green-600 text-white font-bold text-[10px] uppercase rounded-lg",children:"Potvrdit"})]})]})}),e.jsx(ce,{children:k&&e.jsx(C.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.5},className:"absolute inset-0 z-20 bg-black/80 flex items-center justify-center gap-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex gap-2 justify-center mb-2",children:[e.jsx(Ge,{className:"w-12 h-12 text-white animate-spin"}),e.jsx(Ge,{className:"w-12 h-12 text-white animate-spin",style:{animationDirection:"reverse"}})]}),e.jsx("span",{className:"text-2xl font-black text-white font-mono tracking-widest",children:w?`${w[0]} + ${w[1]}`:"? + ?"})]})})}),e.jsxs("div",{className:"h-24 overflow-y-auto no-scrollbar space-y-1 font-mono text-[9px] text-zinc-400 mb-3 border-b border-zinc-800 pb-2",children:[x.length===0?e.jsx("span",{className:"italic opacity-50",children:"Zahajte útok..."}):x.map((v,B)=>e.jsx("div",{className:v.includes("KRITICKÝ")||v.includes("PENETRACE")?"text-yellow-400 font-bold":v.includes("NEPŘÍTEL")?"text-red-400":v.includes("POUŽIT")?"text-cyan-400":v.includes("ÚSPĚCH")?"text-green-400":v.includes("SELHÁNÍ")?"text-red-500":v.includes("ŠTÍT")?"text-zinc-200":"text-zinc-300",children:v},B)),e.jsx("div",{ref:y})]}),e.jsxs("div",{className:"flex gap-2 h-16",children:[e.jsxs("button",{onClick:()=>D(!0),disabled:k||re,className:"flex-1 py-4 bg-zinc-800 hover:bg-zinc-700 text-white font-black uppercase text-[10px] tracking-[0.1em] rounded-xl flex items-center justify-center gap-2 border border-zinc-600 active:scale-95 transition-all",children:[e.jsx(Ct,{className:"w-5 h-5 text-zinc-400"}),e.jsx("span",{children:"ZADAT HOD"})]}),e.jsx("button",{onClick:Y,disabled:k||re,className:"w-20 bg-red-600 hover:bg-red-500 text-white rounded-xl shadow-[0_0_15px_rgba(220,38,38,0.4)] active:scale-95 transition-all flex flex-col items-center justify-center border border-red-400",children:e.jsx(Ge,{className:"w-8 h-8"})})]}),e.jsxs("button",{onClick:q,disabled:k||O||re,className:`w-full py-2 mt-2 bg-zinc-900 border border-zinc-700 text-zinc-400 font-bold uppercase text-[9px] tracking-widest rounded-lg flex items-center justify-center gap-2 ${O?"opacity-50 cursor-not-allowed":"hover:bg-zinc-800 hover:text-white"}`,children:[e.jsx(bt,{className:"w-3 h-3"}),O?"ÚTĚK SELHAL":`POKUSIT SE UTÉCT (${K()}%)`]})]}),r&&r.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("button",{onClick:()=>{L(!ee),o(null)},className:"w-full py-2 bg-zinc-900 hover:bg-zinc-800 border border-zinc-700 text-zinc-400 font-bold uppercase text-[9px] tracking-widest rounded-lg flex items-center justify-center gap-2",children:[e.jsx(De,{className:"w-3 h-3"})," ",ee?"Zavřít Batoh":"Podpora z Batohu"]}),e.jsx(ce,{children:ee&&e.jsx(C.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden bg-black/40 rounded-lg border border-zinc-800 mt-2",children:p?e.jsxs("div",{className:"p-3 bg-zinc-900/80",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-white font-bold text-xs uppercase",children:p.title}),e.jsx("button",{onClick:()=>o(null),children:e.jsx(Ae,{className:"w-4 h-4 text-zinc-500"})})]}),e.jsx("p",{className:"text-[10px] text-zinc-400 italic mb-3",children:p.description}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(Ce=p.stats)==null?void 0:Ce.map((v,B)=>e.jsxs("span",{className:"text-[9px] bg-black border border-zinc-700 px-2 py-1 rounded text-zinc-300 font-mono",children:[v.label,": ",v.value]},B))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>o(null),className:"flex-1 py-2 bg-zinc-800 text-zinc-400 text-[10px] font-bold uppercase rounded",children:"Zpět"}),e.jsx("button",{onClick:U,className:"flex-1 py-2 bg-green-600 text-white text-[10px] font-bold uppercase rounded hover:bg-green-500",children:"POUŽÍT"})]})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2 p-2 max-h-40 overflow-y-auto",children:[Me.map(v=>{var de,je,be;const B=(de=v.stats)==null?void 0:de.find(ve=>["HP","ZDRAVÍ","HEAL"].some(ye=>ve.label.toUpperCase().includes(ye))),G=(je=v.stats)==null?void 0:je.find(ve=>["DMG","ATK","POŠKOZENÍ"].some(ye=>ve.label.toUpperCase().includes(ye))),se=(be=v.stats)==null?void 0:be.find(ve=>["ARMOR","ŠTÍT","BRNĚNÍ"].some(ye=>ve.label.toUpperCase().includes(ye)));return!B&&!G&&!se&&!v.isConsumable?null:e.jsxs("button",{onClick:()=>o(v),className:"flex flex-col items-start p-2 bg-zinc-800 hover:bg-zinc-700 border border-zinc-700 rounded text-left active:scale-95 transition-all",children:[e.jsx("span",{className:"text-[9px] font-bold text-white uppercase line-clamp-1",children:v.title}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 flex-wrap",children:[G&&e.jsxs("span",{className:"text-[8px] font-mono text-orange-400 bg-orange-950/30 px-1 rounded flex items-center gap-0.5",children:[e.jsx(jt,{className:"w-2 h-2"})," ",G.value]}),B&&e.jsxs("span",{className:"text-[8px] font-mono text-green-400 bg-green-950/30 px-1 rounded flex items-center gap-0.5",children:[e.jsx(Ve,{className:"w-2 h-2"})," ",B.value]}),se&&e.jsxs("span",{className:"text-[8px] font-mono text-zinc-300 bg-zinc-700/50 px-1 rounded flex items-center gap-0.5",children:[e.jsx($e,{className:"w-2 h-2"})," ",se.value]})]})]},v.id)}),Me.length===0&&e.jsx("p",{className:"col-span-2 text-center text-[9px] text-zinc-600 italic py-2",children:"Žádné bojové předměty."})]})})})]})]})},rn=({event:t,onClose:s,onPlayerDamage:m,playerClass:a,onClaimLoot:c})=>{var ee,L,p,o,O,J,re;const[i,r]=n.useState("active"),[d,b]=n.useState(!1),[x,g]=n.useState(null),[j,u]=n.useState(!1),[f,E]=n.useState(""),k={difficulty:((ee=t.trapConfig)==null?void 0:ee.difficulty)??10,damage:((L=t.trapConfig)==null?void 0:L.damage)??20,disarmClass:((p=t.trapConfig)==null?void 0:p.disarmClass)||"ANY",successMessage:((o=t.trapConfig)==null?void 0:o.successMessage)||"Past zneškodněna.",failMessage:((O=t.trapConfig)==null?void 0:O.failMessage)||"Past sklapla!",trapType:((J=t.trapConfig)==null?void 0:J.trapType)||"NÁSTRAHA",loot:((re=t.trapConfig)==null?void 0:re.loot)||[]},X=a&&k.disarmClass===a,w=k.trapType,A=()=>{r("success"),N("success"),Q([50,50,50])},T=()=>{i==="success"&&(k.loot&&k.loot.length>0&&c&&c(k.loot),r("claimed"),N("open"),setTimeout(s,800))},D=()=>{if(d||i!=="active")return;b(!0),u(!1),N("scan");let $=0;const ne=setInterval(()=>{g([Math.floor(Math.random()*6)+1,Math.floor(Math.random()*6)+1]),$++,$>10&&(clearInterval(ne),le())},50)},Z=()=>{const $=parseInt(f);if(isNaN($)||$<2||$>12){N("error");return}u(!1);const ne=Math.floor($/2),te=$-ne;g([ne,te]),le($)},le=$=>{let ne=0;if($!==void 0)ne=$;else{const te=Math.floor(Math.random()*6)+1,y=Math.floor(Math.random()*6)+1;g([te,y]),ne=te+y}b(!1),ne>=k.difficulty?(r("success"),N("success"),Q([50,50])):(r("fail"),N("error"),Q([200,100,200]),m&&k.damage>0&&setTimeout(()=>{m(-k.damage)},500),setTimeout(s,2500))};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`p-4 rounded-xl border-2 flex items-center justify-between transition-colors ${i==="active"?"bg-orange-950/30 border-orange-500/50":i==="success"||i==="claimed"?"bg-green-950/30 border-green-500":"bg-red-950/30 border-red-600"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-full border ${i==="active"?"bg-orange-500/10 border-orange-500 text-orange-500":i==="success"||i==="claimed"?"bg-green-500/10 border-green-500 text-green-500":"bg-red-500/10 border-red-500 text-red-500"}`,children:i==="active"?e.jsx(Fe,{className:"w-6 h-6 animate-pulse"}):i==="success"||i==="claimed"?e.jsx(gt,{className:"w-6 h-6"}):e.jsx(It,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-sm font-black uppercase tracking-widest ${i==="active"?"text-orange-500":i==="success"||i==="claimed"?"text-green-500":"text-red-500"}`,children:i==="active"?"DETEKOVÁNA HROZBA":i==="success"?"PAST ZNEŠKODNĚNA":i==="claimed"?"HOTOVO":"PAST SPUŠTĚNA"}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-mono font-bold uppercase tracking-wider",children:i==="active"?w:i==="success"?k.successMessage:k.failMessage})]})]})}),i==="active"&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-black/60 border border-zinc-800 p-4 rounded-xl flex flex-col items-center justify-center gap-1",children:[e.jsx("span",{className:"text-[9px] text-zinc-500 uppercase font-bold tracking-widest",children:"Obtížnost (Cíl)"}),e.jsxs("div",{className:`text-3xl font-black font-mono flex items-center gap-2 ${X?"text-green-500":"text-white"}`,children:[X?e.jsx(aa,{className:"w-5 h-5"}):e.jsx(Re,{className:"w-5 h-5 text-zinc-600"}),X?"0":`${k.difficulty}+`]})]}),e.jsxs("div",{className:"bg-red-950/20 border border-red-900/50 p-4 rounded-xl flex flex-col items-center justify-center gap-1",children:[e.jsx("span",{className:"text-[9px] text-red-400 uppercase font-bold tracking-widest",children:"Riziko (DMG)"}),e.jsxs("div",{className:"text-3xl font-black text-red-500 font-mono flex items-center gap-2",children:[e.jsx(ut,{className:"w-5 h-5"})," -",k.damage]})]})]}),i==="success"&&e.jsxs("div",{className:"animate-in zoom-in duration-300 space-y-4",children:[e.jsxs("div",{className:"bg-green-950/20 border border-green-500/30 p-4 rounded-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-20",children:e.jsx(ke,{className:"w-16 h-16 text-green-500"})}),e.jsx("p",{className:"text-[10px] text-green-400 font-bold uppercase tracking-widest mb-3 border-b border-green-500/30 pb-2",children:"Odměna za zneškodnění (Loot)"}),k.loot&&k.loot.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-2 relative z-10",children:k.loot.map(($,ne)=>e.jsxs("div",{className:"bg-black p-3 rounded border border-green-900 flex justify-between items-center shadow-lg",children:[e.jsx("span",{className:"text-[9px] font-bold text-zinc-400 uppercase tracking-wider",children:$.label}),e.jsx("span",{className:"text-lg font-mono font-black text-green-500",children:$.value})]},ne))}):e.jsx("p",{className:"text-[10px] text-zinc-500 italic py-4 text-center",children:"Žádná dodatečná odměna. Past se jen vypne."})]}),e.jsx("button",{onClick:T,className:"w-full py-4 bg-green-600 hover:bg-green-500 text-white font-black uppercase text-xs tracking-[0.2em] rounded-xl shadow-[0_0_20px_rgba(34,197,94,0.3)] flex items-center justify-center gap-2 transition-all active:scale-95",children:k.loot&&k.loot.length>0?e.jsxs(e.Fragment,{children:["VYZVEDNOUT A ULOŽIT ",e.jsx(Ze,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["POKRAČOVAT ",e.jsx(Qe,{className:"w-4 h-4"})]})})]}),i==="active"&&e.jsx("div",{className:"bg-black border border-white/10 rounded-xl p-4 relative overflow-hidden",children:X?e.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-2",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 bg-green-900/10 p-3 rounded-lg border border-green-500/20",children:[e.jsx(Et,{className:"w-8 h-8 text-green-400"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-black text-green-400 uppercase tracking-widest",children:["Autorizace Přijata: ",a]}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-mono leading-tight mt-1",children:"Tvůj výcvik ti umožňuje tento mechanismus bezpečně obejít. Kostky nejsou potřeba."})]})]}),e.jsxs("button",{onClick:A,className:"w-full py-4 bg-green-600 hover:bg-green-500 text-white font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-3 transition-all active:scale-95 shadow-[0_0_20px_rgba(34,197,94,0.4)] animate-pulse",children:[e.jsx(na,{className:"w-5 h-5"}),"BEZPEČNĚ ZNEŠKODNIT"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{children:j&&e.jsxs(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"absolute inset-0 z-30 bg-black flex flex-col items-center justify-center p-4 space-y-3",children:[e.jsx("h4",{className:"text-xs font-black text-white uppercase tracking-widest",children:"Zadejte součet 2 kostek"}),e.jsx("input",{type:"number",autoFocus:!0,value:f,onChange:$=>E($.target.value),placeholder:"2-12",className:"w-24 bg-zinc-900 border border-zinc-700 p-3 text-center text-xl font-bold text-white rounded-xl outline-none focus:border-orange-500"}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx("button",{onClick:()=>u(!1),className:"flex-1 py-3 bg-zinc-800 text-zinc-400 font-bold text-[10px] uppercase rounded-lg",children:"Zrušit"}),e.jsx("button",{onClick:Z,className:"flex-1 py-3 bg-orange-600 text-white font-bold text-[10px] uppercase rounded-lg",children:"Potvrdit"})]})]})}),e.jsx(ce,{children:d&&e.jsx(C.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.5},className:"absolute inset-0 z-20 bg-black/80 flex items-center justify-center gap-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex gap-2 justify-center mb-2",children:[e.jsx(Ge,{className:"w-12 h-12 text-white animate-spin"}),e.jsx(Ge,{className:"w-12 h-12 text-white animate-spin",style:{animationDirection:"reverse"}})]}),e.jsx("span",{className:"text-2xl font-black text-white font-mono tracking-widest",children:x?`${x[0]} + ${x[1]}`:"? + ?"})]})})}),e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest mb-3 text-center",children:"Zvolte metodu ověření"}),e.jsxs("div",{className:"flex gap-2 h-20",children:[e.jsxs("button",{onClick:()=>u(!0),disabled:d,className:"flex-1 bg-zinc-800 hover:bg-zinc-700 text-white font-black uppercase text-[10px] tracking-[0.1em] rounded-xl flex flex-col items-center justify-center gap-2 border border-zinc-600 active:scale-95 transition-all group",children:[e.jsx(Ct,{className:"w-6 h-6 text-zinc-400 group-hover:text-white transition-colors"}),e.jsx("span",{children:"ZADAT HOD (FYZICKÉ KOSTKY)"})]}),e.jsxs("button",{onClick:D,disabled:d,className:"w-24 bg-orange-600 hover:bg-orange-500 text-white rounded-xl shadow-[0_0_15px_rgba(249,115,22,0.4)] active:scale-95 transition-all flex flex-col items-center justify-center border border-orange-400",children:[e.jsx(Ge,{className:"w-8 h-8"}),e.jsx("span",{className:"text-[8px] font-bold mt-1",children:"VIRTUÁLNÍ"})]})]})]})})]})},ln=({event:t,onClose:s,onSave:m,onDiscard:a,onUse:c,onResolveDilemma:i,isSaved:r,onPlayerDamage:d,playerHp:b,playerArmor:x,onArmorChange:g,playerClass:j,inventory:u,onUseItem:f,onClaimLoot:E})=>{var fe,U,Oe,Me,Pe,Le;const[k,X]=n.useState("CHOICE"),[w,A]=n.useState(null),[T,D]=n.useState("success"),[Z,le]=n.useState(!1),[ee,L]=n.useState(null);n.useEffect(()=>{N("open")},[t]);const p=t.type===H.ENCOUNTER||t.type===H.BOSS,o=t.type===H.TRAP,O=!p&&!o,J=M=>{L(ee===M?null:M),N("click"),Q(10)},re=M=>{const V=M.toUpperCase();return["HP","ZDRAVÍ","HEAL","HEALTH"].some(W=>V.includes(W))?"text-green-400":["DMG","ATK","ÚTOK","UTOK","ATTACK"].some(W=>V.includes(W))?"text-signal-hazard":["GOLD","MINCE","KREDITY","CREDITS"].some(W=>V.includes(W))?"text-signal-amber":["MANA","ENERGIE","ENERGY"].some(W=>V.includes(W))?"text-signal-cyan":"text-white"},$=(M,V)=>{const W=M.toUpperCase(),oe=String(V),Ce=oe.includes("+")||!oe.includes("-")&&parseInt(oe)>0;return["HP","ZDRAVÍ","HEAL","HEALTH"].some(v=>W.includes(v))?Ce?`Okamžitě obnovuje ${oe} jednotek biologické integrity.`:`Způsobuje přímé poškození tkání ve výši ${oe} HP.`:["DMG","ATK","ÚTOK","UTOK","ATTACK"].some(v=>W.includes(v))?`Zvyšuje sílu příštího úderu nebo automatického útoku o ${oe}.`:["GOLD","MINCE","KREDITY","CREDITS"].some(v=>W.includes(v))?`Transakční kredity v hodnotě ${oe} byly připsány do tvého účtu.`:["MANA","ENERGIE","ENERGY"].some(v=>W.includes(v))?`Obnovuje ${oe} jednotek energie pro použití schopností nebo svitků.`:["ARMOR","OBRANA","BRNĚNÍ"].some(v=>W.includes(v))?`Zvyšuje tvou statickou ochranu o ${oe}. Snižuje příchozí DMG.`:`Speciální modifikátor sektoru ovlivňující parametr ${M} o ${oe}.`},ne=M=>{A(M);const W=Math.random()*100<(M.successChance??100),oe=W?"success":"fail";D(oe),X("RESULT"),W?(N("success"),Q([50,50])):(N("error"),Q([100,100])),i&&i(M,oe)},te=()=>{Z&&a?(a(),N("error"),s()):(le(!0),Q(20))},K=((M,V)=>{var oe,Ce;if(M===H.BOSS)return{bg:"bg-gradient-to-b from-red-950/90 to-black",border:"border-red-600 shadow-[0_0_60px_rgba(220,38,38,0.4)]",text:"text-red-500",accent:"bg-red-600",icon:e.jsx(oa,{className:"w-8 h-8 text-red-500"})};if(M===H.SPACE_STATION)return{bg:"bg-gradient-to-b from-slate-900/90 to-black",border:"border-cyan-400 shadow-[0_0_40px_rgba(34,211,238,0.2)]",text:"text-cyan-400",accent:"bg-cyan-500",icon:e.jsx(ht,{className:"w-8 h-8 text-cyan-400"})};if(M===H.PLANET)return{bg:"bg-gradient-to-b from-indigo-950/90 to-black",border:"border-indigo-500 shadow-[0_0_40px_rgba(99,102,241,0.2)]",text:"text-indigo-400",accent:"bg-indigo-500",icon:e.jsx(pt,{className:"w-8 h-8 text-indigo-400"})};if(M===H.TRAP)return{bg:"bg-gradient-to-b from-orange-950/90 to-black",border:"border-orange-500 shadow-[0_0_30px_rgba(249,115,22,0.3)]",text:"text-orange-500",accent:"bg-orange-500",icon:e.jsx(Fe,{className:"w-8 h-8 text-orange-500"})};if(M===H.MERCHANT)return{bg:"bg-gradient-to-b from-yellow-950/90 to-black",border:"border-yellow-500 shadow-[0_0_30px_rgba(234,179,8,0.3)]",text:"text-yellow-500",accent:"bg-yellow-500",icon:e.jsx(kt,{className:"w-8 h-8 text-yellow-500"})};if(M===H.ENCOUNTER)return{bg:"bg-gradient-to-b from-rose-950/90 to-black",border:"border-rose-500 shadow-[0_0_30px_rgba(244,63,94,0.3)]",text:"text-rose-500",accent:"bg-rose-500",icon:e.jsx(jt,{className:"w-8 h-8 text-rose-500"})};if(M===H.DILEMA)return{bg:"bg-[#0a0b0d]",border:"border-purple-500/50 shadow-[0_0_40px_rgba(168,85,247,0.2)]",text:"text-purple-400",accent:"bg-purple-500",icon:e.jsx(da,{className:"w-8 h-8 text-purple-400"})};const W={Legendary:"border-signal-amber text-signal-amber shadow-[0_0_30px_rgba(255,157,0,0.3)]",Epic:"border-purple-400 text-purple-400 shadow-[0_0_20px_rgba(192,132,252,0.3)]",Rare:"border-signal-cyan text-signal-cyan shadow-[0_0_20px_rgba(0,242,255,0.2)]",Common:"border-white/30 text-white/60"};return{bg:"bg-[#0a0b0d]",border:W[V]||W.Common,text:((oe=W[V])==null?void 0:oe.split(" ")[1])||"text-white",accent:((Ce=W[V])==null?void 0:Ce.split(" ")[1].replace("text-","bg-"))||"bg-white",icon:e.jsx(xs,{className:"w-8 h-8"})}})(t.type,t.rarity),I=t.type===H.DILEMA,z=(M,V)=>e.jsx(ce,{children:ee===M&&e.jsx(C.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx("div",{className:"mt-2 p-2 bg-black/60 border border-white/10 rounded-lg text-[10px] text-zinc-300 leading-tight italic",children:$(M,V)})})}),q=()=>{var M,V;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-indigo-950/30 border border-indigo-500/30 rounded-xl flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-black border border-indigo-500/50 rounded-full shadow-[0_0_20px_rgba(99,102,241,0.2)]",children:e.jsx(ms,{className:"w-6 h-6 text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-indigo-400 tracking-widest mb-1",children:"Navigační Data"}),e.jsx("p",{className:"text-xs text-zinc-300 font-mono leading-relaxed",children:"Uložte tuto kartu do batohu. Odemkne vám novou destinaci v navigačním systému lodi."})]})]}),e.jsxs("div",{className:"bg-black/40 border border-white/5 p-3 rounded-lg flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-500 uppercase",children:"Sektor ID"}),e.jsx("span",{className:"text-white font-mono font-bold",children:((M=t.planetConfig)==null?void 0:M.planetId)||"N/A"})]}),e.jsxs("div",{className:"bg-black/40 border border-white/5 p-3 rounded-lg flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-500 uppercase",children:"Typ Eventu"}),e.jsx("span",{className:"text-white font-mono font-bold",children:((V=t.planetConfig)==null?void 0:V.landingEventType)||"UNKNOWN"})]})]})},Y=()=>{var M,V,W,oe;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-cyan-950/20 border border-cyan-500/30 p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-cyan-400",children:[e.jsx(us,{className:"w-4 h-4 animate-pulse"}),e.jsx("span",{className:"text-[10px] uppercase font-bold tracking-widest",children:"Stanice Online"})]}),e.jsxs("p",{className:"text-xs text-zinc-300 italic mb-4",children:['"',((M=t.stationConfig)==null?void 0:M.welcomeMessage)||"Vítejte na palubě. Systémy jsou funkční.",'"']}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-3 rounded border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bt,{className:"w-4 h-4 text-cyan-300"}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-300 uppercase",children:"Kyslík (O2)"})]}),e.jsx("div",{className:"text-green-500 font-mono text-xs font-bold flex items-center gap-1 uppercase",children:(V=t.stationConfig)!=null&&V.refillO2?"DOPLNĚNÍ NA 100%":"---"})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-3 rounded border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4 text-slate-300"}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-300 uppercase",children:"Oprava Pláště"})]}),e.jsxs("div",{className:"text-green-500 font-mono text-xs font-bold flex items-center gap-1",children:["+",((W=t.stationConfig)==null?void 0:W.repairAmount)||30," HP"]})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-3 rounded border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ot,{className:"w-4 h-4 text-orange-400"}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-300 uppercase",children:"Doplnění Paliva"})]}),e.jsxs("div",{className:"text-green-500 font-mono text-xs font-bold flex items-center gap-1",children:["+",((oe=t.stationConfig)==null?void 0:oe.fuelReward)||50]})]})]})]}),e.jsx("p",{className:"text-[9px] text-green-500 text-center uppercase font-bold",children:"Odměna za přistání na stanici"})]})},me=()=>{var M,V,W;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-yellow-900/10 border border-yellow-700/30 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-yellow-500 mb-2",children:"Obchodní Status"}),e.jsxs("div",{className:"text-xs text-zinc-300 italic",children:['"',t.description,'"']})]}),e.jsxs("div",{className:"bg-black/40 border border-zinc-800 rounded-lg p-3",children:[e.jsx("h4",{className:"text-[10px] font-bold text-zinc-400 uppercase mb-3 border-b border-zinc-800 pb-1",children:"Třídní Slevy & Bonusy"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-[10px] font-bold uppercase",children:[e.jsx(ns,{className:"w-3 h-3"})," Válečník"]}),e.jsxs("div",{className:"text-white font-mono text-xs",children:[((M=t.tradeConfig)==null?void 0:M.warriorDiscount)||10,"% SLEVA"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-400 text-[10px] font-bold uppercase",children:[e.jsx(rs,{className:"w-3 h-3"})," Mág (Svitky)"]}),e.jsxs("div",{className:"text-white font-mono text-xs",children:[((V=t.tradeConfig)==null?void 0:V.mageDiscount)||25,"% SLEVA"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-500 text-[10px] font-bold uppercase",children:[e.jsx(is,{className:"w-3 h-3"})," Kněz (Heal)"]}),e.jsxs("div",{className:"text-white font-mono text-xs",children:[((W=t.tradeConfig)==null?void 0:W.clericDiscount)||45,"% SLEVA"]})]})]})]})]})},he=()=>{var M;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-[8px] text-white/30 uppercase font-black tracking-widest flex items-center gap-2 mb-2",children:[e.jsx(wt,{className:"w-3 h-3"})," Klikni na stat pro vysvětlení vlivu"]}),t.isSellOnly&&e.jsxs("div",{className:"bg-red-950/20 border border-red-500/30 p-4 rounded-xl flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-3 bg-black border border-red-500/50 rounded-lg shadow-[0_0_15px_rgba(239,68,68,0.15)]",children:e.jsx(ps,{className:"w-6 h-6 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-red-500 tracking-widest mb-1 flex items-center gap-2",children:"JEN PRO PRODEJ"}),e.jsx("p",{className:"text-[8px] text-zinc-400 font-mono leading-relaxed",children:"Tento předmět nemá žádnou funkční hodnotu. Lze jej pouze prodat obchodníkům za kredity."})]})]}),((M=t.resourceConfig)==null?void 0:M.isResourceContainer)&&e.jsxs("div",{className:"bg-orange-950/20 border border-orange-500/30 p-4 rounded-xl flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-3 bg-black border border-orange-500/50 rounded-lg shadow-[0_0_15px_rgba(249,115,22,0.15)]",children:e.jsx(Be,{className:"w-6 h-6 text-orange-500"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-orange-500 tracking-widest mb-1 flex items-center gap-2",children:[e.jsx(Ze,{className:"w-3 h-3"})," ",t.resourceConfig.customLabel||"Surovina k Těžbě"]}),e.jsxs("p",{className:"text-lg font-mono font-bold text-white uppercase leading-none",children:[t.resourceConfig.resourceName," ",e.jsxs("span",{className:"text-orange-500 text-sm",children:["x",t.resourceConfig.resourceAmount]})]}),e.jsx("p",{className:"text-[8px] text-zinc-500 font-mono mt-1",children:"Lze použít pro crafting nebo prodej."})]})]}),t.stats&&t.stats.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.stats.map((V,W)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs(C.button,{onClick:()=>J(V.label),className:`bg-white/5 border p-3 rounded-xl flex flex-col items-center transition-all ${ee===V.label?"border-signal-cyan bg-signal-cyan/5":"border-white/10"}`,children:[e.jsx("span",{className:"text-[9px] uppercase font-bold text-zinc-400",children:V.label}),e.jsx("span",{className:`text-lg font-black font-mono ${re(V.label)}`,children:V.value})]}),z(V.label,V.value)]},W))}),e.jsxs("div",{className:"flex justify-between items-center bg-zinc-900 p-3 rounded-lg border border-zinc-700",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-400 uppercase",children:"Tržní Hodnota"}),e.jsxs("div",{className:"flex items-center gap-2 text-yellow-500",children:[e.jsx(ke,{className:"w-4 h-4"}),e.jsx("span",{className:"font-mono font-bold text-lg",children:t.price??50})]})]})]})};return e.jsx(C.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:1.05,y:-20},className:"fixed inset-0 z-[150] bg-black/95 flex items-center justify-center p-6 backdrop-blur-md",children:e.jsxs("div",{className:`w-full max-w-sm ${K.bg} border-2 ${K.border} relative overflow-hidden flex flex-col shadow-2xl rounded-3xl max-h-[90vh]`,children:[e.jsxs("div",{className:"relative p-6 pb-4 z-10",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-32 bg-gradient-to-b from-white/10 to-transparent pointer-events-none"}),e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:`p-3 rounded-xl bg-black/40 border border-white/10 backdrop-blur-sm ${K.text}`,children:K.icon}),e.jsx("button",{onClick:s,className:"p-2 text-white/30 hover:text-white transition-colors bg-black/20 rounded-full",children:e.jsx(Ae,{className:"w-6 h-6"})})]}),e.jsx("span",{className:`text-[9px] font-mono font-bold uppercase tracking-[0.3em] block mb-1 flex items-center gap-2 ${t.dilemmaScope==="GLOBAL"?"text-purple-400 animate-pulse":"text-white/30"}`,children:I?t.dilemmaScope==="GLOBAL"?e.jsxs(e.Fragment,{children:[e.jsx(pt,{className:"w-3 h-3"})," GLOBÁLNÍ KŘIŽOVATKA"]}):"TAKTICKÉ ROZHODNUTÍ":`${t.type}`}),e.jsx("h2",{className:`text-3xl font-black uppercase tracking-tighter leading-none font-sans ${K.text} drop-shadow-md`,children:t.title}),!I&&e.jsx("div",{className:`inline-block mt-2 px-2 py-0.5 text-[8px] font-bold uppercase tracking-widest border rounded ${K.border} ${K.text} bg-black/40`,children:t.rarity})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar px-6 pb-6 relative z-10",children:[e.jsxs("div",{className:"mb-6 relative",children:[e.jsx("div",{className:`absolute top-0 left-0 w-1 h-full ${K.accent} opacity-50`}),e.jsxs("p",{className:"pl-4 text-xs text-zinc-300 italic leading-relaxed font-serif opacity-90",children:['"',t.description,'"']})]}),!I&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:[t.type===H.TRAP&&e.jsx(rn,{event:t,onClose:s,onPlayerDamage:d,playerClass:j,onClaimLoot:E}),p&&e.jsx(nn,{event:t,onClose:s,playerHp:b,playerArmor:x,onArmorChange:g,onPlayerDamage:d,inventory:u,onUseItem:f,onClaimLoot:E}),t.type===H.MERCHANT&&me(),t.type===H.PLANET&&q(),(t.type===H.ITEM||t.type==="PŘEDMĚT")&&he(),t.type===H.SPACE_STATION&&Y()]}),I&&k==="CHOICE"&&e.jsxs("div",{className:"space-y-4 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ra,{className:"w-4 h-4 text-purple-400 animate-pulse"}),e.jsx("p",{className:"text-[10px] font-bold text-purple-400 uppercase tracking-[0.2em]",children:"Analýza Rozcestí"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:(fe=t.dilemmaOptions)==null?void 0:fe.map((M,V)=>e.jsxs("button",{onClick:()=>ne(M),className:"relative group p-0 overflow-hidden rounded-xl border border-purple-500/30 bg-purple-900/10 hover:border-purple-400 hover:bg-purple-900/20 transition-all active:scale-[0.98]",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-50",children:e.jsx(la,{className:"w-12 h-12 text-purple-500/20 group-hover:text-purple-400/30 transition-colors"})}),e.jsxs("div",{className:"p-4 flex flex-col items-start relative z-10",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsxs("span",{className:"text-[9px] font-black text-zinc-500 uppercase tracking-widest mb-1 group-hover:text-purple-300",children:["TRASA ",String.fromCharCode(65+V)]}),M.successChance!==void 0&&M.successChance<100&&e.jsxs("span",{className:"text-[9px] font-bold text-zinc-500 flex items-center gap-1",children:[e.jsx(ia,{className:"w-3 h-3"})," ",M.successChance,"%"]})]}),e.jsx("span",{className:"text-sm font-bold text-white uppercase tracking-wider text-left w-full",children:M.label})]}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-purple-500/20 group-hover:bg-purple-400 transition-colors"})]},V))})]}),I&&k==="RESULT"&&e.jsxs("div",{className:"space-y-6 mt-4 animate-in slide-in-from-right-8 duration-300",children:[e.jsxs("div",{className:`p-5 rounded-2xl border relative overflow-hidden ${T==="success"?"bg-purple-900/20 border-purple-500/30":"bg-red-900/20 border-red-500/30"}`,children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-white/5 rounded-bl-full pointer-events-none"}),e.jsxs("div",{className:`flex items-center gap-2 mb-3 ${T==="success"?"text-purple-400":"text-red-400"}`,children:[T==="success"?e.jsx(wt,{className:"w-4 h-4"}):e.jsx(ut,{className:"w-4 h-4"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:T==="success"?"Taktický Důsledek":"Selhání Operace"})]}),e.jsx("p",{className:"text-sm text-white font-medium leading-relaxed",children:T==="success"?w==null?void 0:w.consequenceText:(w==null?void 0:w.failMessage)||"Akce selhala."}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[T==="success"&&((U=w==null?void 0:w.rewards)==null?void 0:U.map((M,V)=>e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border bg-green-500/10 border-green-500/30 text-green-400",children:[M.type==="HP"?e.jsx(Ve,{className:"w-3 h-3"}):M.type==="GOLD"?e.jsx(ke,{className:"w-3 h-3"}):e.jsx(Fe,{className:"w-3 h-3"}),e.jsxs("span",{children:["+",M.value," ",M.type]})]},V))),T==="success"&&!(w!=null&&w.rewards)&&(w==null?void 0:w.effectType)&&w.effectType!=="none"&&e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border ${(w.effectValue??0)>0?"bg-green-500/10 border-green-500/30 text-green-400":"bg-red-500/10 border-red-500/30 text-red-400"}`,children:[w.effectType==="hp"?e.jsx(Ve,{className:"w-3 h-3"}):e.jsx(ke,{className:"w-3 h-3"}),e.jsxs("span",{children:[(w.effectValue??0)>0?"+":"",w.effectValue," ",w.effectType.toUpperCase()]})]}),T==="fail"&&(w!=null&&w.failDamage)?e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border bg-red-500/10 border-red-500/30 text-red-400",children:[e.jsx(ut,{className:"w-3 h-3"}),e.jsxs("span",{children:["-",w.failDamage," HP"]})]}):null]})]}),(w==null?void 0:w.physicalInstruction)&&e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-signal-amber to-transparent opacity-30 blur rounded-lg"}),e.jsxs("div",{className:"relative bg-black border-l-4 border-signal-amber p-4 rounded-r-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-signal-amber mb-2",children:[e.jsx(ca,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.3em]",children:"Rozkaz pro Desku"})]}),e.jsx("p",{className:"text-xs text-white font-mono font-bold leading-relaxed uppercase",children:w.physicalInstruction})]})]})]})]}),e.jsxs("div",{className:"p-4 bg-black/60 border-t border-white/5 flex flex-col gap-2 relative z-10 backdrop-blur-md",children:[e.jsxs("div",{className:"flex gap-3",children:[c&&k!=="RESULT"&&!I&&!((Oe=t.resourceConfig)!=null&&Oe.isResourceContainer)&&!t.isSellOnly&&!p&&!o&&t.type!==H.PLANET&&e.jsx("button",{onClick:c,className:`flex-1 py-4 text-black font-black uppercase text-[11px] tracking-[0.2em] hover:brightness-110 active:scale-95 transition-all font-mono rounded-xl shadow-lg ${K.accent}`,children:t.type===H.MERCHANT?"OTEVŘÍT OBCHOD":t.type===H.SPACE_STATION?"Dokovat a Doplnit":"Použít"}),k==="RESULT"&&I&&e.jsxs("button",{onClick:s,className:"w-full py-4 bg-purple-600 hover:bg-purple-500 text-white font-black uppercase text-[11px] tracking-[0.2em] active:scale-95 transition-all rounded-xl shadow-lg shadow-purple-500/20 flex items-center justify-center gap-2",children:["Pokračovat v Misi ",e.jsx(Qe,{className:"w-4 h-4"})]}),O&&m&&!r?e.jsx("button",{onClick:m,className:`flex-1 py-4 border ${(Me=t.resourceConfig)!=null&&Me.isResourceContainer?"border-orange-500 text-orange-500 bg-orange-950/20 hover:bg-orange-900/40":"border-white/20 text-white hover:bg-white/5"} font-black uppercase text-[11px] tracking-[0.2em] active:scale-95 transition-all font-mono rounded-xl flex items-center justify-center gap-2`,children:(Pe=t.resourceConfig)!=null&&Pe.isResourceContainer?e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"w-4 h-4"})," Vytěžit"]}):"Uložit"}):r&&!p&&!o&&(((Le=t.resourceConfig)==null?void 0:Le.isResourceContainer)||t.type===H.PLANET||t.isSellOnly)&&e.jsxs("div",{className:"flex-1 py-4 border border-white/10 bg-white/5 text-zinc-500 font-black uppercase text-[11px] tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 cursor-default",children:[e.jsx(Ze,{className:"w-4 h-4"})," VLASTNĚNO"]})]}),r&&a&&!I&&!p&&!o&&e.jsxs("button",{onClick:te,className:`w-full py-3 border ${Z?"bg-red-900/80 border-red-500 text-white":"border-white/5 bg-transparent text-zinc-500"} font-black uppercase text-[10px] tracking-[0.2em] active:scale-95 transition-all font-mono rounded-xl flex items-center justify-center gap-2`,children:[e.jsx(ds,{className:"w-3 h-3"})," ",Z?"POTVRDIT ZAHOZENÍ":"Zahodit"]})]})]})})},cn=({onComplete:t})=>{const[s,m]=n.useState("approach"),[a,c]=n.useState(8500),[i,r]=n.useState(34),[d,b]=n.useState([]);return n.useEffect(()=>{const x=setInterval(()=>{const g=Math.random().toString(16).substr(2,8).toUpperCase();b(j=>[`SYS_DAT: 0x${g}`,...j.slice(0,6)])},150);return()=>clearInterval(x)},[]),n.useEffect(()=>{N("open");const x=setInterval(()=>{c(g=>Math.max(0,g-150))},30);return setTimeout(()=>{m("align"),N("scan");const g=setInterval(()=>{r(j=>Math.min(100,j+2))},50);setTimeout(()=>clearInterval(g),2e3)},2e3),setTimeout(()=>{m("dock"),clearInterval(x),c(0),r(100),N("error"),Q([80,50,80,50])},4e3),setTimeout(()=>{m("flash"),N("success")},4800),setTimeout(()=>{t()},5500),()=>clearInterval(x)},[]),e.jsxs("div",{className:"fixed inset-0 z-[2000] bg-black overflow-hidden flex flex-col items-center justify-center font-mono cursor-none select-none",children:[e.jsxs("div",{className:"absolute inset-0 perspective-1000",children:[e.jsx(C.div,{className:"absolute bottom-0 left-[-50%] right-[-50%] h-[50vh] bg-[linear-gradient(transparent_0%,rgba(0,242,255,0.2)_1px,transparent_1px),linear-gradient(90deg,transparent_0%,rgba(0,242,255,0.2)_1px,transparent_1px)]",style:{backgroundSize:"100px 100px",transform:"rotateX(60deg)",transformOrigin:"bottom"},animate:{backgroundPositionY:["0px","1000px"]},transition:{duration:s==="approach"?1:5,repeat:1/0,ease:"linear"}}),s==="approach"&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:[...Array(8)].map((x,g)=>e.jsx(C.div,{className:"absolute w-0.5 h-1/2 bg-cyan-500/50",style:{left:`${50+(Math.random()*80-40)}%`,top:"50%",transformOrigin:"top"},animate:{scaleY:[0,2],opacity:[0,1,0],rotate:Math.random()*60-30},transition:{duration:.4,repeat:1/0,delay:Math.random()*.5}},g))})]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center w-full h-full",children:[e.jsxs(C.div,{initial:{scale:.1,opacity:0},animate:{scale:s==="approach"?.4:s==="align"?.9:1.2,opacity:1,rotate:s==="dock"?0:15},transition:{duration:4.5,ease:"circIn"},className:"relative",children:[e.jsx(ht,{className:"w-64 h-64 text-zinc-300 drop-shadow-[0_0_50px_rgba(0,242,255,0.2)]",strokeWidth:.5}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:[1,2,3].map(x=>e.jsx(C.div,{className:"absolute border border-cyan-500/30 rounded-full",style:{width:"100%",height:"100%"},animate:{scale:[.5,2],opacity:[0,1,0]},transition:{duration:2,repeat:1/0,delay:x*.6,ease:"linear"}},x))})]}),e.jsxs(C.div,{className:"absolute inset-0 pointer-events-none",animate:s==="dock"?{x:[-5,5,-5,5,0],y:[-5,5,-5,5,0]}:{},transition:{duration:.4},children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:`relative transition-all duration-500 ${s==="dock"?"scale-90":"scale-100"}`,children:[e.jsx("div",{className:"w-[280px] h-[280px] border border-cyan-500/30 rounded-full flex items-center justify-center border-dashed animate-spin-slow"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(os,{className:`w-8 h-8 ${i===100?"text-green-500":"text-red-500"}`})}),e.jsxs("div",{className:"absolute top-[-40px] left-1/2 -translate-x-1/2 text-center w-full",children:[e.jsx("div",{className:"text-[10px] font-black text-cyan-500 uppercase tracking-widest bg-black/50 px-2",children:i<100?"KALIBRACE VEKTORU":"ZAMĚŘENO"}),e.jsxs("div",{className:"text-xl font-bold text-white font-mono",children:[i,"%"]})]})]})}),e.jsxs("div",{className:"absolute top-12 w-full px-6 flex justify-between items-start",children:[e.jsxs("div",{className:"bg-black/60 border-l-4 border-cyan-500 p-2 pl-4 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-cyan-400 mb-1",children:[e.jsx(us,{className:"w-4 h-4 animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"NEXUS_LINK"})]}),e.jsx("div",{className:"text-xs text-white font-bold uppercase",children:"Signál: SILNÝ"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-black text-white font-mono tracking-tighter tabular-nums",children:[Math.floor(a),e.jsx("span",{className:"text-sm text-zinc-500 ml-1",children:"m"})]}),e.jsx("div",{className:"text-[10px] font-bold text-red-500 uppercase tracking-widest animate-pulse",children:s==="approach"?"PŘIBLIŽOVÁNÍ >>":s==="align"?"BRZDĚNÍ...":"KONTAKT"})]})]}),e.jsxs("div",{className:"absolute left-6 bottom-24 w-40 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 text-zinc-500 mb-2 border-b border-zinc-800 pb-1",children:[e.jsx(_t,{className:"w-3 h-3"}),e.jsx("span",{className:"text-[8px] font-black uppercase",children:"Telemetrie"})]}),e.jsx("div",{className:"space-y-1 font-mono text-[9px] text-cyan-500/70 h-24 flex flex-col-reverse opacity-80",children:d.map((x,g)=>e.jsx(C.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},children:x},g))})]}),e.jsxs("div",{className:"absolute right-6 bottom-24 w-32 text-right space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[8px] font-bold text-zinc-500 uppercase block mb-1",children:"Tlak Kabiny"}),e.jsx("div",{className:"w-full bg-zinc-800 h-1.5 rounded-full overflow-hidden",children:e.jsx(C.div,{className:"h-full bg-green-500",initial:{width:"90%"},animate:{width:["90%","92%","89%"]},transition:{repeat:1/0,duration:2}})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[8px] font-bold text-zinc-500 uppercase block mb-1",children:"Integrita Pláště"}),e.jsx("div",{className:"w-full bg-zinc-800 h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-cyan-500 w-full"})})]}),e.jsx("div",{className:"pt-2",children:s==="dock"||s==="flash"?e.jsxs("div",{className:"flex items-center justify-end gap-2 text-green-500",children:[e.jsx(yt,{className:"w-4 h-4"})," ",e.jsx("span",{className:"font-black text-xs uppercase",children:"ZAMČENO"})]}):e.jsxs("div",{className:"flex items-center justify-end gap-2 text-yellow-500",children:[e.jsx(xa,{className:"w-4 h-4 animate-bounce"})," ",e.jsx("span",{className:"font-black text-xs uppercase",children:"DOKOVÁNÍ"})]})})]}),e.jsxs("div",{className:"absolute bottom-10 left-10 right-10 flex flex-col items-center",children:[e.jsx("div",{className:"w-full max-w-md bg-zinc-900/50 h-2 rounded-full overflow-hidden border border-zinc-800",children:e.jsx(C.div,{className:`h-full ${s==="dock"?"bg-green-500":"bg-red-500"}`,animate:{width:s==="approach"?"80%":s==="align"?"20%":"0%"},transition:{duration:.5}})}),e.jsxs("div",{className:"flex justify-between w-full max-w-md mt-1 text-[8px] font-bold text-zinc-600 uppercase tracking-widest",children:[e.jsx("span",{children:"Rychlost"}),e.jsx("span",{children:s==="approach"?"850 m/s":s==="align"?"120 m/s":"0 m/s"})]})]})]})]}),s==="flash"&&e.jsx(C.div,{className:"absolute inset-0 bg-white z-[2100]",initial:{opacity:0},animate:{opacity:1},transition:{duration:.2,ease:"easeIn"}})]})},on=({inventory:t,masterCatalog:s,onClose:m,onCraft:a})=>{var D,Z,le,ee;const c=t.filter(L=>{var p;return(p=L.resourceConfig)==null?void 0:p.isResourceContainer}),i=s.filter(L=>L.craftingRecipe&&L.craftingRecipe.enabled===!0),[r,d]=n.useState(null),[b,x]=n.useState(!1),[g,j]=n.useState(0),[u,f]=n.useState(0),E=n.useRef(null);n.useEffect(()=>()=>{E.current&&clearInterval(E.current)},[]);const k=L=>{b||(N("click"),d(L),j(0),f(0))},X=L=>c.reduce((p,o)=>{var O;return((O=o.resourceConfig)==null?void 0:O.resourceName)===L?p+(o.resourceConfig.resourceAmount||0):p},0),w=L=>{var p;return(p=L.craftingRecipe)!=null&&p.requiredResources?L.craftingRecipe.requiredResources.every(o=>X(o.resourceName)>=o.amount):!0},A=()=>{var J;if(!r||!a)return;if(!w(r)){N("error");return}x(!0),N("scan"),Q([50,100,50]);const L=((J=r.craftingRecipe)==null?void 0:J.craftingTimeSeconds)||10,p=L*1e3,o=50;let O=0;f(L),j(0),E.current=setInterval(()=>{O+=o;const re=Math.min(100,O/p*100),$=Math.max(0,L-O/1e3);j(re),f($),O>=p&&(clearInterval(E.current),T())},o)},T=()=>{!r||!a||(a(r),N("success"),Q([50,50,50]),x(!1),j(0),f(0),d(null))};return e.jsxs("div",{className:"fixed inset-0 z-[250] bg-zinc-950 text-white flex flex-col font-sans overflow-hidden",children:[e.jsxs("header",{className:"bg-zinc-900 border-b border-orange-500/30 p-4 flex justify-between items-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"repeating-linear-gradient(45deg, #000 0, #000 10px, #f97316 10px, #f97316 20px)"}}),e.jsxs("div",{className:"flex items-center gap-3 relative z-10 text-orange-500",children:[e.jsx("div",{className:"p-2 bg-orange-500/10 border border-orange-500/30 rounded",children:e.jsx(Be,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black uppercase tracking-widest leading-none text-white",children:"Výrobní Modul"}),e.jsx("p",{className:"text-[9px] font-mono font-bold uppercase tracking-[0.3em]",children:"Sekce: FAB-01"})]})]}),e.jsx("button",{onClick:m,disabled:b,className:`p-2 relative z-10 bg-zinc-800 rounded-full hover:bg-zinc-700 transition-colors ${b?"opacity-50 cursor-not-allowed":""}`,children:e.jsx(Ae,{className:"w-6 h-6 text-zinc-400"})})]}),e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden relative",children:[e.jsxs("div",{className:"flex-1 border-b md:border-b-0 md:border-r border-zinc-800 bg-zinc-950/50 flex flex-col min-h-[40%] md:min-h-full",children:[e.jsxs("div",{className:"p-3 bg-zinc-900/50 border-b border-zinc-800 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-500 flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4"})," Sklad Surovin"]}),e.jsxs("span",{className:"text-[9px] font-mono text-zinc-600",children:[c.length," jednotek"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 grid grid-cols-2 md:grid-cols-2 gap-3 content-start",children:c.length===0?e.jsxs("div",{className:"col-span-2 text-center py-10 opacity-30 flex flex-col items-center",children:[e.jsx(Ze,{className:"w-12 h-12 mb-2"}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"Sklad prázdný"})]}):c.map((L,p)=>{var o;return e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 p-3 rounded-lg flex flex-col items-center justify-center gap-1 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-orange-600/50"}),e.jsx(Be,{className:"w-5 h-5 text-orange-500/50 mb-1"}),e.jsx("span",{className:"text-xs font-bold text-white uppercase text-center leading-tight line-clamp-2",children:L.title}),e.jsxs("span",{className:"text-[10px] font-mono text-orange-400 bg-orange-950/30 px-2 py-0.5 rounded border border-orange-500/20",children:["x",((o=L.resourceConfig)==null?void 0:o.resourceAmount)||1]})]},p)})})]}),e.jsxs("div",{className:"flex-[1.5] bg-black flex flex-col",children:[e.jsxs("div",{className:"p-3 bg-zinc-900/50 border-b border-zinc-800 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-500 flex items-center gap-2",children:[e.jsx(At,{className:"w-4 h-4"})," Databáze Schémat"]}),e.jsx("span",{className:"text-[9px] font-mono text-zinc-600",children:"Admin_Vault Access"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:i.length===0?e.jsx("div",{className:"text-center py-10 text-zinc-600 font-mono text-xs uppercase",children:"Žádná schémata k dispozici."}):i.map(L=>e.jsxs("button",{onClick:()=>k(L),className:"w-full text-left bg-zinc-900/40 border border-zinc-800 hover:border-orange-500/50 hover:bg-zinc-900 p-3 rounded-xl flex items-center gap-4 transition-all active:scale-[0.98] group",children:[e.jsx("div",{className:"w-10 h-10 bg-black border border-zinc-700 rounded-lg flex items-center justify-center group-hover:border-orange-500/50 transition-colors",children:e.jsx(ma,{className:"w-5 h-5 text-zinc-500 group-hover:text-orange-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h4",{className:"text-xs font-bold text-white uppercase tracking-wider",children:L.title}),e.jsx("span",{className:"text-[9px] font-mono text-zinc-500",children:L.rarity})]}),e.jsx("p",{className:"text-[9px] text-zinc-500 line-clamp-1 italic",children:L.description})]})]},L.id))})]})]}),e.jsx(ce,{children:r&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-black/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(C.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-zinc-900 border border-orange-500/50 w-full max-w-sm rounded-2xl p-6 relative shadow-[0_0_50px_rgba(249,115,22,0.15)] flex flex-col max-h-[90vh]",children:[!b&&e.jsx("button",{onClick:()=>d(null),className:"absolute top-4 right-4 text-zinc-500 hover:text-white",children:e.jsx(Ae,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[e.jsx("div",{className:"w-20 h-20 bg-black border-2 border-orange-500/30 rounded-xl flex items-center justify-center mb-4 relative overflow-hidden",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-orange-500/20 z-0",style:{height:`${g}%`,bottom:0,top:"auto",transition:"height 0.1s linear"}}),e.jsxs("span",{className:"relative z-10 text-xl font-black text-white",children:[u.toFixed(1),"s"]})]}):e.jsx(pa,{className:"w-8 h-8 text-orange-500"})}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter mb-1",children:r.title}),!b&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-orange-400 bg-orange-950/20 px-3 py-1 rounded-full border border-orange-500/20",children:[e.jsx(ua,{className:"w-3 h-3"}),e.jsxs("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:["Čas výroby: ",((D=r.craftingRecipe)==null?void 0:D.craftingTimeSeconds)||10,"s"]})]})]}),e.jsxs("div",{className:"p-4 bg-black/40 rounded-xl border border-zinc-800 mb-6 flex-1 overflow-y-auto",children:[e.jsx("p",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-3 tracking-widest border-b border-zinc-800 pb-2",children:"Požadované Suroviny"}),e.jsxs("div",{className:"space-y-2",children:[(le=(Z=r.craftingRecipe)==null?void 0:Z.requiredResources)==null?void 0:le.map((L,p)=>{const o=X(L.resourceName),O=o>=L.amount;return e.jsxs("div",{className:"flex justify-between items-center bg-zinc-900/50 p-2 rounded",children:[e.jsx("span",{className:"text-xs text-zinc-300 font-mono",children:L.resourceName}),e.jsxs("div",{className:`flex items-center gap-2 text-xs font-mono font-bold ${O?"text-green-500":"text-red-500"}`,children:[e.jsxs("span",{children:[o," / ",L.amount]}),O?e.jsx(We,{className:"w-3 h-3"}):e.jsx(_e,{className:"w-3 h-3"})]})]},p)}),(!((ee=r.craftingRecipe)!=null&&ee.requiredResources)||r.craftingRecipe.requiredResources.length===0)&&e.jsx("p",{className:"text-center text-zinc-600 text-xs italic",children:"Žádné suroviny nejsou potřeba."})]})]}),b?e.jsxs("div",{className:"w-full bg-zinc-800 rounded-full h-4 overflow-hidden border border-zinc-700 relative",children:[e.jsx(C.div,{className:"h-full bg-orange-500",style:{width:`${g}%`},transition:{duration:.1,ease:"linear"}}),e.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[8px] font-black uppercase text-white drop-shadow-md",children:"Fabrikace..."})]}):e.jsx("button",{onClick:A,disabled:!w(r),className:`w-full py-4 font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 transition-all ${w(r)?"bg-orange-600 hover:bg-orange-500 text-white shadow-lg shadow-orange-500/20":"bg-zinc-800 text-zinc-600 cursor-not-allowed border border-zinc-700"}`,children:w(r)?"VYROBIT PŘEDMĚT":"NEDOSTATEK SUROVIN"})]})})})]})},dn=({onClose:t,masterCatalog:s,inventory:m,playerGold:a,playerClass:c,onBuy:i,onRecycle:r})=>{const[d,b]=n.useState("BUY"),[x,g]=n.useState(null),[j,u]=n.useState(!1),[f,E]=n.useState("ALL");n.useEffect(()=>{N("open")},[]);const k=n.useMemo(()=>{const p={};return s.forEach(o=>{var O;if((O=o.marketConfig)!=null&&O.saleChance){const J=Math.random()*100;p[o.id]=J<=o.marketConfig.saleChance}}),p},[s]),X=n.useMemo(()=>{let p=s.filter(o=>{var O;return(O=o.marketConfig)==null?void 0:O.enabled});return f!=="ALL"&&(p=p.filter(o=>o.type===f)),p},[s,f]),w=n.useMemo(()=>m.filter(p=>{var o;return((o=p.marketConfig)==null?void 0:o.recyclingOutput)&&p.marketConfig.recyclingOutput.length>0}),[m]),A=p=>{var ne,te;const o=p.price??100;let O=o,J=null;const re=k[p.id]||!1;if(re&&((ne=p.marketConfig)!=null&&ne.marketPrice&&p.marketConfig.marketPrice>0?O=p.marketConfig.marketPrice:O=Math.floor(o*.7)),c&&((te=p.marketConfig)!=null&&te.classModifiers)){const y=p.marketConfig.classModifiers.find(K=>K.playerClass===c);y&&(O=Math.floor(O*y.priceMultiplier),y.priceMultiplier<1?J=`BONUS: ${c}`:y.priceMultiplier>1&&(J=`PŘIRÁŽKA: ${c}`))}return{finalPrice:Math.max(1,O),basePrice:o,discountLabel:J,isOnSale:re}},T=p=>{var o;return(o=p.marketConfig)!=null&&o.recyclingOutput?p.marketConfig.recyclingOutput.map(O=>{const J=s.find(re=>{var $;return(($=re.resourceConfig)==null?void 0:$.isResourceContainer)&&re.resourceConfig.resourceName===O.resourceName||re.title===O.resourceName});return J?{resource:J,amount:O.amount}:null}).filter(O=>O!==null):[]},D=()=>{if(!(!x||j))if(u(!0),d==="BUY"){const{finalPrice:p}=A(x);if(a<p){N("error"),u(!1);return}N("success"),Q([50,50]),setTimeout(()=>{i(x,p),u(!1),g(null)},1e3)}else{const p=T(x);N("damage"),Q([100,50,200]),setTimeout(()=>{r(x,p),u(!1),g(null),N("success")},1500)}},Z=p=>{const o=p.toUpperCase();return o.includes("HP")||o.includes("ZDRAVÍ")?e.jsx(Ve,{className:"w-3 h-3 text-red-500"}):o.includes("MANA")||o.includes("ENERGIE")?e.jsx(Fe,{className:"w-3 h-3 text-blue-400"}):o.includes("DMG")||o.includes("ÚTOK")?e.jsx(jt,{className:"w-3 h-3 text-orange-500"}):o.includes("DEF")||o.includes("OBRANA")?e.jsx($e,{className:"w-3 h-3 text-slate-300"}):e.jsx(Re,{className:"w-3 h-3 text-zinc-400"})},le="text-yellow-500",ee="border-yellow-500/30";return e.jsxs("div",{className:"fixed inset-0 z-[250] bg-zinc-950 text-white flex flex-col font-sans overflow-hidden",children:[e.jsxs("header",{className:`bg-zinc-900 border-b ${ee} p-4 flex justify-between items-center relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"repeating-linear-gradient(45deg, #000 0, #000 10px, #eab308 10px, #eab308 20px)"}}),e.jsxs("div",{className:`flex items-center gap-3 relative z-10 ${le}`,children:[e.jsx("div",{className:`p-2 bg-yellow-950/20 border ${ee} rounded`,children:e.jsx(St,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black uppercase tracking-widest leading-none text-white",children:"Obchodní Terminál"}),e.jsx("p",{className:"text-[9px] font-mono font-bold uppercase tracking-[0.3em] text-zinc-400",children:"SEKTOR MARKET_V2"})]})]}),e.jsx("button",{onClick:t,className:"p-2 relative z-10 bg-zinc-800 rounded-full hover:bg-zinc-700 transition-colors",children:e.jsx(Ae,{className:"w-6 h-6 text-zinc-400"})})]}),e.jsxs("div",{className:"flex flex-col border-b border-zinc-800",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-zinc-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-black border border-yellow-500/30 rounded-lg shadow-[0_0_15px_rgba(234,179,8,0.1)]",children:[e.jsx(ke,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"text-xl font-mono font-bold text-white",children:a})]}),e.jsxs("div",{className:"flex bg-black rounded-lg p-1 border border-zinc-800",children:[e.jsx("button",{onClick:()=>{b("BUY"),N("click")},className:`px-6 py-2 rounded-md text-xs font-bold uppercase tracking-wider transition-all ${d==="BUY"?"bg-yellow-600 text-black shadow-lg":"text-zinc-500 hover:text-white"}`,children:"Nákup"}),e.jsx("button",{onClick:()=>{b("RECYCLE"),N("click")},className:`px-6 py-2 rounded-md text-xs font-bold uppercase tracking-wider transition-all ${d==="RECYCLE"?"bg-orange-600 text-white shadow-lg":"text-zinc-500 hover:text-white"}`,children:"Drtička"})]})]}),d==="BUY"&&e.jsxs("div",{className:"flex gap-2 p-2 px-4 bg-black overflow-x-auto no-scrollbar border-b border-zinc-800",children:[e.jsx(ha,{className:"w-4 h-4 text-zinc-600 my-auto mr-2"}),["ALL","PŘEDMĚT","SUROVINA"].map(p=>e.jsx("button",{onClick:()=>E(p),className:`px-3 py-1 rounded text-[10px] font-bold uppercase border transition-colors whitespace-nowrap ${f===p?"border-yellow-500 text-yellow-500 bg-yellow-950/20":"border-zinc-800 text-zinc-500"}`,children:p==="ALL"?"Vše":p},p))]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-zinc-950 relative",children:d==="BUY"?X.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full opacity-30",children:[e.jsx(St,{className:"w-16 h-16 mb-4 text-zinc-500"}),e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-zinc-500",children:"Sklad vyprodán"})]}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:X.map(p=>{const{finalPrice:o,basePrice:O,discountLabel:J,isOnSale:re}=A(p),$=a>=o,ne=o<O;return e.jsxs("button",{onClick:()=>{g(p),N("click")},className:`relative flex flex-col text-left p-3 rounded-xl border transition-all active:scale-95 group ${$?"bg-zinc-900 border-zinc-800 hover:border-yellow-500/50":"bg-zinc-900/50 border-red-900/30 opacity-70"}`,children:[re&&e.jsx("div",{className:"absolute top-2 right-2 bg-pink-600 text-white text-[8px] font-black px-1.5 py-0.5 rounded uppercase tracking-wider animate-pulse shadow-[0_0_10px_#db2777]",children:"AKCE"}),e.jsx("div",{className:"mb-2 p-3 bg-black rounded-lg border border-zinc-800 self-start group-hover:border-yellow-500/30 transition-colors",children:e.jsx(De,{className:`w-6 h-6 ${$?"text-zinc-200":"text-red-900"}`})}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("h4",{className:"text-xs font-bold text-white uppercase line-clamp-1 mb-1",children:p.title}),p.stats&&p.stats.length>0&&e.jsx("div",{className:"grid grid-cols-1 gap-1 mb-2",children:p.stats.slice(0,3).map((te,y)=>e.jsxs("div",{className:"flex items-center justify-between text-[9px] bg-white/5 px-1.5 py-0.5 rounded border border-white/5",children:[e.jsxs("span",{className:"text-zinc-400 font-bold uppercase flex items-center gap-1",children:[Z(te.label)," ",te.label.substring(0,3)]}),e.jsx("span",{className:"text-white font-mono font-bold",children:te.value})]},y))})]}),e.jsxs("div",{className:"mt-auto pt-2 border-t border-zinc-800 w-full",children:[J&&e.jsx("span",{className:"text-[8px] text-green-500 font-bold uppercase block mb-1",children:J}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:`flex items-center gap-1 font-mono font-bold ${$?"text-yellow-500":"text-red-500"}`,children:[e.jsx("span",{children:o}),e.jsx(ke,{className:"w-3 h-3"})]}),ne&&e.jsx("span",{className:"text-[9px] text-zinc-600 line-through decoration-red-500 font-mono",children:O})]})]})]},p.id)})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-orange-900/10 border border-orange-500/20 rounded-lg flex items-center gap-3 mb-4",children:[e.jsx(fa,{className:"w-5 h-5 text-orange-500"}),e.jsx("p",{className:"text-[10px] text-zinc-400 font-mono leading-tight",children:"Vložte nepotřebné předměty do drtičky a získejte suroviny pro výrobu."})]}),w.length===0?e.jsxs("div",{className:"text-center py-10 opacity-30",children:[e.jsx(ga,{className:"w-12 h-12 mx-auto mb-2"}),e.jsx("p",{className:"text-xs font-bold uppercase",children:"Žádný recyklovatelný odpad"})]}):w.map(p=>e.jsxs("button",{onClick:()=>{g(p),N("click")},className:"w-full flex items-center gap-4 p-3 bg-zinc-900 border border-zinc-800 hover:border-orange-500/50 rounded-xl transition-all active:scale-95 group text-left",children:[e.jsx("div",{className:"p-2 bg-black border border-zinc-700 rounded text-zinc-500 group-hover:text-orange-500 transition-colors",children:e.jsx(De,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-bold text-white uppercase",children:p.title}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:T(p).map((o,O)=>e.jsxs("span",{className:"text-[9px] bg-orange-950/30 text-orange-400 px-1.5 py-0.5 rounded border border-orange-500/20",children:["+",o.amount," ",o.resource.title]},O))})]}),e.jsx(Qe,{className:"w-4 h-4 text-zinc-600 group-hover:text-orange-500"})]},p.id))]})}),e.jsx(ce,{children:x&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-black/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(C.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:`bg-zinc-900 border w-full max-w-sm rounded-2xl p-6 relative shadow-2xl flex flex-col ${d==="BUY"?"border-yellow-500/50":"border-orange-500/50"}`,children:[e.jsx("button",{onClick:()=>g(null),className:"absolute top-4 right-4 text-zinc-500 hover:text-white",children:e.jsx(Ae,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[e.jsx("div",{className:`w-20 h-20 bg-black border-2 rounded-xl flex items-center justify-center mb-4 ${d==="BUY"?"border-yellow-500/30 text-yellow-500":"border-orange-500/30 text-orange-500"}`,children:d==="BUY"?e.jsx(De,{className:"w-10 h-10"}):e.jsx(ds,{className:"w-10 h-10"})}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter mb-1",children:x.title}),e.jsx("p",{className:"text-[10px] font-mono text-zinc-500 uppercase",children:x.type})]}),d==="BUY"?e.jsxs("div",{className:"space-y-4",children:[x.stats&&x.stats.length>0&&e.jsxs("div",{className:"bg-white/5 p-3 rounded-lg border border-white/5 mb-2",children:[e.jsxs("p",{className:"text-[10px] font-bold text-zinc-400 uppercase mb-2 flex items-center gap-1",children:[e.jsx(Re,{className:"w-3 h-3"})," Statistiky Assetu"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:x.stats.map((p,o)=>e.jsxs("div",{className:"flex justify-between items-center bg-black px-2 py-1 rounded",children:[e.jsxs("span",{className:"text-[9px] text-zinc-500 font-bold uppercase flex items-center gap-1",children:[Z(p.label)," ",p.label]}),e.jsx("span",{className:"text-xs font-mono font-bold text-white",children:p.value})]},o))})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/40 p-4 rounded-xl border border-zinc-800",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-bold text-zinc-400 uppercase",children:"Cena"}),A(x).finalPrice<A(x).basePrice&&e.jsxs("span",{className:"text-[10px] text-zinc-600 line-through decoration-red-500 font-mono",children:[A(x).basePrice," GOLD"]})]}),e.jsxs("div",{className:`flex items-center gap-2 text-xl font-mono font-black ${a>=A(x).finalPrice?"text-yellow-500":"text-red-500"}`,children:[A(x).finalPrice," ",e.jsx(ke,{className:"w-5 h-5"})]})]}),a<A(x).finalPrice&&e.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-[10px] font-bold uppercase justify-center bg-red-950/20 p-2 rounded",children:[e.jsx(_e,{className:"w-3 h-3"})," Nedostatek prostředků"]})]}):e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("p",{className:"text-[10px] font-bold text-orange-500 uppercase tracking-widest mb-2 border-b border-orange-500/20 pb-1",children:"Získáte suroviny:"}),T(x).map((p,o)=>e.jsxs("div",{className:"flex justify-between items-center bg-orange-900/10 p-2 rounded border border-orange-500/20",children:[e.jsx("span",{className:"text-xs text-zinc-300 font-mono",children:p.resource.title}),e.jsxs("span",{className:"text-sm font-black text-white",children:["x",p.amount]})]},o))]}),e.jsx("button",{onClick:D,disabled:j||d==="BUY"&&a<A(x).finalPrice,className:`w-full py-4 mt-6 font-black uppercase text-xs tracking-[0.2em] rounded-xl flex items-center justify-center gap-2 transition-all ${j?"bg-zinc-800 text-zinc-500 cursor-not-allowed":d==="BUY"?a>=A(x).finalPrice?"bg-yellow-600 hover:bg-yellow-500 text-black shadow-lg shadow-yellow-500/20":"bg-zinc-800 text-zinc-600 cursor-not-allowed":"bg-orange-600 hover:bg-orange-500 text-white shadow-lg shadow-orange-500/20"}`,children:j?e.jsx("span",{className:"animate-pulse",children:"Zpracování..."}):d==="BUY"?e.jsxs(e.Fragment,{children:[a>=A(x).finalPrice?"POTVRDIT NÁKUP":"NEDOSTATEK KREDITŮ",e.jsx(hs,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["ROZEMLÍT PŘEDMĚT ",e.jsx(Be,{className:"w-4 h-4"})]})})]})})})]})},xn="admin_test_vault@nexus.local",mn=({station:t,onLeave:s,onClaimRewards:m,onCraft:a,inventory:c=[],masterCatalog:i=[],playerGold:r=0,playerClass:d=null,onInventoryUpdate:b,onGoldChange:x,isAdmin:g=!1,isTestMode:j=!1})=>{var ne,te,y,K;const[u,f]=n.useState(!0),[E,k]=n.useState(!1),[X,w]=n.useState(null),[A,T]=n.useState(!1),[D,Z]=n.useState(!1),[le,ee]=n.useState(!1);n.useEffect(()=>{N("open");const I=setTimeout(()=>f(!1),2e3);return()=>clearTimeout(I)},[]);const L=()=>{!A&&m&&(m(t),T(!0))},p=()=>{N("click"),k(!0)},o=()=>{k(!1),s()},O=I=>{N("error"),w(I),setTimeout(()=>w(null),2e3)},J=()=>g&&j?xn:localStorage.getItem("nexus_current_user"),re=async(I,z)=>{try{const q=J();q&&(x&&x(-Math.abs(z)),await ft(q,{...I,id:`BOUGHT-${Date.now()}`}),b&&b())}catch{}},$=async(I,z)=>{try{const q=J();if(q){await mt(q,I.id);for(const Y of z){const me={...Y.resource,id:`RES-${Date.now()}-${Math.random()}`,resourceConfig:{...Y.resource.resourceConfig,resourceAmount:Y.amount}};await ft(q,me)}b&&b()}}catch{}};return u?e.jsx("div",{className:"fixed inset-0 z-[200] bg-black flex items-center justify-center font-mono",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(ht,{className:"w-16 h-16 text-cyan-500 animate-pulse mx-auto"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-cyan-500 uppercase tracking-[0.2em] font-bold",children:"Iniciace Servisních Protokolů..."}),e.jsx("p",{className:"text-xl text-white font-black uppercase tracking-widest",children:t.title})]}),e.jsx("div",{className:"w-48 h-1 bg-zinc-800 rounded-full mx-auto overflow-hidden",children:e.jsx(C.div,{className:"h-full bg-cyan-500",initial:{width:0},animate:{width:"100%"},transition:{duration:1.5,ease:"easeInOut"}})})]})}):e.jsxs(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[200] bg-[#050608] text-white overflow-hidden flex flex-col font-sans",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-10",style:{backgroundImage:"linear-gradient(rgba(34, 211, 238, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(34, 211, 238, 0.1) 1px, transparent 1px)",backgroundSize:"40px 40px"}}),e.jsxs("header",{className:"relative z-10 bg-black/60 backdrop-blur-md border-b border-white/10 p-6 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-cyan-950/30 border border-cyan-500/50 rounded-lg flex items-center justify-center",children:e.jsx(ht,{className:"w-6 h-6 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black uppercase tracking-tighter leading-none",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsxs("span",{className:"text-[10px] font-mono text-cyan-500/80 uppercase tracking-widest",children:["Připojení Stabilní • ID: ",t.id]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[g&&j&&e.jsx("div",{className:"px-3 py-1 bg-orange-900/30 border border-orange-500/30 rounded text-[9px] font-bold uppercase text-orange-500 animate-pulse hidden md:block",children:"TESTOVACÍ REŽIM AKTIVNÍ"}),e.jsxs("div",{className:"text-right hidden md:block",children:[e.jsx("p",{className:"text-[10px] text-zinc-500 uppercase font-bold tracking-widest",children:"Lokální Čas"}),e.jsx("p",{className:"text-sm font-mono font-bold text-zinc-300",children:new Date().toLocaleTimeString()})]})]})]}),e.jsxs("main",{className:"flex-1 relative z-10 p-6 overflow-y-auto no-scrollbar pb-32",children:[e.jsxs("div",{className:"mb-8 p-6 bg-gradient-to-r from-cyan-900/20 to-transparent border-l-4 border-cyan-500 rounded-r-xl",children:[e.jsx("h2",{className:"text-lg font-bold text-cyan-100 mb-1",children:"Diagnostika lodi."}),e.jsxs("p",{className:"text-sm text-cyan-400/60 font-mono",children:['"',((ne=t.stationConfig)==null?void 0:ne.welcomeMessage)||"Dostupné servisní úkony nalezeny.",'"']})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("h3",{className:"text-xs font-black text-white/40 uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"})," Dostupný Servis"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[((te=t.stationConfig)==null?void 0:te.refillO2)&&e.jsxs(C.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:`p-5 rounded-xl flex items-center gap-4 border transition-colors ${A?"bg-green-900/20 border-green-500/50":"bg-black/40 border-white/10"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${A?"bg-green-900/20 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:e.jsx(bt,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest",children:"Podpora Života"}),e.jsx("p",{className:"text-lg font-black text-white uppercase",children:"Doplnění O2"})]}),A&&e.jsx(We,{className:"w-6 h-6 text-green-500 ml-auto"})]}),((y=t.stationConfig)==null?void 0:y.fuelReward)&&e.jsxs(C.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:`p-5 rounded-xl flex items-center gap-4 border transition-colors ${A?"bg-green-900/20 border-green-500/50":"bg-black/40 border-white/10"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${A?"bg-green-900/20 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:e.jsx(Ot,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest",children:"Tankování"}),e.jsxs("p",{className:"text-lg font-black text-white uppercase",children:["+",t.stationConfig.fuelReward," Paliva"]})]}),A&&e.jsx(We,{className:"w-6 h-6 text-green-500 ml-auto"})]}),((K=t.stationConfig)==null?void 0:K.repairAmount)&&e.jsxs(C.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:`p-5 rounded-xl flex items-center gap-4 border transition-colors ${A?"bg-green-900/20 border-green-500/50":"bg-black/40 border-white/10"}`,children:[e.jsx("div",{className:`p-3 rounded-full ${A?"bg-green-900/20 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:e.jsx($e,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-zinc-400 uppercase font-bold tracking-widest",children:"Opravy"}),e.jsxs("p",{className:"text-lg font-black text-white uppercase",children:["+",t.stationConfig.repairAmount," HP/Hull"]})]}),A&&e.jsx(We,{className:"w-6 h-6 text-green-500 ml-auto"})]})]}),e.jsx("button",{onClick:L,disabled:A,className:`w-full py-5 font-black uppercase text-sm tracking-[0.3em] rounded-xl flex items-center justify-center gap-3 transition-all shadow-lg ${A?"bg-green-600 text-white cursor-default":"bg-white text-black hover:bg-cyan-400 active:scale-95"}`,children:A?e.jsxs(e.Fragment,{children:[e.jsx(gt,{className:"w-5 h-5"})," SERVISNÍ ÚKONY DOKONČENY"]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"w-5 h-5"})," PROVÉST KOMPLETNÍ SERVIS"]})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-xs font-black text-white/40 uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"})," Doplňkové Služby"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>ee(!0),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(St,{className:"w-6 h-6 text-zinc-500 group-hover:text-cyan-400 transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400 group-hover:text-white",children:"Tržiště & Scrap"})]}),e.jsxs("button",{onClick:()=>Z(!0),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(Be,{className:"w-6 h-6 text-zinc-500 group-hover:text-orange-500 transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400 group-hover:text-white",children:"Výroba (Factory)"})]}),e.jsxs("button",{onClick:()=>O("Loděnice"),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(ba,{className:"w-6 h-6 text-zinc-500 group-hover:text-signal-cyan transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400",children:"Vylepšit Loď"})]}),e.jsxs("button",{onClick:()=>O("Kartografie"),className:"bg-zinc-900/50 border border-white/5 hover:bg-zinc-800 p-4 rounded-xl flex flex-col items-center gap-2 transition-all active:scale-95 group",children:[e.jsx(pt,{className:"w-6 h-6 text-zinc-500 group-hover:text-purple-500 transition-colors"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400",children:"Registr Planet"})]})]})]}),e.jsx("div",{className:"w-full h-0.5 bg-signal-amber mb-6 shadow-[0_0_10px_#ff9d00]"}),e.jsxs("div",{className:"pt-2",children:[e.jsxs("h3",{className:"text-xs font-black text-signal-amber uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"})," Protokol Údržby"]}),e.jsxs("div",{className:"font-mono text-[10px] text-zinc-500 space-y-1.5 p-4 bg-black/40 rounded-xl border border-white/5",children:[e.jsxs("p",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-700",children:"08:00"})," ",e.jsx("span",{children:"> Navázáno spojení s centrálním serverem..."})]}),e.jsxs("p",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-700",children:"08:01"})," ",e.jsx("span",{children:"> Autorizace jednotky: ÚSPĚCH"})]}),e.jsxs("p",{className:"flex gap-2 text-green-500",children:[e.jsx("span",{className:"text-green-900",children:"08:02"})," ",e.jsx("span",{children:"> Zahájení automatických oprav..."})]}),e.jsxs("p",{className:"flex gap-2 text-green-500",children:[e.jsx("span",{className:"text-green-900",children:"08:05"})," ",e.jsx("span",{children:"> Doplnění zásob..."})]}),e.jsxs("p",{className:"flex gap-2",children:[e.jsx("span",{className:"text-zinc-700",children:"08:10"})," ",e.jsx("span",{children:"> Odpojení servisních ramen."})]}),e.jsxs("p",{className:"flex gap-2 animate-pulse text-signal-cyan",children:[e.jsx("span",{className:"text-cyan-900",children:"08:11"})," ",e.jsx("span",{children:"> Připraveno k odletu."})]})]})]})]}),e.jsx("footer",{className:"relative z-10 p-6 bg-black/80 backdrop-blur-xl border-t border-white/10",children:e.jsxs("button",{onClick:p,className:"w-full py-4 bg-cyan-600/10 hover:bg-cyan-600/20 border border-cyan-600/30 text-cyan-400 font-black uppercase text-sm tracking-[0.3em] rounded-xl flex items-center justify-center gap-3 transition-all active:scale-95 shadow-[0_0_20px_rgba(8,145,178,0.2)]",children:[e.jsx(Ht,{className:"w-5 h-5"}),"Opustit Stanici (Undock)"]})}),e.jsx(ce,{children:E&&e.jsx("div",{className:"fixed inset-0 z-[250] bg-black/90 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(C.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-zinc-900 border border-white/10 p-6 rounded-2xl w-full max-w-xs text-center shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-signal-cyan"}),e.jsx("div",{className:"w-16 h-16 bg-cyan-500/10 rounded-full flex items-center justify-center mx-auto mb-4 text-cyan-500 border border-cyan-500/30",children:e.jsx(Ht,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-wider mb-2",children:"Opustit Dok?"}),e.jsx("p",{className:"text-xs text-zinc-400 mb-6 font-mono leading-relaxed",children:"Opravdu chcete opustit stanici? Ujistěte se, že máte doplněno palivo a zásoby."}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>k(!1),className:"py-3 bg-zinc-800 text-zinc-400 font-bold uppercase text-[10px] rounded-lg hover:bg-zinc-700 transition-colors",children:"Zůstat"}),e.jsx("button",{onClick:o,className:"py-3 bg-cyan-600 text-white font-bold uppercase text-[10px] rounded-lg hover:bg-cyan-500 transition-colors shadow-lg shadow-cyan-500/20",children:"Odletět"})]})]})})}),e.jsx(ce,{children:X&&e.jsxs(C.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},className:"fixed bottom-24 left-1/2 -translate-x-1/2 z-[300] bg-black/90 border border-orange-500/50 px-6 py-3 rounded-full shadow-[0_0_30px_rgba(249,115,22,0.3)] flex items-center gap-3",children:[e.jsx(ja,{className:"w-5 h-5 text-orange-500 animate-pulse"}),e.jsxs("span",{className:"text-xs font-bold text-orange-500 uppercase tracking-widest whitespace-nowrap",children:["Modul ",X," ve výstavbě"]})]})}),e.jsx(ce,{children:D&&e.jsx(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-[250]",children:e.jsx(on,{inventory:c,masterCatalog:i,onClose:()=>Z(!1),onCraft:a})})}),e.jsx(ce,{children:le&&e.jsx(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-[250]",children:e.jsx(dn,{onClose:()=>ee(!1),masterCatalog:i,inventory:c,playerGold:r,playerClass:d,onBuy:(I,z)=>{re(I,z)},onRecycle:(I,z)=>{$(I,z)}})})})]})},pn=({merchant:t,userGold:s,adminEmail:m,inventory:a,playerClass:c,onClose:i,onBuy:r,onSell:d,onAddFreeItem:b,masterCatalog:x=[]})=>{const[g,j]=n.useState("buy"),[u,f]=n.useState([]),[E,k]=n.useState({}),[X,w]=n.useState(!0),[A,T]=n.useState(null),[D,Z]=n.useState(null),[le,ee]=n.useState("thinking"),[L,p]=n.useState(0),o=t.tradeConfig||{warriorDiscount:10,clericDiscount:45,mageDiscount:25,rogueStealChance:30},O=n.useMemo(()=>{var K;const y={};return(K=t.merchantItems)==null||K.forEach(I=>{if(I.saleChance&&I.saleChance>0){const z=Math.random()*100;y[I.id]=z<=I.saleChance}}),y},[t.id]);n.useEffect(()=>{(async()=>{if(!t.merchantItems||t.merchantItems.length===0){w(!1);return}w(!0);const K={},I=[];for(const z of t.merchantItems){K[z.id]=z.stock;const q=z.id.trim();let Y=x.find(me=>me.id===q);if(Y||(Y=x.find(me=>me.id.split("__")[0]===q)),!Y)try{Y=await Tt(m,q)||void 0}catch{}Y&&I.push({...Y,price:z.price!==void 0&&z.price>0?z.price:Y.price,_merchantEntry:z})}k(K),f(I),w(!1)})()},[t,m,x]);const J=y=>{var me,he;const K=y.price??100;let I=K,z=null;const q=((me=y._merchantEntry)==null?void 0:me.id)||y.id,Y=O[q]||!1;if(Y&&(I=Math.floor(K*.7),z="SALE"),c===Ie.WARRIOR){const fe=(100-o.warriorDiscount)/100;I=Math.floor(I*fe),z||(z="CLASS")}if(c===Ie.CLERIC&&((he=y.stats)==null?void 0:he.some(U=>["HP","HEAL","LÉČENÍ","ZDRAVÍ"].some(Oe=>U.label.toUpperCase().includes(Oe))))){const U=(100-o.clericDiscount)/100;I=Math.floor(I*U),z||(z="CLASS")}if(c===Ie.MAGE&&(y.isConsumable||y.type===H.ITEM)){const fe=(100-o.mageDiscount)/100;I=Math.floor(I*fe),z||(z="CLASS")}return{finalPrice:Math.max(1,I),basePrice:K,discountType:z,isOnSale:Y}},re=y=>{var q;const K=((q=y._merchantEntry)==null?void 0:q.id)||y.id,I=E[K]||0,{finalPrice:z}=J(y);if(I>0&&s>=z){let Y=1;c===Ie.ROGUE&&I>=2&&b&&Math.random()*100<o.rogueStealChance&&(Y=2,b(y),N("success"),T(`Získal jsi ${y.title} navíc zdarma! (Krádež)`),setTimeout(()=>T(null),3e3)),k(he=>({...he,[K]:Math.max(0,he[K]-Y)}));const me={...y,price:z};r(me)}},$=y=>{Z(y),ee("thinking"),N("scan"),setTimeout(()=>{var z;const K=y.id.split("__")[0],I=(z=t.merchantItems)==null?void 0:z.find(q=>q.id===y.id||q.id===K);I&&I.sellPrice&&I.sellPrice>0?(p(I.sellPrice),ee("offer"),N("success")):(ee("reject"),N("error"))},1500)},ne=()=>{D&&d&&(d(D,L),N("success"),Z(null))},te=y=>!y||y.length===0?null:e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:y.map((K,I)=>{let z=e.jsx(Re,{className:"w-3 h-3"}),q="text-zinc-400";const Y=K.label.toUpperCase();return(Y.includes("HP")||Y.includes("HEAL"))&&(z=e.jsx(Ve,{className:"w-3 h-3"}),q="text-red-400"),(Y.includes("DMG")||Y.includes("ATK"))&&(z=e.jsx(jt,{className:"w-3 h-3"}),q="text-orange-400"),(Y.includes("DEF")||Y.includes("ARMOR"))&&(z=e.jsx($e,{className:"w-3 h-3"}),q="text-blue-400"),Y.includes("MANA")&&(z=e.jsx(Fe,{className:"w-3 h-3"}),q="text-cyan-400"),e.jsxs("div",{className:`flex items-center gap-1 text-[9px] bg-black/60 px-2 py-1 rounded border border-white/10 ${q} font-bold`,children:[z," ",K.label,": ",K.value]},I)})});return e.jsxs(C.div,{initial:{opacity:0,y:"100%"},animate:{opacity:1,y:0},exit:{opacity:0,y:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed inset-0 z-[60] bg-zinc-950/95 flex flex-col pt-28",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-5 z-0",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"30px 30px"}}),e.jsxs("div",{className:"p-4 bg-black border-b border-zinc-800 shadow-xl z-20 flex flex-col gap-4 relative",children:[e.jsx(ce,{children:A&&e.jsxs(C.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},className:"absolute top-2 left-2 right-2 bg-green-900/90 border border-green-500 text-green-100 p-3 rounded-xl z-50 flex items-center gap-2 shadow-xl",children:[e.jsx(ls,{className:"w-5 h-5 text-green-400"}),e.jsx("span",{className:"text-xs font-bold uppercase",children:A})]})}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-2xl font-display font-black text-white uppercase tracking-wider leading-none",children:t.title})}),e.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2 bg-red-900/20 border border-red-500/50 rounded-lg text-red-500 hover:bg-red-900/40 active:scale-95 transition-all",children:[e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Odejít"}),e.jsx(Ae,{className:"w-4 h-4"})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-zinc-900 p-3 rounded-xl border border-zinc-800",children:[e.jsx("span",{className:"text-xs text-zinc-400 font-bold uppercase tracking-widest",children:"Dostupný Kredit"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"text-xl font-mono font-black text-white",children:s})]})]}),t.canSellToMerchant&&e.jsxs("div",{className:"flex bg-zinc-900 p-1 rounded-lg border border-zinc-800",children:[e.jsx("button",{onClick:()=>j("buy"),className:`flex-1 py-2 text-xs font-bold uppercase rounded-md transition-all ${g==="buy"?"bg-zinc-800 text-white shadow":"text-zinc-500 hover:text-zinc-200"}`,children:"Nákup"}),e.jsx("button",{onClick:()=>j("sell"),className:`flex-1 py-2 text-xs font-bold uppercase rounded-md transition-all ${g==="sell"?"bg-zinc-800 text-white shadow":"text-zinc-500 hover:text-zinc-200"}`,children:"Prodej"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-zinc-950 pb-20 relative z-10",children:g==="buy"?X?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 gap-4",children:[e.jsx(Xe,{className:"w-8 h-8 text-signal-cyan animate-spin"}),e.jsx("p",{className:"text-xs text-zinc-400 uppercase tracking-widest font-bold",children:"Naskladňování zboží..."})]}):u.length===0?e.jsxs("div",{className:"text-center py-10 opacity-50",children:[e.jsx(kt,{className:"w-16 h-16 mx-auto mb-4 text-zinc-600"}),e.jsx("p",{className:"text-zinc-300 font-bold uppercase tracking-widest",children:"Vyprodáno"}),e.jsx("p",{className:"text-[10px] text-zinc-500 mt-2 max-w-xs mx-auto",children:"Obchodník nemá na skladě žádné zboží odpovídající zadaným ID. Zkontrolujte Fabrikaci."})]}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:u.map(y=>{var U;const K=((U=y._merchantEntry)==null?void 0:U.id)||y.id,I=E[K]||0,z=I<=0,{finalPrice:q,basePrice:Y,discountType:me,isOnSale:he}=J(y),fe=s>=q;return e.jsxs("div",{className:`bg-zinc-900 border border-zinc-800 p-4 rounded-xl relative overflow-hidden transition-all ${z?"opacity-50 grayscale":"hover:border-zinc-600"}`,children:[he&&!z&&e.jsx("div",{className:"absolute top-0 right-0 bg-pink-600 text-white text-[9px] font-black px-2 py-1 rounded-bl-xl uppercase tracking-wider animate-pulse shadow-[0_0_10px_#db2777]",children:"BLESKOVÁ AKCE"}),e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${y.rarity==="Legendary"?"bg-yellow-500":y.rarity==="Epic"?"bg-purple-500":y.rarity==="Rare"?"bg-blue-500":"bg-zinc-600"}`}),e.jsxs("div",{className:"pl-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h3",{className:"font-bold text-white text-lg leading-tight",children:y.title}),e.jsxs("div",{className:`flex items-center gap-1 text-[10px] px-1.5 py-0.5 rounded font-bold uppercase border ${z?"bg-red-900/20 text-red-500 border-red-900/40":"bg-zinc-800 text-zinc-200 border-zinc-700"}`,children:[e.jsx(De,{className:"w-3 h-3"}),z?"Vyprodáno":`Skladem: ${I}`]})]}),e.jsxs("span",{className:"text-[10px] text-zinc-400 uppercase tracking-wider font-bold block mb-2",children:[y.type," • ",y.rarity]}),e.jsxs("p",{className:"text-xs text-zinc-300 line-clamp-2 font-serif leading-relaxed mb-2 italic opacity-80",children:['"',y.description,'"']}),te(y.stats)]}),e.jsxs("div",{className:"pl-3 mt-3 pt-3 border-t border-zinc-800 flex justify-between items-end",children:[e.jsxs("div",{className:"flex flex-col",children:[q<Y&&e.jsxs("span",{className:"text-[10px] text-zinc-500 line-through decoration-red-500 font-mono mb-0.5",children:[Y," GOLD"]}),e.jsxs("div",{className:`flex items-center gap-1 font-mono font-black text-xl ${fe?"text-yellow-500":"text-red-500"}`,children:[q," ",e.jsx(ke,{className:"w-4 h-4"})]}),me&&e.jsx("span",{className:"text-[8px] text-green-500 font-bold uppercase",children:me==="SALE"?"Sleva":"Třídní Bonus"})]}),e.jsx("button",{onClick:()=>re(y),disabled:z||!fe,className:`px-6 py-3 rounded-lg font-bold uppercase tracking-widest text-xs transition-all shadow-lg flex items-center justify-center gap-2 ${z?"bg-zinc-800 text-zinc-500 cursor-not-allowed border border-zinc-700":fe?"bg-signal-cyan text-black hover:bg-white shadow-[0_0_15px_rgba(0,242,255,0.4)] active:scale-95":"bg-zinc-900 text-zinc-600 cursor-not-allowed border border-zinc-800"}`,children:z?"Vyprodáno":fe?e.jsxs(e.Fragment,{children:[e.jsx(kt,{className:"w-4 h-4"})," Koupit"]}):"Drahé"})]})]},y.id)})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"mb-4 bg-zinc-900 border border-zinc-800 p-3 rounded-lg flex items-center gap-3",children:[e.jsx(Na,{className:"w-5 h-5 text-green-500"}),e.jsx("p",{className:"text-xs text-zinc-200 font-bold leading-relaxed",children:"Vyberte předmět k prodeji."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[(a||[]).filter(y=>y.type===H.ITEM||y.type==="PŘEDMĚT").map(y=>e.jsxs("button",{onClick:()=>$(y),className:"bg-zinc-900 border border-zinc-800 p-3 rounded-xl flex flex-col gap-2 relative overflow-hidden hover:border-green-500/50 transition-colors text-left group active:scale-95",children:[e.jsx("div",{className:"flex justify-between items-start w-full",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-black p-2 rounded-lg border border-zinc-800 group-hover:border-green-500/30 transition-colors",children:e.jsx(De,{className:"w-5 h-5 text-zinc-400 group-hover:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white text-sm uppercase tracking-tight",children:y.title}),e.jsx("span",{className:"text-[9px] font-bold uppercase bg-black/40 px-1.5 rounded text-zinc-400 border border-white/10",children:y.rarity})]})]})}),te(y.stats)]},y.id)),(!a||a.filter(y=>y.type===H.ITEM||y.type==="PŘEDMĚT").length===0)&&e.jsx("p",{className:"col-span-1 text-center text-zinc-500 text-xs py-10 uppercase font-bold tracking-widest",children:"Váš batoh je prázdný."})]})]})}),e.jsx(ce,{children:D&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-black/95 backdrop-blur-sm flex items-center justify-center p-6",children:e.jsxs(C.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-zinc-900 border border-zinc-700 rounded-2xl p-6 w-full max-w-sm text-center relative overflow-hidden",children:[e.jsx("button",{onClick:()=>Z(null),className:"absolute top-4 right-4 text-zinc-400 hover:text-white",children:e.jsx(Ae,{className:"w-5 h-5"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-1 uppercase tracking-tighter",children:D.title}),e.jsx("div",{className:"flex justify-center mb-4",children:te(D.stats)}),le==="thinking"&&e.jsxs("div",{className:"py-8 flex flex-col items-center gap-4",children:[e.jsx(va,{className:"w-12 h-12 text-neon-purple animate-pulse"}),e.jsx("p",{className:"text-sm font-bold text-neon-purple uppercase tracking-widest animate-pulse",children:"Obchodník přemýšlí..."})]}),le==="reject"&&e.jsxs("div",{className:"py-4 flex flex-col items-center gap-4",children:[e.jsx(ps,{className:"w-12 h-12 text-red-500"}),e.jsx("div",{className:"bg-black/60 p-4 rounded-xl border-l-4 border-red-500 text-left w-full border border-zinc-800",children:e.jsx("p",{className:"text-sm italic text-zinc-100 leading-relaxed font-serif",children:'"Tohle? To je bezcenný krám. O to nemám zájem. Přines mi něco pořádného, co mám na seznamu."'})}),e.jsx("button",{onClick:()=>Z(null),className:"w-full py-3 bg-zinc-800 text-white font-bold uppercase rounded-lg border border-zinc-700 tracking-widest text-xs",children:"Zpět k Batohu"})]}),le==="offer"&&e.jsxs("div",{className:"py-4 flex flex-col items-center gap-4",children:[e.jsx(hs,{className:"w-12 h-12 text-green-500"}),e.jsxs("div",{className:"bg-black/60 p-4 rounded-xl border-l-4 border-green-500 text-left w-full border border-zinc-800",children:[e.jsx("p",{className:"text-sm italic text-zinc-200 mb-4 font-serif leading-relaxed",children:'"Hmm, zajímavé. O tohle bych zájem měl."'}),e.jsxs("div",{className:"flex justify-between items-center bg-black/50 p-3 rounded border border-zinc-800",children:[e.jsx("span",{className:"text-xs font-bold uppercase text-zinc-300 tracking-wider",children:"Nabídka:"}),e.jsxs("span",{className:"text-xl font-mono font-bold text-green-500 flex items-center gap-1",children:[L," ",e.jsx(ke,{className:"w-4 h-4"})]})]})]}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx("button",{onClick:()=>Z(null),className:"flex-1 py-3 bg-zinc-800 text-zinc-300 font-bold uppercase rounded-lg border border-zinc-700 text-xs tracking-widest",children:"Odmítnout"}),e.jsx("button",{onClick:ne,className:"flex-1 py-3 bg-green-600 hover:bg-green-500 text-white font-bold uppercase rounded-lg shadow-[0_0_15px_rgba(34,197,94,0.4)] text-xs tracking-widest",children:"PRODAT"})]})]})]})})})]})},gs=()=>et(()=>import("./InventoryView-CSmHJOXD.js"),__vite__mapDeps([0,1,2]),import.meta.url),bs=()=>et(()=>import("./Generator-CHmcwILc.js"),__vite__mapDeps([3,1,2]),import.meta.url),js=()=>et(()=>import("./Room-DWqlth8Z.js"),__vite__mapDeps([4,1,2]),import.meta.url),Ns=()=>et(()=>import("./SettingsView-E6z1kldW.js"),__vite__mapDeps([5,1]),import.meta.url),vs=()=>et(()=>import("./SpaceshipView-yvOXTdZc.js"),__vite__mapDeps([6,1,2]),import.meta.url),un=n.lazy(gs),hn=n.lazy(bs),fn=n.lazy(js),gn=n.lazy(Ns),bn=n.lazy(vs);class jn extends n.Component{constructor(){super(...arguments);Bt(this,"state",{hasError:!1})}static getDerivedStateFromError(m){return{hasError:!0}}componentDidCatch(m,a){}render(){return this.state.hasError?e.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center bg-black p-10 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-950/20 border border-red-500/50 rounded-full flex items-center justify-center mb-6 shadow-[0_0_20px_rgba(239,68,68,0.2)]",children:e.jsx(_e,{className:"w-8 h-8 text-red-500"})}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-widest mb-2",children:"Chyba_Segmentu"}),e.jsxs("p",{className:"text-zinc-500 text-[10px] font-mono uppercase tracking-widest mb-8 leading-relaxed",children:["Nepodařilo se stáhnout herní modul.",e.jsx("br",{}),"Možná ztráta signálu se sektorem."]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"button-primary py-4 px-10 text-[10px]",children:"Restartovat HUD"})]}):this.props.children}}const Nn=()=>e.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center bg-black gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Xe,{className:"w-12 h-12 text-signal-cyan animate-spin opacity-50"}),e.jsx(C.div,{animate:{scale:[1,1.2,1],opacity:[.3,1,.3]},transition:{duration:1.5,repeat:1/0},className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-signal-cyan rounded-full shadow-[0_0_10px_#00f2ff]"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-black text-signal-cyan uppercase tracking-[0.4em] animate-pulse",children:"Synchronizace_Dat"}),e.jsx("span",{className:"text-[8px] font-mono text-zinc-600 uppercase mt-1",children:"Stahování_Segmentu..."})]})]}),vn=()=>{const t=Wa(),[s,m]=n.useState(()=>sessionStorage.getItem("nexus_boot_done")==="true"),[a,c]=n.useState(.85),[i,r]=n.useState(navigator.onLine);n.useEffect(()=>{s&&t.userEmail&&i&&(gs().catch(()=>{}),js().catch(()=>{}),vs().catch(()=>{}),t.isAdmin&&bs().catch(()=>{}),Ns().catch(()=>{}))},[s,t.userEmail,i,t.isAdmin]),n.useEffect(()=>{const u=()=>r(navigator.onLine);return window.addEventListener("online",u),window.addEventListener("offline",u),"getBattery"in navigator&&navigator.getBattery().then(f=>{const E=()=>c(f.level);return E(),f.addEventListener("levelchange",E),()=>f.removeEventListener("levelchange",E)}),()=>{window.removeEventListener("online",u),window.removeEventListener("offline",u)}},[]);const d=()=>{m(!0),sessionStorage.setItem("nexus_boot_done","true")},b=()=>{N("message"),Q(15);const u=t.isNight,f=u?"NOČNÍ PROTOKOL AKTIVNÍ":"DENNÍ PROTOKOL AKTIVNÍ",E=u?"20:00 — 06:00":"06:00 — 20:00",k=u?"Zvýšená aktivita biotických hrozeb. Noční varianty karet mají bonus k poškození (+5 DMG). Viditelnost skeneru omezena.":"Stabilní atmosférické podmínky. Standardní loot tabulky a bezpečné obchodní trasy. Bonus k regeneraci kyslíku.";t.setNotification({id:"cycle-"+Date.now(),message:`${f}
Čas: ${E}

${k}`,type:"info"})},x=u=>{let f=0;u.forEach(E=>{const X=String(E.value).replace(/[^0-9-]/g,""),w=parseInt(X),A=String(E.label).toUpperCase().trim();!isNaN(w)&&w!==0&&(["HP","ZDRAVÍ","HEAL"].some(T=>A.includes(T))?(t.handleHpChange(w),f++):["MANA","ENERGIE"].some(T=>A.includes(T))?(t.handleManaChange(w),f++):["PALIVO","FUEL"].some(T=>A.includes(T))?(t.handleFuelChange(w),f++):["GOLD","ZLATO","MINCE"].some(T=>A.includes(T))?(t.handleGoldChange(w),f++):["O2","KYSLÍK"].some(T=>A.includes(T))?(t.setPlayerOxygen(T=>Math.min(100,Math.max(0,T+w))),f++):["ARMOR","BRNĚNÍ"].some(T=>A.includes(T))&&(t.setPlayerArmor(T=>Math.max(0,T+w)),f++))}),f>0&&t.setNotification({id:"loot-claim",type:"success",message:"Kořist byla úspěšně připsána."})},g=u=>{t.setPlayerArmor(f=>Math.max(0,f+u))},j=(u,f)=>{var w,A;const E=t.inventory.find(T=>{var D;return T.type===H.PLANET&&((D=T.planetConfig)==null?void 0:D.planetId)===u});if((w=E==null?void 0:E.planetConfig)!=null&&w.phases&&E.planetConfig.phases.length>0){const T=E.planetProgress||0;if(T<E.planetConfig.phases.length){const D=E.planetConfig.phases[T],Z=t.masterCatalog.find(le=>le.id===D);if(Z){t.setCurrentEvent({...Z});return}}}if((A=E==null?void 0:E.planetConfig)!=null&&A.landingEventId){const T=t.masterCatalog.find(D=>D.id===E.planetConfig.landingEventId);if(T){t.setCurrentEvent({...T,id:`LIVE-${Date.now()}`});return}}const k=t.masterCatalog.filter(T=>T.type===f);let X=null;if(k.length>0){const T=Math.floor(Math.random()*k.length);X={...k[T],id:`LANDING-${Date.now()}`}}else X={id:`GEN-${Date.now()}`,title:"Průzkum Sektoru",description:`Narazili jste na neznámou aktivitu typu ${f}.`,type:f,rarity:"Common",stats:[],isConsumable:!1};t.setCurrentEvent(X)};return s?t.userEmail?!t.roomState.isNicknameSet||!t.playerClass?e.jsx(sn,{initialNickname:t.roomState.nickname,onConfirmSetup:t.handleGameSetup,isGuest:t.isGuest}):e.jsxs("div",{className:"h-screen w-screen bg-black overflow-hidden flex flex-col font-sans text-white relative",children:[e.jsx(ce,{children:t.screenFlash&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-[999] pointer-events-none mix-blend-overlay ${t.screenFlash==="red"?"bg-red-600/40":t.screenFlash==="green"?"bg-green-500/30":t.screenFlash==="blue"?"bg-blue-500/30":"bg-orange-500/50"}`})}),e.jsxs("div",{className:"h-28 bg-zinc-950/95 border-b border-white/10 flex flex-col z-[100] shadow-[0_5px_20px_rgba(0,0,0,0.8)]",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-1 border-b border-white/5 bg-white/[0.01]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[7px] font-black text-signal-cyan uppercase tracking-[0.2em] opacity-80",children:"Nexus_OS_v1.4"}),e.jsx("div",{className:`w-1 h-1 rounded-full ${i?"bg-green-500 animate-pulse":"bg-red-500 shadow-[0_0_8px_red] animate-ping"}`}),t.isAdmin&&e.jsxs("div",{className:`ml-2 px-2 py-0.5 rounded border-[0.5px] text-[6px] font-black uppercase tracking-wider flex items-center gap-1 ${t.isTestMode?"border-orange-500/50 text-orange-500 bg-orange-950/30 shadow-[0_0_10px_rgba(249,115,22,0.2)]":"border-purple-500/50 text-purple-400 bg-purple-950/30 shadow-[0_0_10px_rgba(168,85,247,0.2)]"}`,children:[t.isTestMode?e.jsx(ya,{className:"w-2 h-2"}):e.jsx(At,{className:"w-2 h-2"}),t.isTestMode?"TEST_ENV":"LIVE_DB"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:b,className:"flex items-center gap-1.5 active:scale-95 transition-transform",children:[t.isNight?e.jsx(wa,{className:"w-3 h-3 text-indigo-400"}):e.jsx(ka,{className:"w-3 h-3 text-signal-amber"}),e.jsx("span",{className:"text-[8px] font-mono text-zinc-400 uppercase tracking-widest",children:t.isNight?"Night_Cycle":"Day_Cycle"})]}),e.jsx("div",{className:"w-8 h-1.5 bg-white/5 relative rounded-full overflow-hidden border border-white/10",children:e.jsx("div",{className:"h-full bg-signal-amber shadow-[0_0_50px_#ff9d00]",style:{width:`${a*100}%`}})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-1 p-1 bg-black/40",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-1",children:[e.jsx(Ke,{icon:e.jsx(Ve,{className:"w-4 h-4"}),value:t.playerHp,color:"#ef4444",label:"HP"}),e.jsx(Ke,{icon:e.jsx(Fe,{className:"w-4 h-4"}),value:t.playerMana,color:"#00f2ff",label:"MANA"}),e.jsx(Ke,{icon:e.jsx(Ot,{className:"w-4 h-4"}),value:t.playerFuel,color:"#f97316",label:"PALIVO"})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-1",children:[e.jsx(Ke,{icon:e.jsx(ke,{className:"w-3 h-3"}),value:t.playerGold,color:"#fbbf24",label:"GOLD",small:!0}),e.jsx(Ke,{icon:e.jsx($e,{className:"w-3 h-3"}),value:t.playerArmor,color:"#a1a1aa",label:"ARMOR",small:!0}),e.jsx(Ke,{icon:e.jsx(bt,{className:"w-3 h-3"}),value:t.playerOxygen,color:"#22d3ee",label:"O2",small:!0})]})]})]}),e.jsx("div",{className:"flex-1 relative overflow-hidden",children:e.jsx(jn,{children:e.jsx(n.Suspense,{fallback:e.jsx(Nn,{}),children:e.jsxs(ce,{mode:"wait",children:[t.activeTab===pe.SCANNER&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:e.jsx(Xa,{onScanCode:t.handleScanCode,isAIThinking:t.isAIThinking,isPaused:t.isScannerPaused})},"scanner"),t.activeTab===pe.INVENTORY&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:e.jsx(un,{inventory:t.inventory,loadingInventory:!1,isRefreshing:t.isRefreshing,isAdmin:t.isAdmin,isNight:t.isNight,adminNightOverride:t.adminNightOverride,playerClass:t.playerClass,giftTarget:t.giftTarget,onRefresh:t.handleRefreshDatabase,onItemClick:t.handleOpenInventoryItem,isTestMode:t.isTestMode})},"inventory"),t.activeTab===pe.GENERATOR&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0",children:e.jsx(hn,{onSaveCard:u=>t.handleSaveEvent(u,!0),userEmail:t.userEmail||"",initialData:t.editingEvent,onClearData:()=>t.setEditingEvent(null),onDelete:t.handleDeleteEvent,masterCatalog:t.masterCatalog})},"generator"),t.activeTab===pe.ROOM&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1,exit:{opacity:0}},className:"absolute inset-0",children:e.jsx(fn,{roomState:t.roomState,inventory:t.inventory,playerHp:t.playerHp,scanLog:t.scanLog,onExitToMenu:t.handleExitToMenu,onSendMessage:t.handleSendMessage,onStartGame:t.handleStartGame,onInspectItem:t.handleInspectItem,onSwapItems:t.handleSwapItems,userEmail:t.userEmail||void 0,playerClass:t.playerClass})},"room"),t.activeTab===pe.SETTINGS&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1,exit:{opacity:0}},className:"absolute inset-0",children:e.jsx(gn,{onBack:()=>t.setActiveTab(pe.SCANNER),onLogout:t.handleLogout,soundEnabled:t.soundEnabled,vibrationEnabled:t.vibrationEnabled,onToggleSound:t.handleToggleSound,onToggleVibration:t.handleToggleVibration,userEmail:t.userEmail,isAdmin:t.isAdmin,isTestMode:t.isTestMode,onToggleTestMode:t.toggleTestMode,onHardReset:t.handleHardReset,onWipeTestVault:t.handleWipeTestVault})},"settings"),t.activeTab===pe.SPACESHIP&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1,exit:{opacity:0}},className:"absolute inset-0",children:e.jsx(bn,{playerFuel:t.playerFuel,inventory:t.inventory,onPlanetLand:j,onFuelConsume:u=>t.handleFuelChange(u),onProgressPlanet:t.handlePlanetProgress,masterCatalog:t.masterCatalog})},"spaceship")]})})})}),e.jsxs("div",{className:"h-20 bg-zinc-950 border-t-2 border-signal-cyan/40 flex items-center justify-around px-2 pb-2 relative z-50 shadow-[0_-12px_35px_rgba(0,242,255,0.25)]",children:[e.jsx(Ue,{active:t.activeTab===pe.SCANNER,onClick:()=>t.setActiveTab(pe.SCANNER),icon:e.jsx(xs,{}),label:"Sken"}),e.jsx(Ue,{active:t.activeTab===pe.INVENTORY,onClick:()=>t.setActiveTab(pe.INVENTORY),icon:e.jsx(Ze,{}),label:t.isAdmin?"Databáze":"Batoh"}),e.jsx(Ue,{active:t.activeTab===pe.SPACESHIP,onClick:()=>t.setActiveTab(pe.SPACESHIP),icon:e.jsx(ms,{}),label:"Loď"}),t.isAdmin&&e.jsx(Ue,{active:t.activeTab===pe.GENERATOR,onClick:()=>t.setActiveTab(pe.GENERATOR),icon:e.jsx(Be,{}),label:"Fab"}),e.jsx(Ue,{active:t.activeTab===pe.ROOM,onClick:()=>t.setActiveTab(pe.ROOM),icon:e.jsx(cs,{}),label:"Tým"}),e.jsx(Ue,{active:t.activeTab===pe.SETTINGS,onClick:()=>t.setActiveTab(pe.SETTINGS),icon:e.jsx(Sa,{}),label:"Sys"})]}),e.jsx(ce,{children:t.isDocking&&e.jsx(cn,{onComplete:t.handleDockingComplete})}),e.jsx(ce,{children:t.activeMerchant&&e.jsx(pn,{merchant:t.activeMerchant,userGold:t.playerGold,adminEmail:t.isTestMode?"admin_test_vault@nexus.local":"zbynekbal97@gmail.com",inventory:t.inventory,playerClass:t.playerClass,onClose:()=>t.setActiveMerchant(null),onBuy:t.handleBuyItem,onSell:t.handleSellItem,onAddFreeItem:u=>t.handleSaveEvent(u,!1),masterCatalog:t.masterCatalog})}),e.jsx(ce,{children:t.activeStation&&e.jsx(mn,{station:t.activeStation,onLeave:t.handleLeaveStation,onClaimRewards:t.handleClaimStationRewards,inventory:t.inventory,masterCatalog:t.masterCatalog,onCraft:t.handleCraftItem,playerGold:t.playerGold,playerClass:t.playerClass,onInventoryUpdate:t.handleRefreshDatabase,isAdmin:t.isAdmin,isTestMode:t.isTestMode,onGoldChange:t.handleGoldChange})}),e.jsx(ce,{children:t.currentEvent&&!t.isDocking&&!t.activeStation&&!t.activeMerchant&&e.jsx(ln,{event:t.currentEvent,onClose:t.closeEvent,onSave:()=>t.handleSaveEvent(t.currentEvent,!1),onUse:()=>t.handleUseEvent(t.currentEvent),onDiscard:()=>t.handleDeleteEvent(t.currentEvent.id),onResolveDilemma:t.handleResolveDilemma,isSaved:t.inventory.some(u=>{var f;return u.id===((f=t.currentEvent)==null?void 0:f.id)}),onPlayerDamage:t.handleHpChange,playerHp:t.playerHp,playerArmor:t.playerArmor,onArmorChange:g,playerClass:t.playerClass,inventory:t.inventory,onUseItem:u=>t.handleUseEvent(u),onClaimLoot:x})}),e.jsx(ce,{children:t.notification&&e.jsx(an,{data:t.notification,onClose:()=>t.setNotification(null)})}),e.jsx("style",{children:`
        .stat-glow-box {
          box-shadow: inset 0 0 10px var(--slot-color-alpha);
          border-color: var(--slot-color-border);
        }
        .animate-spin-slow {
          animation: spin 6s linear infinite;
        }
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]}):e.jsx(en,{onLogin:t.handleLogin}):e.jsx(tn,{onComplete:d})},Ke=({icon:t,value:s,color:m,label:a,small:c})=>e.jsxs("div",{className:`flex flex-col items-center justify-center rounded-lg border bg-black/60 transition-all stat-glow-box ${c?"py-0.5":"py-1"}`,style:{"--slot-color-alpha":`${m}15`,"--slot-color-border":`${m}40`},children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{style:{color:m},children:t}),e.jsx("span",{className:`${c?"text-xs":"text-sm"} font-black font-mono tracking-tighter text-white drop-shadow-sm`,children:s})]}),e.jsx("span",{className:"text-[6px] font-black uppercase tracking-[0.2em] opacity-50 text-white leading-none mt-0.5",children:a})]}),Ue=({active:t,onClick:s,icon:m,label:a})=>e.jsxs("button",{onClick:s,className:`flex flex-col items-center gap-1 transition-all duration-300 ${t?"text-signal-cyan scale-110":"text-zinc-500"}`,children:[e.jsx("div",{className:`p-2 rounded-xl transition-colors ${t?"bg-signal-cyan/10 border border-signal-cyan/20":""}`,children:m}),e.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest",children:a})]}),ys=document.getElementById("root");if(!ys)throw new Error("Could not find root element to mount to");"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").then(t=>{}).catch(t=>{})});const ts="263088388062-9dgio8dv930qsefdokl2g0uqekvrvs2c.apps.googleusercontent.com",ss=zt.createRoot(ys);ts.length<10?ss.render(e.jsxs("div",{className:"h-screen w-screen bg-zinc-950 flex flex-col items-center justify-center p-8 text-center text-white",children:[e.jsx("div",{className:"w-20 h-20 bg-red-900/20 rounded-full flex items-center justify-center border border-red-500/50 mb-6",children:e.jsx(_e,{className:"w-10 h-10 text-red-500"})}),e.jsx("h1",{className:"text-2xl font-black uppercase tracking-widest mb-2",children:"Chyba Konfigurace"}),e.jsxs("p",{className:"text-sm text-zinc-400 font-mono mb-6 max-w-md",children:["Aplikace postrádá ",e.jsx("strong",{children:"VITE_GOOGLE_CLIENT_ID"}),".",e.jsx("br",{}),"Vytvořte soubor ",e.jsx("code",{children:".env"})," v kořenovém adresáři a přidejte vaše Google Client ID."]}),e.jsx("div",{className:"bg-black p-4 rounded border border-zinc-800 text-xs font-mono text-zinc-500",children:"VITE_GOOGLE_CLIENT_ID=vaše-id-z-google-cloud.apps.googleusercontent.com"})]})):ss.render(e.jsx(za.StrictMode,{children:e.jsx(Ea,{clientId:ts,children:e.jsx(vn,{})})}));export{H as G,Ie as P,Mn as a,Rn as d,N as p,Q as v};
