import{r,j as e,U as B,a5 as V,p as X,aQ as Y,V as q,m as o,aR as ee,w as L,am as se,aS as ae,aT as te,aU as ne,A as M,aE as ie,H as re,G as le,X as ce,n as de,F as oe,l as xe,k as pe}from"./vendor-Dgu-9KXE.js";import{P as m,p as x,v as w}from"./index-DaMuFrk8.js";import"html5-qrcode";import"./utils-BOwlEK-f.js";const be=a=>{switch(a){case m.WARRIOR:return e.jsx(pe,{className:"w-3 h-3"});case m.MAGE:return e.jsx(xe,{className:"w-3 h-3"});case m.ROGUE:return e.jsx(oe,{className:"w-3 h-3"});case m.CLERIC:return e.jsx(de,{className:"w-3 h-3"});default:return e.jsx(B,{className:"w-3 h-3"})}},ge=({roomState:a,inventory:U,playerHp:h,scanLog:u=[],onExitToMenu:f,onSendMessage:y,onStartGame:G,onInspectItem:z,onSwapItems:_,userEmail:g,playerClass:d,onToggleReady:I})=>{var T,P,E,D;const[l,j]=r.useState("party"),[p,R]=r.useState(""),[H,N]=r.useState(!1),[K,C]=r.useState(!1),[c,v]=r.useState(null),A=r.useRef(null),$=r.useRef(null),k=a.host===a.nickname,n=!a.isInRoom||a.id.startsWith("SOLO-");r.useEffect(()=>{var s,t;(s=A.current)==null||s.scrollIntoView({behavior:"smooth"}),(t=$.current)==null||t.scrollIntoView({behavior:"smooth"})},[a.messages,l,u]);const F=s=>{s.preventDefault(),p.trim()&&(y(p),R(""),x("message"))},Z=()=>{N(!0),x("open"),w(30)},J=s=>{y(`[NABÍDKA] ${s.title} (ID: ${s.id}) (EMAIL: ${g})`),N(!1),x("success"),w([40,40])},O=s=>{const t=s.match(/\(ID: (.*?)\)/),i=s.match(/\(EMAIL: (.*?)\)/),b=s.replace("[NABÍDKA] ","").split(" (ID:")[0];return{id:t?t[1]:null,email:i?i[1]:null,title:b}},S=s=>{const t=O(s);t.id&&z&&(z(t.id),x("scan"))},W=(s,t)=>{const i=O(t);i.id&&i.email&&(v({makerNick:s,makerEmail:i.email,makerItemId:i.id,makerItemTitle:i.title}),x("open"),w(30))},Q=s=>{c&&_&&g&&(_(c.makerEmail,g,c.makerItemId,s.id),v(null))};return e.jsxs("div",{className:"h-full flex flex-col bg-zinc-950 overflow-hidden relative",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-5 z-0",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"30px 30px"}}),e.jsxs("div",{className:"bg-black/80 backdrop-blur-md border-b border-zinc-800 relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-zinc-900 px-3 py-1 rounded-full border border-zinc-800",children:[e.jsx(B,{className:"w-3 h-3 text-zinc-400"}),e.jsx("span",{className:"text-xs font-mono text-zinc-100 font-bold",children:a.nickname})]}),e.jsxs("button",{onClick:()=>C(!0),className:"flex items-center gap-1 text-red-500 px-2 py-1 bg-red-900/10 rounded border border-red-900/20 active:scale-90 transition-all",children:[e.jsx(V,{className:"w-3 h-3"}),e.jsx("span",{className:"text-[9px] font-bold uppercase",children:n?"Ukončit Solo":"Opustit"})]})]}),!n&&e.jsxs("div",{className:"flex px-2",children:[e.jsxs("button",{onClick:()=>j("party"),className:`flex-1 py-3 text-xs font-bold uppercase border-b-2 transition-colors ${l==="party"?"border-signal-amber text-white":"border-transparent text-zinc-400"}`,children:["Jednotka (",((T=a.members)==null?void 0:T.length)??0,")"]}),e.jsx("button",{onClick:()=>j("chat"),className:`flex-1 py-3 text-xs font-bold uppercase border-b-2 transition-colors ${l==="chat"?"border-signal-amber text-white":"border-transparent text-zinc-400"}`,children:"Spojení"}),e.jsx("button",{onClick:()=>j("trade"),className:`flex-1 py-3 text-xs font-bold uppercase border-b-2 transition-colors ${l==="trade"?"border-signal-amber text-white":"border-transparent text-zinc-400"}`,children:"Burza"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar relative z-10",children:[l==="party"&&e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"bg-zinc-900/50 p-5 rounded-2xl border border-zinc-800 relative overflow-hidden",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-6",children:[e.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded bg-black/40 border ${a.isGameStarted||n?"border-green-500/30 text-green-500":"border-red-500/30 text-red-500"}`,children:[e.jsx(X,{className:"w-2.5 h-2.5"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:n?"NEZÁVISLÁ_JEDNOTKA":a.isGameStarted?"MISE_PROBÍHÁ":"SYSTÉM_PŘIPRAVEN"})]}),!n&&k&&e.jsx("div",{className:"bg-signal-amber/10 text-signal-amber px-2 py-1 rounded text-[9px] font-black uppercase tracking-widest border border-signal-amber/30",children:"AUTORITA_SEKTORU"}),!n&&!k&&a.host&&e.jsxs("div",{className:"bg-zinc-800 text-zinc-500 px-2 py-1 rounded text-[9px] font-black uppercase tracking-widest border border-zinc-700",children:["Hostitel: ",a.host]})]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-bold uppercase text-zinc-500 tracking-[0.2em] block mb-1",children:"Označení_Sektoru"}),e.jsx("span",{className:"text-xl font-mono font-black text-white leading-tight",children:n?"LOKÁLNÍ_BATOH":a.id})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase text-zinc-500 tracking-[0.2em] block mb-1",children:"Cyklus"}),e.jsx("span",{className:"text-3xl font-mono font-black text-signal-cyan leading-none",children:n?1:a.roundNumber})]})]}),!n&&!a.isGameStarted&&e.jsxs("div",{className:"mt-6 flex gap-2",children:[I&&e.jsx("button",{onClick:I,className:`flex-1 py-4 font-black uppercase rounded-xl transition-all active:scale-95 border ${(P=(a.members||[]).find(s=>s.name===a.nickname))!=null&&P.isReady?"bg-green-500/10 border-green-500 text-green-500":"bg-zinc-800 border-zinc-700 text-zinc-400 hover:text-white"}`,children:(E=(a.members||[]).find(s=>s.name===a.nickname))!=null&&E.isReady?"JSME PŘIPRAVENI":"POTVRDIT PŘIPRAVENOST"}),k&&e.jsxs("button",{onClick:G,disabled:!(a.members||[]).every(s=>s.isReady),className:`flex-1 py-4 font-black uppercase rounded-xl flex items-center justify-center gap-3 transition-transform shadow-[0_0_20px_rgba(255,157,0,0.3)] active:scale-95 cursor-pointer ${(a.members||[]).length>0&&(a.members||[]).every(s=>s.isReady)?"bg-signal-amber text-black opacity-100":"bg-zinc-800 text-zinc-500 opacity-50 cursor-not-allowed shadow-none"}`,children:[e.jsx(Y,{className:"w-5 h-5 fill-current"}),"START"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.3em] pl-1",children:"Aktivní_Jednotky_V_Dosahu"}),n?e.jsxs("div",{className:"bg-black border border-signal-cyan/30 bg-signal-cyan/5 p-4 rounded-xl flex items-center gap-4 shadow-[inset_0_0_20px_rgba(0,242,255,0.05)]",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center font-black text-lg border-2 border-signal-cyan bg-signal-cyan/10 text-signal-cyan",children:a.nickname.substring(0,2).toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-black text-white uppercase tracking-wider",children:a.nickname}),d&&e.jsxs("div",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-zinc-800 rounded border border-zinc-700",children:[be(d),e.jsx("span",{className:"text-[8px] font-mono text-zinc-400 uppercase font-bold",children:d})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(q,{className:"w-3 h-3 text-signal-hazard"}),e.jsxs("span",{className:"font-mono font-black text-sm text-white",children:[h??100," HP"]})]})]}),e.jsx("div",{className:"h-2 bg-zinc-800 rounded-full overflow-hidden border border-white/5",children:e.jsx(o.div,{initial:{width:0},animate:{width:`${h??100}%`},className:`h-full transition-all duration-500 ${(h??100)<30?"bg-red-600 shadow-[0_0_10px_rgba(220,38,38,0.5)]":"bg-signal-cyan shadow-[0_0_10px_rgba(0,242,255,0.3)]"}`})})]})]}):(D=a.members)==null?void 0:D.map((s,t)=>{const i=s.name===a.nickname,b=a.isGameStarted&&a.turnOrder[a.turnIndex]===s.name;return e.jsxs("div",{className:`bg-black border p-4 rounded-xl flex items-center gap-4 transition-all ${i?"border-signal-cyan/30 bg-signal-cyan/5 shadow-[inset_0_0_20px_rgba(0,242,255,0.05)]":"border-zinc-800"} ${b?"ring-2 ring-signal-amber border-signal-amber bg-signal-amber/5 animate-pulse":""}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm border-2 ${i?"border-signal-cyan bg-signal-cyan/10 text-signal-cyan":b?"border-signal-amber bg-signal-amber/10 text-signal-amber":"border-zinc-700 bg-zinc-900 text-zinc-300"}`,children:s.name.substring(0,2).toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-bold text-sm ${i?"text-white":"text-zinc-200"}`,children:s.name}),i&&d&&e.jsx("div",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-black/50 rounded border border-white/10",children:e.jsx("span",{className:"text-[7px] font-mono text-zinc-400 uppercase font-bold",children:d})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[!a.isGameStarted&&e.jsx("div",{className:`w-3 h-3 rounded-full border ${s.isReady?"bg-green-500 border-green-400 shadow-[0_0_8px_lime]":"bg-transparent border-zinc-600"}`}),e.jsxs("span",{className:`font-mono font-bold text-xs ${s.hp<30?"text-red-500":"text-green-500"}`,children:[s.hp," HP"]})]})]}),e.jsx("div",{className:"h-1.5 bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-500 ${s.hp<30?"bg-red-600 shadow-[0_0_8px_rgba(220,38,38,0.5)]":"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.3)]"}`,style:{width:`${Math.min(100,Math.max(0,s.hp))}%`}})})]})]},t)})]}),n&&e.jsxs("div",{className:"mt-8 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 pl-1 mb-2",children:[e.jsx(ee,{className:"w-4 h-4 text-signal-cyan"}),e.jsx("h3",{className:"text-[10px] font-black text-white/70 uppercase tracking-[0.3em]",children:"Průzkumný_Deník"})]}),e.jsxs("div",{className:"bg-zinc-900/40 border border-white/5 rounded-xl p-4 h-[250px] overflow-y-auto no-scrollbar font-mono text-[10px] space-y-2 relative",children:[u.length===0?e.jsx("div",{className:"h-full flex items-center justify-center text-zinc-600 italic",children:"Čekám na záznam dat..."}):u.map((s,t)=>e.jsxs(o.div,{initial:{opacity:0,x:-5},animate:{opacity:1,x:0},key:t,className:"flex gap-2 text-zinc-400 border-l border-zinc-700 pl-2 py-0.5",children:[e.jsxs("span",{className:"text-signal-cyan/50",children:["[",new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),"]"]}),e.jsx("span",{className:"text-zinc-300",children:s})]})),e.jsx("div",{ref:$}),e.jsx("div",{className:"absolute inset-0 pointer-events-none shadow-[inset_0_0_40px_rgba(0,0,0,0.5)]"})]})]})]}),l==="chat"&&!n&&e.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 no-scrollbar",children:[a.messages.map(s=>{const t=s.text.startsWith("[NABÍDKA]");return e.jsx("div",{className:`flex flex-col ${s.sender===a.nickname?"items-end":"items-start"}`,children:s.isSystem?e.jsx("div",{className:"w-full text-center my-2",children:e.jsx("span",{className:"text-[9px] bg-zinc-900 px-3 py-1 rounded text-zinc-500 font-mono uppercase tracking-widest border border-white/5",children:s.text})}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-[9px] font-black uppercase text-zinc-500 mb-1",children:s.sender}),t?e.jsxs("div",{className:`p-4 rounded-2xl max-w-[90%] border bg-black overflow-hidden relative ${s.sender===a.nickname?"border-signal-amber/50 rounded-tr-none":"border-signal-cyan/50 rounded-tl-none"}`,children:[e.jsx("div",{className:`absolute top-0 left-0 w-full h-0.5 animate-pulse ${s.sender===a.nickname?"bg-signal-amber":"bg-signal-cyan"}`}),e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:`p-2 rounded-lg bg-white/5 ${s.sender===a.nickname?"text-signal-amber":"text-signal-cyan"}`,children:e.jsx(L,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black uppercase text-zinc-500 mb-0.5 tracking-widest",children:"Sektorový_Transfer"}),e.jsx("p",{className:"text-sm font-bold text-white uppercase leading-tight",children:s.text.replace("[NABÍDKA] ","").split(" (ID:")[0]})]})]}),s.sender!==a.nickname&&e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[e.jsxs("button",{onClick:()=>S(s.text),className:"flex items-center justify-center gap-2 py-2.5 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg text-[10px] font-black uppercase tracking-wider transition-colors",children:[e.jsx(se,{className:"w-3 h-3"})," Inspekce"]}),e.jsxs("button",{onClick:()=>W(s.sender,s.text),className:"flex items-center justify-center gap-2 py-2.5 bg-signal-cyan text-black hover:bg-white rounded-lg text-[10px] font-black uppercase tracking-wider transition-colors shadow-[0_0_10px_rgba(0,242,255,0.2)]",children:[e.jsx(ae,{className:"w-3 h-3"})," Převzít"]})]})]}):e.jsx("div",{className:`p-3 rounded-2xl text-sm max-w-[85%] ${s.sender===a.nickname?"bg-signal-cyan/10 border border-signal-cyan/30 text-white rounded-tr-none":"bg-zinc-800 text-zinc-100 rounded-tl-none"}`,children:s.text})]})},s.id)}),e.jsx("div",{ref:A})]}),e.jsxs("form",{onSubmit:F,className:"p-3 bg-black border-t border-zinc-800 flex gap-2",children:[e.jsx("input",{type:"text",value:p,onChange:s=>R(s.target.value),placeholder:"Zpráva sektoru...",className:"flex-1 bg-zinc-900 border border-zinc-800 rounded-xl px-4 py-3 text-white outline-none focus:border-signal-cyan text-sm"}),e.jsx("button",{type:"submit",disabled:!p.trim(),className:"bg-signal-cyan text-black p-3 rounded-xl active:scale-90",children:e.jsx(te,{className:"w-5 h-5"})})]})]}),l==="trade"&&!n&&e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 bg-white/5 border border-white/10 rounded-3xl text-center space-y-4",children:[e.jsx(ne,{className:"w-12 h-12 text-signal-amber animate-pulse"}),e.jsx("h3",{className:"text-xl font-black uppercase tracking-widest",children:"Sektorová_Burza"}),e.jsx("p",{className:"text-xs text-zinc-500 font-mono leading-relaxed",children:"Zde můžete směňovat assety z Batohu s ostatními jednotkami v sektoru v reálném čase."}),e.jsx("button",{onClick:Z,className:"px-6 py-3 bg-signal-amber text-black font-black uppercase text-[10px] tracking-widest rounded-xl shadow-[0_0_20px_rgba(255,157,0,0.2)]",children:"Vytvořit Nabídku"})]})})]}),e.jsx(M,{children:K&&e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[300] bg-black/98 backdrop-blur-2xl flex flex-col items-center justify-center p-8 text-center",children:e.jsxs(o.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"w-full max-w-sm space-y-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-20 h-20 bg-red-950/20 border border-red-500/50 rounded-full flex items-center justify-center mx-auto shadow-[0_0_30px_rgba(239,68,68,0.2)]",children:e.jsx(V,{className:"w-10 h-10 text-red-500"})}),e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter chromatic-text",children:"Odpojení"}),e.jsxs("p",{className:"text-sm text-zinc-500 font-bold uppercase tracking-widest",children:["Opouštíte Sektor ",n?"LOKÁLNÍ":a.id,". Jak chcete pokračovat?"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:f,className:"w-full group p-5 bg-zinc-900 border border-zinc-700 hover:border-signal-cyan rounded-2xl flex items-center gap-5 transition-all active:scale-95 text-left",children:[e.jsx("div",{className:"p-3 bg-signal-cyan/10 rounded-xl text-signal-cyan group-hover:scale-110 transition-transform",children:e.jsx(ie,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-white uppercase text-sm tracking-widest",children:"Založit Nový Sektor"}),e.jsx("p",{className:"text-[10px] text-zinc-500 uppercase font-bold mt-1",children:"Vytvořit novou místnost pro skupinu"})]})]}),e.jsxs("button",{onClick:f,className:"w-full group p-5 bg-zinc-900 border border-zinc-700 hover:border-signal-amber rounded-2xl flex items-center gap-5 transition-all active:scale-95 text-left",children:[e.jsx("div",{className:"p-3 bg-signal-amber/10 rounded-xl text-signal-amber group-hover:scale-110 transition-transform",children:e.jsx(re,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-white uppercase text-sm tracking-widest",children:"Vstoupit do jiného Sektoru"}),e.jsx("p",{className:"text-[10px] text-zinc-500 uppercase font-bold mt-1",children:"Zadat kód pro připojení k jednotce"})]})]}),e.jsxs("button",{onClick:f,className:"w-full group p-5 bg-zinc-900 border border-zinc-700 hover:border-white rounded-2xl flex items-center gap-5 transition-all active:scale-95 text-left",children:[e.jsx("div",{className:"p-3 bg-white/10 rounded-xl text-white group-hover:scale-110 transition-transform",children:e.jsx(le,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-white uppercase text-sm tracking-widest",children:"Samostatná Mise (Online)"}),e.jsx("p",{className:"text-[10px] text-zinc-500 uppercase font-bold mt-1",children:"Pokračovat sólo se synchronizací Vaultu"})]})]})]}),e.jsx("button",{onClick:()=>C(!1),className:"text-zinc-500 text-[10px] font-black uppercase tracking-[0.4em] hover:text-white transition-colors",children:"Zrušit a zůstat v misi"})]})})}),e.jsx(M,{children:(H||c)&&e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-[100] bg-black/95 backdrop-blur-xl flex flex-col p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-black uppercase tracking-widest text-white",children:c?"Vyberte_Protihodnotu":"Vyberte_Asset_z_Batohu"}),e.jsx("button",{onClick:()=>{N(!1),v(null)},className:"p-2 bg-white/5 rounded-full text-zinc-400",children:e.jsx(ce,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar space-y-4",children:U.map(s=>e.jsxs("button",{onClick:()=>{c?Q(s):J(s)},className:"w-full p-4 tactical-card border-white/10 bg-white/5 flex gap-4 text-left active:scale-[0.98] group overflow-hidden",children:[e.jsx("div",{className:"w-14 h-14 bg-black border border-zinc-800 rounded-lg flex items-center justify-center shrink-0",children:e.jsx(L,{className:"w-7 h-7 text-signal-cyan"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-[11px] font-black uppercase text-white truncate block",children:s.title}),e.jsx("p",{className:"text-[9px] text-zinc-500 font-mono line-clamp-2 uppercase italic",children:s.description})]})]},s.id))})]})})]})};export{ge as default};
